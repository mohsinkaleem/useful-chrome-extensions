<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tab Manager</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="icons.css">
</head>
<body>
  <div id="app">
    <!-- Header -->
    <header class="header">
      <h1 class="title">Tab Manager</h1>
      <div class="header-stats">
        <span id="tab-count">0 tabs</span>
        <span class="stat-sep">•</span>
        <span id="window-count">0 windows</span>
        <span class="stat-sep">•</span>
        <button id="merge-windows-btn" class="action-btn" style="display: none;" title="Merge Selected Windows"><span class="icon icon-merge"></span> Merge</button>
        <button id="theme-toggle" class="action-btn small" title="Toggle Dark Mode" style="border:none; background:transparent; padding:0; line-height:1; cursor:pointer;"><span class="icon icon-md icon-moon"></span></button>
      </div>
    </header>

    <!-- Search & Filters Section (Compact) -->
    <div class="search-section-compact">
      <input 
        type="text" 
        id="search-input" 
        class="search-input" 
        placeholder="Search tabs..."
      />
      <div class="filter-chips-compact">
        <label class="filter-chip-icon" title="Filter audible tabs">
          <input type="checkbox" id="filter-audible" />
          <span class="filter-icon"><span class="icon icon-sound"></span></span>
        </label>
        <label class="filter-chip-icon" title="Filter pinned tabs">
          <input type="checkbox" id="filter-pinned" />
          <span class="filter-icon"><span class="icon icon-pin"></span></span>
        </label>
        <label class="filter-chip-icon" title="Highlight duplicate tabs">
          <input type="checkbox" id="filter-duplicates" />
          <span class="filter-icon"><span class="icon icon-duplicate"></span></span>
        </label>
      </div>
      <div class="view-controls">
        <button id="open-sidepanel" class="view-btn" title="Open Side Panel"><span class="icon icon-sidebar"></span></button>
        <div class="view-sep" style="width: 1px; height: 16px; background: #ddd; margin: 0 4px;"></div>
        <button id="view-list" class="view-btn active" title="List view"><span class="icon icon-list"></span></button>
        <button id="view-compact" class="view-btn" title="Compact view"><span class="icon icon-menu"></span></button>
        <button id="view-grid" class="view-btn" title="Grid view"><span class="icon icon-grid"></span></button>
      </div>
    </div>

    <!-- Collapsible Panels Section -->
    <div class="panels-container">
      <!-- Media Controls (only shown when media tabs exist) -->
      <details class="panel" id="media-section">
        <summary class="panel-header">
          <span class="panel-icon"><span class="icon icon-sound"></span></span>
          <span>Media Tabs</span>
          <span class="panel-badge" id="media-badge">0</span>
        </summary>
        <div class="panel-content">
          <div id="media-tabs" class="media-tabs-list"></div>
        </div>
      </details>

      <!-- Unified Actions Bar -->
      <div class="unified-actions-bar">
        <button id="action-close-duplicates" class="action-btn-inline" title="Close duplicate tabs">
          <span class="icon icon-trash"></span> (<strong id="duplicate-count">0</strong>)
        </button>
        <div class="action-divider"></div>
        <button id="action-close-selected" class="action-btn-inline" disabled title="Close selected tabs"><span class="icon icon-close"></span></button>
        <button id="action-bookmark-selected" class="action-btn-inline" disabled title="Bookmark selected tabs"><span class="icon icon-star"></span></button>
        <button id="action-bookmark-all" class="action-btn-inline" title="Bookmark all tabs"><span class="icon icon-star-filled"></span> All</button>
        <button id="action-group-selected" class="action-btn-inline" disabled title="Group selected tabs"><span class="icon icon-group"></span></button>
        
        <div style="display: flex; align-items: center; gap: 4px; border-left: 1px solid #ddd; padding-left: 4px;">
            <button id="action-balance-windows" class="action-btn-inline" title="Balance windows (Re-arrange tabs)"><span class="icon icon-balance"></span></button>
            <button id="action-group-all" class="action-btn-inline" title="Group all tabs by domain"><span class="icon icon-folder-plus"></span></button>
            <button id="action-ungroup-all" class="action-btn-inline" title="Ungroup all tabs"><span class="icon icon-ungroup"></span></button>
        </div>
        
        <button id="action-save-session" class="action-btn-inline" title="Save session"><span class="icon icon-save"></span></button>
      </div>
    </div>

    <!-- Main Tabs Container (scrollable area) -->
    <div id="tabs-container" class="tabs-container">
      <!-- Windows and tabs will be dynamically inserted here -->
    </div>

    <!-- Session Manager (Modal) -->
    <div id="session-modal" class="modal hidden">
      <div class="modal-content">
        <h2>Session Manager</h2>
        <div id="sessions-list"></div>
        <div class="modal-actions">
          <input type="text" id="session-name" placeholder="Session name..." />
          <button id="save-session-btn">Save Current Session</button>
          <button id="close-modal-btn">Close</button>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="dist/popup/popup.js"></script>
</body>
</html>
