function e(){}function t(e){return e()}function n(){return Object.create(null)}function r(e){e.forEach(t)}function i(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let a,s;function l(e,t){return e===t||(a||(a=document.createElement("a")),a.href=t,e===a.href)}function c(t,...n){if(null==t){for(const e of n)e(void 0);return e}const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function u(e,t,n){e.$$.on_destroy.push(c(t,n))}function d(e,t){e.appendChild(t)}function h(e,t,n){e.insertBefore(t,n||null)}function f(e){e.parentNode&&e.parentNode.removeChild(e)}function p(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function g(e){return document.createElement(e)}function m(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function y(e){return document.createTextNode(e)}function b(){return y(" ")}function v(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function x(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function w(e,t){t=""+t,e.data!==t&&(e.data=t)}function k(e,t){e.value=null==t?"":t}function _(e,t,n,r){null==n?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}function A(e,t,n){e.classList.toggle(t,!!n)}function C(e){s=e}function S(){if(!s)throw new Error("Function called outside component initialization");return s}function j(e){S().$$.on_mount.push(e)}function P(){const e=S();return(t,n,{cancelable:r=!1}={})=>{const i=e.$$.callbacks[t];if(i){const o=function(e,t,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:r})}(t,n,{cancelable:r});return i.slice().forEach(t=>{t.call(e,o)}),!o.defaultPrevented}return!0}}const E=[],T=[];let M=[];const O=[],D=Promise.resolve();let B=!1;function I(e){M.push(e)}const R=new Set;let $=0;function K(){if(0!==$)return;const e=s;do{try{for(;$<E.length;){const e=E[$];$++,C(e),q(e.$$)}}catch(e){throw E.length=0,$=0,e}for(C(null),E.length=0,$=0;T.length;)T.pop()();for(let e=0;e<M.length;e+=1){const t=M[e];R.has(t)||(R.add(t),t())}M.length=0}while(E.length);for(;O.length;)O.pop()();B=!1,R.clear(),C(e)}function q(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(I)}}const L=new Set;let F;function z(){F={r:0,c:[],p:F}}function N(){F.r||r(F.c),F=F.p}function W(e,t){e&&e.i&&(L.delete(e),e.i(t))}function U(e,t,n,r){if(e&&e.o){if(L.has(e))return;L.add(e),F.c.push(()=>{L.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}else r&&r()}function H(e){return void 0!==e?.length?e:Array.from(e)}function V(e,t){U(e,1,1,()=>{t.delete(e.key)})}function Q(e){e&&e.c()}function Y(e,n,o){const{fragment:a,after_update:s}=e.$$;a&&a.m(n,o),I(()=>{const n=e.$$.on_mount.map(t).filter(i);e.$$.on_destroy?e.$$.on_destroy.push(...n):r(n),e.$$.on_mount=[]}),s.forEach(I)}function G(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];M.forEach(r=>-1===e.indexOf(r)?t.push(r):n.push(r)),n.forEach(e=>e()),M=t}(n.after_update),r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function J(e,t){-1===e.$$.dirty[0]&&(E.push(e),B||(B=!0,D.then(K)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function X(t,i,o,a,l,c,u=null,d=[-1]){const h=s;C(t);const p=t.$$={fragment:null,ctx:[],props:c,update:e,not_equal:l,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(i.context||(h?h.$$.context:[])),callbacks:n(),dirty:d,skip_bound:!1,root:i.target||h.$$.root};u&&u(p.root);let g=!1;if(p.ctx=o?o(t,i.props||{},(e,n,...r)=>{const i=r.length?r[0]:n;return p.ctx&&l(p.ctx[e],p.ctx[e]=i)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](i),g&&J(t,e)),n}):[],p.update(),g=!0,r(p.before_update),p.fragment=!!a&&a(p.ctx),i.target){if(i.hydrate){const e=function(e){return Array.from(e.childNodes)}(i.target);p.fragment&&p.fragment.l(e),e.forEach(f)}else p.fragment&&p.fragment.c();i.intro&&W(t.$$.fragment),Y(t,i.target,i.anchor),K()}C(h)}class Z{$$=void 0;$$set=void 0;$destroy(){G(this,1),this.$destroy=e}$on(t,n){if(!i(n))return e;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const e=r.indexOf(n);-1!==e&&r.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function ee(e){return new Date(e).toLocaleDateString()}function te(e){if(e.faviconUrl)return e.faviconUrl;if(e.url&&(e.url.startsWith("http://")||e.url.startsWith("https://")))try{return`https://www.google.com/s2/favicons?domain=${e.domain||new URL(e.url).hostname}&sz=32`}catch(e){}return function(e){if(e.url.startsWith("http://")||e.url.startsWith("https://")){const t=e.domain||"unknown",n=t.charAt(0).toUpperCase(),r=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899"];return`data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="${r[t.length%r.length]}"/><text x="8" y="12" font-family="Arial" font-size="10" text-anchor="middle" fill="white" font-weight="bold">${n}</text></svg>`}switch(e.domain||""){case"chrome-internal":return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%23EA4335"/><circle cx="8" cy="8" r="3" fill="white"/></svg>';case"local-file":return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%23F59E0B"/><text x="8" y="12" font-family="Arial" font-size="10" text-anchor="middle" fill="white">ðŸ“„</text></svg>';case"javascript-bookmarklet":return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%23F7DF1E"/><text x="8" y="12" font-family="Arial" font-size="8" text-anchor="middle" fill="black" font-weight="bold">JS</text></svg>';case"data-uri":return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%2310B981"/><text x="8" y="12" font-family="Arial" font-size="8" text-anchor="middle" fill="white" font-weight="bold">D</text></svg>';case"contact-link":return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%238B5CF6"/><text x="8" y="12" font-family="Arial" font-size="10" text-anchor="middle" fill="white">@</text></svg>';case"other-protocol":return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%236B7280"/><text x="8" y="12" font-family="Arial" font-size="10" text-anchor="middle" fill="white">âš¡</text></svg>';default:return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%23E5E7EB"/><text x="8" y="12" font-family="Arial" font-size="10" text-anchor="middle" fill="%236B7280">?</text></svg>'}}(e)}function ne(e){switch(e.domain){case"chrome-internal":return"Chrome";case"local-file":return"Local File";case"javascript-bookmarklet":return"Bookmarklet";case"data-uri":return"Data URI";case"contact-link":return"Contact";case"other-protocol":return"Other";case"invalid-url":return"Invalid URL";default:return e.domain}}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");const re={RELEVANCE:{key:"relevance",label:"Best Match",sort:(e,t)=>(t._searchScore||0)-(e._searchScore||0)},DATE_DESC:{key:"date_desc",label:"Newest First",sort:(e,t)=>t.dateAdded-e.dateAdded},DATE_ASC:{key:"date_asc",label:"Oldest First",sort:(e,t)=>e.dateAdded-t.dateAdded},TITLE_ASC:{key:"title_asc",label:"Title A-Z",sort:(e,t)=>(e.title||"").localeCompare(t.title||"")},TITLE_DESC:{key:"title_desc",label:"Title Z-A",sort:(e,t)=>(t.title||"").localeCompare(e.title||"")},DOMAIN_ASC:{key:"domain_asc",label:"Domain A-Z",sort:(e,t)=>(e.domain||"").localeCompare(t.domain||"")}};function ie(e){const t=Object.values(re).find(t=>t.key===e);return t?t.sort:re.DATE_DESC.sort}function oe(e,t){if(!e||!t)return e;const{positive:n,phrases:r,regular:i,regexPatterns:o}=t,a=[...n||[],...r||[],...i||[]];if(0===a.length&&(!o||0===o.length))return e;const s=[];a.forEach(t=>{if(!t)return;const n=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),r=new RegExp(n,"gi");let i;for(;null!==(i=r.exec(e));)s.push({start:i.index,end:i.index+i[0].length})}),o&&o.forEach(t=>{const n=t.flags.includes("g")?t.flags:t.flags+"g";try{const r=new RegExp(t.source,n);let i;for(;null!==(i=r.exec(e));)s.push({start:i.index,end:i.index+i[0].length}),i.index===r.lastIndex&&r.lastIndex++}catch(e){console.warn("Invalid regex for highlighting:",e)}}),s.sort((e,t)=>e.start-t.start);const l=[];if(s.length>0){let e=s[0];for(let t=1;t<s.length;t++){const n=s[t];n.start<e.end?e.end=Math.max(e.end,n.end):(l.push(e),e=n)}l.push(e)}let c=e;for(let e=l.length-1;e>=0;e--){const{start:t,end:n}=l[e],r=c.slice(0,t),i=c.slice(t,n),o=c.slice(n);c=`${r}<mark class="bg-yellow-200 text-gray-900 rounded-sm px-0.5">${i}</mark>${o}`}return c}const ae=[];function se(t,n=e){let r;const i=new Set;function a(e){if(o(t,e)&&(t=e,r)){const e=!ae.length;for(const e of i)e[1](),ae.push(e,t);if(e){for(let e=0;e<ae.length;e+=2)ae[e][0](ae[e+1]);ae.length=0}}}function s(e){a(e(t))}return{set:a,update:s,subscribe:function(o,l=e){const c=[o,l];return i.add(c),1===i.size&&(r=n(a,s)||e),o(t),()=>{i.delete(c),0===i.size&&r&&(r(),r=null)}}}}function le(t,n,o){const a=!Array.isArray(t),s=a?[t]:t;if(!s.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const l=n.length<2;return u=(t,o)=>{let u=!1;const d=[];let h=0,f=e;const p=()=>{if(h)return;f();const r=n(a?d[0]:d,t,o);l?t(r):f=i(r)?r:e},g=s.map((e,t)=>c(e,e=>{d[t]=e,h&=~(1<<t),u&&p()},()=>{h|=1<<t}));return u=!0,p(),function(){r(g),f(),u=!1}},{subscribe:se(o,u).subscribe};var u}var ce="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function ue(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var de={exports:{}};de.exports=function(){
/*! *****************************************************************************
	    Copyright (c) Microsoft Corporation.
	    Permission to use, copy, modify, and/or distribute this software for any
	    purpose with or without fee is hereby granted.
	    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	    PERFORMANCE OF THIS SOFTWARE.
	    ***************************************************************************** */
var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};function t(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var n=function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};function r(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:ce,o=Object.keys,a=Array.isArray;function s(e,t){return"object"!=typeof t||o(t).forEach(function(n){e[n]=t[n]}),e}"undefined"==typeof Promise||i.Promise||(i.Promise=Promise);var l=Object.getPrototypeOf,c={}.hasOwnProperty;function u(e,t){return c.call(e,t)}function d(e,t){"function"==typeof t&&(t=t(l(e))),("undefined"==typeof Reflect?o:Reflect.ownKeys)(t).forEach(function(n){f(e,n,t[n])})}var h=Object.defineProperty;function f(e,t,n,r){h(e,t,s(n&&u(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function p(e){return{from:function(t){return e.prototype=Object.create(t.prototype),f(e.prototype,"constructor",e),{extend:d.bind(null,e.prototype)}}}}var g=Object.getOwnPropertyDescriptor;function m(e,t){var n;return g(e,t)||(n=l(e))&&m(n,t)}var y=[].slice;function b(e,t,n){return y.call(e,t,n)}function v(e,t){return t(e)}function x(e){if(!e)throw new Error("Assertion Failed")}function w(e){i.setImmediate?setImmediate(e):setTimeout(e,0)}function k(e,t){return e.reduce(function(e,n,r){var i=t(n,r);return i&&(e[i[0]]=i[1]),e},{})}function _(e,t){if("string"==typeof t&&u(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,i=t.length;r<i;++r){var o=_(e,t[r]);n.push(o)}return n}var a=t.indexOf(".");if(-1!==a){var s=e[t.substr(0,a)];return null==s?void 0:_(s,t.substr(a+1))}}function A(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){x("string"!=typeof n&&"length"in n);for(var r=0,i=t.length;r<i;++r)A(e,t[r],n[r])}else{var o=t.indexOf(".");if(-1!==o){var s=t.substr(0,o),l=t.substr(o+1);if(""===l)void 0===n?a(e)&&!isNaN(parseInt(s))?e.splice(s,1):delete e[s]:e[s]=n;else{var c=e[s];c&&u(e,s)||(c=e[s]={}),A(c,l,n)}}else void 0===n?a(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function C(e,t){"string"==typeof t?A(e,t,void 0):"length"in t&&[].map.call(t,function(t){A(e,t,void 0)})}function S(e){var t={};for(var n in e)u(e,n)&&(t[n]=e[n]);return t}var j=[].concat;function P(e){return j.apply([],e)}var E="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(P([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return i[e]}),T=new Set(E.map(function(e){return i[e]}));function M(e){var t={};for(var n in e)if(u(e,n)){var r=e[n];t[n]=!r||"object"!=typeof r||T.has(r.constructor)?r:M(r)}return t}function O(e){for(var t in e)if(u(e,t))return!1;return!0}var D=null;function B(e){D=new WeakMap;var t=I(e);return D=null,t}function I(e){if(!e||"object"!=typeof e)return e;var t=D.get(e);if(t)return t;if(a(e)){t=[],D.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(I(e[n]))}else if(T.has(e.constructor))t=e;else{var i=l(e);for(var o in t=i===Object.prototype?{}:Object.create(i),D.set(e,t),e)u(e,o)&&(t[o]=I(e[o]))}return t}var R={}.toString;function $(e){return R.call(e).slice(8,-1)}var K="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",q="symbol"==typeof K?function(e){var t;return null!=e&&(t=e[K])&&t.apply(e)}:function(){return null};function L(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),n>=0}var F={};function z(e){var t,n,r,i;if(1===arguments.length){if(a(e))return e.slice();if(this===F&&"string"==typeof e)return[e];if(i=q(e)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var N="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},W=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],U=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(W),H={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function V(e,t){this.name=e,this.message=t}function Q(e,t){return e+". Errors: "+Object.keys(t).map(function(e){return t[e].toString()}).filter(function(e,t,n){return n.indexOf(e)===t}).join("\n")}function Y(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=Q(e,t)}function G(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(e){return t[e]}),this.failuresByPos=t,this.message=Q(e,this.failures)}p(V).from(Error).extend({toString:function(){return this.name+": "+this.message}}),p(Y).from(V),p(G).from(V);var J=U.reduce(function(e,t){return e[t]=t+"Error",e},{}),X=V,Z=U.reduce(function(e,t){var n=t+"Error";function r(e,r){this.name=n,e?"string"==typeof e?(this.message="".concat(e).concat(r?"\n "+r:""),this.inner=r||null):"object"==typeof e&&(this.message="".concat(e.name," ").concat(e.message),this.inner=e):(this.message=H[t]||n,this.inner=null)}return p(r).from(X),e[t]=r,e},{});Z.Syntax=SyntaxError,Z.Type=TypeError,Z.Range=RangeError;var ee=W.reduce(function(e,t){return e[t+"Error"]=Z[t],e},{});function te(e,t){if(!e||e instanceof V||e instanceof TypeError||e instanceof SyntaxError||!e.name||!ee[e.name])return e;var n=new ee[e.name](t||e.message,e);return"stack"in e&&f(n,"stack",{get:function(){return this.inner.stack}}),n}var ne=U.reduce(function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=Z[t]),e},{});function re(){}function ie(e){return e}function oe(e,t){return null==e||e===ie?t:function(n){return t(e(n))}}function ae(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function se(e,t){return e===re?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?ae(r,this.onsuccess):r),i&&(this.onerror=this.onerror?ae(i,this.onerror):i),void 0!==o?o:n}}function le(e,t){return e===re?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?ae(n,this.onsuccess):n),r&&(this.onerror=this.onerror?ae(r,this.onerror):r)}}function ue(e,t){return e===re?t:function(n){var r=e.apply(this,arguments);s(n,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?ae(i,this.onsuccess):i),o&&(this.onerror=this.onerror?ae(o,this.onerror):o),void 0===r?void 0===a?void 0:a:s(r,a)}}function de(e,t){return e===re?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function he(e,t){return e===re?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then(function(){return t.apply(r,o)})}return t.apply(this,arguments)}}ne.ModifyError=Y,ne.DexieError=V,ne.BulkError=G;var fe="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function pe(e,t){fe=e}var ge={},me=100,ye="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,l(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,l(t),e]}(),be=ye[0],ve=ye[1],xe=ye[2],we=ve&&ve.then,ke=be&&be.constructor,_e=!!xe;function Ae(){queueMicrotask(We)}var Ce=function(e,t){De.push([e,t]),je&&(Ae(),je=!1)},Se=!0,je=!0,Pe=[],Ee=[],Te=ie,Me={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:re,pgp:!1,env:{},finalize:re},Oe=Me,De=[],Be=0,Ie=[];function Re(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=Oe;if("function"!=typeof e){if(e!==ge)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Le(this,this._value))}this._state=null,this._value=null,++t.ref,qe(this,e)}var $e={get:function(){var e=Oe,t=rt;function n(n,r){var i=this,o=!e.global&&(e!==Oe||t!==rt),a=o&&!st(),s=new Re(function(t,s){ze(i,new Ke(pt(n,e,o,a),pt(r,e,o,a),t,s,e))});return this._consoleTask&&(s._consoleTask=this._consoleTask),s}return n.prototype=ge,n},set:function(e){f(this,"then",e&&e.prototype===ge?$e:{get:function(){return e},set:$e.set})}};function Ke(e,t,n,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=i}function qe(e,t){try{t(function(t){if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&Ue();t&&"function"==typeof t.then?qe(e,function(e,n){t instanceof Re?t._then(e,n):t.then(e,n)}):(e._state=!0,e._value=t,Fe(e)),n&&He()}},Le.bind(null,e))}catch(t){Le(e,t)}}function Le(e,t){if(Ee.push(t),null===e._state){var n=e._lib&&Ue();t=Te(t),e._state=!1,e._value=t,Ye(e),Fe(e),n&&He()}}function Fe(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)ze(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),0===Be&&(++Be,Ce(function(){0===--Be&&Ve()},[]))}function ze(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Be,Ce(Ne,[n,e,t])}else e._listeners.push(t)}function Ne(e,t,n){try{var r,i=t._value;!t._state&&Ee.length&&(Ee=[]),r=fe&&t._consoleTask?t._consoleTask.run(function(){return e(i)}):e(i),t._state||-1!==Ee.indexOf(i)||Ge(t),n.resolve(r)}catch(e){n.reject(e)}finally{0===--Be&&Ve(),--n.psd.ref||n.psd.finalize()}}function We(){ft(Me,function(){Ue()&&He()})}function Ue(){var e=Se;return Se=!1,je=!1,e}function He(){var e,t,n;do{for(;De.length>0;)for(e=De,De=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(De.length>0);Se=!0,je=!0}function Ve(){var e=Pe;Pe=[],e.forEach(function(e){e._PSD.onunhandled.call(null,e._value,e)});for(var t=Ie.slice(0),n=t.length;n;)t[--n]()}function Qe(e){function t(){e(),Ie.splice(Ie.indexOf(t),1)}Ie.push(t),++Be,Ce(function(){0===--Be&&Ve()},[])}function Ye(e){Pe.some(function(t){return t._value===e._value})||Pe.push(e)}function Ge(e){for(var t=Pe.length;t;)if(Pe[--t]._value===e._value)return void Pe.splice(t,1)}function Je(e){return new Re(ge,!1,e)}function Xe(e,t){var n=Oe;return function(){var r=Ue(),i=Oe;try{return dt(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{dt(i,!1),r&&He()}}}d(Re.prototype,{then:$e,_then:function(e,t){ze(this,new Ke(null,null,e,t,Oe))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,function(e){return e instanceof t?n(e):Je(e)}):this.then(null,function(e){return e&&e.name===t?n(e):Je(e)})},finally:function(e){return this.then(function(t){return Re.resolve(e()).then(function(){return t})},function(t){return Re.resolve(e()).then(function(){return Je(t)})})},timeout:function(e,t){var n=this;return e<1/0?new Re(function(r,i){var o=setTimeout(function(){return i(new Z.Timeout(t))},e);n.then(r,i).finally(clearTimeout.bind(null,o))}):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&f(Re.prototype,Symbol.toStringTag,"Dexie.Promise"),Me.env=ht(),d(Re,{all:function(){var e=z.apply(null,arguments).map(lt);return new Re(function(t,n){0===e.length&&t([]);var r=e.length;e.forEach(function(i,o){return Re.resolve(i).then(function(n){e[o]=n,--r||t(e)},n)})})},resolve:function(e){return e instanceof Re?e:e&&"function"==typeof e.then?new Re(function(t,n){e.then(t,n)}):new Re(ge,!0,e)},reject:Je,race:function(){var e=z.apply(null,arguments).map(lt);return new Re(function(t,n){e.map(function(e){return Re.resolve(e).then(t,n)})})},PSD:{get:function(){return Oe},set:function(e){return Oe=e}},totalEchoes:{get:function(){return rt}},newPSD:ot,usePSD:ft,scheduler:{get:function(){return Ce},set:function(e){Ce=e}},rejectionMapper:{get:function(){return Te},set:function(e){Te=e}},follow:function(e,t){return new Re(function(n,r){return ot(function(t,n){var r=Oe;r.unhandleds=[],r.onunhandled=n,r.finalize=ae(function(){var e=this;Qe(function(){0===e.unhandleds.length?t():n(e.unhandleds[0])})},r.finalize),e()},t,n,r)})}}),ke&&(ke.allSettled&&f(Re,"allSettled",function(){var e=z.apply(null,arguments).map(lt);return new Re(function(t){0===e.length&&t([]);var n=e.length,r=new Array(n);e.forEach(function(e,i){return Re.resolve(e).then(function(e){return r[i]={status:"fulfilled",value:e}},function(e){return r[i]={status:"rejected",reason:e}}).then(function(){return--n||t(r)})})})}),ke.any&&"undefined"!=typeof AggregateError&&f(Re,"any",function(){var e=z.apply(null,arguments).map(lt);return new Re(function(t,n){0===e.length&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach(function(e,o){return Re.resolve(e).then(function(e){return t(e)},function(e){i[o]=e,--r||n(new AggregateError(i))})})})}),ke.withResolvers&&(Re.withResolvers=ke.withResolvers));var Ze={awaits:0,echoes:0,id:0},et=0,tt=[],nt=0,rt=0,it=0;function ot(e,t,n,r){var i=Oe,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++it,Me.env,o.env=_e?{Promise:Re,PromiseProp:{value:Re,configurable:!0,writable:!0},all:Re.all,race:Re.race,allSettled:Re.allSettled,any:Re.any,resolve:Re.resolve,reject:Re.reject}:{},t&&s(o,t),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=ft(o,e,n,r);return 0===o.ref&&o.finalize(),a}function at(){return Ze.id||(Ze.id=++et),++Ze.awaits,Ze.echoes+=me,Ze.id}function st(){return!!Ze.awaits&&(0===--Ze.awaits&&(Ze.id=0),Ze.echoes=Ze.awaits*me,!0)}function lt(e){return Ze.echoes&&e&&e.constructor===ke?(at(),e.then(function(e){return st(),e},function(e){return st(),mt(e)})):e}function ct(e){++rt,Ze.echoes&&0!==--Ze.echoes||(Ze.echoes=Ze.awaits=Ze.id=0),tt.push(Oe),dt(e,!0)}function ut(){var e=tt[tt.length-1];tt.pop(),dt(e,!1)}function dt(e,t){var n=Oe;if((t?!Ze.echoes||nt++&&e===Oe:!nt||--nt&&e===Oe)||queueMicrotask(t?ct.bind(null,e):ut),e!==Oe&&(Oe=e,n===Me&&(Me.env=ht()),_e)){var r=Me.env.Promise,o=e.env;(n.global||e.global)&&(Object.defineProperty(i,"Promise",o.PromiseProp),r.all=o.all,r.race=o.race,r.resolve=o.resolve,r.reject=o.reject,o.allSettled&&(r.allSettled=o.allSettled),o.any&&(r.any=o.any))}}function ht(){var e=i.Promise;return _e?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function ft(e,t,n,r,i){var o=Oe;try{return dt(e,!0),t(n,r,i)}finally{dt(o,!1)}}function pt(e,t,n,r){return"function"!=typeof e?e:function(){var i=Oe;n&&at(),dt(t,!0);try{return e.apply(this,arguments)}finally{dt(i,!1),r&&queueMicrotask(st)}}}function gt(e){Promise===ke&&0===Ze.echoes?0===nt?e():enqueueNativeMicroTask(e):setTimeout(e,0)}-1===(""+we).indexOf("[native code]")&&(at=st=re);var mt=Re.reject;function yt(e,t,n,r){if(e.idbdb&&(e._state.openComplete||Oe.letThrough||e._vip)){var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(i){return i.name===J.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return yt(e,t,n,r)})):mt(i)}return i._promise(t,function(e,t){return ot(function(){return Oe.trans=i,r(e,t,i)})}).then(function(e){if("readwrite"===t)try{i.idbtrans.commit()}catch(e){}return"readonly"===t?e:i._completion.then(function(){return e})})}if(e._state.openComplete)return mt(new Z.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return mt(new Z.DatabaseClosed);e.open().catch(re)}return e._state.dbReadyPromise.then(function(){return yt(e,t,n,r)})}var bt="4.2.1",vt=String.fromCharCode(65535),xt=-1/0,wt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",kt="String expected.",_t=[],At="__dbnames",Ct="readonly",St="readwrite";function jt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Pt={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Et(e){return"string"!=typeof e||/\./.test(e)?function(e){return e}:function(t){return void 0===t[e]&&e in t&&delete(t=B(t))[e],t}}function Tt(){throw Z.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Mt(e,t){try{var n=Bt(e),r=Bt(t);if(n!==r)return"Array"===n?1:"Array"===r?-1:"binary"===n?1:"binary"===r?-1:"string"===n?1:"string"===r?-1:"Date"===n?1:"Date"!==r?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return Dt(It(e),It(t));case"Array":return Ot(e,t)}}catch(e){}return NaN}function Ot(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,o=0;o<i;++o){var a=Mt(e[o],t[o]);if(0!==a)return a}return n===r?0:n<r?-1:1}function Dt(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,o=0;o<i;++o)if(e[o]!==t[o])return e[o]<t[o]?-1:1;return n===r?0:n<r?-1:1}function Bt(e){var t=typeof e;if("object"!==t)return t;if(ArrayBuffer.isView(e))return"binary";var n=$(e);return"ArrayBuffer"===n?"binary":n}function It(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function Rt(e,t,n){var r=e.schema.yProps;return r?(t&&n.numFailures>0&&(t=t.filter(function(e,t){return!n.failures[t]})),Promise.all(r.map(function(n){var r=n.updatesTable;return t?e.db.table(r).where("k").anyOf(t).delete():e.db.table(r).clear()})).then(function(){return n})):n}var $t=function(){function e(e){this["@@propmod"]=e}return e.prototype.execute=function(e){var t,n=this["@@propmod"];if(void 0!==n.add){var i=n.add;if(a(i))return r(r([],a(e)?e:[],!0),i,!0).sort();if("number"==typeof i)return(Number(e)||0)+i;if("bigint"==typeof i)try{return BigInt(e)+i}catch(e){return BigInt(0)+i}throw new TypeError("Invalid term ".concat(i))}if(void 0!==n.remove){var o=n.remove;if(a(o))return a(e)?e.filter(function(e){return!o.includes(e)}).sort():[];if("number"==typeof o)return Number(e)-o;if("bigint"==typeof o)try{return BigInt(e)-o}catch(e){return BigInt(0)-o}throw new TypeError("Invalid subtrahend ".concat(o))}var s=null===(t=n.replacePrefix)||void 0===t?void 0:t[0];return s&&"string"==typeof e&&e.startsWith(s)?n.replacePrefix[1]+e.substring(s.length):e},e}();function Kt(e,t){for(var n=o(t),r=n.length,i=!1,a=0;a<r;++a){var s=n[a],l=t[s],c=_(e,s);l instanceof $t?(A(e,s,l.execute(c)),i=!0):c!==l&&(A(e,s,l),i=!0)}return i}var qt=function(){function e(){}return e.prototype._trans=function(e,t,n){var r=this._tx||Oe.trans,i=this.name,o=fe&&"undefined"!=typeof console&&console.createTask&&console.createTask("Dexie: ".concat("readonly"===e?"read":"write"," ").concat(this.name));function a(e,n,r){if(!r.schema[i])throw new Z.NotFound("Table "+i+" not part of transaction");return t(r.idbtrans,r)}var s=Ue();try{var l=r&&r.db._novip===this.db._novip?r===Oe.trans?r._promise(e,a,n):ot(function(){return r._promise(e,a,n)},{trans:r,transless:Oe.transless||Oe}):yt(this.db,e,[this.name],a);return o&&(l._consoleTask=o,l=l.catch(function(e){return console.trace(e),mt(e)})),l}finally{s&&He()}},e.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):null==e?mt(new Z.Type("Invalid argument to Table.get()")):this._trans("readonly",function(t){return n.core.get({trans:t,key:e}).then(function(e){return n.hook.reading.fire(e)})}).then(t)},e.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(a(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=o(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(e){if(e.compound&&t.every(function(t){return e.keyPath.indexOf(t)>=0})){for(var n=0;n<t.length;++n)if(-1===t.indexOf(e.keyPath[n]))return!1;return!0}return!1}).sort(function(e,t){return e.keyPath.length-t.keyPath.length})[0];if(n&&this.db._maxKey!==vt){var r=n.keyPath.slice(0,t.length);return this.where(r).equals(r.map(function(t){return e[t]}))}!n&&fe&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var i=this.schema.idxByName;function s(e,t){return 0===Mt(e,t)}var l=t.reduce(function(t,n){var r=t[0],o=t[1],l=i[n],c=e[n];return[r||l,r||!l?jt(o,l&&l.multi?function(e){var t=_(e,n);return a(t)&&t.some(function(e){return s(c,e)})}:function(e){return s(c,_(e,n))}):o]},[null,null]),c=l[0],u=l[1];return c?this.where(c.name).equals(e[c.keyPath]).filter(u):n?this.filter(u):this.where(t).equals("")},e.prototype.filter=function(e){return this.toCollection().and(e)},e.prototype.count=function(e){return this.toCollection().count(e)},e.prototype.offset=function(e){return this.toCollection().offset(e)},e.prototype.limit=function(e){return this.toCollection().limit(e)},e.prototype.each=function(e){return this.toCollection().each(e)},e.prototype.toArray=function(e){return this.toCollection().toArray(e)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,a(e)?"[".concat(e.join("+"),"]"):e))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(e){var n=this,r=n.db,i=n.name;this.schema.mappedClass=e,e.prototype instanceof Tt&&(e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),Object.defineProperty(n.prototype,"db",{get:function(){return r},enumerable:!1,configurable:!0}),n.prototype.table=function(){return i},n}(e));for(var o=new Set,a=e.prototype;a;a=l(a))Object.getOwnPropertyNames(a).forEach(function(e){return o.add(e)});var s=function(t){if(!t)return t;var n=Object.create(e.prototype);for(var r in t)if(!o.has(r))try{n[r]=t[r]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=s,this.hook("reading",s),e},e.prototype.defineClass=function(){function e(e){s(this,e)}return this.mapToClass(e)},e.prototype.add=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,a=e;return o&&i&&(a=Et(o)(e)),this._trans("readwrite",function(e){return n.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[a]})}).then(function(e){return e.numFailures?Re.reject(e.failures[0]):e.lastResult}).then(function(t){if(o)try{A(e,o,t)}catch(e){}return t})},e.prototype.upsert=function(e,t){var n=this,r=this.schema.primKey.keyPath;return this._trans("readwrite",function(i){return n.core.get({trans:i,key:e}).then(function(o){var a=null!=o?o:{};return Kt(a,t),r&&A(a,r,e),n.core.mutate({trans:i,type:"put",values:[a],keys:[e],upsert:!0,updates:{keys:[e],changeSpecs:[t]}}).then(function(e){return e.numFailures?Re.reject(e.failures[0]):!!o})})})},e.prototype.update=function(e,t){if("object"!=typeof e||a(e))return this.where(":id").equals(e).modify(t);var n=_(e,this.schema.primKey.keyPath);return void 0===n?mt(new Z.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(t)},e.prototype.put=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,a=e;return o&&i&&(a=Et(o)(e)),this._trans("readwrite",function(e){return n.core.mutate({trans:e,type:"put",values:[a],keys:null!=t?[t]:null})}).then(function(e){return e.numFailures?Re.reject(e.failures[0]):e.lastResult}).then(function(t){if(o)try{A(e,o,t)}catch(e){}return t})},e.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]}).then(function(n){return Rt(t,[e],n)}).then(function(e){return e.numFailures?Re.reject(e.failures[0]):void 0})})},e.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Pt}).then(function(t){return Rt(e,null,t)})}).then(function(e){return e.numFailures?Re.reject(e.failures[0]):void 0})},e.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(n){return t.core.getMany({keys:e,trans:n}).then(function(e){return e.map(function(e){return t.hook.reading.fire(e)})})})},e.prototype.bulkAdd=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(t){var n=r.schema.primKey,a=n.auto,s=n.keyPath;if(s&&i)throw new Z.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new Z.InvalidArgument("Arguments objects and keys must have the same length");var l=e.length,c=s&&a?e.map(Et(s)):e;return r.core.mutate({trans:t,type:"add",keys:i,values:c,wantResults:o}).then(function(e){var t=e.numFailures,n=e.results,i=e.lastResult,a=e.failures;if(0===t)return o?n:i;throw new G("".concat(r.name,".bulkAdd(): ").concat(t," of ").concat(l," operations failed"),a)})})},e.prototype.bulkPut=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(t){var n=r.schema.primKey,a=n.auto,s=n.keyPath;if(s&&i)throw new Z.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new Z.InvalidArgument("Arguments objects and keys must have the same length");var l=e.length,c=s&&a?e.map(Et(s)):e;return r.core.mutate({trans:t,type:"put",keys:i,values:c,wantResults:o}).then(function(e){var t=e.numFailures,n=e.results,i=e.lastResult,a=e.failures;if(0===t)return o?n:i;throw new G("".concat(r.name,".bulkPut(): ").concat(t," of ").concat(l," operations failed"),a)})})},e.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map(function(e){return e.key}),i=e.map(function(e){return e.changes}),o=[];return this._trans("readwrite",function(a){return n.getMany({trans:a,keys:r,cache:"clone"}).then(function(s){var l=[],c=[];e.forEach(function(e,n){var r=e.key,i=e.changes,a=s[n];if(a){for(var u=0,d=Object.keys(i);u<d.length;u++){var h=d[u],f=i[h];if(h===t.schema.primKey.keyPath){if(0!==Mt(f,r))throw new Z.Constraint("Cannot update primary key in bulkUpdate()")}else A(a,h,f)}o.push(n),l.push(r),c.push(a)}});var u=l.length;return n.mutate({trans:a,type:"put",keys:l,values:c,updates:{keys:r,changeSpecs:i}}).then(function(e){var n=e.numFailures,r=e.failures;if(0===n)return u;for(var i=0,a=Object.keys(r);i<a.length;i++){var s=a[i],l=o[Number(s)];if(null!=l){var c=r[s];delete r[s],r[l]=c}}throw new G("".concat(t.name,".bulkUpdate(): ").concat(n," of ").concat(u," operations failed"),r)})})})},e.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:e}).then(function(n){return Rt(t,e,n)})}).then(function(e){var r=e.numFailures,i=e.lastResult,o=e.failures;if(0===r)return i;throw new G("".concat(t.name,".bulkDelete(): ").concat(r," of ").concat(n," operations failed"),o)})},e}();function Lt(e){var t={},n=function(n,r){if(r){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return t[n].subscribe.apply(null,o),e}if("string"==typeof n)return t[n]};n.addEventType=s;for(var r=1,i=arguments.length;r<i;++r)s(arguments[r]);return n;function s(e,r,i){if("object"==typeof e)return l(e);r||(r=de),i||(i=re);var o={subscribers:[],fire:i,subscribe:function(e){-1===o.subscribers.indexOf(e)&&(o.subscribers.push(e),o.fire=r(o.fire,e))},unsubscribe:function(e){o.subscribers=o.subscribers.filter(function(t){return t!==e}),o.fire=o.subscribers.reduce(r,i)}};return t[e]=n[e]=o,o}function l(e){o(e).forEach(function(t){var n=e[t];if(a(n))s(t,e[t][0],e[t][1]);else{if("asap"!==n)throw new Z.InvalidArgument("Invalid event config");var r=s(t,ie,function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];r.subscribers.forEach(function(e){w(function(){e.apply(null,t)})})})}})}}function Ft(e,t){return p(t).from({prototype:e}),t}function zt(e){return Ft(qt.prototype,function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:Lt(null,{creating:[se,re],reading:[oe,ie],updating:[ue,re],deleting:[le,re]})})}function Nt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Wt(e,t){e.filter=jt(e.filter,t)}function Ut(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return jt(r(),t())}:t,e.justLimit=n&&!r}function Ht(e,t){e.isMatch=jt(e.isMatch,t)}function Vt(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new Z.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Qt(e,t,n){var r=Vt(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function Yt(e,t,n,r){var i=e.replayFilter?jt(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},a=function(e,n,r){if(!i||i(n,r,function(e){return n.stop(e)},function(e){return n.fail(e)})){var a=n.primaryKey,s=""+a;"[object ArrayBuffer]"===s&&(s=""+new Uint8Array(a)),u(o,s)||(o[s]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(a,n),Gt(Qt(e,r,n),e.algorithm,a,!e.keysOnly&&e.valueMapper)])}return Gt(Qt(e,r,n),jt(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function Gt(e,t,n,r){var i=Xe(r?function(e,t,i){return n(r(e),t,i)}:n);return e.then(function(e){if(e)return e.start(function(){var n=function(){return e.continue()};t&&!t(e,function(e){return n=e},function(t){e.stop(t),n=re},function(t){e.fail(t),n=re})||i(e.value,e,function(e){return n=e}),n()})})}var Jt=function(){function e(){}return e.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,mt.bind(null,n.error)):n.table._trans("readonly",e).then(t)},e.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,mt.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},e.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=jt(t.algorithm,e)},e.prototype._iterate=function(e,t){return Yt(this._ctx,e,t,this._ctx.table.core)},e.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&s(n,e),t._ctx=n,t},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return Yt(t,e,n,t.table.core)})},e.prototype.count=function(e){var t=this;return this._read(function(e){var n=t._ctx,r=n.table.core;if(Nt(n,!0))return r.count({trans:e,query:{index:Vt(n,r.schema),range:n.range}}).then(function(e){return Math.min(e,n.limit)});var i=0;return Yt(n,function(){return++i,!1},e,r).then(function(){return i})}).then(e)},e.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],i=n.length-1;function o(e,t){return t?o(e[n[t]],t-1):e[r]}var a="next"===this._ctx.dir?1:-1;function s(e,t){return Mt(o(e,i),o(t,i))*a}return this.toArray(function(e){return e.sort(s)}).then(t)},e.prototype.toArray=function(e){var t=this;return this._read(function(e){var n=t._ctx;if("next"===n.dir&&Nt(n,!0)&&n.limit>0){var r=n.valueMapper,i=Vt(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:i,range:n.range}}).then(function(e){var t=e.result;return r?t.map(r):t})}var o=[];return Yt(n,function(e){return o.push(e)},e,n.table.core).then(function(){return o})},e)},e.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Nt(t)?Ut(t,function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n(function(){e.advance(t),t=0}),!1))}}):Ut(t,function(){var t=e;return function(){return--t<0}})),this},e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Ut(this._ctx,function(){var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}},!0),this},e.prototype.until=function(e,t){return Wt(this._ctx,function(n,r,i){return!e(n.value)||(r(i),t)}),this},e.prototype.first=function(e){return this.limit(1).toArray(function(e){return e[0]}).then(e)},e.prototype.last=function(e){return this.reverse().first(e)},e.prototype.filter=function(e){return Wt(this._ctx,function(t){return e(t.value)}),Ht(this._ctx,e),this},e.prototype.and=function(e){return this.filter(e)},e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},e.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.key,n)})},e.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},e.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.primaryKey,n)})},e.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(e,t){n.push(t.key)}).then(function(){return n}).then(e)},e.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&Nt(t,!0)&&t.limit>0)return this._read(function(e){var n=Vt(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})}).then(function(e){return e.result}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(e,t){n.push(t.primaryKey)}).then(function(){return n}).then(e)},e.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},e.prototype.firstKey=function(e){return this.limit(1).keys(function(e){return e[0]}).then(e)},e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},e.prototype.distinct=function(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return Wt(this._ctx,function(e){var t=e.primaryKey.toString(),r=u(n,t);return n[t]=!0,!r}),this},e.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(r){var i;i="function"==typeof e?e:function(t){return Kt(t,e)};var a=n.table.core,s=a.schema.primaryKey,l=s.outbound,c=s.extractKey,u=200,d=t.db._options.modifyChunkSize;d&&(u="object"==typeof d?d[a.name]||d["*"]||200:d);var h=[],f=0,p=[],g=function(e,t){var n=t.failures,r=t.numFailures;f+=e-r;for(var i=0,a=o(n);i<a.length;i++){var s=a[i];h.push(n[s])}},m=e===Xt;return t.clone().primaryKeys().then(function(t){var o=Nt(n)&&n.limit===1/0&&("function"!=typeof e||m)&&{index:n.index,range:n.range},s=function(d){var h=Math.min(u,t.length-d),f=t.slice(d,d+h);return(m?Promise.resolve([]):a.getMany({trans:r,keys:f,cache:"immutable"})).then(function(p){var y=[],b=[],v=l?[]:null,x=m?f:[];if(!m)for(var w=0;w<h;++w){var k=p[w],_={value:B(k),primKey:t[d+w]};!1!==i.call(_,_.value,_)&&(null==_.value?x.push(t[d+w]):l||0===Mt(c(k),c(_.value))?(b.push(_.value),l&&v.push(t[d+w])):(x.push(t[d+w]),y.push(_.value)))}return Promise.resolve(y.length>0&&a.mutate({trans:r,type:"add",values:y}).then(function(e){for(var t in e.failures)x.splice(parseInt(t),1);g(y.length,e)})).then(function(){return(b.length>0||o&&"object"==typeof e)&&a.mutate({trans:r,type:"put",keys:v,values:b,criteria:o,changeSpec:"function"!=typeof e&&e,isAdditionalChunk:d>0}).then(function(e){return g(b.length,e)})}).then(function(){return(x.length>0||o&&m)&&a.mutate({trans:r,type:"delete",keys:x,criteria:o,isAdditionalChunk:d>0}).then(function(e){return Rt(n.table,x,e)}).then(function(e){return g(x.length,e)})}).then(function(){return t.length>d+h&&s(d+u)})})};return s(0).then(function(){if(h.length>0)throw new Y("Error modifying one or more objects",h,f,p);return t.length})})})},e.prototype.delete=function(){var e=this._ctx,t=e.range;return!Nt(e)||e.table.schema.yProps||!e.isPrimKey&&3!==t.type?this.modify(Xt):this._write(function(n){var r=e.table.core.schema.primaryKey,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then(function(t){return e.table.core.mutate({trans:n,type:"deleteRange",range:i}).then(function(e){var n=e.failures,r=e.numFailures;if(r)throw new Y("Could not delete some values",Object.keys(n).map(function(e){return n[e]}),t-r);return t-r})})})},e}(),Xt=function(e,t){return t.value=null};function Zt(e){return Ft(Jt.prototype,function(t,n){this.db=e;var r=Pt,i=null;if(n)try{r=n()}catch(e){i=e}var o=t._ctx,a=o.table,s=a.hook.reading.fire;this._ctx={table:a,index:o.index,isPrimKey:!o.index||a.schema.primKey.keyPath&&o.index===a.schema.primKey.name,range:r,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:i,or:o.or,valueMapper:s!==ie?s:null}})}function en(e,t){return e<t?-1:e===t?0:1}function tn(e,t){return e>t?-1:e===t?0:1}function nn(e,t,n){var r=e instanceof dn?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function rn(e){return new e.Collection(e,function(){return un("")}).limit(0)}function on(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}function an(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}function sn(e,t,n,r,i,o){for(var a=Math.min(e.length,r.length),s=-1,l=0;l<a;++l){var c=t[l];if(c!==r[l])return i(e[l],n[l])<0?e.substr(0,l)+n[l]+n.substr(l+1):i(e[l],r[l])<0?e.substr(0,l)+r[l]+n.substr(l+1):s>=0?e.substr(0,s)+t[s]+n.substr(s+1):null;i(e[l],c)<0&&(s=l)}return a<r.length&&"next"===o?e+n.substr(e.length):a<e.length&&"prev"===o?e.substr(0,n.length):s<0?null:e.substr(0,s)+r[s]+n.substr(s+1)}function ln(e,t,n,r){var i,o,a,s,l,c,u,d=n.length;if(!n.every(function(e){return"string"==typeof e}))return nn(e,kt);function h(e){i=on(e),o=an(e),a="next"===e?en:tn;var t=n.map(function(e){return{lower:o(e),upper:i(e)}}).sort(function(e,t){return a(e.lower,t.lower)});s=t.map(function(e){return e.upper}),l=t.map(function(e){return e.lower}),c=e,u="next"===e?"":r}h("next");var f=new e.Collection(e,function(){return cn(s[0],l[d-1]+r)});f._ondirectionchange=function(e){h(e)};var p=0;return f._addAlgorithm(function(e,n,r){var i=e.key;if("string"!=typeof i)return!1;var h=o(i);if(t(h,l,p))return!0;for(var f=null,g=p;g<d;++g){var m=sn(i,h,s[g],l[g],a,c);null===m&&null===f?p=g+1:(null===f||a(f,m)>0)&&(f=m)}return n(null!==f?function(){e.continue(f+u)}:r),!1}),f}function cn(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function un(e){return{type:1,lower:e,upper:e}}var dn=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?rn(this):new this.Collection(this,function(){return cn(e,t,!n,!r)})}catch(e){return nn(this,wt)}},e.prototype.equals=function(e){return null==e?nn(this,wt):new this.Collection(this,function(){return un(e)})},e.prototype.above=function(e){return null==e?nn(this,wt):new this.Collection(this,function(){return cn(e,void 0,!0)})},e.prototype.aboveOrEqual=function(e){return null==e?nn(this,wt):new this.Collection(this,function(){return cn(e,void 0,!1)})},e.prototype.below=function(e){return null==e?nn(this,wt):new this.Collection(this,function(){return cn(void 0,e,!1,!0)})},e.prototype.belowOrEqual=function(e){return null==e?nn(this,wt):new this.Collection(this,function(){return cn(void 0,e)})},e.prototype.startsWith=function(e){return"string"!=typeof e?nn(this,kt):this.between(e,e+vt,!0,!0)},e.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):ln(this,function(e,t){return 0===e.indexOf(t[0])},[e],vt)},e.prototype.equalsIgnoreCase=function(e){return ln(this,function(e,t){return e===t[0]},[e],"")},e.prototype.anyOfIgnoreCase=function(){var e=z.apply(F,arguments);return 0===e.length?rn(this):ln(this,function(e,t){return-1!==t.indexOf(e)},e,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var e=z.apply(F,arguments);return 0===e.length?rn(this):ln(this,function(e,t){return t.some(function(t){return 0===e.indexOf(t)})},e,vt)},e.prototype.anyOf=function(){var e=this,t=z.apply(F,arguments),n=this._cmp;try{t.sort(n)}catch(e){return nn(this,wt)}if(0===t.length)return rn(this);var r=new this.Collection(this,function(){return cn(t[0],t[t.length-1])});r._ondirectionchange=function(r){n="next"===r?e._ascending:e._descending,t.sort(n)};var i=0;return r._addAlgorithm(function(e,r,o){for(var a=e.key;n(a,t[i])>0;)if(++i===t.length)return r(o),!1;return 0===n(a,t[i])||(r(function(){e.continue(t[i])}),!1)}),r},e.prototype.notEqual=function(e){return this.inAnyRange([[xt,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var e=z.apply(F,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return nn(this,wt)}var t=e.reduce(function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[xt,t]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(e,t){var n=this,r=this._cmp,i=this._ascending,o=this._descending,a=this._min,s=this._max;if(0===e.length)return rn(this);if(!e.every(function(e){return void 0!==e[0]&&void 0!==e[1]&&i(e[0],e[1])<=0}))return nn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Z.InvalidArgument);var l=!t||!1!==t.includeLowers,c=t&&!0===t.includeUppers;function u(e,t){for(var n=0,i=e.length;n<i;++n){var o=e[n];if(r(t[0],o[1])<0&&r(t[1],o[0])>0){o[0]=a(o[0],t[0]),o[1]=s(o[1],t[1]);break}}return n===i&&e.push(t),e}var d,h=i;function f(e,t){return h(e[0],t[0])}try{(d=e.reduce(u,[])).sort(f)}catch(e){return nn(this,wt)}var p=0,g=c?function(e){return i(e,d[p][1])>0}:function(e){return i(e,d[p][1])>=0},m=l?function(e){return o(e,d[p][0])>0}:function(e){return o(e,d[p][0])>=0};function y(e){return!g(e)&&!m(e)}var b=g,v=new this.Collection(this,function(){return cn(d[0][0],d[d.length-1][1],!l,!c)});return v._ondirectionchange=function(e){"next"===e?(b=g,h=i):(b=m,h=o),d.sort(f)},v._addAlgorithm(function(e,t,r){for(var o=e.key;b(o);)if(++p===d.length)return t(r),!1;return!!y(o)||(0===n._cmp(o,d[p][1])||0===n._cmp(o,d[p][0])||t(function(){h===i?e.continue(d[p][0]):e.continue(d[p][1])}),!1)}),v},e.prototype.startsWithAnyOf=function(){var e=z.apply(F,arguments);return e.every(function(e){return"string"==typeof e})?0===e.length?rn(this):this.inAnyRange(e.map(function(e){return[e,e+vt]})):nn(this,"startsWithAnyOf() only works with strings")},e}();function hn(e){return Ft(dn.prototype,function(t,n,r){if(this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r},this._cmp=this._ascending=Mt,this._descending=function(e,t){return Mt(t,e)},this._max=function(e,t){return Mt(e,t)>0?e:t},this._min=function(e,t){return Mt(e,t)<0?e:t},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new Z.MissingAPI})}function fn(e){return Xe(function(t){return pn(t),e(t.target.error),!1})}function pn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var gn="storagemutated",mn="x-storagemutated-1",yn=Lt(null,gn),bn=function(){function e(){}return e.prototype._lock=function(){return x(!Oe.global),++this._reculock,1!==this._reculock||Oe.global||(Oe.lockOwnerFor=this),this},e.prototype._unlock=function(){if(x(!Oe.global),0===--this._reculock)for(Oe.global||(Oe.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{ft(e[1],e[0])}catch(e){}}return this},e.prototype._locked=function(){return this._reculock&&Oe.lockOwnerFor!==this},e.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(x(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new Z.DatabaseClosed(r);case"MissingAPIError":throw new Z.MissingAPI(r.message,r);default:throw new Z.OpenFailed(r)}if(!this.active)throw new Z.TransactionInactive;return x(null===this._completion._state),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Xe(function(n){pn(n),t._reject(e.error)}),e.onabort=Xe(function(n){pn(n),t.active&&t._reject(new Z.Abort(e.error)),t.active=!1,t.on("abort").fire(n)}),e.oncomplete=Xe(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&yn.storagemutated.fire(e.mutatedParts)}),this},e.prototype._promise=function(e,t,n){var r=this;if("readwrite"===e&&"readwrite"!==this.mode)return mt(new Z.ReadOnly("Transaction is readonly"));if(!this.active)return mt(new Z.TransactionInactive);if(this._locked())return new Re(function(i,o){r._blockedFuncs.push([function(){r._promise(e,t,n).then(i,o)},Oe])});if(n)return ot(function(){var e=new Re(function(e,n){r._lock();var i=t(e,n,r);i&&i.then&&i.then(e,n)});return e.finally(function(){return r._unlock()}),e._lib=!0,e});var i=new Re(function(e,n){var i=t(e,n,r);i&&i.then&&i.then(e,n)});return i._lib=!0,i},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(e){var t=this._root(),n=Re.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then(function(){return n});else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var i=t._waitingFor;return new Re(function(e,r){n.then(function(n){return t._waitingQueue.push(Xe(e.bind(null,n)))},function(e){return t._waitingQueue.push(Xe(r.bind(null,e)))}).finally(function(){t._waitingFor===i&&(t._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Z.Abort))},e.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(u(t,e))return t[e];var n=this.schema[e];if(!n)throw new Z.NotFound("Table "+e+" not part of transaction");var r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r},e}();function vn(e){return Ft(bn.prototype,function(t,n,r,i,o){var a=this;"readonly"!==t&&n.forEach(function(e){var t,i=null===(t=r[e])||void 0===t?void 0:t.yProps;i&&(n=n.concat(i.map(function(e){return e.updatesTable})))}),this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.chromeTransactionDurability=i,this.idbtrans=null,this.on=Lt(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Re(function(e,t){a._resolve=e,a._reject=t}),this._completion.then(function(){a.active=!1,a.on.complete.fire()},function(e){var t=a.active;return a.active=!1,a.on.error.fire(e),a.parent?a.parent._reject(e):t&&a.idbtrans&&a.idbtrans.abort(),mt(e)})})}function xn(e,t,n,r,i,o,a,s){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:o,src:(n&&!a?"&":"")+(r?"*":"")+(i?"++":"")+wn(t),type:s}}function wn(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function kn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:k(n,function(e){return[e.name,e]})}}function _n(e){return 1===e.length?e[0]:e}var An=function(e){try{return e.only([[]]),An=function(){return[[]]},[[]]}catch(e){return An=function(){return vt},vt}};function Cn(e){return null==e?function(){}:"string"==typeof e?Sn(e):function(t){return _(t,e)}}function Sn(e){return 1===e.split(".").length?function(t){return t[e]}:function(t){return _(t,e)}}function jn(e){return[].slice.call(e)}var Pn=0;function En(e){return null==e?":id":"string"==typeof e?e:"[".concat(e.join("+"),"]")}function Tn(e,t,n){function r(e,t){var n=jn(e.objectStoreNames);return{schema:{name:e.name,tables:n.map(function(e){return t.objectStore(e)}).map(function(e){var t=e.keyPath,n=e.autoIncrement,r=a(t),i=null==t,o={},s={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:Cn(t)},indexes:jn(e.indexNames).map(function(t){return e.index(t)}).map(function(e){var t=e.name,n=e.unique,r=e.multiEntry,i=e.keyPath,s={name:t,compound:a(i),keyPath:i,unique:n,multiEntry:r,extractKey:Cn(i)};return o[En(i)]=s,s}),getIndexByKeyPath:function(e){return o[En(e)]}};return o[":id"]=s.primaryKey,null!=t&&(o[En(t)]=s.primaryKey),s})},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var n=e.lower,r=e.upper,i=e.lowerOpen,o=e.upperOpen;return void 0===n?void 0===r?null:t.upperBound(r,!!o):void 0===r?t.lowerBound(n,!!i):t.bound(n,r,!!i,!!o)}function o(e){var t=e.name;function n(e){var n=e.trans,r=e.type,o=e.keys,a=e.values,s=e.range;return new Promise(function(e,l){e=Xe(e);var c=n.objectStore(t),u=null==c.keyPath,d="put"===r||"add"===r;if(!d&&"delete"!==r&&"deleteRange"!==r)throw new Error("Invalid operation type: "+r);var h,f=(o||a||{length:1}).length;if(o&&a&&o.length!==a.length)throw new Error("Given keys array must have same length as given values array.");if(0===f)return e({numFailures:0,failures:{},results:[],lastResult:void 0});var p=[],g=[],m=0,y=function(e){++m,pn(e)};if("deleteRange"===r){if(4===s.type)return e({numFailures:m,failures:g,results:[],lastResult:void 0});3===s.type?p.push(h=c.clear()):p.push(h=c.delete(i(s)))}else{var b=d?u?[a,o]:[a,null]:[o,null],v=b[0],x=b[1];if(d)for(var w=0;w<f;++w)p.push(h=x&&void 0!==x[w]?c[r](v[w],x[w]):c[r](v[w])),h.onerror=y;else for(w=0;w<f;++w)p.push(h=c[r](v[w])),h.onerror=y}var k=function(t){var n=t.target.result;p.forEach(function(e,t){return null!=e.error&&(g[t]=e.error)}),e({numFailures:m,failures:g,results:"delete"===r?o:p.map(function(e){return e.result}),lastResult:n})};h.onerror=function(e){y(e),k(e)},h.onsuccess=k})}function r(e){var n=e.trans,r=e.values,o=e.query,a=e.reverse,s=e.unique;return new Promise(function(e,l){e=Xe(e);var c=o.index,u=o.range,d=n.objectStore(t),h=c.isPrimaryKey?d:d.index(c.name),f=a?s?"prevunique":"prev":s?"nextunique":"next",p=r||!("openKeyCursor"in h)?h.openCursor(i(u),f):h.openKeyCursor(i(u),f);p.onerror=fn(l),p.onsuccess=Xe(function(t){var r=p.result;if(r){r.___id=++Pn,r.done=!1;var i=r.continue.bind(r),o=r.continuePrimaryKey;o&&(o=o.bind(r));var a=r.advance.bind(r),s=function(){throw new Error("Cursor not started")},c=function(){throw new Error("Cursor not stopped")};r.trans=n,r.stop=r.continue=r.continuePrimaryKey=r.advance=s,r.fail=Xe(l),r.next=function(){var e=this,t=1;return this.start(function(){return t--?e.continue():e.stop()}).then(function(){return e})},r.start=function(e){var t=new Promise(function(e,t){e=Xe(e),p.onerror=fn(t),r.fail=t,r.stop=function(t){r.stop=r.continue=r.continuePrimaryKey=r.advance=c,e(t)}}),n=function(){if(p.result)try{e()}catch(e){r.fail(e)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()};return p.onsuccess=Xe(function(e){p.onsuccess=n,n()}),r.continue=i,r.continuePrimaryKey=o,r.advance=a,n(),t},e(r)}else e(null)},l)})}function o(e){return function(n){return new Promise(function(r,o){r=Xe(r);var a=n.trans,s=n.values,l=n.limit,c=n.query,u=l===1/0?void 0:l,d=c.index,h=c.range,f=a.objectStore(t),p=d.isPrimaryKey?f:f.index(d.name),g=i(h);if(0===l)return r({result:[]});if(e){var m=s?p.getAll(g,u):p.getAllKeys(g,u);m.onsuccess=function(e){return r({result:e.target.result})},m.onerror=fn(o)}else{var y=0,b=s||!("openKeyCursor"in p)?p.openCursor(g):p.openKeyCursor(g),v=[];b.onsuccess=function(e){var t=b.result;return t?(v.push(s?t.value:t.primaryKey),++y===l?r({result:v}):void t.continue()):r({result:v})},b.onerror=fn(o)}})}}return{name:t,schema:e,mutate:n,getMany:function(e){var n=e.trans,r=e.keys;return new Promise(function(e,i){e=Xe(e);for(var o,a=n.objectStore(t),s=r.length,l=new Array(s),c=0,u=0,d=function(t){var n=t.target;l[n._pos]=n.result,++u===c&&e(l)},h=fn(i),f=0;f<s;++f)null!=r[f]&&((o=a.get(r[f]))._pos=f,o.onsuccess=d,o.onerror=h,++c);0===c&&e(l)})},get:function(e){var n=e.trans,r=e.key;return new Promise(function(e,i){e=Xe(e);var o=n.objectStore(t).get(r);o.onsuccess=function(t){return e(t.target.result)},o.onerror=fn(i)})},query:o(c),openCursor:r,count:function(e){var n=e.query,r=e.trans,o=n.index,a=n.range;return new Promise(function(e,n){var s=r.objectStore(t),l=o.isPrimaryKey?s:s.index(o.name),c=i(a),u=c?l.count(c):l.count();u.onsuccess=Xe(function(t){return e(t.target.result)}),u.onerror=fn(n)})}}}var s=r(e,n),l=s.schema,c=s.hasGetAll,u=l.tables.map(function(e){return o(e)}),d={};return u.forEach(function(e){return d[e.name]=e}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!d[e])throw new Error("Table '".concat(e,"' not found"));return d[e]},MIN_KEY:-1/0,MAX_KEY:An(t),schema:l}}function Mn(e,t){return t.reduce(function(e,t){var r=t.create;return n(n({},e),r(e))},e)}function On(e,t,n,r){var i=n.IDBKeyRange;return n.indexedDB,{dbcore:Mn(Tn(t,i,r),e.dbcore)}}function Dn(e,t){var n=t.db,r=On(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach(function(t){var n=t.name;e.core.schema.tables.some(function(e){return e.name===n})&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))})}function Bn(e,t,n,r){n.forEach(function(n){var i=r[n];t.forEach(function(t){var r=m(t,n);(!r||"value"in r&&void 0===r.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?f(t,n,{get:function(){return this.table(n)},set:function(e){h(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,i))})})}function In(e,t){t.forEach(function(t){for(var n in t)t[n]instanceof e.Table&&delete t[n]})}function Rn(e,t){return e._cfg.version-t._cfg.version}function $n(e,t,n,r){var i=e._dbSchema;n.objectStoreNames.contains("$meta")&&!i.$meta&&(i.$meta=kn("$meta",Gn("")[0],[]),e._storeNames.push("$meta"));var a=e._createTransaction("readwrite",e._storeNames,i);a.create(n),a._completion.catch(r);var s=a._reject.bind(a),l=Oe.transless||Oe;ot(function(){if(Oe.trans=a,Oe.transless=l,0!==t)return Dn(e,n),qn(e,a,t).then(function(t){return Ln(e,t,a,n)}).catch(s);o(i).forEach(function(e){zn(n,e,i[e].primKey,i[e].indexes)}),Dn(e,n),Re.follow(function(){return e.on.populate.fire(a)}).catch(s)})}function Kn(e,t){Nn(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=Hn(e,e.idbdb,t);Yn(e,e._dbSchema,t);for(var r=function(e){if(e.change.length||e.recreate)return console.warn("Unable to patch indexes of table ".concat(e.name," because it has changes on the type of index or primary key.")),{value:void 0};var n=t.objectStore(e.name);e.add.forEach(function(t){fe&&console.debug("Dexie upgrade patch: Creating missing index ".concat(e.name,".").concat(t.src)),Un(n,t)})},i=0,o=Fn(n,e._dbSchema).change;i<o.length;i++){var a=r(o[i]);if("object"==typeof a)return a.value}}function qn(e,t,n){return t.storeNames.includes("$meta")?t.table("$meta").get("version").then(function(e){return null!=e?e:n}):Re.resolve(n)}function Ln(e,t,n,r){var i=[],a=e._versions,s=e._dbSchema=Hn(e,e.idbdb,r),l=a.filter(function(e){return e._cfg.version>=t});if(0===l.length)return Re.resolve();function c(){return i.length?Re.resolve(i.shift()(n.idbtrans)).then(c):Re.resolve()}return l.forEach(function(a){i.push(function(){var i=s,l=a._cfg.dbschema;Yn(e,i,r),Yn(e,l,r),s=e._dbSchema=l;var c=Fn(i,l);c.add.forEach(function(e){zn(r,e[0],e[1].primKey,e[1].indexes)}),c.change.forEach(function(e){if(e.recreate)throw new Z.Upgrade("Not yet support for changing primary key");var t=r.objectStore(e.name);e.add.forEach(function(e){return Un(t,e)}),e.change.forEach(function(e){t.deleteIndex(e.name),Un(t,e)}),e.del.forEach(function(e){return t.deleteIndex(e)})});var u=a._cfg.contentUpgrade;if(u&&a._cfg.version>t){Dn(e,r),n._memoizedTables={};var d=S(l);c.del.forEach(function(e){d[e]=i[e]}),In(e,[e.Transaction.prototype]),Bn(e,[e.Transaction.prototype],o(d),d),n.schema=d;var h,f=N(u);f&&at();var p=Re.follow(function(){if((h=u(n))&&f){var e=st.bind(null,null);h.then(e,e)}});return h&&"function"==typeof h.then?Re.resolve(h):p.then(function(){return h})}}),i.push(function(t){Wn(a._cfg.dbschema,t),In(e,[e.Transaction.prototype]),Bn(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}),i.push(function(t){e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===a._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter(function(e){return"$meta"!==e})):t.objectStore("$meta").put(a._cfg.version,"version"))})}),c().then(function(){Nn(s,r)})}function Fn(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var i=e[n],o=t[n];if(i){var a={name:n,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto)a.recreate=!0,r.change.push(a);else{var s=i.idxByName,l=o.idxByName,c=void 0;for(c in s)l[c]||a.del.push(c);for(c in l){var u=s[c],d=l[c];u?u.src!==d.src&&a.change.push(d):a.add.push(d)}(a.del.length>0||a.add.length>0||a.change.length>0)&&r.change.push(a)}}else r.add.push([n,o])}return r}function zn(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(e){return Un(i,e)}),i}function Nn(e,t){o(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(fe&&console.debug("Dexie: Creating missing table",n),zn(t,n,e[n].primKey,e[n].indexes))})}function Wn(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(n){return null==e[n]&&t.db.deleteObjectStore(n)})}function Un(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Hn(e,t,n){var r={};return b(t.objectStoreNames,0).forEach(function(e){for(var t=n.objectStore(e),i=t.keyPath,o=xn(wn(i),i||"",!0,!1,!!t.autoIncrement,i&&"string"!=typeof i,!0),a=[],s=0;s<t.indexNames.length;++s){var l=t.index(t.indexNames[s]);i=l.keyPath;var c=xn(l.name,i,!!l.unique,!!l.multiEntry,!1,i&&"string"!=typeof i,!1);a.push(c)}r[e]=kn(e,o,a)}),r}function Vn(e,t,n){e.verno=t.version/10;var r=e._dbSchema=Hn(e,t,n);e._storeNames=b(t.objectStoreNames,0),Bn(e,[e._allTables],o(r),r)}function Qn(e,t){var n=Fn(Hn(e,e.idbdb,t),e._dbSchema);return!(n.add.length||n.change.some(function(e){return e.add.length||e.change.length}))}function Yn(e,t,n){for(var r=n.db.objectStoreNames,o=0;o<r.length;++o){var a=r[o],s=n.objectStore(a);e._hasGetAll="getAll"in s;for(var l=0;l<s.indexNames.length;++l){var c=s.indexNames[l],u=s.index(c).keyPath,d="string"==typeof u?u:"["+b(u).join("+")+"]";if(t[a]){var h=t[a].idxByName[d];h&&(h.name=c,delete t[a].idxByName[d],t[a].idxByName[c]=h)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function Gn(e){return e.split(",").map(function(e,t){var n,r=e.split(":"),i=null===(n=r[1])||void 0===n?void 0:n.trim(),o=(e=r[0].trim()).replace(/([&*]|\+\+)/g,""),s=/^\[/.test(o)?o.match(/^\[(.*)\]$/)[1].split("+"):o;return xn(o,s||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),a(s),0===t,i)})}var Jn,Xn=function(){function e(){}return e.prototype._createTableSchema=function(e,t,n){return kn(e,t,n)},e.prototype._parseIndexSyntax=function(e){return Gn(e)},e.prototype._parseStoresSpec=function(e,t){var n=this;o(e).forEach(function(r){if(null!==e[r]){var i=n._parseIndexSyntax(e[r]),o=i.shift();if(!o)throw new Z.Schema("Invalid schema for table "+r+": "+e[r]);if(o.unique=!0,o.multi)throw new Z.Schema("Primary key cannot be multiEntry*");i.forEach(function(e){if(e.auto)throw new Z.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new Z.Schema("Index must have a name and cannot be an empty string")});var a=n._createTableSchema(r,o,i);t[r]=a}})},e.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?s(this._cfg.storesSource,e):e;var n=t._versions,r={},i={};return n.forEach(function(e){s(r,e._cfg.storesSource),i=e._cfg.dbschema={},e._parseStoresSpec(r,i)}),t._dbSchema=i,In(t,[t._allTables,t,t.Transaction.prototype]),Bn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],o(i),i),t._storeNames=o(i),this},e.prototype.upgrade=function(e){return this._cfg.contentUpgrade=he(this._cfg.contentUpgrade||re,e),this},e}();function Zn(e){return Ft(Xn.prototype,function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function er(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new ti(At,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function tr(e){return e&&"function"==typeof e.databases}function nr(e){var t=e.indexedDB,n=e.IDBKeyRange;return tr(t)?Promise.resolve(t.databases()).then(function(e){return e.map(function(e){return e.name}).filter(function(e){return e!==At})}):er(t,n).toCollection().primaryKeys()}function rr(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!tr(n)&&t!==At&&er(n,r).put({name:t}).catch(re)}function ir(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!tr(n)&&t!==At&&er(n,r).delete(t).catch(re)}function or(e){return ot(function(){return Oe.letThrough=!0,e()})}function ar(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(t){var n=function(){return indexedDB.databases().finally(t)};e=setInterval(n,100),n()}).finally(function(){return clearInterval(e)}):Promise.resolve()}function sr(e){return!("from"in e)}var lr=function(e,t){if(!this){var n=new lr;return e&&"d"in e&&s(n,e),n}s(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function cr(e,t,n){var r=Mt(t,n);if(!isNaN(r)){if(r>0)throw RangeError();if(sr(e))return s(e,{from:t,to:n,d:1});var i=e.l,o=e.r;if(Mt(n,e.from)<0)return i?cr(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},fr(e);if(Mt(t,e.to)>0)return o?cr(o,t,n):e.r={from:t,to:n,d:1,l:null,r:null},fr(e);Mt(t,e.from)<0&&(e.from=t,e.l=null,e.d=o?o.d+1:1),Mt(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var a=!e.r;i&&!e.l&&ur(e,i),o&&a&&ur(e,o)}}function ur(e,t){function n(e,t){var r=t.from,i=t.to,o=t.l,a=t.r;cr(e,r,i),o&&n(e,o),a&&n(e,a)}sr(t)||n(e,t)}function dr(e,t){var n=hr(t),r=n.next();if(r.done)return!1;for(var i=r.value,o=hr(e),a=o.next(i.from),s=a.value;!r.done&&!a.done;){if(Mt(s.from,i.to)<=0&&Mt(s.to,i.from)>=0)return!0;Mt(i.from,s.from)<0?i=(r=n.next(s.from)).value:s=(a=o.next(i.from)).value}return!1}function hr(e){var t=sr(e)?null:{s:0,n:e};return{next:function(e){for(var n=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&Mt(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||Mt(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function fr(e){var t,r,i=((null===(t=e.r)||void 0===t?void 0:t.d)||0)-((null===(r=e.l)||void 0===r?void 0:r.d)||0),o=i>1?"r":i<-1?"l":"";if(o){var a="r"===o?"l":"r",s=n({},e),l=e[o];e.from=l.from,e.to=l.to,e[o]=l[o],s[o]=l[a],e[a]=s,s.d=pr(s)}e.d=pr(e)}function pr(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function gr(e,t){return o(t).forEach(function(n){e[n]?ur(e[n],t[n]):e[n]=M(t[n])}),e}function mr(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&dr(t[n],e[n])})}d(lr.prototype,((Jn={add:function(e){return ur(this,e),this},addKey:function(e){return cr(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(e){return cr(t,e,e)}),this},hasKey:function(e){var t=hr(this).next(e).value;return t&&Mt(t.from,e)<=0&&Mt(t.to,e)>=0}})[K]=function(){return hr(this)},Jn));var yr={},br={},vr=!1;function xr(e,t){gr(br,e),vr||(vr=!0,setTimeout(function(){vr=!1;var e=br;br={},wr(e,!1)},0))}function wr(e,t){void 0===t&&(t=!1);var n=new Set;if(e.all)for(var r=0,i=Object.values(yr);r<i.length;r++)kr(s=i[r],e,n,t);else for(var o in e){var a=/^idb\:\/\/(.*)\/(.*)\//.exec(o);if(a){var s,l=a[1],c=a[2];(s=yr["idb://".concat(l,"/").concat(c)])&&kr(s,e,n,t)}}n.forEach(function(e){return e()})}function kr(e,t,n,r){for(var i=[],o=0,a=Object.entries(e.queries.query);o<a.length;o++){for(var s=a[o],l=s[0],c=[],u=0,d=s[1];u<d.length;u++){var h=d[u];mr(t,h.obsSet)?h.subscribers.forEach(function(e){return n.add(e)}):r&&c.push(h)}r&&i.push([l,c])}if(r)for(var f=0,p=i;f<p.length;f++){var g=p[f];l=g[0],c=g[1],e.queries.query[l]=c}}function _r(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?mt(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,i=Math.round(10*e.verno),o=!1;function a(){if(t.openCanceller!==r)throw new Z.DatabaseClosed("db.open() was cancelled")}var s=t.dbReadyResolve,l=null,c=!1,u=function(){return new Re(function(r,s){if(a(),!n)throw new Z.MissingAPI;var d=e.name,h=t.autoSchema||!i?n.open(d):n.open(d,i);if(!h)throw new Z.MissingAPI;h.onerror=fn(s),h.onblocked=Xe(e._fireOnBlocked),h.onupgradeneeded=Xe(function(r){if(l=h.transaction,t.autoSchema&&!e._options.allowEmptyDB){h.onerror=pn,l.abort(),h.result.close();var i=n.deleteDatabase(d);i.onsuccess=i.onerror=Xe(function(){s(new Z.NoSuchDatabase("Database ".concat(d," doesnt exist")))})}else{l.onerror=fn(s);var a=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;c=a<1,e.idbdb=h.result,o&&Kn(e,l),$n(e,a/10,l,s)}},s),h.onsuccess=Xe(function(){l=null;var n=e.idbdb=h.result,a=b(n.objectStoreNames);if(a.length>0)try{var s=n.transaction(_n(a),"readonly");if(t.autoSchema)Vn(e,n,s);else if(Yn(e,e._dbSchema,s),!Qn(e,s)&&!o)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),n.close(),i=n.version+1,o=!0,r(u());Dn(e,s)}catch(e){}_t.push(e),n.onversionchange=Xe(function(n){t.vcFired=!0,e.on("versionchange").fire(n)}),n.onclose=Xe(function(){e.close({disableAutoOpen:!1})}),c&&rr(e._deps,d),r()},s)}).catch(function(e){switch(null==e?void 0:e.name){case"UnknownError":if(t.PR1398_maxLoop>0)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),u();break;case"VersionError":if(i>0)return i=0,u()}return Re.reject(e)})};return Re.race([r,("undefined"==typeof navigator?Re.resolve():ar()).then(u)]).then(function(){return a(),t.onReadyBeingFired=[],Re.resolve(or(function(){return e.on.ready.fire(e.vip)})).then(function n(){if(t.onReadyBeingFired.length>0){var r=t.onReadyBeingFired.reduce(he,re);return t.onReadyBeingFired=[],Re.resolve(or(function(){return r(e.vip)})).then(n)}})}).finally(function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(n){t.dbOpenError=n;try{l&&l.abort()}catch(e){}return r===t.openCanceller&&e._close(),mt(n)}).finally(function(){t.openComplete=!0,s()}).then(function(){if(c){var t={};e.tables.forEach(function(n){n.schema.indexes.forEach(function(r){r.name&&(t["idb://".concat(e.name,"/").concat(n.name,"/").concat(r.name)]=new lr(-1/0,[[[]]]))}),t["idb://".concat(e.name,"/").concat(n.name,"/")]=t["idb://".concat(e.name,"/").concat(n.name,"/:dels")]=new lr(-1/0,[[[]]])}),yn(gn).fire(t),wr(t,!0)}return e})}function Ar(e){var t=function(t){return e.next(t)},n=function(t){return e.throw(t)},r=o(t),i=o(n);function o(e){return function(t){var n=e(t),o=n.value;return n.done?o:o&&"function"==typeof o.then?o.then(r,i):a(o)?Promise.all(o).then(r,i):r(o)}}return o(t)()}function Cr(e,t,n){var r=arguments.length;if(r<2)throw new Z.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];return n=i.pop(),[e,P(i),n]}function Sr(e,t,n,r,i){return Re.resolve().then(function(){var o=Oe.transless||Oe,a=e._createTransaction(t,n,e._dbSchema,r);a.explicit=!0;var s={trans:a,transless:o};if(r)a.idbtrans=r.idbtrans;else try{a.create(),a.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(r){return r.name===J.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return Sr(e,t,n,null,i)})):mt(r)}var l,c=N(i);c&&at();var u=Re.follow(function(){if(l=i.call(a,a))if(c){var e=st.bind(null,null);l.then(e,e)}else"function"==typeof l.next&&"function"==typeof l.throw&&(l=Ar(l))},s);return(l&&"function"==typeof l.then?Re.resolve(l).then(function(e){return a.active?e:mt(new Z.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):u.then(function(){return l})).then(function(e){return r&&a._resolve(),a._completion.then(function(){return e})}).catch(function(e){return a._reject(e),mt(e)})})}function jr(e,t,n){for(var r=a(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}function Pr(e){return n(n({},e),{table:function(t){var r=e.table(t),i=r.schema,o={},a=[];function s(e,t,r){var i=En(e),l=o[i]=o[i]||[],c=null==e?0:"string"==typeof e?1:e.length,u=t>0,d=n(n({},r),{name:u?"".concat(i,"(virtual-from:").concat(r.name,")"):r.name,lowLevelIndex:r,isVirtual:u,keyTail:t,keyLength:c,extractKey:Cn(e),unique:!u&&r.unique});return l.push(d),d.isPrimaryKey||a.push(d),c>1&&s(2===c?e[0]:e.slice(0,c-1),t+1,r),l.sort(function(e,t){return e.keyTail-t.keyTail}),d}var l=s(i.primaryKey.keyPath,0,i.primaryKey);o[":id"]=[l];for(var c=0,u=i.indexes;c<u.length;c++){var d=u[c];s(d.keyPath,0,d)}function h(e){var t=o[En(e)];return t&&t[0]}function f(t,n){return{type:1===t.type?2:t.type,lower:jr(t.lower,t.lowerOpen?e.MAX_KEY:e.MIN_KEY,n),lowerOpen:!0,upper:jr(t.upper,t.upperOpen?e.MIN_KEY:e.MAX_KEY,n),upperOpen:!0}}function p(e){var t=e.query.index;return t.isVirtual?n(n({},e),{query:{index:t.lowLevelIndex,range:f(e.query.range,t.keyTail)}}):e}var g=n(n({},r),{schema:n(n({},i),{primaryKey:l,indexes:a,getIndexByKeyPath:h}),count:function(e){return r.count(p(e))},query:function(e){return r.query(p(e))},openCursor:function(t){var n=t.query.index,i=n.keyTail,o=n.isVirtual,a=n.keyLength;if(!o)return r.openCursor(t);function s(n){function r(r){null!=r?n.continue(jr(r,t.reverse?e.MAX_KEY:e.MIN_KEY,i)):t.unique?n.continue(n.key.slice(0,a).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,i)):n.continue()}var o=Object.create(n,{continue:{value:r},continuePrimaryKey:{value:function(t,r){n.continuePrimaryKey(jr(t,e.MAX_KEY,i),r)}},primaryKey:{get:function(){return n.primaryKey}},key:{get:function(){var e=n.key;return 1===a?e[0]:e.slice(0,a)}},value:{get:function(){return n.value}}});return o}return r.openCursor(p(t)).then(function(e){return e&&s(e)})}});return g}})}var Er={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:Pr};function Tr(e,t,n,r){return n=n||{},r=r||"",o(e).forEach(function(i){if(u(t,i)){var o=e[i],a=t[i];if("object"==typeof o&&"object"==typeof a&&o&&a){var s=$(o);s!==$(a)?n[r+i]=t[i]:"Object"===s?Tr(o,a,n,r+i+"."):o!==a&&(n[r+i]=t[i])}else o!==a&&(n[r+i]=t[i])}else n[r+i]=void 0}),o(t).forEach(function(i){u(e,i)||(n[r+i]=t[i])}),n}function Mr(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}var Or={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return n(n({},e),{table:function(t){var i=e.table(t),o=i.schema.primaryKey,a=n(n({},i),{mutate:function(e){var a=Oe.trans,s=a.table(t).hook,l=s.deleting,c=s.creating,d=s.updating;switch(e.type){case"add":if(c.fire===re)break;return a._promise("readwrite",function(){return h(e)},!0);case"put":if(c.fire===re&&d.fire===re)break;return a._promise("readwrite",function(){return h(e)},!0);case"delete":if(l.fire===re)break;return a._promise("readwrite",function(){return h(e)},!0);case"deleteRange":if(l.fire===re)break;return a._promise("readwrite",function(){return f(e)},!0)}return i.mutate(e);function h(e){var t=Oe.trans,a=e.keys||Mr(o,e);if(!a)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?n(n({},e),{keys:a}):n({},e)).type&&(e.values=r([],e.values,!0)),e.keys&&(e.keys=r([],e.keys,!0)),Dr(i,e,a).then(function(n){var r=a.map(function(r,i){var a=n[i],s={onerror:null,onsuccess:null};if("delete"===e.type)l.fire.call(s,r,a,t);else if("add"===e.type||void 0===a){var h=c.fire.call(s,r,e.values[i],t);null==r&&null!=h&&(r=h,e.keys[i]=r,o.outbound||A(e.values[i],o.keyPath,r))}else{var f=Tr(a,e.values[i]),p=d.fire.call(s,f,r,a,t);if(p){var g=e.values[i];Object.keys(p).forEach(function(e){u(g,e)?g[e]=p[e]:A(g,e,p[e])})}}return s});return i.mutate(e).then(function(t){for(var i=t.failures,o=t.results,s=t.numFailures,l=t.lastResult,c=0;c<a.length;++c){var u=o?o[c]:a[c],d=r[c];null==u?d.onerror&&d.onerror(i[c]):d.onsuccess&&d.onsuccess("put"===e.type&&n[c]?e.values[c]:u)}return{failures:i,results:o,numFailures:s,lastResult:l}}).catch(function(e){return r.forEach(function(t){return t.onerror&&t.onerror(e)}),Promise.reject(e)})})}function f(e){return p(e.trans,e.range,1e4)}function p(e,t,r){return i.query({trans:e,values:!1,query:{index:o,range:t},limit:r}).then(function(i){var o=i.result;return h({type:"delete",keys:o,trans:e}).then(function(i){return i.numFailures>0?Promise.reject(i.failures[0]):o.length<r?{failures:[],numFailures:0,lastResult:void 0}:p(e,n(n({},t),{lower:o[o.length-1],lowerOpen:!0}),r)})})}}});return a}})}};function Dr(e,t,n){return"add"===t.type?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}function Br(e,t,n){try{if(!t)return null;if(t.keys.length<e.length)return null;for(var r=[],i=0,o=0;i<t.keys.length&&o<e.length;++i)0===Mt(t.keys[i],e[o])&&(r.push(n?B(t.values[i]):t.values[i]),++o);return r.length===e.length?r:null}catch(e){return null}}var Ir={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var r=e.table(t);return n(n({},r),{getMany:function(e){if(!e.cache)return r.getMany(e);var t=Br(e.keys,e.trans._cache,"clone"===e.cache);return t?Re.resolve(t):r.getMany(e).then(function(t){return e.trans._cache={keys:e.keys,values:"clone"===e.cache?B(t):t},t})},mutate:function(e){return"add"!==e.type&&(e.trans._cache=null),r.mutate(e)}})}}}};function Rr(e,t){return"readonly"===e.trans.mode&&!!e.subscr&&!e.trans.explicit&&"disabled"!==e.trans.db._options.cache&&!t.schema.primaryKey.outbound}function $r(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Kr={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,r=new lr(e.MIN_KEY,e.MAX_KEY);return n(n({},e),{transaction:function(t,n,r){if(Oe.subscr&&"readonly"!==n)throw new Z.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Oe.querier));return e.transaction(t,n,r)},table:function(i){var s=e.table(i),l=s.schema,c=l.primaryKey,u=l.indexes,d=c.extractKey,h=c.outbound,f=c.autoIncrement&&u.filter(function(e){return e.compound&&e.keyPath.includes(c.keyPath)}),p=n(n({},s),{mutate:function(n){var o,u,d=n.trans,h=n.mutatedParts||(n.mutatedParts={}),p=function(e){var n="idb://".concat(t,"/").concat(i,"/").concat(e);return h[n]||(h[n]=new lr)},g=p(""),m=p(":dels"),y=n.type,b="deleteRange"===n.type?[n.range]:"delete"===n.type?[n.keys]:n.values.length<50?[Mr(c,n).filter(function(e){return e}),n.values]:[],v=b[0],x=b[1],w=n.trans._cache;if(a(v)){g.addKeys(v);var k="delete"===y||v.length===x.length?Br(v,w):null;k||m.addKeys(v),(k||x)&&qr(p,l,k,x)}else if(v){var _={from:null!==(o=v.lower)&&void 0!==o?o:e.MIN_KEY,to:null!==(u=v.upper)&&void 0!==u?u:e.MAX_KEY};m.add(_),g.add(_)}else g.add(r),m.add(r),l.indexes.forEach(function(e){return p(e.name).add(r)});return s.mutate(n).then(function(e){return!v||"add"!==n.type&&"put"!==n.type||(g.addKeys(e.results),f&&f.forEach(function(t){for(var r=n.values.map(function(e){return t.extractKey(e)}),i=t.keyPath.findIndex(function(e){return e===c.keyPath}),o=0,a=e.results.length;o<a;++o)r[o][i]=e.results[o];p(t.name).addKeys(r)})),d.mutatedParts=gr(d.mutatedParts||{},h),e})}}),g=function(t){var n,r,i=t.query,o=i.index,a=i.range;return[o,new lr(null!==(n=a.lower)&&void 0!==n?n:e.MIN_KEY,null!==(r=a.upper)&&void 0!==r?r:e.MAX_KEY)]},m={get:function(e){return[c,new lr(e.key)]},getMany:function(e){return[c,(new lr).addKeys(e.keys)]},count:g,query:g,openCursor:g};return o(m).forEach(function(e){p[e]=function(o){var a=Oe.subscr,l=!!a,c=Rr(Oe,s)&&$r(e,o)?o.obsSet={}:a;if(l){var u=function(e){var n="idb://".concat(t,"/").concat(i,"/").concat(e);return c[n]||(c[n]=new lr)},f=u(""),p=u(":dels"),g=m[e](o),y=g[0],b=g[1];if("query"===e&&y.isPrimaryKey&&!o.values?p.add(b):u(y.name||"").add(b),!y.isPrimaryKey){if("count"!==e){var v="query"===e&&h&&o.values&&s.query(n(n({},o),{values:!1}));return s[e].apply(this,arguments).then(function(t){if("query"===e){if(h&&o.values)return v.then(function(e){var n=e.result;return f.addKeys(n),t});var n=o.values?t.result.map(d):t.result;o.values?f.addKeys(n):p.addKeys(n)}else if("openCursor"===e){var r=t,i=o.values;return r&&Object.create(r,{key:{get:function(){return p.addKey(r.primaryKey),r.key}},primaryKey:{get:function(){var e=r.primaryKey;return p.addKey(e),e}},value:{get:function(){return i&&f.addKey(r.primaryKey),r.value}}})}return t})}p.add(r)}}return s[e].apply(this,arguments)}}),p}})}};function qr(e,t,n,r){function i(t){var i=e(t.name||"");function o(e){return null!=e?t.extractKey(e):null}var s=function(e){return t.multiEntry&&a(e)?e.forEach(function(e){return i.addKey(e)}):i.addKey(e)};(n||r).forEach(function(e,t){var i=n&&o(n[t]),a=r&&o(r[t]);0!==Mt(i,a)&&(null!=i&&s(i),null!=a&&s(a))})}t.indexes.forEach(i)}function Lr(e,t,r){if(0===r.numFailures)return t;if("deleteRange"===t.type)return null;var i=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;if(r.numFailures===i)return null;var o=n({},t);return a(o.keys)&&(o.keys=o.keys.filter(function(e,t){return!(t in r.failures)})),"values"in o&&a(o.values)&&(o.values=o.values.filter(function(e,t){return!(t in r.failures)})),o}function Fr(e,t){return void 0===t.lower||(t.lowerOpen?Mt(e,t.lower)>0:Mt(e,t.lower)>=0)}function zr(e,t){return void 0===t.upper||(t.upperOpen?Mt(e,t.upper)<0:Mt(e,t.upper)<=0)}function Nr(e,t){return Fr(e,t)&&zr(e,t)}function Wr(e,t,n,r,i,o){if(!n||0===n.length)return e;var s=t.query.index,l=s.multiEntry,c=t.query.range,u=r.schema.primaryKey.extractKey,d=s.extractKey,h=(s.lowLevelIndex||s).extractKey,f=n.reduce(function(e,n){var r=e,i=[];if("add"===n.type||"put"===n.type)for(var o=new lr,s=n.values.length-1;s>=0;--s){var h=n.values[s],f=u(h);if(!o.hasKey(f)){var p=d(h);(l&&a(p)?p.some(function(e){return Nr(e,c)}):Nr(p,c))&&(o.addKey(f),i.push(h))}}switch(n.type){case"add":var g=(new lr).addKeys(t.values?e.map(function(e){return u(e)}):e);r=e.concat(t.values?i.filter(function(e){var t=u(e);return!g.hasKey(t)&&(g.addKey(t),!0)}):i.map(function(e){return u(e)}).filter(function(e){return!g.hasKey(e)&&(g.addKey(e),!0)}));break;case"put":var m=(new lr).addKeys(n.values.map(function(e){return u(e)}));r=e.filter(function(e){return!m.hasKey(t.values?u(e):e)}).concat(t.values?i:i.map(function(e){return u(e)}));break;case"delete":var y=(new lr).addKeys(n.keys);r=e.filter(function(e){return!y.hasKey(t.values?u(e):e)});break;case"deleteRange":var b=n.range;r=e.filter(function(e){return!Nr(u(e),b)})}return r},e);return f===e?e:(f.sort(function(e,t){return Mt(h(e),h(t))||Mt(u(e),u(t))}),t.limit&&t.limit<1/0&&(f.length>t.limit?f.length=t.limit:e.length===t.limit&&f.length<t.limit&&(i.dirty=!0)),o?Object.freeze(f):f)}function Ur(e,t){return 0===Mt(e.lower,t.lower)&&0===Mt(e.upper,t.upper)&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Hr(e,t,n,r){if(void 0===e)return void 0!==t?-1:0;if(void 0===t)return 1;var i=Mt(e,t);if(0===i){if(n&&r)return 0;if(n)return 1;if(r)return-1}return i}function Vr(e,t,n,r){if(void 0===e)return void 0!==t?1:0;if(void 0===t)return-1;var i=Mt(e,t);if(0===i){if(n&&r)return 0;if(n)return-1;if(r)return 1}return i}function Qr(e,t){return Hr(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&Vr(e.upper,t.upper,e.upperOpen,t.upperOpen)>=0}function Yr(e,t,n,r){var i=yr["idb://".concat(e,"/").concat(t)];if(!i)return[];var o=i.queries[n];if(!o)return[null,!1,i,null];var a=o[(r.query?r.query.index.name:null)||""];if(!a)return[null,!1,i,null];switch(n){case"query":var s=a.find(function(e){return e.req.limit===r.limit&&e.req.values===r.values&&Ur(e.req.query.range,r.query.range)});return s?[s,!0,i,a]:[a.find(function(e){return("limit"in e.req?e.req.limit:1/0)>=r.limit&&(!r.values||e.req.values)&&Qr(e.req.query.range,r.query.range)}),!1,i,a];case"count":var l=a.find(function(e){return Ur(e.req.query.range,r.query.range)});return[l,!!l,i,a]}}function Gr(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",function(){e.subscribers.delete(n),0===e.subscribers.size&&Jr(e,t)})}function Jr(e,t){setTimeout(function(){0===e.subscribers.size&&L(t,e)},3e3)}var Xr={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name,r=n(n({},e),{transaction:function(n,r,i){var o=e.transaction(n,r,i);if("readwrite"===r){var a=new AbortController,s=a.signal,l=function(i){return function(){if(a.abort(),"readwrite"===r){for(var s=new Set,l=0,c=n;l<c.length;l++){var u=c[l],d=yr["idb://".concat(t,"/").concat(u)];if(d){var h=e.table(u),f=d.optimisticOps.filter(function(e){return e.trans===o});if(o._explicit&&i&&o.mutatedParts)for(var p=0,g=Object.values(d.queries.query);p<g.length;p++)for(var m=0,y=(x=g[p]).slice();m<y.length;m++)mr((_=y[m]).obsSet,o.mutatedParts)&&(L(x,_),_.subscribers.forEach(function(e){return s.add(e)}));else if(f.length>0){d.optimisticOps=d.optimisticOps.filter(function(e){return e.trans!==o});for(var b=0,v=Object.values(d.queries.query);b<v.length;b++)for(var x,w=0,k=(x=v[b]).slice();w<k.length;w++){var _;if(null!=(_=k[w]).res&&o.mutatedParts)if(i&&!_.dirty){var A=Object.isFrozen(_.res),C=Wr(_.res,_.req,f,h,_,A);_.dirty?(L(x,_),_.subscribers.forEach(function(e){return s.add(e)})):C!==_.res&&(_.res=C,_.promise=Re.resolve({result:C}))}else _.dirty&&L(x,_),_.subscribers.forEach(function(e){return s.add(e)})}}}}s.forEach(function(e){return e()})}}};o.addEventListener("abort",l(!1),{signal:s}),o.addEventListener("error",l(!1),{signal:s}),o.addEventListener("complete",l(!0),{signal:s})}return o},table:function(r){var i=e.table(r),o=i.schema.primaryKey,a=n(n({},i),{mutate:function(e){var a=Oe.trans;if(o.outbound||"disabled"===a.db._options.cache||a.explicit||"readwrite"!==a.idbtrans.mode)return i.mutate(e);var s=yr["idb://".concat(t,"/").concat(r)];if(!s)return i.mutate(e);var l=i.mutate(e);return"add"!==e.type&&"put"!==e.type||!(e.values.length>=50||Mr(o,e).some(function(e){return null==e}))?(s.optimisticOps.push(e),e.mutatedParts&&xr(e.mutatedParts),l.then(function(t){if(t.numFailures>0){L(s.optimisticOps,e);var n=Lr(s,e,t);n&&s.optimisticOps.push(n),e.mutatedParts&&xr(e.mutatedParts)}}),l.catch(function(){L(s.optimisticOps,e),e.mutatedParts&&xr(e.mutatedParts)})):l.then(function(t){var r=n(n({},e),{values:e.values.map(function(e,r){var i;if(t.failures[r])return e;var a=(null===(i=o.keyPath)||void 0===i?void 0:i.includes("."))?B(e):n({},e);return A(a,o.keyPath,t.results[r]),a})}),i=Lr(s,r,t);s.optimisticOps.push(i),queueMicrotask(function(){return e.mutatedParts&&xr(e.mutatedParts)})}),l},query:function(e){var n;if(!Rr(Oe,i)||!$r("query",e))return i.query(e);var o="immutable"===(null===(n=Oe.trans)||void 0===n?void 0:n.db._options.cache),a=Oe,s=a.requery,l=a.signal,c=Yr(t,r,"query",e),u=c[0],d=c[1],h=c[2],f=c[3];if(u&&d)u.obsSet=e.obsSet;else{var p=i.query(e).then(function(e){var t=e.result;if(u&&(u.res=t),o){for(var n=0,r=t.length;n<r;++n)Object.freeze(t[n]);Object.freeze(t)}else e.result=B(t);return e}).catch(function(e){return f&&u&&L(f,u),Promise.reject(e)});u={obsSet:e.obsSet,promise:p,subscribers:new Set,type:"query",req:e,dirty:!1},f?f.push(u):(f=[u],h||(h=yr["idb://".concat(t,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),h.queries.query[e.query.index.name||""]=f)}return Gr(u,f,s,l),u.promise.then(function(t){return{result:Wr(t.result,e,null==h?void 0:h.optimisticOps,i,u,o)}})}});return a}});return r}};function Zr(e,t){return new Proxy(e,{get:function(e,n,r){return"db"===n?t:Reflect.get(e,n,r)}})}var ei,ti=function(){function e(t,r){var i=this;this._middlewares={},this.verno=0;var o=e.dependencies;this._options=r=n({addons:e.addons,autoOpen:!0,indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange,cache:"cloned"},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};var a=r.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var s={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:re,dbReadyPromise:null,cancelOpen:re,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:r.autoOpen};s.dbReadyPromise=new Re(function(e){s.dbReadyResolve=e}),s.openCanceller=new Re(function(e,t){s.cancelOpen=t}),this._state=s,this.name=t,this.on=Lt(this,"populate","blocked","versionchange","close",{ready:[he,re]}),this.once=function(e,t){var n=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];i.on(e).unsubscribe(n),t.apply(i,r)};return i.on(e,n)},this.on.ready.subscribe=v(this.on.ready.subscribe,function(t){return function(n,r){e.vip(function(){var e=i._state;if(e.openComplete)e.dbOpenError||Re.resolve().then(n),r&&t(n);else if(e.onReadyBeingFired)e.onReadyBeingFired.push(n),r&&t(n);else{t(n);var o=i;r||t(function e(){o.on.ready.unsubscribe(n),o.on.ready.unsubscribe(e)})}})}}),this.Collection=Zt(this),this.Table=zt(this),this.Transaction=vn(this),this.Version=Zn(this),this.WhereClause=hn(this),this.on("versionchange",function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(i.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(i.name,"'. Closing db now to resume the delete request.")),i.close({disableAutoOpen:!1})}),this.on("blocked",function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('".concat(i.name,"') was blocked")):console.warn("Upgrade '".concat(i.name,"' blocked by other connection holding version ").concat(e.oldVersion/10))}),this._maxKey=An(r.IDBKeyRange),this._createTransaction=function(e,t,n,r){return new i.Transaction(e,t,n,i._options.chromeTransactionDurability,r)},this._fireOnBlocked=function(e){i.on("blocked").fire(e),_t.filter(function(e){return e.name===i.name&&e!==i&&!e._state.vcFired}).map(function(t){return t.on("versionchange").fire(e)})},this.use(Ir),this.use(Xr),this.use(Kr),this.use(Er),this.use(Or);var l=new Proxy(this,{get:function(e,t,n){if("_vip"===t)return!0;if("table"===t)return function(e){return Zr(i.table(e),l)};var r=Reflect.get(e,t,n);return r instanceof qt?Zr(r,l):"tables"===t?r.map(function(e){return Zr(e,l)}):"_createTransaction"===t?function(){return Zr(r.apply(this,arguments),l)}:r}});this.vip=l,a.forEach(function(e){return e(i)})}return e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new Z.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new Z.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(t){return t._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort(Rn),n.stores({}),this._state.autoSchema=!1,n)},e.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||Oe.letThrough||this._vip)?e():new Re(function(e,n){if(t._state.openComplete)return n(new Z.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void n(new Z.DatabaseClosed);t.open().catch(re)}t._state.dbReadyPromise.then(e,n)}).then(e)},e.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,i=e.name;i&&this.unuse({stack:t,name:i});var o=this._middlewares[t]||(this._middlewares[t]=[]);return o.push({stack:t,create:n,level:null==r?10:r,name:i}),o.sort(function(e,t){return e.level-t.level}),this},e.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(e){return r?e.create!==r:!!n&&e.name!==n})),this},e.prototype.open=function(){var e=this;return ft(Me,function(){return _r(e)})},e.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var e=this._state,t=_t.indexOf(this);if(t>=0&&_t.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(e){}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new Re(function(t){e.dbReadyResolve=t}),e.openCanceller=new Re(function(t,n){e.cancelOpen=n}))},e.prototype.close=function(e){var t=(void 0===e?{disableAutoOpen:!0}:e).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new Z.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new Z.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},e.prototype.delete=function(e){var t=this;void 0===e&&(e={disableAutoOpen:!0});var n=arguments.length>0&&"object"!=typeof arguments[0],r=this._state;return new Re(function(i,o){var a=function(){t.close(e);var n=t._deps.indexedDB.deleteDatabase(t.name);n.onsuccess=Xe(function(){ir(t._deps,t.name),i()}),n.onerror=fn(o),n.onblocked=t._fireOnBlocked};if(n)throw new Z.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(a):a()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return null!==this.idbdb},e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},e.prototype.hasFailed=function(){return null!==this._state.dbOpenError},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var e=this;return o(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var e=Cr.apply(this,arguments);return this._transaction.apply(this,e)},e.prototype._transaction=function(e,t,n){var r=this,i=Oe.trans;i&&i.db===this&&-1===e.indexOf("!")||(i=null);var o,a,s=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(a=t.map(function(e){var t=e instanceof r.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t}),"r"==e||e===Ct)o=Ct;else{if("rw"!=e&&e!=St)throw new Z.InvalidArgument("Invalid transaction mode: "+e);o=St}if(i){if(i.mode===Ct&&o===St){if(!s)throw new Z.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&a.forEach(function(e){if(i&&-1===i.storeNames.indexOf(e)){if(!s)throw new Z.SubTransaction("Table "+e+" not included in parent transaction.");i=null}}),s&&i&&!i.active&&(i=null)}}catch(e){return i?i._promise(null,function(t,n){n(e)}):mt(e)}var l=Sr.bind(null,this,o,a,i,n);return i?i._promise(o,l,"lock"):Oe.trans?ft(Oe.transless,function(){return r._whenReady(l)}):this._whenReady(l)},e.prototype.table=function(e){if(!u(this._allTables,e))throw new Z.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},e}(),ni="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable",ri=function(){function e(e){this._subscribe=e}return e.prototype.subscribe=function(e,t,n){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:n})},e.prototype[ni]=function(){return this},e}();try{ei={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch(e){ei={indexedDB:null,IDBKeyRange:null}}function ii(e){var t,n=!1,r=new ri(function(r){var i=N(e);function o(t){var n=Ue();try{i&&at();var r=ot(e,t);return i&&(r=r.finally(st)),r}finally{n&&He()}}var a,s=!1,l={},c={},u={get closed(){return s},unsubscribe:function(){s||(s=!0,a&&a.abort(),d&&yn.storagemutated.unsubscribe(p))}};r.start&&r.start(u);var d=!1,h=function(){return gt(g)};function f(){return mr(c,l)}var p=function(e){gr(l,e),f()&&h()},g=function(){if(!s&&ei.indexedDB){l={};var i={};a&&a.abort(),a=new AbortController;var u={subscr:i,signal:a.signal,requery:h,querier:e,trans:null},f=o(u);Promise.resolve(f).then(function(e){n=!0,t=e,s||u.signal.aborted||(l={},O(c=i)||d||(yn(gn,p),d=!0),gt(function(){return!s&&r.next&&r.next(e)}))},function(e){n=!1,["DatabaseClosedError","AbortError"].includes(null==e?void 0:e.name)||s||gt(function(){s||r.error&&r.error(e)})})}};return setTimeout(h,0),u});return r.hasValue=function(){return n},r.getValue=function(){return t},r}var oi=ti;function ai(e){var t=li;try{li=!0,yn.storagemutated.fire(e),wr(e,!0)}finally{li=t}}d(oi,n(n({},ne),{delete:function(e){return new oi(e,{addons:[]}).delete()},exists:function(e){return new oi(e,{addons:[]}).open().then(function(e){return e.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return nr(oi.dependencies).then(e)}catch(e){return mt(new Z.MissingAPI)}},defineClass:function(){function e(e){s(this,e)}return e},ignoreTransaction:function(e){return Oe.trans?ft(Oe.transless,e):e()},vip:or,async:function(e){return function(){try{var t=Ar(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Re.resolve(t)}catch(e){return mt(e)}}},spawn:function(e,t,n){try{var r=Ar(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:Re.resolve(r)}catch(e){return mt(e)}},currentTransaction:{get:function(){return Oe.trans||null}},waitFor:function(e,t){var n=Re.resolve("function"==typeof e?oi.ignoreTransaction(e):e).timeout(t||6e4);return Oe.trans?Oe.trans.waitFor(n):n},Promise:Re,debug:{get:function(){return fe},set:function(e){pe(e)}},derive:p,extend:s,props:d,override:v,Events:Lt,on:yn,liveQuery:ii,extendObservabilitySet:gr,getByKeyPath:_,setByKeyPath:A,delByKeyPath:C,shallowClone:S,deepClone:B,getObjectDiff:Tr,cmp:Mt,asap:w,minKey:xt,addons:[],connections:_t,errnames:J,dependencies:ei,cache:yr,semVer:bt,version:bt.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)})})),oi.maxKey=An(oi.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(yn(gn,function(e){var t;li||(t=new CustomEvent(mn,{detail:e}),li=!0,dispatchEvent(t),li=!1)}),addEventListener(mn,function(e){var t=e.detail;li||ai(t)}));var si,li=!1,ci=function(){};function ui(e){return new $t({add:e})}function di(e){return new $t({remove:e})}function hi(e,t){return new $t({replacePrefix:[e,t]})}return"undefined"!=typeof BroadcastChannel&&((ci=function(){(si=new BroadcastChannel(mn)).onmessage=function(e){return e.data&&ai(e.data)}})(),"function"==typeof si.unref&&si.unref(),yn(gn,function(e){li||si.postMessage(e)})),"undefined"!=typeof addEventListener&&(addEventListener("pagehide",function(e){if(!ti.disableBfCache&&e.persisted){fe&&console.debug("Dexie: handling persisted pagehide"),null==si||si.close();for(var t=0,n=_t;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!ti.disableBfCache&&e.persisted&&(fe&&console.debug("Dexie: handling persisted pageshow"),ci(),ai({all:new lr(-1/0,[[]])}))})),Re.rejectionMapper=te,pe(fe),n(ti,Object.freeze({__proto__:null,Dexie:ti,liveQuery:ii,Entity:Tt,cmp:Mt,PropModification:$t,replacePrefix:hi,add:ui,remove:di,default:ti,RangeSet:lr,mergeRanges:ur,rangesOverlap:dr}),{default:ti}),ti}();var he=ue(de.exports);const fe=Symbol.for("Dexie"),pe=globalThis[fe]||(globalThis[fe]=he);if(he.semVer!==pe.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${he.semVer} and ${pe.semVer}`);function ge(e){return{video:"Video",short:"Short",channel:"Channel",playlist:"Playlist",repo:"Repository",issue:"Issue",pr:"Pull Request",gist:"Gist",file:"File",wiki:"Wiki",article:"Article",profile:"Profile",question:"Question",package:"Package",subreddit:"Subreddit",post:"Post",tweet:"Tweet",home:"Home",search:"Search",page:"Page"}[e]||e}const me=new pe("BookmarkInsightsDB");async function ye(){try{return await me.bookmarks.toArray()}catch(e){return console.error("Error getting bookmarks:",e),[]}}async function be(e,t,n=null){try{return await me.cache.put({key:e,value:t,timestamp:Date.now(),ttl:n}),!0}catch(e){return console.error("Error setting cache:",e),!1}}me.version(1).stores({bookmarks:"id, url, title, domain, category, dateAdded, lastAccessed, lastChecked, isAlive, parentId",enrichmentQueue:"++queueId, bookmarkId, addedAt, priority",events:"++eventId, bookmarkId, type, timestamp",cache:"key",settings:"key"}),me.version(2).stores({bookmarks:"id, url, title, domain, category, dateAdded, lastAccessed, lastChecked, isAlive, parentId",enrichmentQueue:"++queueId, bookmarkId, addedAt, priority",events:"++eventId, bookmarkId, type, timestamp",cache:"key",settings:"key"}).upgrade(e=>{console.log("Upgrading database to version 2 - adding rawMetadata support")}),me.version(3).stores({bookmarks:"id, url, title, domain, category, dateAdded, lastAccessed, lastChecked, isAlive, parentId",enrichmentQueue:"++queueId, bookmarkId, addedAt, priority",events:"++eventId, bookmarkId, type, timestamp",cache:"key",settings:"key",similarities:"++id, bookmark1Id, bookmark2Id, score, [bookmark1Id+bookmark2Id]",computedMetrics:"key"}).upgrade(e=>{console.log("Upgrading database to version 3 - adding similarities and computedMetrics tables")}),me.version(4).stores({bookmarks:"id, url, title, domain, category, dateAdded, lastAccessed, lastChecked, isAlive, parentId, platform, creator, contentType",enrichmentQueue:"++queueId, bookmarkId, addedAt, priority",events:"++eventId, bookmarkId, type, timestamp",cache:"key",settings:"key",similarities:"++id, bookmark1Id, bookmark2Id, score, [bookmark1Id+bookmark2Id]",computedMetrics:"key"}).upgrade(e=>{console.log("Upgrading database to version 4 - adding platformData indexes")}),me.version(5).stores({bookmarks:"id, url, title, domain, category, dateAdded, lastAccessed, lastChecked, isAlive, parentId, platform, creator, contentType, publishedDate",enrichmentQueue:"++queueId, bookmarkId, addedAt, priority",events:"++eventId, bookmarkId, type, timestamp",cache:"key",settings:"key",similarities:"++id, bookmark1Id, bookmark2Id, score, [bookmark1Id+bookmark2Id]",computedMetrics:"key"}).upgrade(e=>{console.log("Upgrading database to version 5 - adding deep metadata analysis fields")});const ve=36e5,xe=3e5;async function we(e,t,n){try{const r=await me.computedMetrics.get(e);if(r&&r.validUntil>Date.now())return console.log(`Cache hit for metric: ${e}`),r.data;console.log(`Cache miss for metric: ${e}, computing...`);const i=await t();return await me.computedMetrics.put({key:e,data:i,computedAt:Date.now(),validUntil:Date.now()+n}),i}catch(n){return console.error(`Error getting cached metric ${e}:`,n),t()}}async function ke(){return we("domainAnalytics",async()=>{const e=await ye(),t={};e.forEach(e=>{if(!e.domain)return;t[e.domain]||(t[e.domain]={domain:e.domain,count:0,latestDate:0,oldestDate:1/0,enrichedCount:0});const n=t[e.domain];n.count++,e.lastChecked&&n.enrichedCount++,e.dateAdded>n.latestDate&&(n.latestDate=e.dateAdded),e.dateAdded<n.oldestDate&&(n.oldestDate=e.dateAdded)});const n=Object.values(t),r=e.length;return n.forEach(e=>{e.percentage=r>0?Math.round(e.count/r*100):0,e.dateAdded=e.latestDate}),{byRecency:[...n].sort((e,t)=>t.latestDate-e.latestDate),byCount:[...n].sort((e,t)=>t.count-e.count),top10:[...n].sort((e,t)=>t.count-e.count).slice(0,10),totalDomains:n.length,totalBookmarks:r}},ve)}async function _e(){try{const e=await ye(),t={};return e.forEach(e=>{e.folderPath&&(t[e.folderPath]=(t[e.folderPath]||0)+1)}),Object.entries(t).map(([e,t])=>({folder:e,count:t})).sort((e,t)=>t.count-e.count)}catch(e){return console.error("Error getting unique folders:",e),[]}}const Ae=(()=>{const{subscribe:e,set:t,update:n}=se({total:0,enriched:0,pending:0,deadLinks:0,duplicates:0,uniqueDomains:0,addedThisWeek:0,addedThisMonth:0,lastUpdated:null,loading:!0});let r=null;return{subscribe:e,async refresh(){try{const e=await ye(),n=Date.now(),r=6048e5,i=2592e6,o=e.length,a=e.filter(e=>e.lastChecked).length,s=e.filter(e=>!1===e.isAlive).length,l=new Set(e.map(e=>e.domain).filter(e=>e)).size,c=e.filter(e=>n-e.dateAdded<r).length,u=e.filter(e=>n-e.dateAdded<i).length,d=await we("quickDuplicateCount",async()=>{const t=new Map;return e.forEach(e=>{const n=e.url.toLowerCase().replace(/\/$/,"");t.has(n)||t.set(n,0),t.set(n,t.get(n)+1)}),Array.from(t.values()).filter(e=>e>1).length},xe);t({total:o,enriched:a,pending:o-a,deadLinks:s,duplicates:d,uniqueDomains:l,addedThisWeek:c,addedThisMonth:u,lastUpdated:Date.now(),loading:!1})}catch(e){console.error("Error refreshing stats:",e),n(e=>({...e,loading:!1}))}},startAutoRefresh(e=3e4){if(this.refresh(),!r){r=setInterval(()=>{"undefined"!=typeof document&&"visible"===document.visibilityState&&this.refresh()},e),console.log("Stats auto-refresh started (visibility-aware)")}},stopAutoRefresh(){r&&(clearInterval(r),r=null,console.log("Stats auto-refresh stopped"))}}})();le(Ae,e=>0===e.total?0:Math.round(e.enriched/e.total*100)),le(Ae,e=>e.pending);const Ce=function(){const{subscribe:e,set:t,update:n}=se([]);let r=0,i=null;return{subscribe:e,set:t,getCached:async(n=3e4)=>{const o=Date.now();let a=[];if(e(e=>{a=e})(),a.length>0&&o-r<n)return a;if(i){const e=await i;return null!==e?e:a}i=(async()=>{try{const e=await ye();return t(e),r=Date.now(),e}catch(e){return console.error("Error fetching bookmarks:",e),null}finally{i=null}})();const s=await i;return null!==s?s:a},refresh:async()=>{i=(async()=>{try{const e=await ye();return t(e),r=Date.now(),e}catch(e){return console.error("Error refreshing bookmarks:",e),null}finally{i=null}})();const e=await i;return null!==e?e:[]},invalidate:()=>{r=0}}}();const Se=function(){const{subscribe:e,set:t,update:n}=se({domains:[],folders:[],topics:[],types:[],creators:[],tags:[],deadLinks:!1,stale:!1,dateRange:null,readingTimeRange:null,qualityScoreRange:null,hasPublishedDate:null});return{subscribe:e,set:t,addFilter:(e,t)=>n(n=>{if(!Array.isArray(n[e]))return"boolean"==typeof n[e]?{...n,[e]:t}:{...n,[e]:t};if("creators"===e){if(!n.creators.find(e=>e.key===t.key))return{...n,creators:[...n.creators,t]}}else{const r=String(t).toLowerCase();if(!n[e].some(e=>String(e).toLowerCase()===r))return{...n,[e]:[...n[e],t]}}return n}),removeFilter:(e,t)=>n(n=>{if(Array.isArray(n[e])){if("creators"===e)return{...n,creators:n.creators.filter(e=>e.key!==t.key)};const r=String(t).toLowerCase();return{...n,[e]:n[e].filter(e=>String(e).toLowerCase()!==r)}}return"boolean"==typeof n[e]?{...n,[e]:!1}:{...n,[e]:null}}),toggleFilter:(e,t)=>n(n=>{if(Array.isArray(n[e])){if("creators"===e){return n.creators.find(e=>e.key===t.key)?{...n,creators:n.creators.filter(e=>e.key!==t.key)}:{...n,creators:[...n.creators,t]}}const r=String(t).toLowerCase(),i=n[e].findIndex(e=>String(e).toLowerCase()===r);return-1!==i?{...n,[e]:n[e].filter((e,t)=>t!==i)}:{...n,[e]:[...n[e],t]}}return"boolean"==typeof n[e]?{...n,[e]:!n[e]}:n}),setFilter:(e,t)=>n(n=>({...n,[e]:t})),clearFilters:()=>t({domains:[],folders:[],topics:[],types:[],creators:[],tags:[],deadLinks:!1,stale:!1,dateRange:null,readingTimeRange:null,qualityScoreRange:null,hasPublishedDate:null}),reset:()=>t({domains:[],folders:[],topics:[],types:[],creators:[],tags:[],deadLinks:!1,stale:!1,dateRange:null,readingTimeRange:null,qualityScoreRange:null,hasPublishedDate:null})}}();const je=function(){const{subscribe:e,set:t,update:n}=se(new Set);return{subscribe:e,set:t,toggle:e=>n(t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n}),add:e=>n(t=>{const n=new Set(t);return n.add(e),n}),remove:e=>n(t=>{const n=new Set(t);return n.delete(e),n}),selectAll:e=>t(new Set(e)),clear:()=>t(new Set)}}();function Pe(e,t,n){const r=e.slice();return r[11]=t[n],r}function Ee(e,t,n){const r=e.slice();return r[14]=t[n],r}function Te(e){const t=e.slice(),n=t[0].contentQualityScore>=70?"text-green-700 dark:text-green-400 bg-green-50 dark:bg-green-900/40":t[0].contentQualityScore>=40?"text-yellow-700 dark:text-yellow-400 bg-yellow-50 dark:bg-yellow-900/40":"text-orange-700 dark:text-orange-400 bg-orange-50 dark:bg-orange-900/40";return t[17]=n,t}function Me(e){let t;return{c(){t=g("span"),t.innerHTML='<svg class="w-3.5 h-3.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg>',x(t,"class","text-red-500 dark:text-red-400"),x(t,"title","Dead link")},m(e,n){h(e,t,n)},d(e){e&&f(t)}}}function Oe(e){let t;return{c(){t=g("span"),t.innerHTML='<svg class="w-3.5 h-3.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>',x(t,"class","text-green-500 dark:text-green-400"),x(t,"title","Enriched with metadata")},m(e,n){h(e,t,n)},d(e){e&&f(t)}}}function De(e){let t,n,r,i,o;return{c(){t=g("span"),n=m("svg"),r=m("path"),i=m("path"),x(r,"d","M10 12a2 2 0 100-4 2 2 0 000 4z"),x(i,"fill-rule","evenodd"),x(i,"d","M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z"),x(i,"clip-rule","evenodd"),x(n,"class","w-3.5 h-3.5"),x(n,"fill","currentColor"),x(n,"viewBox","0 0 20 20"),x(t,"class","text-blue-500 dark:text-blue-400 text-xs"),x(t,"title",o="Accessed "+e[0].accessCount+" times")},m(e,o){h(e,t,o),d(t,n),d(n,r),d(n,i)},p(e,n){1&n&&o!==(o="Accessed "+e[0].accessCount+" times")&&x(t,"title",o)},d(e){e&&f(t)}}}function Be(e){let t,n,r,i,o=e[0].category+"";return{c(){t=g("span"),n=y("ðŸ·ï¸ "),r=y(o),x(t,"class","text-xs text-purple-600 dark:text-purple-400 bg-purple-50 dark:bg-purple-900/40 px-2 py-0.5 rounded"),x(t,"title",i="Category: "+e[0].category)},m(e,i){h(e,t,i),d(t,n),d(t,r)},p(e,n){1&n&&o!==(o=e[0].category+"")&&w(r,o),1&n&&i!==(i="Category: "+e[0].category)&&x(t,"title",i)},d(e){e&&f(t)}}}function Ie(e){let t,n,r=oe(e[0].description,e[1])+"";return{c(){t=g("p"),x(t,"class","text-xs text-gray-500 dark:text-gray-400 mt-2 line-clamp-2 w-full"),x(t,"title",n=e[0].description)},m(e,n){h(e,t,n),t.innerHTML=r},p(e,i){3&i&&r!==(r=oe(e[0].description,e[1])+"")&&(t.innerHTML=r),1&i&&n!==(n=e[0].description)&&x(t,"title",n)},d(e){e&&f(t)}}}function Re(e){let t,n,r,i=e[0].readingTime&&$e(e),o=e[0].publishedDate&&Ke(e),a=e[0].contentQualityScore&&qe(Te(e));return{c(){t=g("div"),i&&i.c(),n=b(),o&&o.c(),r=b(),a&&a.c(),x(t,"class","flex items-center gap-2 mt-2 flex-wrap")},m(e,s){h(e,t,s),i&&i.m(t,null),d(t,n),o&&o.m(t,null),d(t,r),a&&a.m(t,null)},p(e,s){e[0].readingTime?i?i.p(e,s):(i=$e(e),i.c(),i.m(t,n)):i&&(i.d(1),i=null),e[0].publishedDate?o?o.p(e,s):(o=Ke(e),o.c(),o.m(t,r)):o&&(o.d(1),o=null),e[0].contentQualityScore?a?a.p(Te(e),s):(a=qe(Te(e)),a.c(),a.m(t,null)):a&&(a.d(1),a=null)},d(e){e&&f(t),i&&i.d(),o&&o.d(),a&&a.d()}}}function $e(e){let t,n,r,i,o=e[0].readingTime+"";return{c(){t=g("span"),n=y("â±ï¸ "),r=y(o),i=y(" min"),x(t,"class","text-xs text-gray-600 dark:text-gray-300 bg-gray-50 dark:bg-gray-700 px-2 py-0.5 rounded flex items-center gap-1"),x(t,"title","Estimated reading time")},m(e,o){h(e,t,o),d(t,n),d(t,r),d(t,i)},p(e,t){1&t&&o!==(o=e[0].readingTime+"")&&w(r,o)},d(e){e&&f(t)}}}function Ke(e){let t,n,r,i=ee(e[0].publishedDate)+"";return{c(){t=g("span"),n=y("ðŸ“… "),r=y(i),x(t,"class","text-xs text-gray-600 dark:text-gray-300 bg-gray-50 dark:bg-gray-700 px-2 py-0.5 rounded flex items-center gap-1"),x(t,"title","Published date")},m(e,i){h(e,t,i),d(t,n),d(t,r)},p(e,t){1&t&&i!==(i=ee(e[0].publishedDate)+"")&&w(r,i)},d(e){e&&f(t)}}}function qe(e){let t,n,r,i,o=e[0].contentQualityScore+"";return{c(){t=g("span"),n=y("â­ "),r=y(o),x(t,"class",i="text-xs px-2 py-0.5 rounded flex items-center gap-1 "+e[17]+" svelte-1oo2sed"),x(t,"title","Content quality score")},m(e,i){h(e,t,i),d(t,n),d(t,r)},p(e,n){1&n&&o!==(o=e[0].contentQualityScore+"")&&w(r,o),1&n&&i!==(i="text-xs px-2 py-0.5 rounded flex items-center gap-1 "+e[17]+" svelte-1oo2sed")&&x(t,"class",i)},d(e){e&&f(t)}}}function Le(e){let t,n,r=H(e[0].smartTags.slice(0,5)),i=[];for(let t=0;t<r.length;t+=1)i[t]=Fe(Ee(e,r,t));let o=e[0].smartTags.length>5&&ze(e);return{c(){t=g("div");for(let e=0;e<i.length;e+=1)i[e].c();n=b(),o&&o.c(),x(t,"class","flex items-center gap-1 mt-2 flex-wrap")},m(e,r){h(e,t,r);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);d(t,n),o&&o.m(t,null)},p(e,a){if(1&a){let o;for(r=H(e[0].smartTags.slice(0,5)),o=0;o<r.length;o+=1){const s=Ee(e,r,o);i[o]?i[o].p(s,a):(i[o]=Fe(s),i[o].c(),i[o].m(t,n))}for(;o<i.length;o+=1)i[o].d(1);i.length=r.length}e[0].smartTags.length>5?o?o.p(e,a):(o=ze(e),o.c(),o.m(t,null)):o&&(o.d(1),o=null)},d(e){e&&f(t),p(i,e),o&&o.d()}}}function Fe(e){let t,n,r=e[14]+"";return{c(){t=g("span"),n=y(r),x(t,"class","text-xs text-indigo-600 dark:text-indigo-400 bg-indigo-50 dark:bg-indigo-900/40 px-1.5 py-0.5 rounded"),x(t,"title","Smart tag")},m(e,r){h(e,t,r),d(t,n)},p(e,t){1&t&&r!==(r=e[14]+"")&&w(n,r)},d(e){e&&f(t)}}}function ze(e){let t,n,r,i,o=e[0].smartTags.length-5+"";return{c(){t=g("span"),n=y("+"),r=y(o),i=y(" more"),x(t,"class","text-xs text-gray-500 dark:text-gray-400")},m(e,o){h(e,t,o),d(t,n),d(t,r),d(t,i)},p(e,t){1&t&&o!==(o=e[0].smartTags.length-5+"")&&w(r,o)},d(e){e&&f(t)}}}function Ne(e){let t,n,r=H(e[0].topics.slice(0,4)),i=[];for(let t=0;t<r.length;t+=1)i[t]=We(Pe(e,r,t));let o=e[0].topics.length>4&&Ue(e);return{c(){t=g("div");for(let e=0;e<i.length;e+=1)i[e].c();n=b(),o&&o.c(),x(t,"class","flex items-center gap-1 mt-2 flex-wrap")},m(e,r){h(e,t,r);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);d(t,n),o&&o.m(t,null)},p(e,a){if(1&a){let o;for(r=H(e[0].topics.slice(0,4)),o=0;o<r.length;o+=1){const s=Pe(e,r,o);i[o]?i[o].p(s,a):(i[o]=We(s),i[o].c(),i[o].m(t,n))}for(;o<i.length;o+=1)i[o].d(1);i.length=r.length}e[0].topics.length>4?o?o.p(e,a):(o=Ue(e),o.c(),o.m(t,null)):o&&(o.d(1),o=null)},d(e){e&&f(t),p(i,e),o&&o.d()}}}function We(e){let t,n,r,i,o=e[11]+"";return{c(){t=g("span"),n=y("ðŸ·ï¸ "),r=y(o),x(t,"class","text-xs text-teal-600 dark:text-teal-400 bg-teal-50 dark:bg-teal-900/40 px-1.5 py-0.5 rounded"),x(t,"title",i="Topic: "+e[11])},m(e,i){h(e,t,i),d(t,n),d(t,r)},p(e,n){1&n&&o!==(o=e[11]+"")&&w(r,o),1&n&&i!==(i="Topic: "+e[11])&&x(t,"title",i)},d(e){e&&f(t)}}}function Ue(e){let t,n,r,i,o=e[0].topics.length-4+"";return{c(){t=g("span"),n=y("+"),r=y(o),i=y(" more"),x(t,"class","text-xs text-gray-500 dark:text-gray-400")},m(e,o){h(e,t,o),d(t,n),d(t,r),d(t,i)},p(e,t){1&t&&o!==(o=e[0].topics.length-4+"")&&w(r,o)},d(e){e&&f(t)}}}function He(e){let t,n;return{c(){t=m("svg"),n=m("path"),x(n,"stroke-linecap","round"),x(n,"stroke-linejoin","round"),x(n,"stroke-width","2"),x(n,"d","M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"),x(t,"class","w-4 h-4"),x(t,"fill","none"),x(t,"stroke","currentColor"),x(t,"viewBox","0 0 24 24")},m(e,r){h(e,t,r),d(t,n)},d(e){e&&f(t)}}}function Ve(e){let t,n;return{c(){t=m("svg"),n=m("path"),x(n,"stroke-linecap","round"),x(n,"stroke-linejoin","round"),x(n,"stroke-width","2"),x(n,"d","M5 13l4 4L19 7"),x(t,"class","w-4 h-4 text-green-500 dark:text-green-400"),x(t,"fill","none"),x(t,"stroke","currentColor"),x(t,"viewBox","0 0 24 24")},m(e,r){h(e,t,r),d(t,n)},d(e){e&&f(t)}}}function Qe(e){let t,n,r,i,o=e[0].folderPath+"";return{c(){t=g("p"),n=y("ðŸ“ "),r=y(o),x(t,"class","text-xs text-gray-400 dark:text-gray-500 mt-1 truncate"),x(t,"title",i=e[0].folderPath)},m(e,i){h(e,t,i),d(t,n),d(t,r)},p(e,n){1&n&&o!==(o=e[0].folderPath+"")&&w(r,o),1&n&&i!==(i=e[0].folderPath)&&x(t,"title",i)},d(e){e&&f(t)}}}function Ye(t){let n,i,o,a,s,c,u,p,m,k,_,C,S,j,P,E,T,M,O,D,B,I,R,$,K,q,L,F,z,N,W,U,H,V,Q,Y,G,J,X,Z,re=oe(t[0].title,t[1])+"",ie=oe(t[0].url,t[1])+"",ae=ne(t[0])+"",se=ee(t[0].dateAdded)+"",le=!1===t[0].isAlive&&Me(),ce=(t[0].description||t[0].keywords&&t[0].keywords.length>0)&&Oe(),ue=t[0].accessCount>0&&De(t),de=t[0].category&&Be(t),he=t[0].description&&Ie(t),fe=(t[0].readingTime||t[0].publishedDate||t[0].contentQualityScore)&&Re(t),pe=t[0].smartTags&&t[0].smartTags.length>0&&Le(t),ge=t[0].topics&&t[0].topics.length>0&&Ne(t);function me(e,t){return e[3]?Ve:He}let ye=me(t),be=ye(t),ve=t[0].folderPath&&Qe(t);return{c(){n=g("div"),i=g("div"),o=g("input"),s=b(),c=g("div"),u=g("img"),m=b(),k=g("div"),_=g("div"),C=g("h3"),j=b(),P=g("div"),le&&le.c(),E=b(),ce&&ce.c(),T=b(),ue&&ue.c(),M=b(),O=g("p"),B=b(),I=g("div"),R=g("div"),$=g("span"),K=y(ae),q=b(),de&&de.c(),L=b(),he&&he.c(),F=b(),fe&&fe.c(),z=b(),pe&&pe.c(),N=b(),ge&&ge.c(),W=b(),U=g("div"),H=g("button"),be.c(),V=b(),Q=g("span"),Y=y(se),G=b(),ve&&ve.c(),x(o,"type","checkbox"),o.checked=a=t[2].has(t[0].id),x(o,"class","w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500 cursor-pointer"),x(i,"class","absolute top-2 right-2 z-10"),A(i,"opacity-0",!t[2].has(t[0].id)),A(i,"group-hover:opacity-100",!0),l(u.src,p=te(t[0]))||x(u,"src",p),x(u,"alt","Favicon"),x(u,"class","w-4 h-4 mt-1 flex-shrink-0"),x(C,"class","text-sm font-medium text-gray-900 dark:text-gray-100 truncate flex-1"),x(C,"title",S=t[0].title),x(P,"class","flex items-center gap-1 flex-shrink-0"),x(_,"class","flex items-center gap-1.5"),x(O,"class","text-xs text-gray-500 dark:text-gray-400 truncate mt-1 max-w-full"),x(O,"title",D=t[0].url),x($,"class","text-xs text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/40 px-2 py-1 rounded"),x(R,"class","flex items-center gap-1.5"),x(H,"class","p-1 text-gray-400 dark:text-gray-500 hover:text-blue-600 dark:hover:text-blue-400 transition-colors"),x(H,"title","Copy URL"),x(Q,"class","text-xs text-gray-400 dark:text-gray-500"),x(U,"class","flex items-center space-x-2"),x(I,"class","flex items-center justify-between mt-2 gap-2 flex-wrap"),x(k,"class","flex-1 min-w-0"),x(c,"class","flex items-start space-x-3"),x(n,"class",J="bookmark-card bg-white dark:bg-gray-800 rounded-lg shadow-md p-4 hover:shadow-lg transition-shadow cursor-pointer border border-gray-200 dark:border-gray-700 relative group "+t[5]+" "+t[4]+" svelte-1oo2sed"),x(n,"role","button"),x(n,"tabindex","0")},m(e,r){h(e,n,r),d(n,i),d(i,o),d(n,s),d(n,c),d(c,u),d(c,m),d(c,k),d(k,_),d(_,C),C.innerHTML=re,d(_,j),d(_,P),le&&le.m(P,null),d(P,E),ce&&ce.m(P,null),d(P,T),ue&&ue.m(P,null),d(k,M),d(k,O),O.innerHTML=ie,d(k,B),d(k,I),d(I,R),d(R,$),d($,K),d(R,q),de&&de.m(R,null),d(I,L),he&&he.m(I,null),d(I,F),fe&&fe.m(I,null),d(I,z),pe&&pe.m(I,null),d(I,N),ge&&ge.m(I,null),d(I,W),d(I,U),d(U,H),be.m(H,null),d(U,V),d(U,Q),d(Q,Y),d(k,G),ve&&ve.m(k,null),X||(Z=[v(o,"click",t[8]),v(H,"click",t[7]),v(n,"click",t[6]),v(n,"keydown",t[9])],X=!0)},p(e,[t]){5&t&&a!==(a=e[2].has(e[0].id))&&(o.checked=a),5&t&&A(i,"opacity-0",!e[2].has(e[0].id)),1&t&&!l(u.src,p=te(e[0]))&&x(u,"src",p),3&t&&re!==(re=oe(e[0].title,e[1])+"")&&(C.innerHTML=re),1&t&&S!==(S=e[0].title)&&x(C,"title",S),!1===e[0].isAlive?le||(le=Me(),le.c(),le.m(P,E)):le&&(le.d(1),le=null),e[0].description||e[0].keywords&&e[0].keywords.length>0?ce||(ce=Oe(),ce.c(),ce.m(P,T)):ce&&(ce.d(1),ce=null),e[0].accessCount>0?ue?ue.p(e,t):(ue=De(e),ue.c(),ue.m(P,null)):ue&&(ue.d(1),ue=null),3&t&&ie!==(ie=oe(e[0].url,e[1])+"")&&(O.innerHTML=ie),1&t&&D!==(D=e[0].url)&&x(O,"title",D),1&t&&ae!==(ae=ne(e[0])+"")&&w(K,ae),e[0].category?de?de.p(e,t):(de=Be(e),de.c(),de.m(R,null)):de&&(de.d(1),de=null),e[0].description?he?he.p(e,t):(he=Ie(e),he.c(),he.m(I,F)):he&&(he.d(1),he=null),e[0].readingTime||e[0].publishedDate||e[0].contentQualityScore?fe?fe.p(e,t):(fe=Re(e),fe.c(),fe.m(I,z)):fe&&(fe.d(1),fe=null),e[0].smartTags&&e[0].smartTags.length>0?pe?pe.p(e,t):(pe=Le(e),pe.c(),pe.m(I,N)):pe&&(pe.d(1),pe=null),e[0].topics&&e[0].topics.length>0?ge?ge.p(e,t):(ge=Ne(e),ge.c(),ge.m(I,W)):ge&&(ge.d(1),ge=null),ye!==(ye=me(e))&&(be.d(1),be=ye(e),be&&(be.c(),be.m(H,null))),1&t&&se!==(se=ee(e[0].dateAdded)+"")&&w(Y,se),e[0].folderPath?ve?ve.p(e,t):(ve=Qe(e),ve.c(),ve.m(k,null)):ve&&(ve.d(1),ve=null),48&t&&J!==(J="bookmark-card bg-white dark:bg-gray-800 rounded-lg shadow-md p-4 hover:shadow-lg transition-shadow cursor-pointer border border-gray-200 dark:border-gray-700 relative group "+e[5]+" "+e[4]+" svelte-1oo2sed")&&x(n,"class",J)},i:e,o:e,d(e){e&&f(n),le&&le.d(),ce&&ce.d(),ue&&ue.d(),de&&de.d(),he&&he.d(),fe&&fe.d(),pe&&pe.d(),ge&&ge.d(),be.d(),ve&&ve.d(),X=!1,r(Z)}}}function Ge(e,t,n){let r,i,o;u(e,je,e=>n(2,o=e));let{bookmark:a}=t,{parsedSearchQuery:s=null}=t;P();let l=!1;function c(e){const t=!(e&&(e.shiftKey||e.metaKey||e.ctrlKey));!function(e,t=!0){chrome.tabs.create({url:e,active:t})}(a.url,t)}return e.$$set=e=>{"bookmark"in e&&n(0,a=e.bookmark),"parsedSearchQuery"in e&&n(1,s=e.parsedSearchQuery)},e.$$.update=()=>{1&e.$$.dirty&&n(5,r=!1===a.isAlive?"border-red-200 dark:border-red-800 bg-red-50 dark:bg-red-900/20":""),5&e.$$.dirty&&n(4,i=o.has(a.id)?"ring-2 ring-blue-500":"")},[a,s,o,l,i,r,c,async function(e){e.stopPropagation();const t=await async function(e){try{return await navigator.clipboard.writeText(e),!0}catch(e){return console.error("Failed to copy to clipboard:",e),!1}}(a.url);t&&(n(3,l=!0),setTimeout(()=>n(3,l=!1),2e3))},function(e){e.stopPropagation(),je.toggle(a.id)},e=>"Enter"===e.key&&c(e)]}class Je extends Z{constructor(e){super(),X(this,e,Ge,Ye,o,{bookmark:0,parsedSearchQuery:1})}}function Xe(e,t,n){const r=e.slice();return r[13]=t[n],r}function Ze(e,t,n){const r=e.slice();return r[16]=t[n],r}function et(e,t,n){const r=e.slice();return r[19]=t[n],r}function tt(e,t,n){const r=e.slice();return r[19]=t[n],r}function nt(t){let n,r,i;return{c(){n=g("button"),n.innerHTML='<svg class="h-5 w-5 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',x(n,"class","absolute inset-y-0 right-0 pr-3 flex items-center"),x(n,"type","button"),x(n,"title","Clear search (Esc)")},m(e,o){h(e,n,o),r||(i=v(n,"click",t[7]),r=!0)},p:e,d(e){e&&f(n),r=!1,i()}}}function rt(e){let t,n,r,i,o=H(e[4].positive),a=[];for(let t=0;t<o.length;t+=1)a[t]=it(tt(e,o,t));let s=H(e[4].negative),l=[];for(let t=0;t<s.length;t+=1)l[t]=ot(et(e,s,t));let c=H(e[4].phrases),u=[];for(let t=0;t<c.length;t+=1)u[t]=at(Ze(e,c,t));let m=H(e[4].regexPatterns),y=[];for(let t=0;t<m.length;t+=1)y[t]=st(Xe(e,m,t));return{c(){t=g("div");for(let e=0;e<a.length;e+=1)a[e].c();n=b();for(let e=0;e<l.length;e+=1)l[e].c();r=b();for(let e=0;e<u.length;e+=1)u[e].c();i=b();for(let e=0;e<y.length;e+=1)y[e].c();x(t,"class","flex flex-wrap gap-1.5 mt-2")},m(e,o){h(e,t,o);for(let e=0;e<a.length;e+=1)a[e]&&a[e].m(t,null);d(t,n);for(let e=0;e<l.length;e+=1)l[e]&&l[e].m(t,null);d(t,r);for(let e=0;e<u.length;e+=1)u[e]&&u[e].m(t,null);d(t,i);for(let e=0;e<y.length;e+=1)y[e]&&y[e].m(t,null)},p(e,d){if(16&d){let r;for(o=H(e[4].positive),r=0;r<o.length;r+=1){const i=tt(e,o,r);a[r]?a[r].p(i,d):(a[r]=it(i),a[r].c(),a[r].m(t,n))}for(;r<a.length;r+=1)a[r].d(1);a.length=o.length}if(16&d){let n;for(s=H(e[4].negative),n=0;n<s.length;n+=1){const i=et(e,s,n);l[n]?l[n].p(i,d):(l[n]=ot(i),l[n].c(),l[n].m(t,r))}for(;n<l.length;n+=1)l[n].d(1);l.length=s.length}if(16&d){let n;for(c=H(e[4].phrases),n=0;n<c.length;n+=1){const r=Ze(e,c,n);u[n]?u[n].p(r,d):(u[n]=at(r),u[n].c(),u[n].m(t,i))}for(;n<u.length;n+=1)u[n].d(1);u.length=c.length}if(16&d){let n;for(m=H(e[4].regexPatterns),n=0;n<m.length;n+=1){const r=Xe(e,m,n);y[n]?y[n].p(r,d):(y[n]=st(r),y[n].c(),y[n].m(t,null))}for(;n<y.length;n+=1)y[n].d(1);y.length=m.length}},d(e){e&&f(t),p(a,e),p(l,e),p(u,e),p(y,e)}}}function it(e){let t,n,r,i,o,a=e[19]+"";return{c(){t=g("span"),n=m("svg"),r=m("path"),i=b(),o=y(a),x(r,"fill-rule","evenodd"),x(r,"d","M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"),x(r,"clip-rule","evenodd"),x(n,"class","w-3 h-3 mr-1"),x(n,"fill","currentColor"),x(n,"viewBox","0 0 20 20"),x(t,"class","inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-300")},m(e,a){h(e,t,a),d(t,n),d(n,r),d(t,i),d(t,o)},p(e,t){16&t&&a!==(a=e[19]+"")&&w(o,a)},d(e){e&&f(t)}}}function ot(e){let t,n,r,i,o,a=e[19]+"";return{c(){t=g("span"),n=m("svg"),r=m("path"),i=b(),o=y(a),x(r,"fill-rule","evenodd"),x(r,"d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"),x(r,"clip-rule","evenodd"),x(n,"class","w-3 h-3 mr-1"),x(n,"fill","currentColor"),x(n,"viewBox","0 0 20 20"),x(t,"class","inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 dark:bg-red-900/40 text-red-800 dark:text-red-300")},m(e,a){h(e,t,a),d(t,n),d(n,r),d(t,i),d(t,o)},p(e,t){16&t&&a!==(a=e[19]+"")&&w(o,a)},d(e){e&&f(t)}}}function at(e){let t,n,r,i,o,a,s=e[16]+"";return{c(){t=g("span"),n=m("svg"),r=m("path"),i=y('\n          "'),o=y(s),a=y('"'),x(r,"fill-rule","evenodd"),x(r,"d","M18 13V5a2 2 0 00-2-2H4a2 2 0 00-2 2v8a2 2 0 002 2h3l3 3 3-3h3a2 2 0 002-2zM5 7a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1zm1 3a1 1 0 100 2h3a1 1 0 100-2H6z"),x(r,"clip-rule","evenodd"),x(n,"class","w-3 h-3 mr-1"),x(n,"fill","currentColor"),x(n,"viewBox","0 0 20 20"),x(t,"class","inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-300")},m(e,s){h(e,t,s),d(t,n),d(n,r),d(t,i),d(t,o),d(t,a)},p(e,t){16&t&&s!==(s=e[16]+"")&&w(o,s)},d(e){e&&f(t)}}}function st(e){let t,n,r,i,o,a,s=e[13]+"";return{c(){t=g("span"),n=m("svg"),r=m("path"),i=b(),o=y(s),a=b(),x(r,"stroke-linecap","round"),x(r,"stroke-linejoin","round"),x(r,"stroke-width","2"),x(r,"d","M10 20l4-16m4 4l-4 4 4 4M6 16l-4-4 4-4"),x(n,"class","w-3 h-3 mr-1"),x(n,"fill","none"),x(n,"stroke","currentColor"),x(n,"viewBox","0 0 20 20"),x(t,"class","inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-100 dark:bg-purple-900/40 text-purple-800 dark:text-purple-300")},m(e,s){h(e,t,s),d(t,n),d(n,r),d(t,i),d(t,o),d(t,a)},p(e,t){16&t&&s!==(s=e[13]+"")&&w(o,s)},d(e){e&&f(t)}}}function lt(e){let t;return{c(){t=g("div"),t.innerHTML='<h4 class="font-medium text-gray-900 dark:text-gray-100 mb-3 flex items-center gap-2"><svg class="w-4 h-4 text-blue-500 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>\n        Search Syntax</h4> <div class="space-y-2 text-sm"><div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-green-100 dark:bg-green-900/40 text-green-800 dark:text-green-300 rounded text-xs whitespace-nowrap">+term</code> <span class="text-gray-600 dark:text-gray-400">Must include this term</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-red-100 dark:bg-red-900/40 text-red-800 dark:text-red-300 rounded text-xs whitespace-nowrap">-term</code> <span class="text-gray-600 dark:text-gray-400">Must NOT include this term</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-blue-100 dark:bg-blue-900/40 text-blue-800 dark:text-blue-300 rounded text-xs whitespace-nowrap">&quot;exact phrase&quot;</code> <span class="text-gray-600 dark:text-gray-400">Match exact phrase</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded text-xs whitespace-nowrap">word</code> <span class="text-gray-600 dark:text-gray-400">Regular search term</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-purple-100 dark:bg-purple-900/40 text-purple-800 dark:text-purple-300 rounded text-xs whitespace-nowrap">/regex/</code> <span class="text-gray-600">Regular expression pattern</span></div></div> <div class="mt-4 pt-3 border-t border-gray-100"><h5 class="font-medium text-gray-800 mb-2 flex items-center gap-2 text-sm"><svg class="w-4 h-4 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path></svg>\n          Special Filters</h5> <div class="space-y-2 text-sm"><div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-indigo-100 text-indigo-800 rounded text-xs whitespace-nowrap">category:tech</code> <span class="text-gray-600">ðŸ“ Filter by category</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-indigo-100 text-indigo-800 rounded text-xs whitespace-nowrap">domain:github.com</code> <span class="text-gray-600">ðŸŒ Filter by domain</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-indigo-100 text-indigo-800 rounded text-xs whitespace-nowrap">folder:&quot;Work/Projects&quot;</code> <span class="text-gray-600">ðŸ“‚ Filter by folder path</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-amber-100 text-amber-800 rounded text-xs whitespace-nowrap">accessed:yes</code> <span class="text-gray-600">ðŸ‘† Has been accessed (yes/no)</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-amber-100 text-amber-800 rounded text-xs whitespace-nowrap">stale:yes</code> <span class="text-gray-600">â° Old &amp; never accessed</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-teal-100 text-teal-800 rounded text-xs whitespace-nowrap">enriched:yes</code> <span class="text-gray-600">âœ¨ Has metadata (yes/no)</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-red-100 text-red-700 rounded text-xs whitespace-nowrap">dead:yes</code> <span class="text-gray-600">ðŸ’€ Dead links (yes/no)</span></div></div></div> <div class="mt-4 pt-3 border-t border-gray-100"><h5 class="font-medium text-gray-800 mb-2 flex items-center gap-2 text-sm"><span class="text-lg">ðŸ“±</span>\n          Platform Filters</h5> <div class="space-y-2 text-sm"><div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-pink-100 text-pink-800 rounded text-xs whitespace-nowrap">platform:youtube</code> <span class="text-gray-600">ðŸ“º Filter by platform (youtube, github, medium, etc.)</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-pink-100 text-pink-800 rounded text-xs whitespace-nowrap">channel:@mkbhd</code> <span class="text-gray-600">ðŸ“º YouTube channel (with or without @)</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-pink-100 text-pink-800 rounded text-xs whitespace-nowrap">repo:facebook/react</code> <span class="text-gray-600">ðŸ’» GitHub repository (owner/repo)</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-pink-100 text-pink-800 rounded text-xs whitespace-nowrap">author:username</code> <span class="text-gray-600">âœï¸ Blog/article author</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-pink-100 text-pink-800 rounded text-xs whitespace-nowrap">type:video</code> <span class="text-gray-600">ðŸ“ Content type (video, issue, article, repo, pr)</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-pink-100 text-pink-800 rounded text-xs whitespace-nowrap">hasimage:yes</code> <span class="text-gray-600">ðŸ–¼ï¸ Has thumbnail image (yes/no)</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-pink-100 text-pink-800 rounded text-xs whitespace-nowrap">playlist:PLxxx</code> <span class="text-gray-600">ðŸŽµ YouTube playlist ID</span></div></div></div> <div class="mt-4 pt-3 border-t border-gray-100"><p class="text-xs text-gray-500"><strong>Example:</strong> <code class="bg-gray-100 px-1 rounded">javascript +tutorial -video &quot;best practices&quot;</code></p> <p class="text-xs text-gray-500 mt-1"><strong>With filters:</strong> <code class="bg-gray-100 px-1 rounded">domain:github.com category:development enriched:yes</code></p> <p class="text-xs text-gray-500 mt-1"><strong>Platform:</strong> <code class="bg-gray-100 px-1 rounded">platform:youtube channel:@fireship type:video</code></p> <p class="text-xs text-gray-500 mt-1"><strong>Regex:</strong> <code class="bg-gray-100 px-1 rounded">/react.*hooks?/</code></p></div>',x(t,"class","absolute z-20 w-full mt-2 p-4 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg max-h-[70vh] overflow-y-auto")},m(e,n){h(e,t,n)},d(e){e&&f(t)}}}function ct(t){let n,i,o,a,s,l,c,u,p,m,y,w,_,A=t[0]&&nt(t),C=t[0]&&(t[4].positive.length>0||t[4].negative.length>0||t[4].phrases.length>0||t[4].regexPatterns.length>0)&&rt(t),S=t[3]&&lt();return{c(){n=g("div"),i=g("div"),o=g("div"),a=g("div"),a.innerHTML='<svg class="h-5 w-5 text-gray-400 dark:text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>',s=b(),l=g("input"),c=b(),A&&A.c(),u=b(),p=g("button"),p.innerHTML='<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>',m=b(),C&&C.c(),y=b(),S&&S.c(),x(a,"class","absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"),x(l,"type","text"),x(l,"placeholder",t[1]),x(l,"class","block w-full pl-10 pr-10 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg leading-5 bg-white dark:bg-gray-800 placeholder-gray-400 dark:placeholder-gray-500 text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"),x(l,"autocomplete","off"),x(l,"spellcheck","false"),x(o,"class","relative flex-1"),x(p,"class","p-2.5 text-gray-500 dark:text-gray-400 hover:text-blue-600 dark:hover:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded-lg border border-gray-300 dark:border-gray-600 transition-colors"),x(p,"type","button"),x(p,"title","Search help"),x(i,"class","flex items-center gap-2"),x(n,"class","relative search-container")},m(e,r){h(e,n,r),d(n,i),d(i,o),d(o,a),d(o,s),d(o,l),t[9](l),k(l,t[0]),d(o,c),A&&A.m(o,null),d(i,u),d(i,p),d(n,m),C&&C.m(n,null),d(n,y),S&&S.m(n,null),w||(_=[v(l,"input",t[10]),v(l,"input",t[5]),v(l,"focus",ut),v(l,"keydown",t[6]),v(p,"click",t[8])],w=!0)},p(e,[t]){2&t&&x(l,"placeholder",e[1]),1&t&&l.value!==e[0]&&k(l,e[0]),e[0]?A?A.p(e,t):(A=nt(e),A.c(),A.m(o,null)):A&&(A.d(1),A=null),e[0]&&(e[4].positive.length>0||e[4].negative.length>0||e[4].phrases.length>0||e[4].regexPatterns.length>0)?C?C.p(e,t):(C=rt(e),C.c(),C.m(n,y)):C&&(C.d(1),C=null),e[3]?S||(S=lt(),S.c(),S.m(n,null)):S&&(S.d(1),S=null)},i:e,o:e,d(e){e&&f(n),t[9](null),A&&A.d(),C&&C.d(),S&&S.d(),w=!1,r(_)}}}function ut(){}function dt(e,t,n){let r;const i=P();let o,a,{value:s=""}=t,{placeholder:l='Search: use +term (must include), -term (exclude), "exact phrase"'}=t,c=!1;function u(){n(0,s=""),i("search",{query:""}),a?.focus()}return j(()=>{}),e.$$set=e=>{"value"in e&&n(0,s=e.value),"placeholder"in e&&n(1,l=e.placeholder)},e.$$.update=()=>{1&e.$$.dirty&&n(4,r=function(e){if(!e)return{positive:[],negative:[],phrases:[],regular:[],regexPatterns:[]};const t=[],n=[],r=[],i=[],o=[];(e.match(/\/([^\/]+)\/([gimsuvy]*)?/g)||[]).forEach(e=>o.push(e));let a=e.replace(/\/[^\/]+\/[gimsuvy]*/g,"").trim();return(a.match(/"([^"]+)"/g)||[]).forEach(e=>r.push(e.slice(1,-1))),a=a.replace(/"[^"]+"/g,"").trim(),a.split(/\s+/).filter(e=>e.length>0).forEach(e=>{e.startsWith("+")&&e.length>1?t.push(e.slice(1)):e.startsWith("-")&&e.length>1?n.push(e.slice(1)):i.push(e)}),{positive:t,negative:n,phrases:r,regular:i,regexPatterns:o}}(s))},[s,l,a,c,r,function(e){n(0,s=e.target.value),clearTimeout(o),o=setTimeout(()=>{i("search",{query:s})},200)},function(e){"Escape"===e.key?u():"Enter"===e.key&&(clearTimeout(o),i("search",{query:s}))},u,function(){n(3,c=!c)},function(e){T[e?"unshift":"push"](()=>{a=e,n(2,a)})},function(){s=this.value,n(0,s)}]}class ht extends Z{constructor(e){super(),X(this,e,dt,ct,o,{value:0,placeholder:1})}}const ft={tech:{id:"tech",name:"Technology",icon:"ðŸ’»",keywords:["technology","tech","software","hardware","computer","digital","gadget","device","smartphone","laptop","pc","server","cloud","saas","startup","silicon valley","innovation"],domains:["techcrunch.com","theverge.com","arstechnica.com","wired.com","engadget.com","gizmodo.com","cnet.com","zdnet.com","venturebeat.com"],subtopics:{ai:{id:"tech/ai",name:"AI & Machine Learning",keywords:["artificial intelligence","machine learning","deep learning","neural network","nlp","natural language","computer vision","llm","gpt","transformer","reinforcement learning","supervised learning","unsupervised","chatgpt","openai","anthropic","claude","gemini","stable diffusion","midjourney","data science","ml ops","model training","inference","embeddings"],domains:["openai.com","huggingface.co","arxiv.org","paperswithcode.com"]},web3:{id:"tech/web3",name:"Web3 & Blockchain",keywords:["blockchain","cryptocurrency","crypto","bitcoin","ethereum","web3","defi","nft","smart contract","solidity","wallet","token","dao"],domains:["coinbase.com","binance.com","etherscan.io","opensea.io"]}}},coding:{id:"coding",name:"Programming",icon:"ðŸ‘¨â€ðŸ’»",keywords:["programming","coding","developer","development","code","software engineering","backend","frontend","fullstack","full-stack","devops","api","sdk","framework","library","package","module","dependency","npm","pip","git","version control","debugging","testing","deployment","ci/cd"],domains:["github.com","gitlab.com","bitbucket.org","stackoverflow.com","npmjs.com","pypi.org","crates.io","packagist.org","rubygems.org"],subtopics:{javascript:{id:"coding/javascript",name:"JavaScript",keywords:["javascript","typescript","node.js","nodejs","react","vue","angular","svelte","nextjs","next.js","nuxt","express","deno","bun","vite","webpack","esbuild","rollup","jsx","tsx","ecmascript","es6","es2020"],domains:["nodejs.org","reactjs.org","vuejs.org","svelte.dev"]},python:{id:"coding/python",name:"Python",keywords:["python","django","flask","fastapi","pandas","numpy","pytorch","tensorflow","scikit-learn","jupyter","notebook","pip","conda","virtualenv","asyncio","pydantic","sqlalchemy"],domains:["python.org","pypi.org","realpython.com","djangoproject.com"]},rust:{id:"coding/rust",name:"Rust",keywords:["rust","rustlang","cargo","crate","tokio","async-std","wasm"],domains:["rust-lang.org","crates.io","docs.rs"]},go:{id:"coding/go",name:"Go",keywords:["golang","go language","goroutine","gin","fiber","echo"],domains:["golang.org","go.dev","pkg.go.dev"]}}},tutorials:{id:"tutorials",name:"Tutorials",icon:"ðŸ“š",keywords:["tutorial","how to","howto","how-to","guide","learn","learning","beginner","introduction","intro to","getting started","step by step","step-by-step","walkthrough","explained","crash course","masterclass","fundamentals","basics","complete guide","definitive guide","cheatsheet","cheat sheet","quick start","quickstart"],domains:["tutorialspoint.com","w3schools.com","freecodecamp.org","codecademy.com","coursera.org","udemy.com","pluralsight.com","egghead.io","frontendmasters.com","levelup.gitconnected.com"]},blogs:{id:"blogs",name:"Blogs & Articles",icon:"ðŸ“",keywords:["blog","article","post","opinion","essay","thoughts on","my experience","story","journey","lessons learned","reflection","review"],domains:["medium.com","dev.to","hashnode.com","substack.com","wordpress.com","blogger.com","ghost.io","mirror.xyz"]},videos:{id:"videos",name:"Videos",icon:"ðŸŽ¬",keywords:["video","watch","stream","streaming","episode","podcast","webinar","talk","presentation","conference talk","keynote","demo","screencast"],domains:["youtube.com","youtu.be","vimeo.com","twitch.tv","dailymotion.com","loom.com","wistia.com","ted.com"]},religious:{id:"religious",name:"Religious & Spiritual",icon:"ðŸ•Œ",keywords:["islam","islamic","muslim","quran","hadith","sunnah","prophet","allah","prayer","salah","fasting","ramadan","hajj","zakat","mosque","masjid","imam","sheikh","fatwa","halal","haram","christianity","christian","bible","jesus","church","gospel","judaism","jewish","torah","synagogue","rabbi","buddhism","buddhist","meditation","dharma","zen","hinduism","hindu","yoga","vedic","spirituality","spiritual","faith","belief","worship","religious","religion","scripture","sermon","dua","tafsir","recitation","tilawah"],domains:["islamqa.info","sunnah.com","quran.com","islamweb.net","biblegateway.com","gotquestions.org","chabad.org","myjewishlearning.com"]},news:{id:"news",name:"News",icon:"ðŸ“°",keywords:["news","breaking","headline","report","latest","update","announcement","press release","coverage","journalism","current events","world news"],domains:["reuters.com","apnews.com","bbc.com","cnn.com","nytimes.com","theguardian.com","washingtonpost.com","wsj.com","bloomberg.com","aljazeera.com","news.ycombinator.com"]},tools:{id:"tools",name:"Tools & Apps",icon:"ðŸ› ï¸",keywords:["tool","app","application","utility","extension","plugin","addon","software","platform","service","saas","free tool","online tool","generator","converter","calculator","formatter","validator","linter"],domains:["notion.so","figma.com","canva.com","trello.com","asana.com","slack.com","discord.com","vercel.com","netlify.com","heroku.com","postman.com","insomnia.rest"]},documentation:{id:"documentation",name:"Documentation",icon:"ðŸ“–",keywords:["documentation","docs","api reference","api docs","reference","specification","spec","manual","handbook","wiki","changelog","release notes","readme"],domains:["docs.github.com","developer.mozilla.org","devdocs.io","readthedocs.org","gitbook.io","notion.site","confluence.atlassian.com"]},research:{id:"research",name:"Research & Papers",icon:"ðŸ”¬",keywords:["research","paper","study","academic","journal","publication","thesis","dissertation","peer-reviewed","scientific","experiment","findings","methodology","abstract","citation","arxiv"],domains:["arxiv.org","scholar.google.com","researchgate.net","academia.edu","semanticscholar.org","paperswithcode.com","nature.com","sciencedirect.com"]},design:{id:"design",name:"Design & UI/UX",icon:"ðŸŽ¨",keywords:["design","ui","ux","user interface","user experience","graphic design","web design","visual design","typography","color","layout","wireframe","prototype","mockup","figma","sketch","adobe","illustration","icon","logo","branding","animation","motion design"],domains:["figma.com","dribbble.com","behance.net","awwwards.com","uxdesign.cc","smashingmagazine.com","nngroup.com","invisionapp.com"]},career:{id:"career",name:"Career & Jobs",icon:"ðŸ’¼",keywords:["career","job","hiring","interview","resume","cv","portfolio","salary","remote work","freelance","contract","employment","recruiting","linkedin","networking","job search","tech job"],domains:["linkedin.com","indeed.com","glassdoor.com","levels.fyi","wellfound.com","remoteok.io","weworkremotely.com","dice.com"]},entertainment:{id:"entertainment",name:"Entertainment",icon:"ðŸŽ®",keywords:["entertainment","game","gaming","movie","film","tv","series","anime","manga","comic","music","song","album","artist","sports","esports","hobby","fun","leisure"],domains:["imdb.com","rottentomatoes.com","ign.com","gamespot.com","spotify.com","netflix.com","twitch.tv","steamcommunity.com"]},finance:{id:"finance",name:"Finance & Investing",icon:"ðŸ’°",keywords:["finance","investing","investment","stock","market","trading","portfolio","dividend","etf","mutual fund","retirement","401k","savings","budgeting","financial planning","wealth","money"],domains:["yahoo.com/finance","investopedia.com","fool.com","seekingalpha.com","morningstar.com","robinhood.com","fidelity.com","vanguard.com"]},productivity:{id:"productivity",name:"Productivity",icon:"âš¡",keywords:["productivity","workflow","automation","efficiency","time management","task management","project management","organization","habit","goal setting","focus","gtd","getting things done","lifehack"],domains:["notion.so","todoist.com","asana.com","monday.com","clickup.com","obsidian.md","roamresearch.com","zapier.com","make.com"]},security:{id:"security",name:"Security & Privacy",icon:"ðŸ”’",keywords:["security","cybersecurity","privacy","hacking","vulnerability","exploit","penetration testing","pentest","encryption","authentication","authorization","oauth","jwt","ssl","tls","firewall","vpn","password","malware","ransomware","phishing","data breach"],domains:["owasp.org","hackerone.com","security.stackexchange.com","krebsonsecurity.com","schneier.com","thehackernews.com"]}};function pt(e){const t=function(e){if(!e)return null;const t=e.split("/"),n=ft[t[0]];if(!n)return null;if(1===t.length)return{id:n.id,name:n.name,icon:n.icon,isSubtopic:!1};const r=n.subtopics?.[t[1]];return r?{id:r.id,name:r.name,icon:n.icon,isSubtopic:!0,parentId:n.id,parentName:n.name}:null}(e);return t?`${t.icon} ${t.name}`:e}function gt(e,t,n){const r=e.slice();return r[75]=t[n],r}function mt(e,t,n){const r=e.slice();r[78]=t[n];const i=r[22]("creators",`${r[78].platform}:${r[78].creator}`);return r[79]=i,r}function yt(e,t,n){const r=e.slice();return r[82]=t[n],r}function bt(e,t,n){const r=e.slice();return r[85]=t[n],r}function vt(e,t,n){const r=e.slice();return r[88]=t[n],r}function xt(e,t,n){const r=e.slice();return r[91]=t[n],r}function wt(e,t,n){const r=e.slice();return r[94]=t[n],r}function kt(e,t,n){const r=e.slice();return r[97]=t[n],r}function _t(e,t,n){const r=e.slice();return r[100]=t[n],r}function At(e,t,n){const r=e.slice();return r[103]=t[n],r}function Ct(t){let n,r,i;return{c(){n=g("button"),n.textContent="Clear All",x(n,"class","text-xs text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300")},m(e,o){h(e,n,o),r||(i=v(n,"click",t[28]),r=!0)},p:e,d(e){e&&f(n),r=!1,i()}}}function St(e){let t,n,r,i,o,a,s=H(e[3].topics),l=[];for(let t=0;t<s.length;t+=1)l[t]=jt(At(e,s,t));let c=H(e[3].creators),u=[];for(let t=0;t<c.length;t+=1)u[t]=Pt(_t(e,c,t));let m=H(e[3].types),y=[];for(let t=0;t<m.length;t+=1)y[t]=Et(kt(e,m,t));let v=H(e[3].domains),w=[];for(let t=0;t<v.length;t+=1)w[t]=Tt(wt(e,v,t));let k=H(e[3].folders),_=[];for(let t=0;t<k.length;t+=1)_[t]=Mt(xt(e,k,t));let A=e[3].dateRange&&Ot(e);return{c(){t=g("div");for(let e=0;e<l.length;e+=1)l[e].c();n=b();for(let e=0;e<u.length;e+=1)u[e].c();r=b();for(let e=0;e<y.length;e+=1)y[e].c();i=b();for(let e=0;e<w.length;e+=1)w[e].c();o=b();for(let e=0;e<_.length;e+=1)_[e].c();a=b(),A&&A.c(),x(t,"class","mb-4 flex flex-wrap gap-2")},m(e,s){h(e,t,s);for(let e=0;e<l.length;e+=1)l[e]&&l[e].m(t,null);d(t,n);for(let e=0;e<u.length;e+=1)u[e]&&u[e].m(t,null);d(t,r);for(let e=0;e<y.length;e+=1)y[e]&&y[e].m(t,null);d(t,i);for(let e=0;e<w.length;e+=1)w[e]&&w[e].m(t,null);d(t,o);for(let e=0;e<_.length;e+=1)_[e]&&_[e].m(t,null);d(t,a),A&&A.m(t,null)},p(e,d){if(33554440&d[0]){let r;for(s=H(e[3].topics),r=0;r<s.length;r+=1){const i=At(e,s,r);l[r]?l[r].p(i,d):(l[r]=jt(i),l[r].c(),l[r].m(t,n))}for(;r<l.length;r+=1)l[r].d(1);l.length=s.length}if(67108872&d[0]){let n;for(c=H(e[3].creators),n=0;n<c.length;n+=1){const i=_t(e,c,n);u[n]?u[n].p(i,d):(u[n]=Pt(i),u[n].c(),u[n].m(t,r))}for(;n<u.length;n+=1)u[n].d(1);u.length=c.length}if(134217736&d[0]){let n;for(m=H(e[3].types),n=0;n<m.length;n+=1){const r=kt(e,m,n);y[n]?y[n].p(r,d):(y[n]=Et(r),y[n].c(),y[n].m(t,i))}for(;n<y.length;n+=1)y[n].d(1);y.length=m.length}if(8388616&d[0]){let n;for(v=H(e[3].domains),n=0;n<v.length;n+=1){const r=wt(e,v,n);w[n]?w[n].p(r,d):(w[n]=Tt(r),w[n].c(),w[n].m(t,o))}for(;n<w.length;n+=1)w[n].d(1);w.length=v.length}if(16777224&d[0]){let n;for(k=H(e[3].folders),n=0;n<k.length;n+=1){const r=xt(e,k,n);_[n]?_[n].p(r,d):(_[n]=Mt(r),_[n].c(),_[n].m(t,a))}for(;n<_.length;n+=1)_[n].d(1);_.length=k.length}e[3].dateRange?A?A.p(e,d):(A=Ot(e),A.c(),A.m(t,null)):A&&(A.d(1),A=null)},d(e){e&&f(t),p(l,e),p(u,e),p(y,e),p(w,e),p(_,e),A&&A.d()}}}function jt(e){let t,n,r,i,o,a,s,l=pt(e[103])+"";function c(){return e[42](e[103])}return{c(){t=g("div"),n=g("div"),r=y(l),i=b(),o=g("button"),o.textContent="Ã—",x(n,"class","text-[10px] text-indigo-800 dark:text-indigo-300"),x(o,"class","text-indigo-600 dark:text-indigo-400 hover:text-indigo-800 dark:hover:text-indigo-200 font-bold"),x(t,"class","flex items-center space-x-1 p-1.5 bg-indigo-50 dark:bg-indigo-900/30 rounded-md border border-indigo-100 dark:border-indigo-800")},m(e,l){h(e,t,l),d(t,n),d(n,r),d(t,i),d(t,o),a||(s=v(o,"click",c),a=!0)},p(t,n){e=t,8&n[0]&&l!==(l=pt(e[103])+"")&&w(r,l)},d(e){e&&f(t),a=!1,s()}}}function Pt(e){let t,n,r,i,o,a,s,l=e[100].creator+"";function c(){return e[43](e[100])}return{c(){t=g("div"),n=g("div"),r=y(l),i=b(),o=g("button"),o.textContent="Ã—",x(n,"class","text-[10px] text-pink-800 dark:text-pink-300"),x(o,"class","text-pink-600 dark:text-pink-400 hover:text-pink-800 dark:hover:text-pink-200 font-bold"),x(t,"class","flex items-center space-x-1 p-1.5 bg-pink-50 dark:bg-pink-900/30 rounded-md border border-pink-100 dark:border-pink-800")},m(e,l){h(e,t,l),d(t,n),d(n,r),d(t,i),d(t,o),a||(s=v(o,"click",c),a=!0)},p(t,n){e=t,8&n[0]&&l!==(l=e[100].creator+"")&&w(r,l)},d(e){e&&f(t),a=!1,s()}}}function Et(e){let t,n,r,i,o,a,s,l=ge(e[97])+"";function c(){return e[44](e[97])}return{c(){t=g("div"),n=g("div"),r=y(l),i=b(),o=g("button"),o.textContent="Ã—",x(n,"class","text-[10px] text-orange-800 dark:text-orange-300"),x(o,"class","text-orange-600 dark:text-orange-400 hover:text-orange-800 dark:hover:text-orange-200 font-bold"),x(t,"class","flex items-center space-x-1 p-1.5 bg-orange-50 dark:bg-orange-900/30 rounded-md border border-orange-100 dark:border-orange-800")},m(e,l){h(e,t,l),d(t,n),d(n,r),d(t,i),d(t,o),a||(s=v(o,"click",c),a=!0)},p(t,n){e=t,8&n[0]&&l!==(l=ge(e[97])+"")&&w(r,l)},d(e){e&&f(t),a=!1,s()}}}function Tt(e){let t,n,r,i,o,a,s,l=e[94]+"";function c(){return e[45](e[94])}return{c(){t=g("div"),n=g("div"),r=y(l),i=b(),o=g("button"),o.textContent="Ã—",x(n,"class","text-[10px] text-blue-800 dark:text-blue-300"),x(o,"class","text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 font-bold"),x(t,"class","flex items-center space-x-1 p-1.5 bg-blue-50 dark:bg-blue-900/30 rounded-md border border-blue-100 dark:border-blue-800")},m(e,l){h(e,t,l),d(t,n),d(n,r),d(t,i),d(t,o),a||(s=v(o,"click",c),a=!0)},p(t,n){e=t,8&n[0]&&l!==(l=e[94]+"")&&w(r,l)},d(e){e&&f(t),a=!1,s()}}}function Mt(e){let t,n,r,i,o,a,s,l=e[91]+"";function c(){return e[46](e[91])}return{c(){t=g("div"),n=g("div"),r=y(l),i=b(),o=g("button"),o.textContent="Ã—",x(n,"class","text-[10px] text-green-800 dark:text-green-300"),x(o,"class","text-green-600 dark:text-green-400 hover:text-green-800 dark:hover:text-green-200 font-bold"),x(t,"class","flex items-center space-x-1 p-1.5 bg-green-50 dark:bg-green-900/30 rounded-md border border-green-100 dark:border-green-800")},m(e,l){h(e,t,l),d(t,n),d(n,r),d(t,i),d(t,o),a||(s=v(o,"click",c),a=!0)},p(t,n){e=t,8&n[0]&&l!==(l=e[91]+"")&&w(r,l)},d(e){e&&f(t),a=!1,s()}}}function Ot(e){let t,n,r,i,o,a,s,l="week"===e[3].dateRange.period?"This Week":"twoWeek"===e[3].dateRange.period?"This 2-Week":"month"===e[3].dateRange.period?"This Month":"threeMonth"===e[3].dateRange.period?"This 3-Month":"sixMonth"===e[3].dateRange.period?"This 6-Month":"year"===e[3].dateRange.period?"This Year":"Older";return{c(){t=g("div"),n=g("div"),r=y(l),i=b(),o=g("button"),o.textContent="Ã—",x(n,"class","text-[10px] text-purple-800 dark:text-purple-300"),x(o,"class","text-purple-600 dark:text-purple-400 hover:text-purple-800 dark:hover:text-purple-200 font-bold"),x(t,"class","flex items-center space-x-1 p-1.5 bg-purple-50 dark:bg-purple-900/30 rounded-md border border-purple-100 dark:border-purple-800")},m(l,c){h(l,t,c),d(t,n),d(n,r),d(t,i),d(t,o),a||(s=v(o,"click",e[47]),a=!0)},p(e,t){8&t[0]&&l!==(l="week"===e[3].dateRange.period?"This Week":"twoWeek"===e[3].dateRange.period?"This 2-Week":"month"===e[3].dateRange.period?"This Month":"threeMonth"===e[3].dateRange.period?"This 3-Month":"sixMonth"===e[3].dateRange.period?"This 6-Month":"year"===e[3].dateRange.period?"This Year":"Older")&&w(r,l)},d(e){e&&f(t),a=!1,s()}}}function Dt(e){let t,n,r,i=e[15].length+"";return{c(){t=y("ðŸŒ Domains ("),n=y(i),r=y(")")},m(e,i){h(e,t,i),h(e,n,i),h(e,r,i)},p(e,t){32768&t[0]&&i!==(i=e[15].length+"")&&w(n,i)},d(e){e&&(f(t),f(n),f(r))}}}function Bt(e){let t,n,r,i,o=e[15].length+"";return{c(){t=g("span"),n=y("Matching Domains ("),r=y(o),i=y(")"),x(t,"class","text-blue-600 dark:text-blue-400")},m(e,o){h(e,t,o),d(t,n),d(t,r),d(t,i)},p(e,t){32768&t[0]&&o!==(o=e[15].length+"")&&w(r,o)},d(e){e&&f(t)}}}function It(e){let t,n,r,i=!e[0]&&Rt(e),o=H(e[15].slice(0,e[4])),a=[];for(let t=0;t<o.length;t+=1)a[t]=$t(vt(e,o,t));let s=e[15].length>e[4]&&Kt(e);return{c(){i&&i.c(),t=b(),n=g("div");for(let e=0;e<a.length;e+=1)a[e].c();r=b(),s&&s.c(),x(n,"class","flex gap-2 overflow-x-auto pb-2"),_(n,"max-height","200px"),_(n,"flex-wrap","wrap")},m(e,o){i&&i.m(e,o),h(e,t,o),h(e,n,o);for(let e=0;e<a.length;e+=1)a[e]&&a[e].m(n,null);d(n,r),s&&s.m(n,null)},p(e,l){if(e[0]?i&&(i.d(1),i=null):i?i.p(e,l):(i=Rt(e),i.c(),i.m(t.parentNode,t)),12615696&l[0]){let t;for(o=H(e[15].slice(0,e[4])),t=0;t<o.length;t+=1){const i=vt(e,o,t);a[t]?a[t].p(i,l):(a[t]=$t(i),a[t].c(),a[t].m(n,r))}for(;t<a.length;t+=1)a[t].d(1);a.length=o.length}e[15].length>e[4]?s?s.p(e,l):(s=Kt(e),s.c(),s.m(n,null)):s&&(s.d(1),s=null)},d(e){e&&(f(t),f(n)),i&&i.d(e),p(a,e),s&&s.d()}}}function Rt(e){let t,n,i,o,a,s,l,c,u,p;return{c(){t=g("div"),n=g("button"),i=y("Recent"),a=b(),s=g("button"),l=y("Count"),x(n,"class",o="text-[10px] px-1.5 py-0.5 rounded transition-colors "+("recency"===e[1]?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300":"text-gray-500 dark:text-gray-400")),x(n,"title","Sort by most recent bookmark"),x(s,"class",c="text-[10px] px-1.5 py-0.5 rounded transition-colors "+("count"===e[1]?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300":"text-gray-500 dark:text-gray-400")),x(s,"title","Sort by bookmark count"),x(t,"class","flex space-x-1 mb-2")},m(r,o){h(r,t,o),d(t,n),d(n,i),d(t,a),d(t,s),d(s,l),u||(p=[v(n,"click",e[49]),v(s,"click",e[50])],u=!0)},p(e,t){2&t[0]&&o!==(o="text-[10px] px-1.5 py-0.5 rounded transition-colors "+("recency"===e[1]?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300":"text-gray-500 dark:text-gray-400"))&&x(n,"class",o),2&t[0]&&c!==(c="text-[10px] px-1.5 py-0.5 rounded transition-colors "+("count"===e[1]?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300":"text-gray-500 dark:text-gray-400"))&&x(s,"class",c)},d(e){e&&f(t),u=!1,r(p)}}}function $t(e){let t,n,r,i,o,a,s,l,c,u,p=e[88].domain+"",m=e[88].count+"";function k(){return e[51](e[88])}return{c(){t=g("button"),n=g("span"),r=y(p),i=b(),o=g("span"),a=y(m),x(n,"class","font-medium"),x(o,"class","text-[10px] text-gray-400 dark:text-gray-500"),x(t,"class",s="flex-shrink-0 px-2 py-1 text-[11px] hover:bg-gray-100 dark:hover:bg-gray-700 rounded border transition-colors flex items-center gap-1.5 "+(e[22]("domains",e[88].domain)?"bg-blue-50 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-800":"text-gray-600 dark:text-gray-400 border-transparent dark:border-transparent")),x(t,"title",l=e[88].domain)},m(e,s){h(e,t,s),d(t,n),d(n,r),d(t,i),d(t,o),d(o,a),c||(u=v(t,"click",k),c=!0)},p(n,i){e=n,32784&i[0]&&p!==(p=e[88].domain+"")&&w(r,p),32784&i[0]&&m!==(m=e[88].count+"")&&w(a,m),32784&i[0]&&s!==(s="flex-shrink-0 px-2 py-1 text-[11px] hover:bg-gray-100 dark:hover:bg-gray-700 rounded border transition-colors flex items-center gap-1.5 "+(e[22]("domains",e[88].domain)?"bg-blue-50 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300 border-blue-200 dark:border-blue-800":"text-gray-600 dark:text-gray-400 border-transparent dark:border-transparent"))&&x(t,"class",s),32784&i[0]&&l!==(l=e[88].domain)&&x(t,"title",l)},d(e){e&&f(t),c=!1,u()}}}function Kt(t){let n,r,i;return{c(){n=g("button"),n.textContent="Load More",x(n,"class","w-full text-center px-2 py-1.5 text-xs text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/40 rounded border border-blue-200 dark:border-blue-800 mt-2")},m(e,o){h(e,n,o),r||(i=v(n,"click",t[16]),r=!0)},p:e,d(e){e&&f(n),r=!1,i()}}}function qt(e){let t,n,r,i=e[14].length+"";return{c(){t=y("ðŸ“ Folders ("),n=y(i),r=y(")")},m(e,i){h(e,t,i),h(e,n,i),h(e,r,i)},p(e,t){16384&t[0]&&i!==(i=e[14].length+"")&&w(n,i)},d(e){e&&(f(t),f(n),f(r))}}}function Lt(e){let t,n,r,i,o=e[14].length+"";return{c(){t=g("span"),n=y("Matching Folders ("),r=y(o),i=y(")"),x(t,"class","text-blue-600 dark:text-blue-400")},m(e,o){h(e,t,o),d(t,n),d(t,r),d(t,i)},p(e,t){16384&t[0]&&o!==(o=e[14].length+"")&&w(r,o)},d(e){e&&f(t)}}}function Ft(e){let t,n,r=H(e[14].slice(0,e[5])),i=[];for(let t=0;t<r.length;t+=1)i[t]=zt(bt(e,r,t));let o=e[14].length>e[5]&&Nt(e);return{c(){t=g("div");for(let e=0;e<i.length;e+=1)i[e].c();n=b(),o&&o.c(),x(t,"class","flex gap-2 overflow-x-auto pb-2"),_(t,"max-height","200px"),_(t,"flex-wrap","wrap")},m(e,r){h(e,t,r);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);d(t,n),o&&o.m(t,null)},p(e,a){if(20987936&a[0]){let o;for(r=H(e[14].slice(0,e[5])),o=0;o<r.length;o+=1){const s=bt(e,r,o);i[o]?i[o].p(s,a):(i[o]=zt(s),i[o].c(),i[o].m(t,n))}for(;o<i.length;o+=1)i[o].d(1);i.length=r.length}e[14].length>e[5]?o?o.p(e,a):(o=Nt(e),o.c(),o.m(t,null)):o&&(o.d(1),o=null)},d(e){e&&f(t),p(i,e),o&&o.d()}}}function zt(e){let t,n,r,i,o,a,s,l,c,u,p,m=e[85].folder.toLowerCase().replace("bookmarks","")+"",k=e[85].count+"";function _(){return e[53](e[85])}return{c(){t=g("button"),n=g("span"),r=y("ðŸ“ "),i=y(m),o=b(),a=g("span"),s=y(k),x(n,"class","font-medium"),x(a,"class","text-[10px] text-gray-400 dark:text-gray-500"),x(t,"class",l="flex-shrink-0 px-2 py-1 text-[11px] hover:bg-gray-100 dark:hover:bg-gray-700 rounded border transition-colors flex items-center gap-1.5 "+(e[22]("folders",e[85].folder)?"bg-green-50 dark:bg-green-900/40 text-green-700 dark:text-green-300 border-green-200 dark:border-green-800":"text-gray-600 dark:text-gray-400 border-transparent dark:border-transparent")),x(t,"title",c=e[85].folder)},m(e,l){h(e,t,l),d(t,n),d(n,r),d(n,i),d(t,o),d(t,a),d(a,s),u||(p=v(t,"click",_),u=!0)},p(n,r){e=n,16416&r[0]&&m!==(m=e[85].folder.toLowerCase().replace("bookmarks","")+"")&&w(i,m),16416&r[0]&&k!==(k=e[85].count+"")&&w(s,k),16416&r[0]&&l!==(l="flex-shrink-0 px-2 py-1 text-[11px] hover:bg-gray-100 dark:hover:bg-gray-700 rounded border transition-colors flex items-center gap-1.5 "+(e[22]("folders",e[85].folder)?"bg-green-50 dark:bg-green-900/40 text-green-700 dark:text-green-300 border-green-200 dark:border-green-800":"text-gray-600 dark:text-gray-400 border-transparent dark:border-transparent"))&&x(t,"class",l),16416&r[0]&&c!==(c=e[85].folder)&&x(t,"title",c)},d(e){e&&f(t),u=!1,p()}}}function Nt(t){let n,r,i;return{c(){n=g("button"),n.textContent="Load More",x(n,"class","w-full text-center px-2 py-1.5 text-xs text-green-600 dark:text-green-400 hover:bg-green-50 dark:hover:bg-green-900/40 rounded border border-green-200 dark:border-green-800 mt-2")},m(e,o){h(e,n,o),r||(i=v(n,"click",t[17]),r=!0)},p:e,d(e){e&&f(n),r=!1,i()}}}function Wt(e){let t,n,r,i,o,a,s,l,c,u,p,m,k=e[13].length+"",_=e[9].topics?"â–¼":"â–¶",A=e[9].topics&&Ut(e);return{c(){t=g("div"),n=g("button"),r=g("span"),i=y("ðŸ·ï¸ Topics ("),o=y(k),a=y(")"),s=b(),l=g("span"),c=y(_),u=b(),A&&A.c(),x(l,"class","text-gray-400 dark:text-gray-500"),x(n,"class","w-full flex items-center justify-between text-xs font-medium text-gray-700 dark:text-gray-400 uppercase tracking-wide mb-2 hover:text-gray-900 dark:hover:text-gray-200"),x(t,"class","mb-0")},m(f,g){h(f,t,g),d(t,n),d(n,r),d(r,i),d(r,o),d(r,a),d(n,s),d(n,l),d(l,c),d(t,u),A&&A.m(t,null),p||(m=v(n,"click",e[54]),p=!0)},p(e,n){8192&n[0]&&k!==(k=e[13].length+"")&&w(o,k),512&n[0]&&_!==(_=e[9].topics?"â–¼":"â–¶")&&w(c,_),e[9].topics?A?A.p(e,n):(A=Ut(e),A.c(),A.m(t,null)):A&&(A.d(1),A=null)},d(e){e&&f(t),A&&A.d(),p=!1,m()}}}function Ut(e){let t,n,r=H(e[13].slice(0,e[8])),i=[];for(let t=0;t<r.length;t+=1)i[t]=Ht(yt(e,r,t));let o=e[13].length>e[8]&&Vt(e);return{c(){t=g("div");for(let e=0;e<i.length;e+=1)i[e].c();n=b(),o&&o.c(),x(t,"class","flex gap-2 overflow-x-auto pb-2"),_(t,"max-height","200px"),_(t,"flex-wrap","wrap")},m(e,r){h(e,t,r);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);d(t,n),o&&o.m(t,null)},p(e,a){if(37757184&a[0]){let o;for(r=H(e[13].slice(0,e[8])),o=0;o<r.length;o+=1){const s=yt(e,r,o);i[o]?i[o].p(s,a):(i[o]=Ht(s),i[o].c(),i[o].m(t,n))}for(;o<i.length;o+=1)i[o].d(1);i.length=r.length}e[13].length>e[8]?o?o.p(e,a):(o=Vt(e),o.c(),o.m(t,null)):o&&(o.d(1),o=null)},d(e){e&&f(t),p(i,e),o&&o.d()}}}function Ht(e){let t,n,r,i,o,a,s,l,c,u=pt(e[82].topic)+"",p=e[82].count+"";function m(){return e[55](e[82])}return{c(){t=g("button"),n=g("span"),r=y(u),i=b(),o=g("span"),a=y(p),x(n,"class","font-medium"),x(o,"class","text-[10px] text-gray-400 dark:text-gray-500"),x(t,"class",s="flex-shrink-0 px-2 py-1 text-[11px] hover:bg-gray-100 dark:hover:bg-gray-700 rounded border transition-colors flex items-center gap-1.5 "+(e[22]("topics",e[82].topic)?"bg-indigo-50 dark:bg-indigo-900/40 text-indigo-700 dark:text-indigo-300 border-indigo-200 dark:border-indigo-800":"text-gray-600 dark:text-gray-400 border-transparent dark:border-transparent"))},m(e,s){h(e,t,s),d(t,n),d(n,r),d(t,i),d(t,o),d(o,a),l||(c=v(t,"click",m),l=!0)},p(n,i){e=n,8448&i[0]&&u!==(u=pt(e[82].topic)+"")&&w(r,u),8448&i[0]&&p!==(p=e[82].count+"")&&w(a,p),8448&i[0]&&s!==(s="flex-shrink-0 px-2 py-1 text-[11px] hover:bg-gray-100 dark:hover:bg-gray-700 rounded border transition-colors flex items-center gap-1.5 "+(e[22]("topics",e[82].topic)?"bg-indigo-50 dark:bg-indigo-900/40 text-indigo-700 dark:text-indigo-300 border-indigo-200 dark:border-indigo-800":"text-gray-600 dark:text-gray-400 border-transparent dark:border-transparent"))&&x(t,"class",s)},d(e){e&&f(t),l=!1,c()}}}function Vt(t){let n,r,i;return{c(){n=g("button"),n.textContent="Show more",x(n,"class","w-full text-center px-2 py-1.5 text-xs text-indigo-600 dark:text-indigo-400 hover:bg-indigo-50 dark:hover:bg-indigo-900/40 rounded border border-indigo-200 dark:border-indigo-800 mt-2")},m(e,o){h(e,n,o),r||(i=v(n,"click",t[20]),r=!0)},p:e,d(e){e&&f(n),r=!1,i()}}}function Qt(e){let t,n,r,i,o,a,s,l,c,u,p,m,k=e[12].length+"",_=e[9].creators?"â–¼":"â–¶",A=e[9].creators&&Yt(e);return{c(){t=g("div"),n=g("button"),r=g("span"),i=y("ðŸ‘¤ Top Creators ("),o=y(k),a=y(")"),s=b(),l=g("span"),c=y(_),u=b(),A&&A.c(),x(l,"class","text-gray-400 dark:text-gray-500"),x(n,"class","w-full flex items-center justify-between text-xs font-medium text-gray-700 dark:text-gray-400 uppercase tracking-wide mb-2 hover:text-gray-900 dark:hover:text-gray-200"),x(t,"class","mb-0")},m(f,g){h(f,t,g),d(t,n),d(n,r),d(r,i),d(r,o),d(r,a),d(n,s),d(n,l),d(l,c),d(t,u),A&&A.m(t,null),p||(m=v(n,"click",e[56]),p=!0)},p(e,n){4096&n[0]&&k!==(k=e[12].length+"")&&w(o,k),512&n[0]&&_!==(_=e[9].creators?"â–¼":"â–¶")&&w(c,_),e[9].creators?A?A.p(e,n):(A=Yt(e),A.c(),A.m(t,null)):A&&(A.d(1),A=null)},d(e){e&&f(t),A&&A.d(),p=!1,m()}}}function Yt(e){let t,n,r=H(e[12].slice(0,e[6])),i=[];for(let t=0;t<r.length;t+=1)i[t]=Gt(mt(e,r,t));let o=e[12].length>e[6]&&Jt(e);return{c(){t=g("div");for(let e=0;e<i.length;e+=1)i[e].c();n=b(),o&&o.c(),x(t,"class","flex gap-2 overflow-x-auto pb-2"),_(t,"max-height","200px"),_(t,"flex-wrap","wrap")},m(e,r){h(e,t,r);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);d(t,n),o&&o.m(t,null)},p(e,a){if(71307328&a[0]){let o;for(r=H(e[12].slice(0,e[6])),o=0;o<r.length;o+=1){const s=mt(e,r,o);i[o]?i[o].p(s,a):(i[o]=Gt(s),i[o].c(),i[o].m(t,n))}for(;o<i.length;o+=1)i[o].d(1);i.length=r.length}e[12].length>e[6]?o?o.p(e,a):(o=Jt(e),o.c(),o.m(t,null)):o&&(o.d(1),o=null)},d(e){e&&f(t),p(i,e),o&&o.d()}}}function Gt(e){let t,n,r,i,o,a,s,l,c,u,p=e[78].creator+"",m=e[78].count+"";function k(){return e[57](e[78])}return{c(){t=g("button"),n=g("span"),r=y("ðŸ‘¤ "),i=y(p),o=b(),a=g("span"),s=y(m),x(n,"class","font-medium"),x(a,"class","text-[10px] text-gray-400 dark:text-gray-500"),x(t,"class",l="flex-shrink-0 px-2 py-1 text-[11px] hover:bg-gray-100 dark:hover:bg-gray-700 rounded border transition-colors flex items-center gap-1.5 "+(e[79]?"bg-pink-50 dark:bg-pink-900/40 text-pink-700 dark:text-pink-300 border-pink-200 dark:border-pink-800":"text-gray-600 dark:text-gray-400 border-transparent dark:border-transparent"))},m(e,l){h(e,t,l),d(t,n),d(n,r),d(n,i),d(t,o),d(t,a),d(a,s),c||(u=v(t,"click",k),c=!0)},p(n,r){e=n,4160&r[0]&&p!==(p=e[78].creator+"")&&w(i,p),4160&r[0]&&m!==(m=e[78].count+"")&&w(s,m),4160&r[0]&&l!==(l="flex-shrink-0 px-2 py-1 text-[11px] hover:bg-gray-100 dark:hover:bg-gray-700 rounded border transition-colors flex items-center gap-1.5 "+(e[79]?"bg-pink-50 dark:bg-pink-900/40 text-pink-700 dark:text-pink-300 border-pink-200 dark:border-pink-800":"text-gray-600 dark:text-gray-400 border-transparent dark:border-transparent"))&&x(t,"class",l)},d(e){e&&f(t),c=!1,u()}}}function Jt(t){let n,r,i;return{c(){n=g("button"),n.textContent="Show more",x(n,"class","w-full text-center px-2 py-1 text-xs text-pink-600 dark:text-pink-400 hover:bg-pink-50 dark:hover:bg-pink-900/40 rounded border border-pink-200 dark:border-pink-800 mt-2")},m(e,o){h(e,n,o),r||(i=v(n,"click",t[18]),r=!0)},p:e,d(e){e&&f(n),r=!1,i()}}}function Xt(e){let t,n,r,i,o,a,s,l,c,u,p,m,k=e[11].length+"",_=e[9].contentTypes?"â–¼":"â–¶",A=e[9].contentTypes&&Zt(e);return{c(){t=g("div"),n=g("button"),r=g("span"),i=y("ðŸ“ Content Types ("),o=y(k),a=y(")"),s=b(),l=g("span"),c=y(_),u=b(),A&&A.c(),x(l,"class","text-gray-400 dark:text-gray-500"),x(n,"class","w-full flex items-center justify-between text-xs font-medium text-gray-700 dark:text-gray-400 uppercase tracking-wide mb-2 hover:text-gray-900 dark:hover:text-gray-200"),x(t,"class","mb-0")},m(f,g){h(f,t,g),d(t,n),d(n,r),d(r,i),d(r,o),d(r,a),d(n,s),d(n,l),d(l,c),d(t,u),A&&A.m(t,null),p||(m=v(n,"click",e[58]),p=!0)},p(e,n){2048&n[0]&&k!==(k=e[11].length+"")&&w(o,k),512&n[0]&&_!==(_=e[9].contentTypes?"â–¼":"â–¶")&&w(c,_),e[9].contentTypes?A?A.p(e,n):(A=Zt(e),A.c(),A.m(t,null)):A&&(A.d(1),A=null)},d(e){e&&f(t),A&&A.d(),p=!1,m()}}}function Zt(e){let t,n,r=H(e[11].slice(0,e[7])),i=[];for(let t=0;t<r.length;t+=1)i[t]=en(gt(e,r,t));let o=e[11].length>e[7]&&tn(e);return{c(){t=g("div");for(let e=0;e<i.length;e+=1)i[e].c();n=b(),o&&o.c(),x(t,"class","flex gap-2 overflow-x-auto pb-2"),_(t,"max-height","200px"),_(t,"flex-wrap","wrap")},m(e,r){h(e,t,r);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);d(t,n),o&&o.m(t,null)},p(e,a){if(138414208&a[0]){let o;for(r=H(e[11].slice(0,e[7])),o=0;o<r.length;o+=1){const s=gt(e,r,o);i[o]?i[o].p(s,a):(i[o]=en(s),i[o].c(),i[o].m(t,n))}for(;o<i.length;o+=1)i[o].d(1);i.length=r.length}e[11].length>e[7]?o?o.p(e,a):(o=tn(e),o.c(),o.m(t,null)):o&&(o.d(1),o=null)},d(e){e&&f(t),p(i,e),o&&o.d()}}}function en(e){let t,n,r,i,o,a,s,l,c,u=ge(e[75].type)+"",p=e[75].count+"";function m(){return e[59](e[75])}return{c(){t=g("button"),n=g("span"),r=y(u),i=b(),o=g("span"),a=y(p),x(n,"class","font-medium"),x(o,"class","text-[10px] text-gray-400 dark:text-gray-500"),x(t,"class",s="flex-shrink-0 px-2 py-1 text-[11px] hover:bg-gray-100 dark:hover:bg-gray-700 rounded border transition-colors flex items-center gap-1.5 "+(e[22]("types",e[75].type)?"bg-orange-50 dark:bg-orange-900/40 text-orange-700 dark:text-orange-300 border-orange-200 dark:border-orange-800":"text-gray-600 dark:text-gray-400 border-transparent dark:border-transparent"))},m(e,s){h(e,t,s),d(t,n),d(n,r),d(t,i),d(t,o),d(o,a),l||(c=v(t,"click",m),l=!0)},p(n,i){e=n,2176&i[0]&&u!==(u=ge(e[75].type)+"")&&w(r,u),2176&i[0]&&p!==(p=e[75].count+"")&&w(a,p),2176&i[0]&&s!==(s="flex-shrink-0 px-2 py-1 text-[11px] hover:bg-gray-100 dark:hover:bg-gray-700 rounded border transition-colors flex items-center gap-1.5 "+(e[22]("types",e[75].type)?"bg-orange-50 dark:bg-orange-900/40 text-orange-700 dark:text-orange-300 border-orange-200 dark:border-orange-800":"text-gray-600 dark:text-gray-400 border-transparent dark:border-transparent"))&&x(t,"class",s)},d(e){e&&f(t),l=!1,c()}}}function tn(t){let n,r,i;return{c(){n=g("button"),n.textContent="Show more",x(n,"class","w-full text-center px-2 py-1.5 text-xs text-orange-600 dark:text-orange-400 hover:bg-orange-50 dark:hover:bg-orange-900/40 rounded border border-orange-200 dark:border-orange-800 mt-2")},m(e,o){h(e,n,o),r||(i=v(n,"click",t[19]),r=!0)},p:e,d(e){e&&f(n),r=!1,i()}}}function nn(t){let n,i,o,a,s,l,c,u,p,m,k,_,A,C,S,j,P,E,T,M,O,D,B,I,R,$,K,q,L,F,z,N,W,U,H,V,Q,Y,G,J,X,Z,ee,te,ne,re,ie,oe,ae,se,le,ce,ue,de,he,fe,pe,ge,me,ye,be,ve,xe,we,ke,_e,Ae,Ce,Se,je,Pe,Ee,Te,Me,Oe,De,Be,Ie,Re,$e,Ke,qe=t[9].domains?"â–¼":"â–¶",Le=t[9].folders?"â–¼":"â–¶",Fe=t[10].week+"",ze=t[10].twoWeek+"",Ne=t[10].month+"",We=t[10].threeMonth+"",Ue=t[10].sixMonth+"",He=t[10].year+"",Ve=t[10].older+"",Qe=t[2]&&Ct(t),Ye=t[2]&&St(t);function Ge(e,t){return e[0]?Bt:Dt}let Je=Ge(t),Xe=Je(t),Ze=t[9].domains&&It(t);function et(e,t){return e[0]?Lt:qt}let tt=et(t),nt=tt(t),rt=t[9].folders&&Ft(t),it=t[13].length>0&&Wt(t),ot=t[12].length>0&&Qt(t),at=t[11].length>0&&Xt(t);return{c(){n=g("div"),i=g("div"),o=g("div"),a=g("h3"),a.textContent="Filters",s=b(),Qe&&Qe.c(),l=b(),Ye&&Ye.c(),c=b(),u=g("div"),p=g("div"),m=g("button"),k=g("span"),Xe.c(),_=b(),A=g("span"),C=y(qe),S=b(),Ze&&Ze.c(),j=b(),P=g("div"),E=g("button"),T=g("span"),nt.c(),M=b(),O=g("span"),D=y(Le),B=b(),rt&&rt.c(),I=b(),it&&it.c(),R=b(),ot&&ot.c(),$=b(),at&&at.c(),K=b(),q=g("div"),L=g("h4"),L.textContent="Date Added",F=b(),z=g("div"),N=g("button"),W=g("span"),W.textContent="This Week",U=b(),H=g("span"),V=y(Fe),Y=b(),G=g("button"),J=g("span"),J.textContent="This 2-Week",X=b(),Z=g("span"),ee=y(ze),ne=b(),re=g("button"),ie=g("span"),ie.textContent="This Month",oe=b(),ae=g("span"),se=y(Ne),ce=b(),ue=g("button"),de=g("span"),de.textContent="This 3-Month",he=b(),fe=g("span"),pe=y(We),me=b(),ye=g("button"),be=g("span"),be.textContent="This 6-Month",ve=b(),xe=g("span"),we=y(Ue),_e=b(),Ae=g("button"),Ce=g("span"),Ce.textContent="This Year",Se=b(),je=g("span"),Pe=y(He),Te=b(),Me=g("button"),Oe=g("span"),Oe.textContent="Older",De=b(),Be=g("span"),Ie=y(Ve),x(a,"class","text-sm font-medium text-gray-900 dark:text-gray-100"),x(o,"class","flex items-center justify-between mb-3"),x(i,"class","mb-6"),x(A,"class","text-gray-400 dark:text-gray-500"),x(m,"class","w-full flex items-center justify-between text-xs font-medium text-gray-700 dark:text-gray-300 uppercase tracking-wide mb-2 hover:text-gray-900 dark:hover:text-white"),x(p,"class","mb-0"),x(O,"class","text-gray-400 dark:text-gray-500"),x(E,"class","w-full flex items-center justify-between text-xs font-medium text-gray-700 dark:text-gray-400 uppercase tracking-wide mb-2 hover:text-gray-900 dark:hover:text-gray-200 transition-colors"),x(P,"class","mb-0"),x(L,"class","text-xs font-medium text-gray-700 dark:text-gray-400 uppercase tracking-wide mb-2"),x(W,"class","text-xs"),x(H,"class","text-[10px] text-gray-400 dark:text-gray-500"),x(N,"class",Q="w-full text-left px-2 py-1 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded flex items-center justify-between "+("week"===t[3].dateRange?.period?"bg-blue-50 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300":"")),x(J,"class","text-xs"),x(Z,"class","text-[10px] text-gray-400 dark:text-gray-500"),x(G,"class",te="w-full text-left px-2 py-1 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded flex items-center justify-between "+("twoWeek"===t[3].dateRange?.period?"bg-blue-50 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300":"")),x(ie,"class","text-xs"),x(ae,"class","text-[10px] text-gray-400 dark:text-gray-500"),x(re,"class",le="w-full text-left px-2 py-1 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded flex items-center justify-between "+("month"===t[3].dateRange?.period?"bg-blue-50 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300":"")),x(de,"class","text-xs"),x(fe,"class","text-[10px] text-gray-400 dark:text-gray-500"),x(ue,"class",ge="w-full text-left px-2 py-1 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded flex items-center justify-between "+("threeMonth"===t[3].dateRange?.period?"bg-blue-50 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300":"")),x(be,"class","text-xs"),x(xe,"class","text-[10px] text-gray-400 dark:text-gray-500"),x(ye,"class",ke="w-full text-left px-2 py-1 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded flex items-center justify-between "+("sixMonth"===t[3].dateRange?.period?"bg-blue-50 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300":"")),x(Ce,"class","text-xs"),x(je,"class","text-[10px] text-gray-400 dark:text-gray-500"),x(Ae,"class",Ee="w-full text-left px-2 py-1 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded flex items-center justify-between "+("year"===t[3].dateRange?.period?"bg-blue-50 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300":"")),x(Oe,"class","text-xs"),x(Be,"class","text-[10px] text-gray-400 dark:text-gray-500"),x(Me,"class",Re="w-full text-left px-2 py-1 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded flex items-center justify-between "+("older"===t[3].dateRange?.period?"bg-blue-50 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300":"")),x(z,"class","grid grid-cols-1 gap-1"),x(q,"class","mb-0"),x(u,"class","grid grid-cols-2 gap-x-6 gap-y-6"),x(n,"class","w-[24rem] bg-gray-50 dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 p-4 overflow-y-auto flex-shrink-0")},m(e,r){h(e,n,r),d(n,i),d(i,o),d(o,a),d(o,s),Qe&&Qe.m(o,null),d(i,l),Ye&&Ye.m(i,null),d(n,c),d(n,u),d(u,p),d(p,m),d(m,k),Xe.m(k,null),d(m,_),d(m,A),d(A,C),d(p,S),Ze&&Ze.m(p,null),d(u,j),d(u,P),d(P,E),d(E,T),nt.m(T,null),d(E,M),d(E,O),d(O,D),d(P,B),rt&&rt.m(P,null),d(u,I),it&&it.m(u,null),d(u,R),ot&&ot.m(u,null),d(u,$),at&&at.m(u,null),d(u,K),d(u,q),d(q,L),d(q,F),d(q,z),d(z,N),d(N,W),d(N,U),d(N,H),d(H,V),d(z,Y),d(z,G),d(G,J),d(G,X),d(G,Z),d(Z,ee),d(z,ne),d(z,re),d(re,ie),d(re,oe),d(re,ae),d(ae,se),d(z,ce),d(z,ue),d(ue,de),d(ue,he),d(ue,fe),d(fe,pe),d(z,me),d(z,ye),d(ye,be),d(ye,ve),d(ye,xe),d(xe,we),d(z,_e),d(z,Ae),d(Ae,Ce),d(Ae,Se),d(Ae,je),d(je,Pe),d(z,Te),d(z,Me),d(Me,Oe),d(Me,De),d(Me,Be),d(Be,Ie),$e||(Ke=[v(m,"click",t[48]),v(E,"click",t[52]),v(N,"click",t[60]),v(G,"click",t[61]),v(re,"click",t[62]),v(ue,"click",t[63]),v(ye,"click",t[64]),v(Ae,"click",t[65]),v(Me,"click",t[66])],$e=!0)},p(e,t){e[2]?Qe?Qe.p(e,t):(Qe=Ct(e),Qe.c(),Qe.m(o,null)):Qe&&(Qe.d(1),Qe=null),e[2]?Ye?Ye.p(e,t):(Ye=St(e),Ye.c(),Ye.m(i,null)):Ye&&(Ye.d(1),Ye=null),Je===(Je=Ge(e))&&Xe?Xe.p(e,t):(Xe.d(1),Xe=Je(e),Xe&&(Xe.c(),Xe.m(k,null))),512&t[0]&&qe!==(qe=e[9].domains?"â–¼":"â–¶")&&w(C,qe),e[9].domains?Ze?Ze.p(e,t):(Ze=It(e),Ze.c(),Ze.m(p,null)):Ze&&(Ze.d(1),Ze=null),tt===(tt=et(e))&&nt?nt.p(e,t):(nt.d(1),nt=tt(e),nt&&(nt.c(),nt.m(T,null))),512&t[0]&&Le!==(Le=e[9].folders?"â–¼":"â–¶")&&w(D,Le),e[9].folders?rt?rt.p(e,t):(rt=Ft(e),rt.c(),rt.m(P,null)):rt&&(rt.d(1),rt=null),e[13].length>0?it?it.p(e,t):(it=Wt(e),it.c(),it.m(u,R)):it&&(it.d(1),it=null),e[12].length>0?ot?ot.p(e,t):(ot=Qt(e),ot.c(),ot.m(u,$)):ot&&(ot.d(1),ot=null),e[11].length>0?at?at.p(e,t):(at=Xt(e),at.c(),at.m(u,K)):at&&(at.d(1),at=null),1024&t[0]&&Fe!==(Fe=e[10].week+"")&&w(V,Fe),8&t[0]&&Q!==(Q="w-full text-left px-2 py-1 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded flex items-center justify-between "+("week"===e[3].dateRange?.period?"bg-blue-50 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300":""))&&x(N,"class",Q),1024&t[0]&&ze!==(ze=e[10].twoWeek+"")&&w(ee,ze),8&t[0]&&te!==(te="w-full text-left px-2 py-1 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded flex items-center justify-between "+("twoWeek"===e[3].dateRange?.period?"bg-blue-50 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300":""))&&x(G,"class",te),1024&t[0]&&Ne!==(Ne=e[10].month+"")&&w(se,Ne),8&t[0]&&le!==(le="w-full text-left px-2 py-1 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded flex items-center justify-between "+("month"===e[3].dateRange?.period?"bg-blue-50 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300":""))&&x(re,"class",le),1024&t[0]&&We!==(We=e[10].threeMonth+"")&&w(pe,We),8&t[0]&&ge!==(ge="w-full text-left px-2 py-1 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded flex items-center justify-between "+("threeMonth"===e[3].dateRange?.period?"bg-blue-50 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300":""))&&x(ue,"class",ge),1024&t[0]&&Ue!==(Ue=e[10].sixMonth+"")&&w(we,Ue),8&t[0]&&ke!==(ke="w-full text-left px-2 py-1 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded flex items-center justify-between "+("sixMonth"===e[3].dateRange?.period?"bg-blue-50 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300":""))&&x(ye,"class",ke),1024&t[0]&&He!==(He=e[10].year+"")&&w(Pe,He),8&t[0]&&Ee!==(Ee="w-full text-left px-2 py-1 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded flex items-center justify-between "+("year"===e[3].dateRange?.period?"bg-blue-50 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300":""))&&x(Ae,"class",Ee),1024&t[0]&&Ve!==(Ve=e[10].older+"")&&w(Ie,Ve),8&t[0]&&Re!==(Re="w-full text-left px-2 py-1 text-sm text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 rounded flex items-center justify-between "+("older"===e[3].dateRange?.period?"bg-blue-50 dark:bg-blue-900/40 text-blue-700 dark:text-blue-300":""))&&x(Me,"class",Re)},i:e,o:e,d(e){e&&f(n),Qe&&Qe.d(),Ye&&Ye.d(),Xe.d(),Ze&&Ze.d(),nt.d(),rt&&rt.d(),it&&it.d(),ot&&ot.d(),at&&at.d(),$e=!1,r(Ke)}}}function rn(e,t,n){let r,i,o,a,s,l,c,d,h;u(e,Se,e=>n(3,h=e));let{searchResultStats:f=null}=t,{isSearchActive:p=!1}=t,g=[],m=[],y=[],b=[],v=[],x=[],w={week:0,twoWeek:0,month:0,threeMonth:0,sixMonth:0,year:0,older:0},k="count",_=40,A=10,C=10,S=10,P=15,E={topics:!0,creators:!0,contentTypes:!0,domains:!0,folders:!0};async function T(){const e=await Ce.getCached(),t=Date.now(),r=864e5,i=7*r,o=14*r,a=90*r,s=180*r,l=new Date,c=l.getFullYear(),u=new Date(c,l.getMonth(),1).getTime(),d=new Date(c,0,1).getTime();let h=0,f=0,p=0,g=0,m=0,y=0,b=0;e.forEach(e=>{const n=e.dateAdded;t-n<i&&h++,t-n<o&&f++,n>=u&&p++,t-n<a&&g++,t-n<s&&m++,n>=d&&y++,n<d&&b++}),n(40,w={week:h,twoWeek:f,month:p,threeMonth:g,sixMonth:m,year:y,older:b})}async function M(){n(34,g=await async function(){return(await ke()).byRecency}()),n(35,m=await async function(){return(await ke()).byCount}())}async function O(){const e=await Ce.getCached(),t={},r={},i={};e.forEach(e=>{const n=e.topics||[];for(const e of n)t[e]=(t[e]||0)+1;if(e.creator){const t=`${e.platform||"other"}:${e.creator}`;r[t]||(r[t]={creator:e.creator,platform:e.platform||"other",count:0}),r[t].count++}e.contentType&&(i[e.contentType]=(i[e.contentType]||0)+1)}),n(37,b=Object.entries(t).map(([e,t])=>({topic:e,count:t})).sort((e,t)=>t.count-e.count)),n(38,v=Object.values(r).sort((e,t)=>t.count-e.count)),n(39,x=Object.entries(i).map(([e,t])=>({type:e,count:t})).sort((e,t)=>t.count-e.count))}function D(e){n(9,E[e]=!E[e],E)}function B(e){Se.toggleFilter("domains",e)}function I(e){Se.toggleFilter("folders",e)}function R(e){Se.toggleFilter("topics",e)}function $(e,t){const n=`${t}:${e}`;Se.toggleFilter("creators",{key:n,creator:e,platform:t})}function K(e){Se.toggleFilter("types",e)}function q(e){if(h.dateRange?.period===e)return void Se.setFilter("dateRange",null);const t=new Date,n=t.getFullYear();let r,i=t.getTime();switch(e){case"week":r=new Date(t.getTime()-6048e5);break;case"twoWeek":r=new Date(t.getTime()-12096e5);break;case"month":r=new Date(n,t.getMonth(),1);break;case"threeMonth":r=new Date(t.getTime()-7776e6);break;case"sixMonth":r=new Date(t.getTime()-15552e6);break;case"year":r=new Date(n,0,1);break;case"older":r=new Date(0),i=new Date(n,0,1).getTime()-1}!function(e,t,n){Se.setFilter("dateRange",{startDate:e,endDate:t,period:n})}(r.getTime(),i,e)}j(async()=>{try{await M(),await O(),await T(),n(36,y=await _e())}catch(e){console.error("Error loading filters:",e)}});return e.$$set=e=>{"searchResultStats"in e&&n(30,f=e.searchResultStats),"isSearchActive"in e&&n(0,p=e.isSearchActive)},e.$$.update=()=>{8&e.$$.dirty[0]&&n(2,r=h.domains.length>0||h.folders.length>0||h.topics.length>0||h.creators.length>0||h.types.length>0||h.tags&&h.tags.length>0||h.deadLinks||h.stale||null!==h.dateRange||null!==h.readingTimeRange||null!==h.qualityScoreRange||null!==h.hasPublishedDate),1073741829&e.$$.dirty[0]&&n(41,i=(p||r)&&null!=f),1073741826&e.$$.dirty[0]|1048&e.$$.dirty[1]&&n(15,o=i&&f?.domains?f.domains:"recency"===k?g:m),1073741824&e.$$.dirty[0]|1056&e.$$.dirty[1]&&n(14,a=i&&f?.folders?f.folders:y),1073741824&e.$$.dirty[0]|1088&e.$$.dirty[1]&&n(13,s=i&&f?.topics?f.topics:b),1073741824&e.$$.dirty[0]|1152&e.$$.dirty[1]&&n(12,l=i&&f?.creators?f.creators:v),1073741824&e.$$.dirty[0]|1280&e.$$.dirty[1]&&n(11,c=i&&f?.contentTypes?f.contentTypes:x),1073741824&e.$$.dirty[0]|1536&e.$$.dirty[1]&&n(10,d=i&&f?.dateCounts?f.dateCounts:w)},[p,k,r,h,_,A,C,S,P,E,d,c,l,s,a,o,function(){n(4,_+=30)},function(){n(5,A+=15)},function(){n(6,C+=10)},function(){n(7,S+=10)},function(){n(8,P+=10)},D,function(e,t){return void 0!==h[e]&&(Array.isArray(h[e])?"creators"===e?h[e].some(e=>e.key===t):h[e].some(e=>String(e).toLowerCase()===String(t).toLowerCase()):h[e]===t)},B,I,R,$,K,function(){Se.clearFilters()},q,f,function(){return r},function(){Se.clearFilters()},async function(){try{await M(),await O(),await T(),n(36,y=await _e())}catch(e){console.error("Error refreshing sidebar:",e)}},g,m,y,b,v,x,w,i,e=>R(e),e=>$(e.creator,e.platform),e=>K(e),e=>B(e),e=>I(e),()=>{Se.setFilter("dateRange",null)},()=>D("domains"),()=>n(1,k="recency"),()=>n(1,k="count"),e=>B(e.domain),()=>D("folders"),e=>I(e.folder),()=>D("topics"),e=>R(e.topic),()=>D("creators"),e=>$(e.creator,e.platform),()=>D("contentTypes"),e=>K(e.type),()=>q("week"),()=>q("twoWeek"),()=>q("month"),()=>q("threeMonth"),()=>q("sixMonth"),()=>q("year"),()=>q("older")]}class on extends Z{constructor(e){super(),X(this,e,rn,nn,o,{searchResultStats:30,isSearchActive:0,getHasActiveFilters:31,clearAllFilters:32,refresh:33},null,[-1,-1,-1,-1])}get getHasActiveFilters(){return this.$$.ctx[31]}get clearAllFilters(){return this.$$.ctx[32]}get refresh(){return this.$$.ctx[33]}}
/**!
 * FlexSearch.js v0.8.212 (Bundle/Module)
 * Author and Copyright: Thomas Wilkerling
 * Licence: Apache-2.0
 * Hosted by Nextapps GmbH
 * https://github.com/nextapps-de/flexsearch
 */var an;function sn(e,t,n){const r=typeof n,i=typeof e;if("undefined"!==r){if("undefined"!==i){if(n){if("function"===i&&r===i)return function(t){return e(n(t))};if((t=e.constructor)===n.constructor){if(t===Array)return n.concat(e);if(t===Map){var o=new Map(n);for(var a of e)o.set(a[0],a[1]);return o}if(t===Set){for(o of(a=new Set(n),e.values()))a.add(o);return a}}}return e}return n}return"undefined"===i?t:e}function ln(e,t){return void 0===e?t:e}function cn(){return Object.create(null)}function un(e){return"string"==typeof e}function dn(e){return"object"==typeof e}function hn(e,t){if(un(t))e=e[t];else for(let n=0;e&&n<t.length;n++)e=e[t[n]];return e}const fn=/[^\p{L}\p{N}]+/u,pn=/(\d{3})/g,gn=/(\D)(\d{3})/g,mn=/(\d{3})(\D)/g,yn=/[\u0300-\u036f]/g;function bn(e={}){if(!this||this.constructor!==bn)return new bn(...arguments);if(arguments.length)for(e=0;e<arguments.length;e++)this.assign(arguments[e]);else this.assign(e)}function vn(e){e.F=null,e.B.clear(),e.D.clear()}function xn(e,t,n){n||(t||"object"!=typeof e?"object"==typeof t&&(n=t,t=0):n=e),n&&(e=n.query||e,t=n.limit||t);let r=""+(t||0);n&&(r+=(n.offset||0)+!!n.context+!!n.suggest+(!1!==n.resolve)+(n.resolution||this.resolution)+(n.boost||0)),e=(""+e).toLowerCase(),this.cache||(this.cache=new wn);let i=this.cache.get(e+r);if(!i){const o=n&&n.cache;o&&(n.cache=!1),i=this.search(e,t,n),o&&(n.cache=o),this.cache.set(e+r,i)}return i}function wn(e){this.limit=e&&!0!==e?e:1e3,this.cache=new Map,this.h=""}(an=bn.prototype).assign=function(e){this.normalize=sn(e.normalize,!0,this.normalize);let t,n=e.include,r=n||e.exclude||e.split;if(r||""===r){if("object"==typeof r&&r.constructor!==RegExp){let e="";t=!n,n||(e+="\\p{Z}"),r.letter&&(e+="\\p{L}"),r.number&&(e+="\\p{N}",t=!!n),r.symbol&&(e+="\\p{S}"),r.punctuation&&(e+="\\p{P}"),r.control&&(e+="\\p{C}"),(r=r.char)&&(e+="object"==typeof r?r.join(""):r);try{this.split=new RegExp("["+(n?"^":"")+e+"]+","u")}catch(e){this.split=/\s+/}}else this.split=r,t=!1===r||"a1a".split(r).length<2;this.numeric=sn(e.numeric,t)}else{try{this.split=sn(this.split,fn)}catch(e){this.split=/\s+/}this.numeric=sn(e.numeric,sn(this.numeric,!0))}if(this.prepare=sn(e.prepare,null,this.prepare),this.finalize=sn(e.finalize,null,this.finalize),r=e.filter,this.filter="function"==typeof r?r:sn(r&&new Set(r),null,this.filter),this.dedupe=sn(e.dedupe,!0,this.dedupe),this.matcher=sn((r=e.matcher)&&new Map(r),null,this.matcher),this.mapper=sn((r=e.mapper)&&new Map(r),null,this.mapper),this.stemmer=sn((r=e.stemmer)&&new Map(r),null,this.stemmer),this.replacer=sn(e.replacer,null,this.replacer),this.minlength=sn(e.minlength,1,this.minlength),this.maxlength=sn(e.maxlength,1024,this.maxlength),this.rtl=sn(e.rtl,!1,this.rtl),(this.cache=r=sn(e.cache,!0,this.cache))&&(this.F=null,this.L="number"==typeof r?r:2e5,this.B=new Map,this.D=new Map,this.I=this.H=128),this.h="",this.J=null,this.A="",this.K=null,this.matcher)for(const e of this.matcher.keys())this.h+=(this.h?"|":"")+e;if(this.stemmer)for(const e of this.stemmer.keys())this.A+=(this.A?"|":"")+e;return this},an.addStemmer=function(e,t){return this.stemmer||(this.stemmer=new Map),this.stemmer.set(e,t),this.A+=(this.A?"|":"")+e,this.K=null,this.cache&&vn(this),this},an.addFilter=function(e){return"function"==typeof e?this.filter=e:(this.filter||(this.filter=new Set),this.filter.add(e)),this.cache&&vn(this),this},an.addMapper=function(e,t){return"object"==typeof e?this.addReplacer(e,t):e.length>1?this.addMatcher(e,t):(this.mapper||(this.mapper=new Map),this.mapper.set(e,t),this.cache&&vn(this),this)},an.addMatcher=function(e,t){return"object"==typeof e?this.addReplacer(e,t):e.length<2&&(this.dedupe||this.mapper)?this.addMapper(e,t):(this.matcher||(this.matcher=new Map),this.matcher.set(e,t),this.h+=(this.h?"|":"")+e,this.J=null,this.cache&&vn(this),this)},an.addReplacer=function(e,t){return"string"==typeof e?this.addMatcher(e,t):(this.replacer||(this.replacer=[]),this.replacer.push(e,t),this.cache&&vn(this),this)},an.encode=function(e,t){if(this.cache&&e.length<=this.H)if(this.F){if(this.B.has(e))return this.B.get(e)}else this.F=setTimeout(vn,50,this);this.normalize&&(e="function"==typeof this.normalize?this.normalize(e):yn?e.normalize("NFKD").replace(yn,"").toLowerCase():e.toLowerCase()),this.prepare&&(e=this.prepare(e)),this.numeric&&e.length>3&&(e=e.replace(gn,"$1 $2").replace(mn,"$1 $2").replace(pn,"$1 "));const n=!(this.dedupe||this.mapper||this.filter||this.matcher||this.stemmer||this.replacer);let r,i,o=[],a=cn(),s=this.split||""===this.split?e.split(this.split):[e];for(let e,c,u=0;u<s.length;u++)if((e=c=s[u])&&!(e.length<this.minlength||e.length>this.maxlength)){if(t){if(a[e])continue;a[e]=1}else{if(r===e)continue;r=e}if(n)o.push(e);else if(!this.filter||("function"==typeof this.filter?this.filter(e):!this.filter.has(e))){if(this.cache&&e.length<=this.I)if(this.F){var l=this.D.get(e);if(l||""===l){l&&o.push(l);continue}}else this.F=setTimeout(vn,50,this);if(this.stemmer){let t;for(this.K||(this.K=new RegExp("(?!^)("+this.A+")$"));t!==e&&e.length>2;)t=e,e=e.replace(this.K,e=>this.stemmer.get(e))}if(e&&(this.mapper||this.dedupe&&e.length>1)){l="";for(let t,n,r=0,i="";r<e.length;r++)t=e.charAt(r),t===i&&this.dedupe||((n=this.mapper&&this.mapper.get(t))||""===n?n===i&&this.dedupe||!(i=n)||(l+=n):l+=i=t);e=l}if(this.matcher&&e.length>1&&(this.J||(this.J=new RegExp("("+this.h+")","g")),e=e.replace(this.J,e=>this.matcher.get(e))),e&&this.replacer)for(l=0;e&&l<this.replacer.length;l+=2)e=e.replace(this.replacer[l],this.replacer[l+1]);if(this.cache&&c.length<=this.I&&(this.D.set(c,e),this.D.size>this.L&&(this.D.clear(),this.I=this.I/1.1|0)),e){if(e!==c)if(t){if(a[e])continue;a[e]=1}else{if(i===e)continue;i=e}o.push(e)}}}return this.finalize&&(o=this.finalize(o)||o),this.cache&&e.length<=this.H&&(this.B.set(e,o),this.B.size>this.L&&(this.B.clear(),this.H=this.H/1.1|0)),o},wn.prototype.set=function(e,t){this.cache.set(this.h=e,t),this.cache.size>this.limit&&this.cache.delete(this.cache.keys().next().value)},wn.prototype.get=function(e){const t=this.cache.get(e);return t&&this.h!==e&&(this.cache.delete(e),this.cache.set(this.h=e,t)),t},wn.prototype.remove=function(e){for(const t of this.cache){const n=t[0];t[1].includes(e)&&this.cache.delete(n)}},wn.prototype.clear=function(){this.cache.clear(),this.h=""};const kn={normalize:!1,numeric:!1,dedupe:!1},_n={},An=new Map([["b","p"],["v","f"],["w","f"],["z","s"],["x","s"],["d","t"],["n","m"],["c","k"],["g","k"],["j","k"],["q","k"],["i","e"],["y","e"],["u","o"]]),Cn=new Map([["ae","a"],["oe","o"],["sh","s"],["kh","k"],["th","t"],["ph","f"],["pf","f"]]),Sn=[/([^aeo])h(.)/g,"$1$2",/([aeo])h([^aeo]|$)/g,"$1$2",/(.)\1+/g,"$1"],jn={a:"",e:"",i:"",o:"",u:"",y:"",b:1,f:1,p:1,v:1,c:2,g:2,j:2,k:2,q:2,s:2,x:2,z:2,"ÃŸ":2,d:3,t:3,l:4,m:5,n:5,r:6};var Pn={Exact:kn,Default:_n,Normalize:_n,LatinBalance:{mapper:An},LatinAdvanced:{mapper:An,matcher:Cn,replacer:Sn},LatinExtra:{mapper:An,replacer:Sn.concat([/(?!^)[aeo]/g,""]),matcher:Cn},LatinSoundex:{dedupe:!1,include:{letter:!0},finalize:function(e){for(let n=0;n<e.length;n++){var t=e[n];let r=t.charAt(0),i=jn[r];for(let e,n=1;n<t.length&&(e=t.charAt(n),"h"===e||"w"===e||!(e=jn[e])||e===i||(r+=e,i=e,4!==r.length));n++);e[n]=r}}},CJK:{split:""},LatinExact:kn,LatinDefault:_n,LatinSimple:_n};function En(e,t,n,r){let i=[];for(let o,a=0;a<e.index.length;a++)if(o=e.index[a],t>=o.length)t-=o.length;else{const a=(t=o[r?"splice":"slice"](t,n)).length;if(a&&(i=i.length?i.concat(t):t,n-=a,r&&(e.length-=a),!n))break;t=0}return i}function Tn(e){if(!this||this.constructor!==Tn)return new Tn(e);this.index=e?[e]:[],this.length=e?e.length:0;const t=this;return new Proxy([],{get:(e,n)=>"length"===n?t.length:"push"===n?function(e){t.index[t.index.length-1].push(e),t.length++}:"pop"===n?function(){if(t.length)return t.length--,t.index[t.index.length-1].pop()}:"indexOf"===n?function(e){let n=0;for(let r,i,o=0;o<t.index.length;o++){if(r=t.index[o],i=r.indexOf(e),i>=0)return n+i;n+=r.length}return-1}:"includes"===n?function(e){for(let n=0;n<t.index.length;n++)if(t.index[n].includes(e))return!0;return!1}:"slice"===n?function(e,n){return En(t,e||0,n||t.length,!1)}:"splice"===n?function(e,n){return En(t,e||0,n||t.length,!0)}:"constructor"===n?Array:"symbol"!=typeof n?(e=t.index[n/2**31|0])&&e[n]:void 0,set:(e,n,r)=>(e=n/2**31|0,(t.index[e]||(t.index[e]=[]))[n]=r,t.length++,!0)})}function Mn(e=8){if(!this||this.constructor!==Mn)return new Mn(e);this.index=cn(),this.h=[],this.size=0,e>32?(this.B=Bn,this.A=BigInt(e)):(this.B=Dn,this.A=e)}function On(e=8){if(!this||this.constructor!==On)return new On(e);this.index=cn(),this.h=[],this.size=0,e>32?(this.B=Bn,this.A=BigInt(e)):(this.B=Dn,this.A=e)}function Dn(e){let t=2**this.A-1;if("number"==typeof e)return e&t;let n=0,r=this.A+1;for(let i=0;i<e.length;i++)n=(n*r^e.charCodeAt(i))&t;return 32===this.A?n+2**31:n}function Bn(e){let t=BigInt(2)**this.A-BigInt(1);var n=typeof e;if("bigint"===n)return e&t;if("number"===n)return BigInt(e)&t;n=BigInt(0);let r=this.A+BigInt(1);for(let i=0;i<e.length;i++)n=(n*r^BigInt(e.charCodeAt(i)))&t;return n}let In,Rn,$n,Kn,qn;async function Ln(e){var t=(e=e.data).task;const n=e.id;let r=e.args;if("init"===t)Rn=e.options||{},(t=e.factory)?(Function("return "+t)()(self),In=new self.FlexSearch.Index(Rn),delete self.FlexSearch):In=new Tr(Rn),postMessage({id:n});else{let i;"export"===t&&(r[1]?(r[0]=Rn.export,r[2]=0,r[3]=1):r=null),"import"===t?r[0]&&(e=await Rn.import.call(In,r[0]),In.import(r[0],e)):((i=r&&In[t].apply(In,r))&&i.then&&(i=await i),i&&i.await&&(i=await i.await),"search"===t&&i.result&&(i=i.result)),postMessage("search"===t?{id:n,msg:i}:{id:n})}}function Fn(e){Nn.call(e,"add"),Nn.call(e,"append"),Nn.call(e,"search"),Nn.call(e,"update"),Nn.call(e,"remove"),Nn.call(e,"searchCache")}function zn(){$n=qn=0}function Nn(e){this[e+"Async"]=function(){const t=arguments;var n=t[t.length-1];let r;if("function"==typeof n&&(r=n,delete t[t.length-1]),$n?qn||(qn=Date.now()-Kn>=this.priority*this.priority*3):($n=setTimeout(zn,0),Kn=Date.now()),qn){const n=this;return new Promise(r=>{setTimeout(function(){r(n[e+"Async"].apply(n,t))},0)})}const i=this[e].apply(this,t);return n=i.then?i:new Promise(e=>e(i)),r&&n.then(r),n}}Tn.prototype.clear=function(){this.index.length=0},Tn.prototype.push=function(){},Mn.prototype.get=function(e){const t=this.index[this.B(e)];return t&&t.get(e)},Mn.prototype.set=function(e,t){var n=this.B(e);let r=this.index[n];r?(n=r.size,r.set(e,t),(n-=r.size)&&this.size++):(this.index[n]=r=new Map([[e,t]]),this.h.push(r),this.size++)},On.prototype.add=function(e){var t=this.B(e);let n=this.index[t];n?(t=n.size,n.add(e),(t-=n.size)&&this.size++):(this.index[t]=n=new Set([e]),this.h.push(n),this.size++)},(an=Mn.prototype).has=On.prototype.has=function(e){const t=this.index[this.B(e)];return t&&t.has(e)},an.delete=On.prototype.delete=function(e){const t=this.index[this.B(e)];t&&t.delete(e)&&this.size--},an.clear=On.prototype.clear=function(){this.index=cn(),this.h=[],this.size=0},an.values=On.prototype.values=function*(){for(let e=0;e<this.h.length;e++)for(let t of this.h[e].values())yield t},an.keys=On.prototype.keys=function*(){for(let e=0;e<this.h.length;e++)for(let t of this.h[e].keys())yield t},an.entries=On.prototype.entries=function*(){for(let e=0;e<this.h.length;e++)for(let t of this.h[e].entries())yield t};let Wn=0;function Un(e={},t){function n(n){function a(e){const t=(e=e.data||e).id,n=t&&o.h[t];n&&(n(e.msg),delete o.h[t])}if(this.worker=n,this.h=cn(),this.worker)return i?this.worker.on("message",a):this.worker.onmessage=a,e.config?new Promise(function(t){Wn>1e9&&(Wn=0),o.h[++Wn]=function(){t(o)},o.worker.postMessage({id:Wn,task:"init",factory:r,options:e})}):(this.priority=e.priority||4,this.encoder=t||null,this.worker.postMessage({task:"init",factory:r,options:e}),this)}if(!this||this.constructor!==Un)return new Un(e);let r="undefined"!=typeof self?self._factory:"undefined"!=typeof window?window._factory:null;r&&(r=r.toString());const i="undefined"==typeof window,o=this,a=function(e,t,n){return t?"undefined"!=typeof module?new(require("worker_threads").Worker)(__dirname+"/worker/node.js"):Promise.resolve().then(function(){return ci}).then(function(e){return new e.Worker(import.meta.dirname+"/node/node.mjs")}):e?new window.Worker(URL.createObjectURL(new Blob(["onmessage="+Ln.toString()],{type:"text/javascript"}))):new window.Worker("string"==typeof n?n:import.meta.url.replace("/worker.js","/worker/worker.js").replace("flexsearch.bundle.module.min.js","module/worker/worker.js").replace("flexsearch.bundle.module.min.mjs","module/worker/worker.js"),{type:"module"})}(r,i,e.worker);return a.then?a.then(function(e){return n.call(o,e)}):n.call(this,a)}function Hn(e){Un.prototype[e]=function(){const t=this,n=[].slice.call(arguments);var r=n[n.length-1];let i;return"function"==typeof r&&(i=r,n.pop()),r=new Promise(function(r){"export"===e&&"function"==typeof n[0]&&(n[0]=null),Wn>1e9&&(Wn=0),t.h[++Wn]=r,t.worker.postMessage({task:e,id:Wn,args:n})}),i?(r.then(i),this):r}}function Vn(e,t,n,r,i,o){if(e=e[i],r===n.length-1)t[i]=o||e;else if(e)if(e.constructor===Array)for(t=t[i]=Array(e.length),i=0;i<e.length;i++)Vn(e,t,n,r,i);else t=t[i]||(t[i]=cn()),i=n[++r],Vn(e,t,n,r,i)}function Qn(e,t,n,r,i,o,a,s){if(e=e[a])if(r===t.length-1){if(e.constructor===Array){if(n[r]){for(t=0;t<e.length;t++)i.add(o,e[t],!0,!0);return}e=e.join(" ")}i.add(o,e,s,!0)}else if(e.constructor===Array)for(a=0;a<e.length;a++)Qn(e,t,n,r,i,o,a,s);else a=t[++r],Qn(e,t,n,r,i,o,a,s)}function Yn(e,t,n,r){if(!e.length)return e;if(1===e.length)return e=e[0],e=n||e.length>t?e.slice(n,n+t):e,r?ur.call(this,e):e;let i=[];for(let o,a,s=0;s<e.length;s++)if((o=e[s])&&(a=o.length)){if(n){if(n>=a){n-=a;continue}o=o.slice(n,n+t),a=o.length,n=0}if(a>t&&(o=o.slice(0,t),a=t),!i.length&&a>=t)return r?ur.call(this,o):o;if(i.push(o),!(t-=a))break}return i=i.length>1?[].concat.apply([],i):i[0],r?ur.call(this,i):i}function Gn(e,t,n,r){var i=r[0];if(i[0]&&i[0].query)return e[t].apply(e,i);if(!("and"!==t&&"not"!==t||e.result.length||e.await||i.suggest))return r.length>1&&(i=r[r.length-1]),(r=i.resolve)?e.await||e.result:e;let o,a,s,l,c,u=[],d=0,h=0;for(t=0;t<r.length;t++)if(i=r[t]){var f=void 0;if(i.constructor===rr)f=i.await||i.result;else if(i.then||i.constructor===Array)f=i;else{d=i.limit||0,h=i.offset||0,s=i.suggest,a=i.resolve,o=((l=i.highlight||e.highlight)||i.enrich)&&a,f=i.queue;let n=i.async||f,r=i.index,p=i.query;if(r?e.index||(e.index=r):r=e.index,p||i.tag){const o=i.field||i.pluck;if(o&&(!p||e.query&&!l||(e.query=p,e.field=o,e.highlight=l),r=r.index.get(o)),f&&(c||e.await)){let o;c=1;const a=e.C.length,s=new Promise(function(e){o=e});(function(t,r){s.h=function(){r.index=null,r.resolve=!1;let i=n?t.searchAsync(r):t.search(r);return i.then?i.then(function(t){return e.C[a]=t=t.result||t,o(t),t}):(i=i.result||i,o(i),i)}})(r,Object.assign({},i)),e.C.push(s),u[t]=s;continue}i.resolve=!1,i.index=null,f=n?r.searchAsync(i):r.search(i),i.resolve=a,i.index=r}else if(i.and)f=Jn(i,"and",r);else if(i.or)f=Jn(i,"or",r);else if(i.not)f=Jn(i,"not",r);else{if(!i.xor)continue;f=Jn(i,"xor",r)}}f.await?(c=1,f=f.await):f.then?(c=1,f=f.then(function(e){return e.result||e})):f=f.result||f,u[t]=f}if(c&&!e.await&&(e.await=new Promise(function(t){e.return=t})),c){const t=Promise.all(u).then(function(r){for(let i=0;i<e.C.length;i++)if(e.C[i]===t){e.C[i]=function(){return n.call(e,r,d,h,o,a,s,l)};break}ir(e)});e.C.push(t)}else{if(!e.await)return n.call(e,u,d,h,o,a,s,l);e.C.push(function(){return n.call(e,u,d,h,o,a,s,l)})}return a?e.await||e.result:e}function Jn(e,t,n){const r=(e=e[t])[0]||e;return r.index||(r.index=n),n=new rr(r),e.length>1&&(n=n[t].apply(n,e.slice(1))),n}function Xn(e,t,n,r,i,o,a){return e.length&&(this.result.length&&e.push(this.result),e.length<2?this.result=e[0]:(this.result=ar(e,t,n,!1,this.h),n=0)),i&&(this.await=null),i?this.resolve(t,n,r,a):this}function Zn(e,t,n,r,i,o,a){if(!o&&!this.result.length)return i?this.result:this;let s;if(e.length)if(this.result.length&&e.unshift(this.result),e.length<2)this.result=e[0];else{let r=0;for(let t,n,i=0;i<e.length;i++)if((t=e[i])&&(n=t.length))r<n&&(r=n);else if(!o){r=0;break}r?(this.result=or(e,r,t,n,o,this.h,i),s=!0):this.result=[]}else o||(this.result=e);return i&&(this.await=null),i?this.resolve(t,n,r,a,s):this}function er(e,t,n,r,i,o,a){if(e.length)if(this.result.length&&e.unshift(this.result),e.length<2)this.result=e[0];else{e:{o=n;var s=this.h;const r=[],a=cn();let l=0;for(let t,n=0;n<e.length;n++)if(t=e[n]){l<t.length&&(l=t.length);for(let e,n=0;n<t.length;n++)if(e=t[n])for(let t,n=0;n<e.length;n++)t=e[n],a[t]=a[t]?2:1}for(let n,c=0,u=0;c<l;c++)for(let l,d=0;d<e.length;d++)if((l=e[d])&&(n=l[c]))for(let l,h=0;h<n.length;h++)if(l=n[h],1===a[l])if(o)o--;else if(i){if(r.push(l),r.length===t){e=r;break e}}else{const n=c+(d?s:0);if(r[n]||(r[n]=[]),r[n].push(l),++u===t){e=r;break e}}e=r}this.result=e,s=!0}else o||(this.result=e);return i&&(this.await=null),i?this.resolve(t,n,r,a,s):this}function tr(e,t,n,r,i,o,a){if(!o&&!this.result.length)return i?this.result:this;if(e.length&&this.result.length){e:{o=n;var s=[];e=new Set(e.flat().flat());for(let n,r=0,a=0;r<this.result.length;r++)if(n=this.result[r])for(let l,c=0;c<n.length;c++)if(l=n[c],!e.has(l))if(o)o--;else if(i){if(s.push(l),s.length===t){e=s;break e}}else if(s[r]||(s[r]=[]),s[r].push(l),++a===t){e=s;break e}e=s}this.result=e,s=!0}return i&&(this.await=null),i?this.resolve(t,n,r,a,s):this}function nr(e,t,n,r,i){let o,a,s;"string"==typeof i?(o=i,i=""):o=i.template,a=o.indexOf("$1"),s=o.substring(a+2),a=o.substring(0,a);let l=i&&i.boundary,c=!i||!1!==i.clip,u=i&&i.merge&&s&&a&&new RegExp(s+" "+a,"g");var d=0;if("object"==typeof(i=i&&i.ellipsis)){var h=i.template;d=h.length-2,i=i.pattern}let f,p;"string"!=typeof i&&(i=!1===i?"":"..."),d&&(i=h.replace("$1",i)),h=i.length-d,"object"==typeof l&&(f=l.before,0===f&&(f=-1),p=l.after,0===p&&(p=-1),l=l.total||9e5),d=new Map;for(let D,B,I,R=0;R<t.length;R++){let $;if(r)$=t,I=r;else{var g=t[R];if(I=g.field,!I)continue;$=g.result}B=n.get(I),D=B.encoder,"string"!=typeof(g=d.get(D))&&(g=D.encode(e),d.set(D,g));for(let e=0;e<$.length;e++){var m=$[e].doc;if(!m)continue;if(!(m=hn(m,I)))continue;var y=m.trim().split(/\s+/);if(!y.length)continue;m="";var b=[];let t=[];for(var v=-1,x=-1,w=0,k=0;k<y.length;k++){var _=y[k],A=D.encode(_);let e;if((A=A.length>1?A.join(" "):A[0])&&_){for(var C=_.length,S=(D.split?_.replace(D.split,""):_).length-A.length,j="",P=0,E=0;E<g.length;E++){var T=g[E];if(T){var M=T.length;M+=S<0?0:S,P&&M<=P||(T=A.indexOf(T))>-1&&(j=(T?_.substring(0,T):"")+a+_.substring(T,T+M)+s+(T+M<C?_.substring(T+M):""),P=M,e=!0)}}j&&(l&&(v<0&&(v=m.length+(m?1:0)),x=m.length+(m?1:0)+j.length,w+=C,t.push(b.length),b.push({match:j})),m+=(m?" ":"")+j)}if(e){if(l&&w>=l)break}else m+=(m?" ":"")+(_=y[k]),l&&b.push({text:_})}if(w=t.length*(o.length-2),f||p||l&&m.length-w>l)if(k=x-v,f>0&&(k+=f),p>0&&(k+=p),k<=(w=l+w-2*h))y=f?v-(f>0?f:0):v-((w-k)/2|0),b=p?x+(p>0?p:0):y+w,c||(y>0&&" "!==m.charAt(y)&&" "!==m.charAt(y-1)&&((y=m.indexOf(" ",y))<0&&(y=0)),b<m.length&&" "!==m.charAt(b-1)&&" "!==m.charAt(b)&&((b=m.lastIndexOf(" ",b))<x?b=x:++b)),m=(y?i:"")+m.substring(y,b)+(b<m.length?i:"");else{for(x=[],v={},w={},k={},_={},A={},j=S=C=0,E=P=1;;){var O=void 0;for(let e,n=0;n<t.length;n++){if(e=t[n],j)if(S!==j){if(k[n+1])continue;if(e+=j,v[e]){C-=h,w[n+1]=1,k[n+1]=1;continue}if(e>=b.length-1){if(e>=b.length){k[n+1]=1,e>=y.length&&(w[n+1]=1);continue}C-=h}if(m=b[e].text,M=p&&A[n]){if(!(M>0)){k[n+1]=1;continue}if(m.length>M){if(k[n+1]=1,!c)continue;m=m.substring(0,M)}(M-=m.length)||(M=-1),A[n]=M}if(C+m.length+1<=l)m=" "+m,x[n]+=m;else{if(!c){k[n+1]=1;continue}(O=l-C-1)>0&&(m=" "+m.substring(0,O),x[n]+=m),k[n+1]=1}}else{if(k[n])continue;if(e-=S,v[e]){C-=h,k[n]=1,w[n]=1;continue}if(e<=0){if(e<0){k[n]=1,w[n]=1;continue}C-=h}if(m=b[e].text,M=f&&_[n]){if(!(M>0)){k[n]=1;continue}if(m.length>M){if(k[n]=1,!c)continue;m=m.substring(m.length-M)}(M-=m.length)||(M=-1),_[n]=M}if(C+m.length+1<=l)m+=" ",x[n]=m+x[n];else{if(!c){k[n]=1;continue}(O=m.length+1-(l-C))>=0&&O<m.length&&(m=m.substring(O)+" ",x[n]=m+x[n]),k[n]=1}}else{let t;if(m=b[e].match,f&&(_[n]=f),p&&(A[n]=p),n&&C++,e?!n&&h&&(C+=h):(w[n]=1,k[n]=1),e>=y.length-1||e<b.length-1&&b[e+1].match?t=1:h&&(C+=h),C-=o.length-2,n&&!(C+m.length<=l)){O=P=E=w[n]=0;break}x[n]=m,t&&(w[n+1]=1,k[n+1]=1)}C+=m.length,O=v[e]=1}if(O)S===j?j++:S++;else{if(S===j?P=0:E=0,!P&&!E)break;P?j=++S:j++}}m="";for(let e,t=0;t<x.length;t++)e=(w[t]?t?" ":"":(t&&!i?" ":"")+i)+x[t],m+=e;i&&!w[x.length]&&(m+=i)}u&&(m=m.replace(u," ")),$[e].highlight=m}if(r)break}return t}function rr(e,t){if(!this||this.constructor!==rr)return new rr(e,t);let n,r,i,o,a,s,l=0;if(e&&e.index){const n=e;if(t=n.index,l=n.boost||0,r=n.query){i=n.field||n.pluck,o=n.highlight;const r=n.resolve;e=n.async||n.queue,n.resolve=!1,n.index=null,e=e?t.searchAsync(n):t.search(n),n.resolve=r,n.index=t,e=e.result||e}else e=[]}if(e&&e.then){const t=this;n=[e=e.then(function(e){t.C[0]=t.result=e.result||e,ir(t)})],e=[],a=new Promise(function(e){s=e})}this.index=t||null,this.result=e||[],this.h=l,this.C=n||[],this.await=a||null,this.return=s||null,this.highlight=o||null,this.query=r||"",this.field=i||""}function ir(e,t){let n=e.result;var r=e.await;e.await=null;for(let t,i=0;i<e.C.length;i++)if(t=e.C[i])if("function"==typeof t)n=t(),e.C[i]=n=n.result||n,i--;else if(t.h)n=t.h(),e.C[i]=n=n.result||n,i--;else if(t.then)return e.await=r;return r=e.return,e.C=[],e.return=null,t||r(n),n}function or(e,t,n,r,i,o,a){const s=e.length;let l,c,u=[];l=cn();for(let d,h,f,p,g=0;g<t;g++)for(let t=0;t<s;t++)if(f=e[t],g<f.length&&(d=f[g]))for(let e=0;e<d.length;e++){if(h=d[e],(c=l[h])?l[h]++:(c=0,l[h]=1),p=u[c]||(u[c]=[]),!a){let e=g+(t||!i?0:o||0);p=p[e]||(p[e]=[])}if(p.push(h),a&&n&&c===s-1&&p.length-r===n)return r?p.slice(r):p}if(e=u.length)if(i)u=u.length>1?ar(u,n,r,a,o):(u=u[0])&&n&&u.length>n||r?u.slice(r,n+r):u;else{if(e<s)return[];if(u=u[e-1],n||r)if(a)(u.length>n||r)&&(u=u.slice(r,n+r));else{i=[];for(let e,t=0;t<u.length;t++)if(e=u[t])if(r&&e.length>r)r-=e.length;else if((n&&e.length>n||r)&&(e=e.slice(r,n+r),n-=e.length,r&&(r-=e.length)),i.push(e),!n)break;u=i}}return u}function ar(e,t,n,r,i){const o=[],a=cn();let s;var l=e.length;let c;if(r){for(i=l-1;i>=0;i--)if(c=(r=e[i])&&r.length)for(l=0;l<c;l++)if(s=r[l],!a[s])if(a[s]=1,n)n--;else if(o.push(s),o.length===t)return o}else for(let u,d=l-1,h=0;d>=0;d--){u=e[d];for(let e=0;e<u.length;e++)if(c=(r=u[e])&&r.length)for(let u=0;u<c;u++)if(s=r[u],!a[s])if(a[s]=1,n)n--;else{let n=(e+(d<l-1&&i||0))/(d+1)|0;if((o[n]||(o[n]=[])).push(s),++h===t)return o}}return o}function sr(e,t,n,r,i){const o=cn(),a=[];for(let e,n=0;n<t.length;n++){e=t[n];for(let t=0;t<e.length;t++)o[e[t]]=1}if(i){for(let t,i=0;i<e.length;i++)if(t=e[i],o[t])if(r)r--;else if(a.push(t),o[t]=0,n&&0===--n)break}else for(let n,r,i=0;i<e.result.length;i++)for(n=e.result[i],t=0;t<n.length;t++)r=n[t],o[r]&&((a[i]||(a[i]=[])).push(r),o[r]=0);return a}function lr(e){const t=[],n=cn(),r=cn();for(let i,o,a,s,l,c,u,d=0;d<e.length;d++){i=e[d],o=i.field,a=i.result;for(let e=0;e<a.length;e++)l=a[e],"object"!=typeof l?l={id:s=l}:s=l.id,(c=n[s])?c.push(o):(l.field=n[s]=[o],t.push(l)),(u=l.highlight)&&(c=r[s],c||(r[s]=c={},l.highlight=c),c[o]=u)}return t}function cr(e,t,n,r,i){return(e=this.tag.get(e))&&(e=e.get(t))?((t=e.length-r)>0&&((n&&t>n||r)&&(e=e.slice(r,r+n)),i&&(e=ur.call(this,e))),e):[]}function ur(e){if(!this||!this.store)return e;if(this.db)return this.index.get(this.field[0]).db.enrich(e);const t=Array(e.length);for(let n,r=0;r<e.length;r++)n=e[r],t[r]={id:n,doc:this.store.get(n)};return t}function dr(e){if(!this||this.constructor!==dr)return new dr(e);const t=e.document||e.doc||e;let n,r;if(this.B=[],this.field=[],this.D=[],this.key=(n=t.key||t.id)&&fr(n,this.D)||"id",(r=e.keystore||0)&&(this.keystore=r),this.fastupdate=!!e.fastupdate,this.reg=!this.fastupdate||e.worker||e.db?r?new On(r):new Set:r?new Mn(r):new Map,this.h=(n=t.store||null)&&n&&!0!==n&&[],this.store=n?r?new Mn(r):new Map:null,this.cache=(n=e.cache||null)&&new wn(n),e.cache=!1,this.worker=e.worker||!1,this.priority=e.priority||4,this.index=hr.call(this,e,t),this.tag=null,(n=t.tag)&&("string"==typeof n&&(n=[n]),n.length)){this.tag=new Map,this.A=[],this.F=[];for(let e,t,r=0;r<n.length;r++){if(e=n[r],t=e.field||e,!t)throw Error("The tag field from the document descriptor is undefined.");e.custom?this.A[r]=e.custom:(this.A[r]=fr(t,this.D),e.filter&&("string"==typeof this.A[r]&&(this.A[r]=new String(this.A[r])),this.A[r].G=e.filter)),this.F[r]=t,this.tag.set(t,new Map)}}if(this.worker){this.fastupdate=!1,e=[];for(const t of this.index.values())t.then&&e.push(t);if(e.length){const t=this;return Promise.all(e).then(function(e){let n=0;for(const r of t.index.entries()){const i=r[0];let o=r[1];o.then&&(o=e[n],t.index.set(i,o),n++)}return t})}}else e.db&&(this.fastupdate=!1,this.mount(e.db))}function hr(e,t){const n=new Map;let r=t.index||t.field||t;un(r)&&(r=[r]);for(let t,o,a=0;a<r.length;a++){if(t=r[a],un(t)||(o=t,t=t.field),o=dn(o)?Object.assign({},e,o):e,this.worker){var i=void 0;i=new Un(o,i=(i=o.encoder)&&i.encode?i:new bn("string"==typeof i?Pn[i]:i||{})),n.set(t,i)}this.worker||n.set(t,new Tr(o,this.reg)),o.custom?this.B[a]=o.custom:(this.B[a]=fr(t,this.D),o.filter&&("string"==typeof this.B[a]&&(this.B[a]=new String(this.B[a])),this.B[a].G=o.filter)),this.field[a]=t}if(this.h){un(e=t.store)&&(e=[e]);for(let t,n,r=0;r<e.length;r++)t=e[r],n=t.field||t,t.custom?(this.h[r]=t.custom,t.custom.O=n):(this.h[r]=fr(n,this.D),t.filter&&("string"==typeof this.h[r]&&(this.h[r]=new String(this.h[r])),this.h[r].G=t.filter))}return n}function fr(e,t){const n=e.split(":");let r=0;for(let i=0;i<n.length;i++)"]"===(e=n[i])[e.length-1]&&(e=e.substring(0,e.length-2))&&(t[r]=!0),e&&(n[r++]=e);return r<n.length&&(n.length=r),r>1?n:n[0]}function pr(e,t=0){let n=[],r=[];t&&(t=25e4/t*5e3|0);for(const i of e.entries())r.push(i),r.length===t&&(n.push(r),r=[]);return r.length&&n.push(r),n}function gr(e,t){t||(t=new Map);for(let n,r=0;r<e.length;r++)n=e[r],t.set(n[0],n[1]);return t}function mr(e,t=0){let n=[],r=[];t&&(t=25e4/t*1e3|0);for(const i of e.entries())r.push([i[0],pr(i[1])[0]||[]]),r.length===t&&(n.push(r),r=[]);return r.length&&n.push(r),n}function yr(e,t){t||(t=new Map);for(let n,r,i=0;i<e.length;i++)n=e[i],r=t.get(n[0]),t.set(n[0],gr(n[1],r));return t}function br(e){let t=[],n=[];for(const r of e.keys())n.push(r),25e4===n.length&&(t.push(n),n=[]);return n.length&&t.push(n),t}function vr(e,t){t||(t=new Set);for(let n=0;n<e.length;n++)t.add(e[n]);return t}function xr(e,t,n,r,i,o,a=0){const s=r&&r.constructor===Array;var l=s?r.shift():r;if(!l)return this.export(e,t,i,o+1);if((l=e((t?t+".":"")+(a+1)+"."+n,JSON.stringify(l)))&&l.then){const c=this;return l.then(function(){return xr.call(c,e,t,n,s?r:null,i,o,a+1)})}return xr.call(this,e,t,n,s?r:null,i,o,a+1)}function wr(e,t){let n="";for(const r of e.entries()){e=r[0];const i=r[1];let o="";for(let e,n=0;n<i.length;n++){e=i[n]||[""];let r="";for(let n=0;n<e.length;n++)r+=(r?",":"")+("string"===t?'"'+e[n]+'"':e[n]);r="["+r+"]",o+=(o?",":"")+r}o='["'+e+'",['+o+"]]",n+=(n?",":"")+o}return n}function kr(e,t){let n=0;var r=void 0===t;if(e.constructor===Array){for(let i,o,a,s=0;s<e.length;s++)if((i=e[s])&&i.length){if(r)return 1;if(o=i.indexOf(t),o>=0){if(i.length>1)return i.splice(o,1),1;if(delete e[s],n)return 1;a=1}else{if(a)return 1;n++}}}else for(let i of e.entries())r=i[0],kr(i[1],t)?n++:e.delete(r);return n}Hn("add"),Hn("append"),Hn("search"),Hn("update"),Hn("remove"),Hn("clear"),Hn("export"),Hn("import"),Un.prototype.searchCache=xn,Fn(Un.prototype),dr.prototype.add=function(e,t,n){if(dn(e)&&(e=hn(t=e,this.key)),t&&(e||0===e)){if(!n&&this.reg.has(e))return this.update(e,t);for(let o,a=0;a<this.field.length;a++){o=this.B[a];var r=this.index.get(this.field[a]);if("function"==typeof o){var i=o(t);i&&r.add(e,i,n,!0)}else(!(i=o.G)||i(t))&&(o.constructor===String?o=[""+o]:un(o)&&(o=[o]),Qn(t,o,this.D,0,r,e,o[0],n))}if(this.tag)for(r=0;r<this.A.length;r++){var o=this.A[r];i=this.tag.get(this.F[r]);let s=cn();if("function"==typeof o){if(!(o=o(t)))continue}else{var a=o.G;if(a&&!a(t))continue;o.constructor===String&&(o=""+o),o=hn(t,o)}if(i&&o){un(o)&&(o=[o]);for(let t,r,l=0;l<o.length;l++)if(t=o[l],!s[t]&&(s[t]=1,(a=i.get(t))?r=a:i.set(t,r=[]),!n||!r.includes(e))){if(r.length===2**31-1){if(a=new Tn(r),this.fastupdate)for(let e of this.reg.values())e.includes(r)&&(e[e.indexOf(r)]=a);i.set(t,r=a)}r.push(e),this.fastupdate&&((a=this.reg.get(e))?a.push(r):this.reg.set(e,[r]))}}}if(this.store&&(!n||!this.store.has(e))){let r;if(this.h){r=cn();for(let e,i=0;i<this.h.length;i++){if(e=this.h[i],(n=e.G)&&!n(t))continue;let o;if("function"==typeof e){if(o=e(t),!o)continue;e=[e.O]}else if(un(e)||e.constructor===String){r[e]=t[e];continue}Vn(t,r,e,0,e[0],o)}}this.store.set(e,r||t)}this.worker&&(this.fastupdate||this.reg.add(e))}return this},rr.prototype.or=function(){return Gn(this,"or",Xn,arguments)},rr.prototype.and=function(){return Gn(this,"and",Zn,arguments)},rr.prototype.xor=function(){return Gn(this,"xor",er,arguments)},rr.prototype.not=function(){return Gn(this,"not",tr,arguments)},(an=rr.prototype).limit=function(e){if(this.await){const t=this;this.C.push(function(){return t.limit(e).result})}else if(this.result.length){const t=[];for(let n,r=0;r<this.result.length;r++)if(n=this.result[r]){if(!(n.length<=e)){t[r]=n.slice(0,e);break}if(t[r]=n,!(e-=n.length))break}this.result=t}return this},an.offset=function(e){if(this.await){const t=this;this.C.push(function(){return t.offset(e).result})}else if(this.result.length){const t=[];for(let n,r=0;r<this.result.length;r++)(n=this.result[r])&&(n.length<=e?e-=n.length:(t[r]=n.slice(e),e=0));this.result=t}return this},an.boost=function(e){if(this.await){const t=this;this.C.push(function(){return t.boost(e).result})}else this.h+=e;return this},an.resolve=function(e,t,n,r,i){let o=this.await?ir(this,!0):this.result;if(o.then){const a=this;return o.then(function(){return a.resolve(e,t,n,r,i)})}return o.length&&("object"==typeof e?(r=e.highlight||this.highlight,n=!!r||e.enrich,t=e.offset,e=e.limit):(r=r||this.highlight,n=!!r||n),o=i?n?ur.call(this.index,o):o:Yn.call(this.index,o,e||100,t,n)),this.finalize(o,r)},an.finalize=function(e,t){if(e.then){const n=this;return e.then(function(e){return n.finalize(e,t)})}t&&e.length&&this.query&&(e=nr(this.query,e,this.index.index,this.field,t));const n=this.return;return this.highlight=this.index=this.result=this.C=this.await=this.return=null,this.query=this.field="",n&&n(e),e},dr.prototype.search=function(e,t,n,r){n||(!t&&dn(e)?(n=e,e=""):dn(t)&&(n=t,t=0));let i=[];var o=[];let a,s,l,c,u,d,h,f,p=0,g=!0;if(n){n.constructor===Array&&(n={index:n}),e=n.query||e,a=n.pluck,s=n.merge,c=n.boost,d=a||n.field||(d=n.index)&&(d.index?null:d);var m=this.tag&&n.tag;l=n.suggest,g=!1!==n.resolve,u=n.cache,h=g&&this.store&&n.highlight;var y=!!h||g&&this.store&&n.enrich;t=n.limit||t;var b=n.offset||0;if(t||(t=g?100:0),m&&(!this.db||!r)){m.constructor!==Array&&(m=[m]);var v=[];for(let e,t=0;t<m.length;t++)if(e=m[t],e.field&&e.tag){var x=e.tag;if(x.constructor===Array)for(var w=0;w<x.length;w++)v.push(e.field,x[w]);else v.push(e.field,x)}else{x=Object.keys(e);for(let t,n,r=0;r<x.length;r++)if(t=x[r],n=e[t],n.constructor===Array)for(w=0;w<n.length;w++)v.push(t,n[w]);else v.push(t,n)}if(m=v,!e){if(o=[],v.length)for(m=0;m<v.length;m+=2){if(this.db){if(!(r=this.index.get(v[m])))continue;o.push(r=r.db.tag(v[m+1],t,b,y))}else r=cr.call(this,v[m],v[m+1],t,b,y);i.push(g?{field:v[m],tag:v[m+1],result:r}:[r])}if(o.length){const e=this;return Promise.all(o).then(function(t){for(let e=0;e<t.length;e++)g?i[e].result=t[e]:i[e]=t[e];return g?i:new rr(i.length>1?or(i,1,0,0,l,c):i[0],e)})}return g?i:new rr(i.length>1?or(i,1,0,0,l,c):i[0],this)}}g||a||!(d=d||this.field)||(un(d)?a=d:(d.constructor===Array&&1===d.length&&(d=d[0]),a=d.field||d.index)),d&&d.constructor!==Array&&(d=[d])}d||(d=this.field),v=(this.worker||this.db)&&!r&&[];for(let a,s,c,_=0;_<d.length;_++){if(s=d[_],this.db&&this.tag&&!this.B[_])continue;let A;if(un(s)||(A=s,s=A.field,e=A.query||e,t=ln(A.limit,t),b=ln(A.offset,b),l=ln(A.suggest,l),h=g&&this.store&&ln(A.highlight,h),y=!!h||g&&this.store&&ln(A.enrich,y),u=ln(A.cache,u)),r)a=r[_];else{w=(x=A||n||{}).enrich;var k=this.index.get(s);if(m&&(this.db&&(x.tag=m,x.field=d,f=k.db.support_tag_search),!f&&w&&(x.enrich=!1),f||(x.limit=0,x.offset=0)),a=u?k.searchCache(e,m&&!f?0:t,x):k.search(e,m&&!f?0:t,x),m&&!f&&(x.limit=t,x.offset=b),w&&(x.enrich=w),v){v[_]=a;continue}}if(c=(a=a.result||a)&&a.length,m&&c){if(x=[],w=0,this.db&&r){if(!f)for(k=d.length;k<r.length;k++){let e=r[k];if(e&&e.length)w++,x.push(e);else if(!l)return g?i:new rr(i,this)}}else for(let e,t,n=0;n<m.length;n+=2){if(e=this.tag.get(m[n]),!e){if(l)continue;return g?i:new rr(i,this)}if(t=(e=e&&e.get(m[n+1]))&&e.length)w++,x.push(e);else if(!l)return g?i:new rr(i,this)}if(w){if(a=sr(a,x,t,b,g),c=a.length,!c&&!l)return g?a:new rr(a,this);w--}}if(c)o[p]=s,i.push(a),p++;else if(1===d.length)return g?i:new rr(i,this)}if(v){if(this.db&&m&&m.length&&!f)for(y=0;y<m.length;y+=2){if(!(o=this.index.get(m[y]))){if(l)continue;return g?i:new rr(i,this)}v.push(o.db.tag(m[y+1],t,b,!1))}const r=this;return Promise.all(v).then(function(i){return n&&(n.resolve=g),i.length&&(i=r.search(e,t,n,i)),i})}if(!p)return g?i:new rr(i,this);if(a&&(!y||!this.store))return i=i[0],g?i:new rr(i,this);for(v=[],b=0;b<o.length;b++){if(m=i[b],y&&m.length&&void 0===m[0].doc&&(this.db?v.push(m=this.index.get(this.field[0]).db.enrich(m)):m=ur.call(this,m)),a)return g?h?nr(e,m,this.index,a,h):m:new rr(m,this);i[b]={field:o[b],result:m}}if(y&&this.db&&v.length){const t=this;return Promise.all(v).then(function(n){for(let e=0;e<n.length;e++)i[e].result=n[e];return h&&(i=nr(e,i,t.index,a,h)),s?lr(i):i})}return h&&(i=nr(e,i,this.index,a,h)),s?lr(i):i},(an=dr.prototype).mount=function(e){let t=this.field;if(this.tag)for(let e,r=0;r<this.F.length;r++){e=this.F[r];var n=void 0;this.index.set(e,n=new Tr({},this.reg)),t===this.field&&(t=t.slice(0)),t.push(e),n.tag=this.tag.get(e)}n=[];const r={db:e.db,type:e.type,fastupdate:e.fastupdate};for(let i,o,a=0;a<t.length;a++){r.field=o=t[a],i=this.index.get(o);const s=new e.constructor(e.id,r);s.id=e.id,n[a]=s.mount(i),i.document=!0,a?i.bypass=!0:i.store=this.store}const i=this;return this.db=Promise.all(n).then(function(){i.db=!0})},an.commit=async function(){const e=[];for(const t of this.index.values())e.push(t.commit());await Promise.all(e),this.reg.clear()},an.destroy=function(){const e=[];for(const t of this.index.values())e.push(t.destroy());return Promise.all(e)},an.append=function(e,t){return this.add(e,t,!0)},an.update=function(e,t){return this.remove(e).add(e,t)},an.remove=function(e){for(var t of(dn(e)&&(e=hn(e,this.key)),this.index.values()))t.remove(e,!0);if(this.reg.has(e)){if(this.tag&&!this.fastupdate)for(let n of this.tag.values())for(let r of n){t=r[0];const i=r[1],o=i.indexOf(e);o>-1&&(i.length>1?i.splice(o,1):n.delete(t))}this.store&&this.store.delete(e),this.reg.delete(e)}return this.cache&&this.cache.remove(e),this},an.clear=function(){const e=[];for(const t of this.index.values()){const n=t.clear();n.then&&e.push(n)}if(this.tag)for(const e of this.tag.values())e.clear();return this.store&&this.store.clear(),this.cache&&this.cache.clear(),e.length?Promise.all(e):this},an.contain=function(e){return this.db?this.index.get(this.field[0]).db.has(e):this.reg.has(e)},an.cleanup=function(){for(const e of this.index.values())e.cleanup();return this},an.get=function(e){return this.db?this.index.get(this.field[0]).db.enrich(e).then(function(e){return e[0]&&e[0].doc||null}):this.store.get(e)||null},an.set=function(e,t){return"object"==typeof e&&(e=hn(t=e,this.key)),this.store.set(e,t),this},an.searchCache=xn,an.export=function(e,t,n=0,r=0){if(n<this.field.length){const i=this.field[n];if((t=this.index.get(i).export(e,i,n,r=1))&&t.then){const r=this;return t.then(function(){return r.export(e,i,n+1)})}return this.export(e,i,n+1)}let i,o;switch(r){case 0:i="reg",o=br(this.reg),t=null;break;case 1:i="tag",o=this.tag&&mr(this.tag,this.reg.size),t=null;break;case 2:i="doc",o=this.store&&pr(this.store),t=null;break;default:return}return xr.call(this,e,t,i,o||null,n,r)},an.import=function(e,t){var n=e.split(".");"json"===n[n.length-1]&&n.pop();const r=n.length>2?n[0]:"";if(n=n.length>2?n[2]:n[1],this.worker&&r)return this.index.get(r).import(e);if(t){if("string"==typeof t&&(t=JSON.parse(t)),r)return this.index.get(r).import(n,t);switch(n){case"reg":this.fastupdate=!1,this.reg=vr(t,this.reg);for(let e,t=0;t<this.field.length;t++)e=this.index.get(this.field[t]),e.fastupdate=!1,e.reg=this.reg;if(this.worker){t=[];for(const n of this.index.values())t.push(n.import(e));return Promise.all(t)}break;case"tag":this.tag=yr(t,this.tag);break;case"doc":this.store=gr(t,this.store)}}},Fn(dr.prototype),Tr.prototype.remove=function(e,t){const n=this.reg.size&&(this.fastupdate?this.reg.get(e):this.reg.has(e));if(n){if(this.fastupdate){for(let t,r,i=0;i<n.length;i++)if((t=n[i])&&(r=t.length))if(t[r-1]===e)t.pop();else{const n=t.indexOf(e);n>=0&&t.splice(n,1)}}else kr(this.map,e),this.depth&&kr(this.ctx,e);t||this.reg.delete(e)}return this.db&&(this.commit_task.push({del:e}),this.M&&Mr(this)),this.cache&&this.cache.remove(e),this};const _r={memory:{resolution:1},performance:{resolution:3,fastupdate:!0,context:{depth:1,resolution:1}},match:{tokenize:"forward"},score:{resolution:9,context:{depth:2,resolution:3}}};function Ar(e,t,n,r,i,o,a){let s,l;if(!(s=t[n])||a&&!s[a]){if(a?((t=s||(t[n]=cn()))[a]=1,l=e.ctx,(s=l.get(a))?l=s:l.set(a,l=e.keystore?new Mn(e.keystore):new Map)):(l=e.map,t[n]=1),(s=l.get(n))?l=s:l.set(n,l=s=[]),o)for(let n,o=0;o<s.length;o++)if((n=s[o])&&n.includes(i)){if(o<=r)return;n.splice(n.indexOf(i),1),e.fastupdate&&(t=e.reg.get(i))&&t.splice(t.indexOf(n),1);break}if(l=l[r]||(l[r]=[]),l.push(i),l.length===2**31-1){if(t=new Tn(l),e.fastupdate)for(let n of e.reg.values())n.includes(l)&&(n[n.indexOf(l)]=t);s[r]=l=t}e.fastupdate&&((r=e.reg.get(i))?r.push(l):e.reg.set(i,[l]))}}function Cr(e,t,n,r,i){return n&&e>1?t+(r||0)<=e?n+(i||0):(e-1)/(t+(r||0))*(n+(i||0))+1|0:0}function Sr(e,t,n,r,i,o,a){let s=e.length,l=e;if(s>1)l=or(e,t,n,r,i,o,a);else if(1===s)return a?Yn.call(null,e[0],n,r):new rr(e[0],this);return a?l:new rr(l,this)}function jr(e,t,n,r,i,o,a){return e=Er(this,e,t,n,r,i,o,a),this.db?e.then(function(e){return i?e||[]:new rr(e,this)}):e&&e.length?i?Yn.call(this,e,n,r):new rr(e,this):i?[]:new rr([],this)}function Pr(e,t,n,r){let i=[];if(e&&e.length){if(e.length<=r)return void t.push(e);for(let t,n=0;n<r;n++)(t=e[n])&&(i[n]=t);if(i.length)return void t.push(i)}if(!n)return i}function Er(e,t,n,r,i,o,a,s){let l;return n&&(l=e.bidirectional&&t>n)&&(l=n,n=t,t=l),e.db?e.db.get(t,n,r,i,o,a,s):e=n?(e=e.ctx.get(n))&&e.get(t):e.map.get(t)}function Tr(e,t){if(!this||this.constructor!==Tr)return new Tr(e);if(e){var n=un(e)?e:e.preset;n&&(e=Object.assign({},_r[n],e))}else e={};const r=!0===(n=e.context)?{depth:1}:n||{},i=un(e.encoder)?Pn[e.encoder]:e.encode||e.encoder||{};this.encoder=i.encode?i:"object"==typeof i?new bn(i):{encode:i},this.resolution=e.resolution||9,this.tokenize=n=(n=e.tokenize)&&"default"!==n&&"exact"!==n&&n||"strict",this.depth="strict"===n&&r.depth||0,this.bidirectional=!1!==r.bidirectional,this.fastupdate=!!e.fastupdate,this.score=e.score||null,(n=e.keystore||0)&&(this.keystore=n),this.map=n?new Mn(n):new Map,this.ctx=n?new Mn(n):new Map,this.reg=t||(this.fastupdate?n?new Mn(n):new Map:n?new On(n):new Set),this.N=r.resolution||3,this.rtl=i.rtl||e.rtl||!1,this.cache=(n=e.cache||null)&&new wn(n),this.resolve=!1!==e.resolve,(n=e.db)&&(this.db=this.mount(n)),this.M=!1!==e.commit,this.commit_task=[],this.commit_timer=null,this.priority=e.priority||4}function Mr(e){e.commit_timer||(e.commit_timer=setTimeout(function(){e.commit_timer=null,e.db.commit(e)},1))}Tr.prototype.add=function(e,t,n,r){if(t&&(e||0===e)){if(!r&&!n&&this.reg.has(e))return this.update(e,t);r=this.depth;const c=(t=this.encoder.encode(t,!r)).length;if(c){const u=cn(),d=cn(),h=this.resolution;for(let f=0;f<c;f++){let p=t[this.rtl?c-1-f:f];var i=p.length;if(i&&(r||!d[p])){var o=this.score?this.score(t,p,f,null,0):Cr(h,c,f),a="";switch(this.tokenize){case"tolerant":if(Ar(this,d,p,o,e,n),i>2){for(let t,r,s,l,c=1;c<i-1;c++)t=p.charAt(c),r=p.charAt(c+1),s=p.substring(0,c)+r,l=p.substring(c+2),Ar(this,d,a=s+t+l,o,e,n),Ar(this,d,a=s+l,o,e,n);Ar(this,d,p.substring(0,p.length-1),o,e,n)}break;case"full":if(i>2){for(let r,l=0;l<i;l++)for(o=i;o>l;o--){a=p.substring(l,o),r=this.rtl?i-1-l:l;var s=this.score?this.score(t,p,f,a,r):Cr(h,c,f,i,r);Ar(this,d,a,s,e,n)}break}case"bidirectional":case"reverse":if(i>1){for(s=i-1;s>0;s--){a=p[this.rtl?i-1-s:s]+a;var l=this.score?this.score(t,p,f,a,s):Cr(h,c,f,i,s);Ar(this,d,a,l,e,n)}a=""}case"forward":if(i>1){for(s=0;s<i;s++)Ar(this,d,a+=p[this.rtl?i-1-s:s],o,e,n);break}default:if(Ar(this,d,p,o,e,n),r&&c>1&&f<c-1)for(i=this.N,a=p,o=Math.min(r+1,this.rtl?f+1:c-f),s=1;s<o;s++){p=t[this.rtl?c-1-f-s:f+s];Ar(this,u,(l=this.bidirectional&&p>a)?a:p,this.score?this.score(t,a,f,p,s-1):Cr(i+(c/2>i?0:1),c,f,o-1,s-1),e,n,l?p:a)}}}}this.fastupdate||this.reg.add(e)}}return this.db&&(this.commit_task.push(n?{ins:e}:{del:e}),this.M&&Mr(this)),this},Tr.prototype.search=function(e,t,n){if(n||(t||"object"!=typeof e?"object"==typeof t&&(n=t,t=0):(n=e,e="")),n&&n.cache)return n.cache=!1,e=this.searchCache(e,t,n),n.cache=!0,e;let r,i,o,a,s,l,c,u,d=[],h=0;n&&(e=n.query||e,t=n.limit||t,h=n.offset||0,i=n.context,o=n.suggest,u=(a=n.resolve)&&n.enrich,l=n.boost,c=n.resolution,s=this.db&&n.tag),void 0===a&&(a=this.resolve),i=this.depth&&!1!==i;let f=this.encoder.encode(e,!i);if(r=f.length,t=t||(a?100:0),1===r)return jr.call(this,f[0],"",t,h,a,u,s);if(2===r&&i&&!o)return jr.call(this,f[1],f[0],t,h,a,u,s);let p,g=cn(),m=0;if(i&&(p=f[0],m=1),c||0===c||(c=p?this.N:this.resolution),this.db){if(this.db.search&&!1!==(n=this.db.search(this,f,t,h,o,a,u,s)))return n;const e=this;return async function(){for(let t,n;m<r;m++){if((n=f[m])&&!g[n]){if(g[n]=1,t=await Er(e,n,p,0,0,!1,!1),t=Pr(t,d,o,c)){d=t;break}p&&(o&&t&&d.length||(p=n))}o&&p&&m===r-1&&!d.length&&(c=e.resolution,p="",m=-1,g=cn())}return Sr(d,c,t,h,o,l,a)}()}for(let e,t;m<r;m++){if((t=f[m])&&!g[t]){if(g[t]=1,e=Er(this,t,p,0,0,!1,!1),e=Pr(e,d,o,c)){d=e;break}p&&(o&&e&&d.length||(p=t))}o&&p&&m===r-1&&!d.length&&(c=this.resolution,p="",m=-1,g=cn())}return Sr(d,c,t,h,o,l,a)},(an=Tr.prototype).mount=function(e){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),e.mount(this)},an.commit=function(){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),this.db.commit(this)},an.destroy=function(){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),this.db.destroy()},an.clear=function(){return this.map.clear(),this.ctx.clear(),this.reg.clear(),this.cache&&this.cache.clear(),this.db?(this.commit_timer&&clearTimeout(this.commit_timer),this.commit_timer=null,this.commit_task=[],this.db.clear()):this},an.append=function(e,t){return this.add(e,t,!0)},an.contain=function(e){return this.db?this.db.has(e):this.reg.has(e)},an.update=function(e,t){const n=this,r=this.remove(e);return r&&r.then?r.then(()=>n.add(e,t)):this.add(e,t)},an.cleanup=function(){return this.fastupdate?(kr(this.map),this.depth&&kr(this.ctx),this):this},an.searchCache=xn,an.export=function(e,t,n=0,r=0){let i,o;switch(r){case 0:i="reg",o=br(this.reg);break;case 1:i="cfg",o=null;break;case 2:i="map",o=pr(this.map,this.reg.size);break;case 3:i="ctx",o=mr(this.ctx,this.reg.size);break;default:return}return xr.call(this,e,t,i,o,n,r)},an.import=function(e,t){if(t)switch("string"==typeof t&&(t=JSON.parse(t)),e=e.split("."),"json"===e[e.length-1]&&e.pop(),3===e.length&&e.shift(),e=e.length>1?e[1]:e[0],e){case"reg":this.fastupdate=!1,this.reg=vr(t,this.reg);break;case"map":this.map=gr(t,this.map);break;case"ctx":this.ctx=yr(t,this.ctx)}},an.serialize=function(e=!0){let t="",n="",r="";if(this.reg.size){let e;for(var i of this.reg.keys())e||(e=typeof i),t+=(t?",":"")+("string"===e?'"'+i+'"':i);t="index.reg=new Set(["+t+"]);",n=wr(this.map,e),n="index.map=new Map(["+n+"]);";for(const t of this.ctx.entries()){i=t[0];let n=wr(t[1],e);n="new Map(["+n+"])",n='["'+i+'",'+n+"]",r+=(r?",":"")+n}r="index.ctx=new Map(["+r+"]);"}return e?"function inject(index){"+t+n+r+"}":t+n+r},Fn(Tr.prototype);const Or="undefined"!=typeof window&&(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB),Dr=["map","ctx","tag","reg","cfg"],Br=cn();function Ir(e,t,n){const r=e.value;let i,o=0;for(let e,a=0;a<r.length;a++){if(e=n?r:r[a]){for(let n,o,s=0;s<t.length;s++)if(o=t[s],n=e.indexOf(o),n>=0){if(i=1,!(e.length>1)){r[a]=[];break}e.splice(n,1)}o+=e.length}if(n)break}o?i&&e.update(r):e.delete(),e.continue()}function Rr(e,t){return new Promise((n,r)=>{e.onsuccess=e.oncomplete=function(){t&&t(this.result),t=null,n(this.result)},e.onerror=e.onblocked=r,e=null})}an=function e(t,n={}){if(!this||this.constructor!==e)return new e(t,n);"object"==typeof t&&(n=t,t=t.name),t||console.info("Default storage space was used, because a name was not passed."),this.id="flexsearch"+(t?":"+t.toLowerCase().replace(/[^a-z0-9_\-]/g,""):""),this.field=n.field?n.field.toLowerCase().replace(/[^a-z0-9_\-]/g,""):"",this.type=n.type,this.fastupdate=this.support_tag_search=!1,this.db=null,this.h={}}.prototype,an.mount=function(e){return e.index?e.mount(this):(e.db=this,this.open())},an.open=function(){if(this.db)return this.db;let e=this;navigator.storage&&navigator.storage.persist&&navigator.storage.persist(),Br[e.id]||(Br[e.id]=[]),Br[e.id].push(e.field);const t=Or.open(e.id,1);return t.onupgradeneeded=function(){const t=e.db=this.result;for(let n,r=0;r<Dr.length;r++){n=Dr[r];for(let r,i=0;i<Br[e.id].length;i++)r=Br[e.id][i],t.objectStoreNames.contains(n+("reg"!==n&&r?":"+r:""))||t.createObjectStore(n+("reg"!==n&&r?":"+r:""))}},e.db=Rr(t,function(t){e.db=t,e.db.onversionchange=function(){e.close()}})},an.close=function(){this.db&&this.db.close(),this.db=null},an.destroy=function(){return Rr(Or.deleteDatabase(this.id))},an.clear=function(){const e=[];for(let t,n=0;n<Dr.length;n++){t=Dr[n];for(let n,r=0;r<Br[this.id].length;r++)n=Br[this.id][r],e.push(t+("reg"!==t&&n?":"+n:""))}const t=this.db.transaction(e,"readwrite");for(let n=0;n<e.length;n++)t.objectStore(e[n]).clear();return Rr(t)},an.get=function(e,t,n=0,r=0,i=!0,o=!1){e=this.db.transaction((t?"ctx":"map")+(this.field?":"+this.field:""),"readonly").objectStore((t?"ctx":"map")+(this.field?":"+this.field:"")).get(t?t+":"+e:e);const a=this;return Rr(e).then(function(e){let t=[];if(!e||!e.length)return t;if(i){if(!n&&!r&&1===e.length)return e[0];for(let i,o=0;o<e.length;o++)if((i=e[o])&&i.length){if(r>=i.length){r-=i.length;continue}const e=n?r+Math.min(i.length-r,n):i.length;for(let n=r;n<e;n++)t.push(i[n]);if(r=0,t.length===n)break}return o?a.enrich(t):t}return e})},an.tag=function(e,t=0,n=0,r=!1){e=this.db.transaction("tag"+(this.field?":"+this.field:""),"readonly").objectStore("tag"+(this.field?":"+this.field:"")).get(e);const i=this;return Rr(e).then(function(e){return!e||!e.length||n>=e.length?[]:t||n?(e=e.slice(n,n+t),r?i.enrich(e):e):e})},an.enrich=function(e){"object"!=typeof e&&(e=[e]);const t=this.db.transaction("reg","readonly").objectStore("reg"),n=[];for(let r=0;r<e.length;r++)n[r]=Rr(t.get(e[r]));return Promise.all(n).then(function(t){for(let n=0;n<t.length;n++)t[n]={id:e[n],doc:t[n]?JSON.parse(t[n]):null};return t})},an.has=function(e){return Rr(e=this.db.transaction("reg","readonly").objectStore("reg").getKey(e)).then(function(e){return!!e})},an.search=null,an.info=function(){},an.transaction=function(e,t,n){e+="reg"!==e&&this.field?":"+this.field:"";let r=this.h[e+":"+t];if(r)return n.call(this,r);let i=this.db.transaction(e,t);this.h[e+":"+t]=r=i.objectStore(e);const o=n.call(this,r);return this.h[e+":"+t]=null,Rr(i).finally(function(){return o})},an.commit=async function(e){let t=e.commit_task,n=[];e.commit_task=[];for(let e,r=0;r<t.length;r++)e=t[r],e.del&&n.push(e.del);n.length&&await this.remove(n),e.reg.size&&(await this.transaction("map","readwrite",function(t){for(const n of e.map){const e=n[0],r=n[1];r.length&&(t.get(e).onsuccess=function(){let n=this.result;var i;if(n&&n.length){const e=Math.max(n.length,r.length);for(let t,o,a=0;a<e;a++)if((o=r[a])&&o.length){if((t=n[a])&&t.length)for(i=0;i<o.length;i++)t.push(o[i]);else n[a]=o;i=1}}else n=r,i=1;i&&t.put(n,e)})}}),await this.transaction("ctx","readwrite",function(t){for(const n of e.ctx){const e=n[0],r=n[1];for(const n of r){const r=n[0],i=n[1];i.length&&(t.get(e+":"+r).onsuccess=function(){let n=this.result;var o;if(n&&n.length){const e=Math.max(n.length,i.length);for(let t,r,a=0;a<e;a++)if((r=i[a])&&r.length){if((t=n[a])&&t.length)for(o=0;o<r.length;o++)t.push(r[o]);else n[a]=r;o=1}}else n=i,o=1;o&&t.put(n,e+":"+r)})}}}),e.store?await this.transaction("reg","readwrite",function(t){for(const n of e.store){const e=n[0],r=n[1];t.put("object"==typeof r?JSON.stringify(r):1,e)}}):e.bypass||await this.transaction("reg","readwrite",function(t){for(const n of e.reg.keys())t.put(1,n)}),e.tag&&await this.transaction("tag","readwrite",function(t){for(const n of e.tag){const e=n[0],r=n[1];r.length&&(t.get(e).onsuccess=function(){let n=this.result;n=n&&n.length?n.concat(r):r,t.put(n,e)})}}),e.map.clear(),e.ctx.clear(),e.tag&&e.tag.clear(),e.store&&e.store.clear(),e.document||e.reg.clear())},an.remove=function(e){return"object"!=typeof e&&(e=[e]),Promise.all([this.transaction("map","readwrite",function(t){t.openCursor().onsuccess=function(){const t=this.result;t&&Ir(t,e)}}),this.transaction("ctx","readwrite",function(t){t.openCursor().onsuccess=function(){const t=this.result;t&&Ir(t,e)}}),this.transaction("tag","readwrite",function(t){t.openCursor().onsuccess=function(){const t=this.result;t&&Ir(t,e,!0)}}),this.transaction("reg","readwrite",function(t){for(let n=0;n<e.length;n++)t.delete(e[n])})])};const $r=dr;let Kr=null,qr=!1;async function Lr(){return await ye()}function Fr(e,t){const{positive:n,negative:r,phrases:i,regular:o,regexPatterns:a=[]}=t,s=[e.title||"",e.url||"",e.description||"",e.domain||"",e.category||"",Array.isArray(e.keywords)?e.keywords.join(" "):""].join(" ").toLowerCase(),l=[e.title||"",e.url||"",e.description||"",e.domain||"",e.category||"",Array.isArray(e.keywords)?e.keywords.join(" "):""].join(" ");for(const e of n)if(!s.includes(e))return!1;for(const e of r)if(s.includes(e))return!1;for(const e of i)if(!s.includes(e))return!1;for(const e of a){const t=e.flags.includes("i")?s:l;if(!e.test(t))return!1}if(o.length>0){if(!o.some(e=>s.includes(e)))return!1}return!0}function zr(e,t){const{positive:n,phrases:r,regular:i,regexPatterns:o=[]}=t;let a=0;const s=(e.title||"").toLowerCase(),l=(e.url||"").toLowerCase(),c=(e.domain||"").toLowerCase(),u=(e.description||"").toLowerCase(),d=(e.category||"").toLowerCase(),h=[...n,...r,...i];for(const e of h)s.includes(e)&&(a+=10,s.startsWith(e)&&(a+=5)),c.includes(e)&&(a+=5),d.includes(e)&&(a+=4),u.includes(e)&&(a+=2),l.includes(e)&&(a+=1);for(const t of o)t.test(e.title||"")&&(a+=8),t.test(e.url||"")&&(a+=3),t.test(e.description||"")&&(a+=2);return a}async function Nr(){if(qr)return Kr;console.log("Initializing FlexSearch index...");const e=await async function(e){try{const t=await me.cache.get(e);return t?t.ttl&&Date.now()-t.timestamp>t.ttl?(await me.cache.delete(e),null):t.value:null}catch(e){return console.error("Error getting cache:",e),null}}("flexsearch_index");if(e&&e.serialized)try{Kr=new $r({document:{id:"id",index:["title","url","description","keywords","category","domain"],store:!0},tokenize:"forward",cache:!0,optimize:!0,resolution:9,context:{depth:3,bidirectional:!0}});const t=Object.keys(e.serialized);for(const n of t)await Kr.import(n,e.serialized[n]);return qr=!0,console.log("Loaded FlexSearch index from cache"),Kr}catch(e){console.error("Error loading cached index:",e)}return await async function(){console.log("Building FlexSearch index..."),Kr=new $r({document:{id:"id",index:["title","url","description","keywords","category","domain"],store:!0},tokenize:"forward",cache:!0,optimize:!0,resolution:9,context:{depth:3,bidirectional:!0}});const e=await Lr();for(const t of e)await Wr(t,!1);qr=!0;try{const t={};await Kr.export((e,n)=>{t[e]=n}),await be("flexsearch_index",{serialized:t,timestamp:Date.now()}),console.log(`Indexed ${e.length} bookmarks`)}catch(e){console.error("Error caching index:",e)}return Kr}(),Kr}async function Wr(e,t=!0){Kr||await Nr();const n={id:e.id,title:e.title||"",url:e.url||"",description:e.description||"",keywords:Array.isArray(e.keywords)?e.keywords.join(" "):"",category:e.category||"",domain:e.domain||""};await Kr.add(n),t&&await async function(){if(!Kr)return;try{const e={};await Kr.export((t,n)=>{e[t]=n}),await be("flexsearch_index",{serialized:e,timestamp:Date.now()})}catch(e){console.error("Error caching index:",e)}}()}async function Ur(e,t=null,n={}){!t||t.domains||Array.isArray(t.domains)||(n=t,t=null);const{limit:r=50,offset:i=0,computeStats:o=!1}=n;let a=await Lr();if(t){const e=Date.now()-2592e6;a=a.filter(n=>{if(t.domains&&t.domains.length>0){const e=(n.domain||"").toLowerCase();if(!t.domains.some(t=>e.includes(t.toLowerCase())))return!1}if(t.folders&&t.folders.length>0){const e=(n.folderPath||"").toLowerCase();if(!t.folders.some(t=>e.includes(t.toLowerCase())))return!1}if(t.topics&&t.topics.length>0){const e=n.topics||[];if(!t.topics.some(t=>e.some(e=>e.toLowerCase()===t.toLowerCase()||e.toLowerCase().startsWith(t.toLowerCase()+"/"))))return!1}if(t.types&&t.types.length>0){const e=(n.contentType||"").toLowerCase();if(!t.types.some(t=>e===t.toLowerCase()))return!1}if(t.creators&&t.creators.length>0){const e=`${n.platform||"other"}:${n.creator}`;if(!t.creators.some(t=>t.key===e))return!1}if(t.tags&&t.tags.length>0){if(!n.tags||!Array.isArray(n.tags))return!1;if(!t.tags.some(e=>n.tags.includes(e)))return!1}if(t.deadLinks&&!1!==n.isAlive)return!1;if(t.stale){const t=n.dateAdded<e,r=!n.accessCount||0===n.accessCount,i=!1!==n.isAlive;if(!(t&&r&&i))return!1}if(t.dateRange){const{startDate:e,endDate:r}=t.dateRange;if(n.dateAdded<e||n.dateAdded>r)return!1}if(t.readingTimeRange){const{min:e,max:r}=t.readingTimeRange,i=n.readingTime||0;if(null!=e&&i<e)return!1;if(null!=r&&i>r)return!1}if(t.qualityScoreRange){const{min:e,max:r}=t.qualityScoreRange,i=n.qualityScore||0;if(null!=e&&i<e)return!1;if(null!=r&&i>r)return!1}if(null!==t.hasPublishedDate&&void 0!==t.hasPublishedDate){const e=Boolean(n.publishedDate||n.rawMetadata?.publishedDate);if(t.hasPublishedDate!==e)return!1}return!0})}if(!e||!e.trim()){const e=ie(n.sortBy||"date_desc"),t={results:a.sort(e).slice(i,i+r),total:a.length,hasMore:i+r<a.length,parsedQuery:null};return o&&(t.stats=Hr(a)),t}const{filters:s,remainingQuery:l}=function(e){if(!e||!e.trim())return{filters:{},remainingQuery:""};const t={};let n=e;const r=n.match(/category:(\S+)/i);r&&(t.category=r[1].toLowerCase(),n=n.replace(r[0],"").trim());const i=n.match(/domain:(\S+)/i);i&&(t.domain=i[1].toLowerCase(),n=n.replace(i[0],"").trim());const o=n.match(/platform:(\S+)/i);o&&(t.platform=o[1].toLowerCase(),n=n.replace(o[0],"").trim());const a=n.match(/channel:(@?\S+)/i);a&&(t.creator=a[1],n=n.replace(a[0],"").trim());const s=n.match(/author:(@?\S+)/i);s&&(t.creator=s[1],n=n.replace(s[0],"").trim());const l=n.match(/repo:(\S+)/i);l&&(t.repo=l[1].toLowerCase(),n=n.replace(l[0],"").trim());const c=n.match(/type:(\S+)/i);c&&(t.contentType=c[1].toLowerCase(),n=n.replace(c[0],"").trim());const u=n.match(/hasimage:(yes|no)/i);u&&(t.hasImage="yes"===u[1].toLowerCase(),n=n.replace(u[0],"").trim());const d=n.match(/playlist:(\S+)/i);d&&(t.playlist=d[1],n=n.replace(d[0],"").trim());const h=n.match(/accessed:(yes|no)/i);h&&(t.accessed="yes"===h[1].toLowerCase(),n=n.replace(h[0],"").trim());const f=n.match(/stale:(yes|no)/i);f&&(t.stale="yes"===f[1].toLowerCase(),n=n.replace(f[0],"").trim());const p=n.match(/enriched:(yes|no)/i);p&&(t.enriched="yes"===p[1].toLowerCase(),n=n.replace(p[0],"").trim());const g=n.match(/dead:(yes|no)/i);g&&(t.dead="yes"===g[1].toLowerCase(),n=n.replace(g[0],"").trim());const m=n.match(/folder:(?:"([^"]+)"|(\S+))/i);return m&&(t.folder=(m[1]||m[2]).toLowerCase(),n=n.replace(m[0],"").trim()),{filters:t,remainingQuery:n}}(e),c=function(e){if(!e||!e.trim())return{positive:[],negative:[],phrases:[],regular:[],regexPatterns:[],hasModifiers:!1};const t=[],n=[],r=[],i=[],o=[],a=/\/([^\/]+)\/([gimsuvy]*)?/g;let s,l=e;for(;null!==(s=a.exec(e));)try{const e=s[1],t=s[2]||"i",n=new RegExp(e,t);o.push(n)}catch(e){console.warn("Invalid regex pattern:",s[0],e.message)}l=l.replace(/\/[^\/]+\/[gimsuvy]*/g,"").trim();const c=/([+-]?)"([^"]+)"/g;for(;null!==(s=c.exec(l));){const e=s[1],i=s[2].toLowerCase();"+"===e?t.push(i):"-"===e?n.push(i):r.push(i)}l=l.replace(/[+-]?"[^"]+"/g,"").trim();const u=l.split(/\s+/).filter(e=>e.length>0);for(const e of u){const r=e.toLowerCase();e.startsWith("+")&&e.length>1?t.push(r.slice(1)):e.startsWith("-")&&e.length>1?n.push(r.slice(1)):i.push(r)}return{positive:t,negative:n,phrases:r,regular:i,regexPatterns:o,hasModifiers:t.length>0||n.length>0||r.length>0||o.length>0}}(l);if(Object.keys(s).length>0&&(a=function(e,t){const n=Date.now()-2592e6;return e.filter(e=>{if(t.category&&(e.category||"uncategorized").toLowerCase()!==t.category)return!1;if(t.domain&&!(e.domain||"").toLowerCase().includes(t.domain))return!1;if(void 0!==t.accessed){const n=e.accessCount&&e.accessCount>0;if(t.accessed!==n)return!1}if(t.stale){const t=e.dateAdded<n,r=!e.accessCount||0===e.accessCount,i=!1!==e.isAlive;if(!(t&&r&&i))return!1}if(void 0!==t.enriched){const n=Boolean(e.description||e.keywords&&e.keywords.length>0||e.contentSnippet);if(t.enriched!==n)return!1}if(void 0!==t.dead){const n=!1===e.isAlive;if(t.dead!==n)return!1}if(t.folder&&!(e.folderPath||"").toLowerCase().includes(t.folder))return!1;if(t.platform&&(e.platform||"other").toLowerCase()!==t.platform)return!1;if(t.creator){const n=(e.creator||"").toLowerCase(),r=t.creator.toLowerCase();if(!n.includes(r)&&!n.includes(r.replace(/^@/,""))&&!`@${n}`.includes(r))return!1}if(t.repo&&!(e.platformData?.extra?.owner&&e.platformData?.extra?.repo?`${e.platformData.extra.owner}/${e.platformData.extra.repo}`.toLowerCase():"").includes(t.repo))return!1;if(t.contentType){const n=(e.contentType||"").toLowerCase();if(!t.contentType.split("|").map(e=>e.trim()).includes(n))return!1}if(void 0!==t.hasImage){const n=Boolean(e.platformData?.extra?.thumbnail||e.rawMetadata?.openGraph?.["og:image"]||e.rawMetadata?.twitterCard?.["twitter:image"]);if(t.hasImage!==n)return!1}return!(t.playlist&&!(e.platformData?.extra?.playlistId||"").includes(t.playlist))})}(a,s)),l.trim()){if(c.regular.length>0)try{const e=await Nr(),t=c.regular.join(" "),n=await e.search(t,{limit:1e4,suggest:!0}),r=new Set;Array.isArray(n)&&n.forEach(e=>{e&&Array.isArray(e.result)&&e.result.forEach(e=>r.add(e))}),a=a.filter(e=>r.has(e.id)),a=a.filter(e=>Fr(e,c))}catch(e){console.error("FlexSearch failed, falling back to manual search:",e),a=a.filter(e=>Fr(e,c))}else a=a.filter(e=>Fr(e,c));a=a.map(e=>({...e,_searchScore:zr(e,c)}));const e=ie(n.sortBy||"relevance");a.sort(e)}else{const e=ie(n.sortBy||"date_desc");a.sort(e)}const u=a.length,d={results:a.slice(i,i+r),total:u,hasMore:i+r<u,parsedQuery:c,specialFilters:s};return o&&(d.stats=Hr(a)),d}function Hr(e){const t=new Map,n=new Map,r=new Map,i=new Map,o=new Map,a=Date.now(),s=864e5,l=7*s,c=14*s,u=90*s,d=180*s,h=new Date,f=h.getFullYear(),p=new Date(f,h.getMonth(),1).getTime(),g=new Date(f,0,1).getTime();let m=0,y=0,b=0,v=0,x=0,w=0,k=0;for(const s of e){if(s.domain){const e=t.get(s.domain)||{count:0,latestDate:0};e.count++,s.dateAdded>e.latestDate&&(e.latestDate=s.dateAdded),t.set(s.domain,e)}if(s.folderPath){const e=n.get(s.folderPath)||0;n.set(s.folderPath,e+1)}const e=s.topics||[];for(const t of e)r.set(t,(r.get(t)||0)+1);if(s.creator){const e=`${s.platform||"other"}:${s.creator}`;i.has(e)||i.set(e,{creator:s.creator,platform:s.platform||"other",count:0}),i.get(e).count++}s.contentType&&o.set(s.contentType,(o.get(s.contentType)||0)+1);const h=s.dateAdded;a-h<l&&m++,a-h<c&&y++,h>=p&&b++,a-h<u&&v++,a-h<d&&x++,h>=g&&w++,h<g&&k++}return{domains:Array.from(t.entries()).map(([e,t])=>({domain:e,count:t.count,latestDate:t.latestDate})).sort((e,t)=>t.count-e.count),folders:Array.from(n.entries()).map(([e,t])=>({folder:e,count:t})).sort((e,t)=>t.count-e.count),topics:Array.from(r.entries()).map(([e,t])=>({topic:e,count:t})).sort((e,t)=>t.count-e.count),creators:Array.from(i.values()).sort((e,t)=>t.count-e.count),contentTypes:Array.from(o.entries()).map(([e,t])=>({type:e,count:t})).sort((e,t)=>t.count-e.count),dateCounts:{week:m,twoWeek:y,month:b,threeMonth:v,sixMonth:x,year:w,older:k}}}function Vr(e,t,n){const r=e.slice();return r[11]=t[n],r}function Qr(e){let t,n;return{c(){t=m("svg"),n=m("path"),x(n,"d","M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"),x(t,"class","w-4 h-4"),x(t,"fill","currentColor"),x(t,"viewBox","0 0 20 20")},m(e,r){h(e,t,r),d(t,n)},d(e){e&&f(t)}}}function Yr(e){let t,n;return{c(){t=m("svg"),n=m("path"),x(n,"fill-rule","evenodd"),x(n,"d","M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z"),x(n,"clip-rule","evenodd"),x(t,"class","w-4 h-4"),x(t,"fill","currentColor"),x(t,"viewBox","0 0 20 20")},m(e,r){h(e,t,r),d(t,n)},d(e){e&&f(t)}}}function Gr(t){let n,r,i;return r=new on({props:{compact:!0}}),r.$on("filter",t[9]),{c(){n=g("div"),Q(r.$$.fragment),x(n,"class","w-48 border-r border-gray-200 dark:border-gray-800 overflow-y-auto bg-gray-50 dark:bg-gray-800")},m(e,t){h(e,n,t),Y(r,n,null),i=!0},p:e,i(e){i||(W(r.$$.fragment,e),i=!0)},o(e){U(r.$$.fragment,e),i=!1},d(e){e&&f(n),G(r)}}}function Jr(e){let t,n,i=[],o=new Map,a=H(e[0]);const s=e=>e[11].id;for(let t=0;t<a.length;t+=1){let n=Vr(e,a,t),r=s(n);o.set(r,i[t]=ti(r,n))}return{c(){t=g("div");for(let e=0;e<i.length;e+=1)i[e].c();x(t,"class","space-y-3")},m(e,r){h(e,t,r);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);n=!0},p(e,n){1&n&&(a=H(e[0]),z(),i=function(e,t,n,i,o,a,s,l,c,u,d,h){let f=e.length,p=a.length,g=f;const m={};for(;g--;)m[e[g].key]=g;const y=[],b=new Map,v=new Map,x=[];for(g=p;g--;){const e=h(o,a,g),r=n(e);let l=s.get(r);l?i&&x.push(()=>l.p(e,t)):(l=u(r,e),l.c()),b.set(r,y[g]=l),r in m&&v.set(r,Math.abs(g-m[r]))}const w=new Set,k=new Set;function _(e){W(e,1),e.m(l,d),s.set(e.key,e),d=e.first,p--}for(;f&&p;){const t=y[p-1],n=e[f-1],r=t.key,i=n.key;t===n?(d=t.first,f--,p--):b.has(i)?!s.has(r)||w.has(r)?_(t):k.has(i)?f--:v.get(r)>v.get(i)?(k.add(r),_(t)):(w.add(i),f--):(c(n,s),f--)}for(;f--;){const t=e[f];b.has(t.key)||c(t,s)}for(;p;)_(y[p-1]);return r(x),y}(i,n,s,1,e,a,o,t,V,ti,null,Vr),N())},i(e){if(!n){for(let e=0;e<a.length;e+=1)W(i[e]);n=!0}},o(e){for(let e=0;e<i.length;e+=1)U(i[e]);n=!1},d(e){e&&f(t);for(let e=0;e<i.length;e+=1)i[e].d()}}}function Xr(t){let n;function r(e,t){return e[3]?ri:ni}let i=r(t),o=i(t);return{c(){n=g("div"),o.c(),x(n,"class","text-center text-gray-500 dark:text-gray-400 mt-10 p-4")},m(e,t){h(e,n,t),o.m(n,null)},p(e,t){i===(i=r(e))&&o?o.p(e,t):(o.d(1),o=i(e),o&&(o.c(),o.m(n,null)))},i:e,o:e,d(e){e&&f(n),o.d()}}}function Zr(t){let n,r,i,o,a,s,l,c;return{c(){n=g("div"),r=g("p"),i=y("Error: "),o=y(t[2]),a=b(),s=g("button"),s.textContent="Retry",x(s,"class","mt-2 px-3 py-1 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors"),x(n,"class","p-4 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 rounded-lg text-sm text-center")},m(e,u){h(e,n,u),d(n,r),d(r,i),d(r,o),d(n,a),d(n,s),l||(c=v(s,"click",t[7]),l=!0)},p(e,t){4&t&&w(o,e[2])},i:e,o:e,d(e){e&&f(n),l=!1,c()}}}function ei(t){let n;return{c(){n=g("div"),n.innerHTML='<div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 dark:border-blue-400"></div>',x(n,"class","flex items-center justify-center h-32")},m(e,t){h(e,n,t)},p:e,i:e,o:e,d(e){e&&f(n)}}}function ti(e,t){let n,r,i;return r=new Je({props:{bookmark:t[11],compact:!0}}),{key:e,first:null,c(){n=y(""),Q(r.$$.fragment),this.first=n},m(e,t){h(e,n,t),Y(r,e,t),i=!0},p(e,n){t=e;const i={};1&n&&(i.bookmark=t[11]),r.$set(i)},i(e){i||(W(r.$$.fragment,e),i=!0)},o(e){U(r.$$.fragment,e),i=!1},d(e){e&&f(n),G(r,e)}}}function ni(t){let n;return{c(){n=g("p"),n.textContent="No bookmarks found"},m(e,t){h(e,n,t)},p:e,d(e){e&&f(n)}}}function ri(e){let t,n,r,i;return{c(){t=g("p"),n=y('No bookmarks found for "'),r=y(e[3]),i=y('"')},m(e,o){h(e,t,o),d(t,n),d(t,r),d(t,i)},p(e,t){8&t&&w(r,e[3])},d(e){e&&f(t)}}}function ii(e){let t,n,i,o,a,s,l,c,u,p,m,k,_,A,C,S,j,P,E,T,M,O,D,B,I,R,$,K,q,L=e[0].length+"",F=1!==e[0].length?"s":"";function H(e,t){return e[5]?Yr:Qr}let V=H(e),J=V(e);C=new ht({}),C.$on("search",e[8]);let X=e[4]&&Gr(e);const Z=[ei,Zr,Xr,Jr],ee=[];function te(e,t){return e[1]?0:e[2]?1:0===e[0].length?2:3}return I=te(e),R=ee[I]=Z[I](e),{c(){t=g("div"),n=g("div"),i=g("div"),o=g("h1"),o.textContent="Bookmark Insight",a=b(),s=g("div"),l=g("button"),J.c(),u=b(),p=g("button"),p.innerHTML='<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z"></path></svg>',m=b(),k=g("button"),k.textContent="Dashboard",_=b(),A=g("div"),Q(C.$$.fragment),S=b(),j=g("div"),P=y(L),E=y(" bookmark"),T=y(F),M=b(),O=g("div"),X&&X.c(),D=b(),B=g("div"),R.c(),x(o,"class","text-lg font-semibold text-gray-900 dark:text-gray-100"),x(l,"class","p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700"),x(l,"title",c=e[5]?"Switch to light mode":"Switch to dark mode"),x(p,"class","p-2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 rounded-md hover:bg-gray-100 dark:hover:bg-gray-700"),x(p,"title","Toggle Filters"),x(k,"class","px-3 py-1 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-700"),x(s,"class","flex space-x-2"),x(i,"class","flex items-center justify-between mb-3"),x(A,"class","mb-4"),x(j,"class","text-xs text-gray-500 dark:text-gray-400"),x(n,"class","p-4 border-b border-gray-200 dark:border-gray-800 bg-gray-50 dark:bg-gray-800"),x(B,"class","flex-1 overflow-y-auto p-4 bg-white dark:bg-gray-900"),x(O,"class","flex flex-1 overflow-hidden"),x(t,"class","w-96 h-96 bg-white dark:bg-gray-900 flex flex-col transition-colors")},m(r,c){h(r,t,c),d(t,n),d(n,i),d(i,o),d(i,a),d(i,s),d(s,l),J.m(l,null),d(s,u),d(s,p),d(s,m),d(s,k),d(n,_),d(n,A),Y(C,A,null),d(n,S),d(n,j),d(j,P),d(j,E),d(j,T),d(t,M),d(t,O),X&&X.m(O,null),d(O,D),d(O,B),ee[I].m(B,null),$=!0,K||(q=[v(l,"click",e[6]),v(p,"click",e[10]),v(k,"click",ai)],K=!0)},p(e,[t]){V!==(V=H(e))&&(J.d(1),J=V(e),J&&(J.c(),J.m(l,null))),(!$||32&t&&c!==(c=e[5]?"Switch to light mode":"Switch to dark mode"))&&x(l,"title",c),(!$||1&t)&&L!==(L=e[0].length+"")&&w(P,L),(!$||1&t)&&F!==(F=1!==e[0].length?"s":"")&&w(T,F),e[4]?X?(X.p(e,t),16&t&&W(X,1)):(X=Gr(e),X.c(),W(X,1),X.m(O,D)):X&&(z(),U(X,1,1,()=>{X=null}),N());let n=I;I=te(e),I===n?ee[I].p(e,t):(z(),U(ee[n],1,1,()=>{ee[n]=null}),N(),R=ee[I],R?R.p(e,t):(R=ee[I]=Z[I](e),R.c()),W(R,1),R.m(B,null))},i(e){$||(W(C.$$.fragment,e),W(X),W(R),$=!0)},o(e){U(C.$$.fragment,e),U(X),U(R),$=!1},d(e){e&&f(t),J.d(),G(C),X&&X.d(),ee[I].d(),K=!1,r(q)}}}function oi(e){e?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}function ai(){chrome.tabs.create({url:chrome.runtime.getURL("dashboard.html")}),window.close()}function si(e,t,n){let r=[],i=!0,o=null,a="",s=!1,l=!1;async function c(){n(0,r=await ye())}return j(async()=>{const e=await chrome.storage.local.get("darkMode");n(5,l=e.darkMode||!1),oi(l);try{await c()}catch(e){n(2,o=e.message)}finally{n(1,i=!1)}}),[r,i,o,a,s,l,async function(){n(5,l=!l),oi(l),await chrome.storage.local.set({darkMode:l})},c,async function(e){const t=e.detail.query;n(3,a=t);try{n(1,i=!0);const e=await Ur(t);n(0,r=e.results||[])}catch(e){n(2,o=e.message)}finally{n(1,i=!1)}},async function(e){const{type:t,value:a}=e.detail;try{switch(n(1,i=!0),t){case"clear":n(0,r=await ye());break;case"domain":n(0,r=await async function(e){try{return await me.bookmarks.where("domain").equals(e).toArray()}catch(e){return console.error("Error getting bookmarks by domain:",e),[]}}(a));break;case"folder":n(0,r=await async function(e){try{return(await ye()).filter(t=>t.folderPath===e)}catch(e){return console.error("Error getting bookmarks by folder:",e),[]}}(a));break;case"date":n(0,r=await async function(e,t){try{return await me.bookmarks.where("dateAdded").between(e,t,!0,!0).toArray()}catch(e){return console.error("Error getting bookmarks by date range:",e),[]}}(a.startDate,a.endDate))}}catch(e){n(2,o=e.message)}finally{n(1,i=!1)}},function(){n(4,s=!s)}]}const li=new class extends Z{constructor(e){super(),X(this,e,si,ii,o,{})}}({target:document.body});var ci=Object.freeze({__proto__:null,default:{}});export{li as default};
