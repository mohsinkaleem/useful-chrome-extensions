function e(){}function t(e){return e()}function n(){return Object.create(null)}function r(e){e.forEach(t)}function i(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let s,a;function c(e,t){return e===t||(s||(s=document.createElement("a")),s.href=t,e===s.href)}function l(t,...n){if(null==t){for(const e of n)e(void 0);return e}const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function u(e,t,n){e.$$.on_destroy.push(l(t,n))}function h(e,t){e.appendChild(t)}function f(e,t,n){e.insertBefore(t,n||null)}function d(e){e.parentNode&&e.parentNode.removeChild(e)}function p(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function g(e){return document.createElement(e)}function m(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function y(e){return document.createTextNode(e)}function v(){return y(" ")}function b(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function w(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function x(e,t){t=""+t,e.data!==t&&(e.data=t)}function k(e,t){e.value=null==t?"":t}function _(e,t,n){e.classList.toggle(t,!!n)}function A(e){a=e}function C(){if(!a)throw new Error("Function called outside component initialization");return a}function S(e){C().$$.on_mount.push(e)}function j(){const e=C();return(t,n,{cancelable:r=!1}={})=>{const i=e.$$.callbacks[t];if(i){const o=function(e,t,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:r})}(t,n,{cancelable:r});return i.slice().forEach(t=>{t.call(e,o)}),!o.defaultPrevented}return!0}}const P=[],E=[];let T=[];const O=[],D=Promise.resolve();let M=!1;function R(e){T.push(e)}const B=new Set;let I=0;function K(){if(0!==I)return;const e=a;do{try{for(;I<P.length;){const e=P[I];I++,A(e),$(e.$$)}}catch(e){throw P.length=0,I=0,e}for(A(null),P.length=0,I=0;E.length;)E.pop()();for(let e=0;e<T.length;e+=1){const t=T[e];B.has(t)||(B.add(t),t())}T.length=0}while(P.length);for(;O.length;)O.pop()();M=!1,B.clear(),A(e)}function $(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(R)}}const q=new Set;let F;function L(){F={r:0,c:[],p:F}}function z(){F.r||r(F.c),F=F.p}function N(e,t){e&&e.i&&(q.delete(e),e.i(t))}function W(e,t,n,r){if(e&&e.o){if(q.has(e))return;q.add(e),F.c.push(()=>{q.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}else r&&r()}function U(e){return void 0!==e?.length?e:Array.from(e)}function Q(e,t){W(e,1,1,()=>{t.delete(e.key)})}function H(e){e&&e.c()}function V(e,n,o){const{fragment:s,after_update:a}=e.$$;s&&s.m(n,o),R(()=>{const n=e.$$.on_mount.map(t).filter(i);e.$$.on_destroy?e.$$.on_destroy.push(...n):r(n),e.$$.on_mount=[]}),a.forEach(R)}function Y(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];T.forEach(r=>-1===e.indexOf(r)?t.push(r):n.push(r)),n.forEach(e=>e()),T=t}(n.after_update),r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function G(e,t){-1===e.$$.dirty[0]&&(P.push(e),M||(M=!0,D.then(K)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function J(t,i,o,s,c,l,u=null,h=[-1]){const f=a;A(t);const p=t.$$={fragment:null,ctx:[],props:l,update:e,not_equal:c,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(i.context||(f?f.$$.context:[])),callbacks:n(),dirty:h,skip_bound:!1,root:i.target||f.$$.root};u&&u(p.root);let g=!1;if(p.ctx=o?o(t,i.props||{},(e,n,...r)=>{const i=r.length?r[0]:n;return p.ctx&&c(p.ctx[e],p.ctx[e]=i)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](i),g&&G(t,e)),n}):[],p.update(),g=!0,r(p.before_update),p.fragment=!!s&&s(p.ctx),i.target){if(i.hydrate){const e=function(e){return Array.from(e.childNodes)}(i.target);p.fragment&&p.fragment.l(e),e.forEach(d)}else p.fragment&&p.fragment.c();i.intro&&N(t.$$.fragment),V(t,i.target,i.anchor),K()}A(f)}class X{$$=void 0;$$set=void 0;$destroy(){Y(this,1),this.$destroy=e}$on(t,n){if(!i(n))return e;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const e=r.indexOf(n);-1!==e&&r.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Z(e){return new Date(e).toLocaleDateString()}function ee(e){if(e.faviconUrl)return e.faviconUrl;if(e.url&&(e.url.startsWith("http://")||e.url.startsWith("https://")))try{return`https://www.google.com/s2/favicons?domain=${e.domain||new URL(e.url).hostname}&sz=32`}catch(e){}return function(e){if(e.url.startsWith("http://")||e.url.startsWith("https://")){const t=e.domain||"unknown",n=t.charAt(0).toUpperCase(),r=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899"];return`data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="${r[t.length%r.length]}"/><text x="8" y="12" font-family="Arial" font-size="10" text-anchor="middle" fill="white" font-weight="bold">${n}</text></svg>`}switch(e.domain||""){case"chrome-internal":return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%23EA4335"/><circle cx="8" cy="8" r="3" fill="white"/></svg>';case"local-file":return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%23F59E0B"/><text x="8" y="12" font-family="Arial" font-size="10" text-anchor="middle" fill="white">ðŸ“„</text></svg>';case"javascript-bookmarklet":return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%23F7DF1E"/><text x="8" y="12" font-family="Arial" font-size="8" text-anchor="middle" fill="black" font-weight="bold">JS</text></svg>';case"data-uri":return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%2310B981"/><text x="8" y="12" font-family="Arial" font-size="8" text-anchor="middle" fill="white" font-weight="bold">D</text></svg>';case"contact-link":return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%238B5CF6"/><text x="8" y="12" font-family="Arial" font-size="10" text-anchor="middle" fill="white">@</text></svg>';case"other-protocol":return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%236B7280"/><text x="8" y="12" font-family="Arial" font-size="10" text-anchor="middle" fill="white">âš¡</text></svg>';default:return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%23E5E7EB"/><text x="8" y="12" font-family="Arial" font-size="10" text-anchor="middle" fill="%236B7280">?</text></svg>'}}(e)}function te(e){switch(e.domain){case"chrome-internal":return"Chrome";case"local-file":return"Local File";case"javascript-bookmarklet":return"Bookmarklet";case"data-uri":return"Data URI";case"contact-link":return"Contact";case"other-protocol":return"Other";case"invalid-url":return"Invalid URL";default:return e.domain}}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");const ne={RELEVANCE:{key:"relevance",label:"Best Match",sort:(e,t)=>(t._searchScore||0)-(e._searchScore||0)},DATE_DESC:{key:"date_desc",label:"Newest First",sort:(e,t)=>t.dateAdded-e.dateAdded},DATE_ASC:{key:"date_asc",label:"Oldest First",sort:(e,t)=>e.dateAdded-t.dateAdded},TITLE_ASC:{key:"title_asc",label:"Title A-Z",sort:(e,t)=>(e.title||"").localeCompare(t.title||"")},TITLE_DESC:{key:"title_desc",label:"Title Z-A",sort:(e,t)=>(t.title||"").localeCompare(e.title||"")},DOMAIN_ASC:{key:"domain_asc",label:"Domain A-Z",sort:(e,t)=>(e.domain||"").localeCompare(t.domain||"")}};function re(e){const t=Object.values(ne).find(t=>t.key===e);return t?t.sort:ne.DATE_DESC.sort}function ie(e,t){if(!e||!t)return e;const{positive:n,phrases:r,regular:i,regexPatterns:o}=t,s=[...n||[],...r||[],...i||[]];if(0===s.length&&(!o||0===o.length))return e;const a=[];s.forEach(t=>{if(!t)return;const n=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),r=new RegExp(n,"gi");let i;for(;null!==(i=r.exec(e));)a.push({start:i.index,end:i.index+i[0].length})}),o&&o.forEach(t=>{const n=t.flags.includes("g")?t.flags:t.flags+"g";try{const r=new RegExp(t.source,n);let i;for(;null!==(i=r.exec(e));)a.push({start:i.index,end:i.index+i[0].length}),i.index===r.lastIndex&&r.lastIndex++}catch(e){console.warn("Invalid regex for highlighting:",e)}}),a.sort((e,t)=>e.start-t.start);const c=[];if(a.length>0){let e=a[0];for(let t=1;t<a.length;t++){const n=a[t];n.start<e.end?e.end=Math.max(e.end,n.end):(c.push(e),e=n)}c.push(e)}let l=e;for(let e=c.length-1;e>=0;e--){const{start:t,end:n}=c[e],r=l.slice(0,t),i=l.slice(t,n),o=l.slice(n);l=`${r}<mark class="bg-yellow-200 text-gray-900 rounded-sm px-0.5">${i}</mark>${o}`}return l}const oe=[];function se(t,n=e){let r;const i=new Set;function s(e){if(o(t,e)&&(t=e,r)){const e=!oe.length;for(const e of i)e[1](),oe.push(e,t);if(e){for(let e=0;e<oe.length;e+=2)oe[e][0](oe[e+1]);oe.length=0}}}function a(e){s(e(t))}return{set:s,update:a,subscribe:function(o,c=e){const l=[o,c];return i.add(l),1===i.size&&(r=n(s,a)||e),o(t),()=>{i.delete(l),0===i.size&&r&&(r(),r=null)}}}}function ae(t,n,o){const s=!Array.isArray(t),a=s?[t]:t;if(!a.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const c=n.length<2;return u=(t,o)=>{let u=!1;const h=[];let f=0,d=e;const p=()=>{if(f)return;d();const r=n(s?h[0]:h,t,o);c?t(r):d=i(r)?r:e},g=a.map((e,t)=>l(e,e=>{h[t]=e,f&=~(1<<t),u&&p()},()=>{f|=1<<t}));return u=!0,p(),function(){r(g),d(),u=!1}},{subscribe:se(o,u).subscribe};var u}var ce="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function le(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ue={exports:{}};ue.exports=function(){
/*! *****************************************************************************
	    Copyright (c) Microsoft Corporation.
	    Permission to use, copy, modify, and/or distribute this software for any
	    purpose with or without fee is hereby granted.
	    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	    PERFORMANCE OF THIS SOFTWARE.
	    ***************************************************************************** */
var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};function t(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var n=function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};function r(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:ce,o=Object.keys,s=Array.isArray;function a(e,t){return"object"!=typeof t||o(t).forEach(function(n){e[n]=t[n]}),e}"undefined"==typeof Promise||i.Promise||(i.Promise=Promise);var c=Object.getPrototypeOf,l={}.hasOwnProperty;function u(e,t){return l.call(e,t)}function h(e,t){"function"==typeof t&&(t=t(c(e))),("undefined"==typeof Reflect?o:Reflect.ownKeys)(t).forEach(function(n){d(e,n,t[n])})}var f=Object.defineProperty;function d(e,t,n,r){f(e,t,a(n&&u(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function p(e){return{from:function(t){return e.prototype=Object.create(t.prototype),d(e.prototype,"constructor",e),{extend:h.bind(null,e.prototype)}}}}var g=Object.getOwnPropertyDescriptor;function m(e,t){var n;return g(e,t)||(n=c(e))&&m(n,t)}var y=[].slice;function v(e,t,n){return y.call(e,t,n)}function b(e,t){return t(e)}function w(e){if(!e)throw new Error("Assertion Failed")}function x(e){i.setImmediate?setImmediate(e):setTimeout(e,0)}function k(e,t){return e.reduce(function(e,n,r){var i=t(n,r);return i&&(e[i[0]]=i[1]),e},{})}function _(e,t){if("string"==typeof t&&u(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,i=t.length;r<i;++r){var o=_(e,t[r]);n.push(o)}return n}var s=t.indexOf(".");if(-1!==s){var a=e[t.substr(0,s)];return null==a?void 0:_(a,t.substr(s+1))}}function A(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){w("string"!=typeof n&&"length"in n);for(var r=0,i=t.length;r<i;++r)A(e,t[r],n[r])}else{var o=t.indexOf(".");if(-1!==o){var a=t.substr(0,o),c=t.substr(o+1);if(""===c)void 0===n?s(e)&&!isNaN(parseInt(a))?e.splice(a,1):delete e[a]:e[a]=n;else{var l=e[a];l&&u(e,a)||(l=e[a]={}),A(l,c,n)}}else void 0===n?s(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function C(e,t){"string"==typeof t?A(e,t,void 0):"length"in t&&[].map.call(t,function(t){A(e,t,void 0)})}function S(e){var t={};for(var n in e)u(e,n)&&(t[n]=e[n]);return t}var j=[].concat;function P(e){return j.apply([],e)}var E="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(P([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return i[e]}),T=new Set(E.map(function(e){return i[e]}));function O(e){var t={};for(var n in e)if(u(e,n)){var r=e[n];t[n]=!r||"object"!=typeof r||T.has(r.constructor)?r:O(r)}return t}function D(e){for(var t in e)if(u(e,t))return!1;return!0}var M=null;function R(e){M=new WeakMap;var t=B(e);return M=null,t}function B(e){if(!e||"object"!=typeof e)return e;var t=M.get(e);if(t)return t;if(s(e)){t=[],M.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(B(e[n]))}else if(T.has(e.constructor))t=e;else{var i=c(e);for(var o in t=i===Object.prototype?{}:Object.create(i),M.set(e,t),e)u(e,o)&&(t[o]=B(e[o]))}return t}var I={}.toString;function K(e){return I.call(e).slice(8,-1)}var $="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",q="symbol"==typeof $?function(e){var t;return null!=e&&(t=e[$])&&t.apply(e)}:function(){return null};function F(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),n>=0}var L={};function z(e){var t,n,r,i;if(1===arguments.length){if(s(e))return e.slice();if(this===L&&"string"==typeof e)return[e];if(i=q(e)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var N="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},W=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],U=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(W),Q={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function H(e,t){this.name=e,this.message=t}function V(e,t){return e+". Errors: "+Object.keys(t).map(function(e){return t[e].toString()}).filter(function(e,t,n){return n.indexOf(e)===t}).join("\n")}function Y(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=V(e,t)}function G(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(e){return t[e]}),this.failuresByPos=t,this.message=V(e,this.failures)}p(H).from(Error).extend({toString:function(){return this.name+": "+this.message}}),p(Y).from(H),p(G).from(H);var J=U.reduce(function(e,t){return e[t]=t+"Error",e},{}),X=H,Z=U.reduce(function(e,t){var n=t+"Error";function r(e,r){this.name=n,e?"string"==typeof e?(this.message="".concat(e).concat(r?"\n "+r:""),this.inner=r||null):"object"==typeof e&&(this.message="".concat(e.name," ").concat(e.message),this.inner=e):(this.message=Q[t]||n,this.inner=null)}return p(r).from(X),e[t]=r,e},{});Z.Syntax=SyntaxError,Z.Type=TypeError,Z.Range=RangeError;var ee=W.reduce(function(e,t){return e[t+"Error"]=Z[t],e},{});function te(e,t){if(!e||e instanceof H||e instanceof TypeError||e instanceof SyntaxError||!e.name||!ee[e.name])return e;var n=new ee[e.name](t||e.message,e);return"stack"in e&&d(n,"stack",{get:function(){return this.inner.stack}}),n}var ne=U.reduce(function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=Z[t]),e},{});function re(){}function ie(e){return e}function oe(e,t){return null==e||e===ie?t:function(n){return t(e(n))}}function se(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ae(e,t){return e===re?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?se(r,this.onsuccess):r),i&&(this.onerror=this.onerror?se(i,this.onerror):i),void 0!==o?o:n}}function le(e,t){return e===re?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?se(n,this.onsuccess):n),r&&(this.onerror=this.onerror?se(r,this.onerror):r)}}function ue(e,t){return e===re?t:function(n){var r=e.apply(this,arguments);a(n,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var s=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?se(i,this.onsuccess):i),o&&(this.onerror=this.onerror?se(o,this.onerror):o),void 0===r?void 0===s?void 0:s:a(r,s)}}function he(e,t){return e===re?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function fe(e,t){return e===re?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then(function(){return t.apply(r,o)})}return t.apply(this,arguments)}}ne.ModifyError=Y,ne.DexieError=H,ne.BulkError=G;var de="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function pe(e,t){de=e}var ge={},me=100,ye="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,c(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,c(t),e]}(),ve=ye[0],be=ye[1],we=ye[2],xe=be&&be.then,ke=ve&&ve.constructor,_e=!!we;function Ae(){queueMicrotask(We)}var Ce=function(e,t){Me.push([e,t]),je&&(Ae(),je=!1)},Se=!0,je=!0,Pe=[],Ee=[],Te=ie,Oe={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:re,pgp:!1,env:{},finalize:re},De=Oe,Me=[],Re=0,Be=[];function Ie(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=De;if("function"!=typeof e){if(e!==ge)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Fe(this,this._value))}this._state=null,this._value=null,++t.ref,qe(this,e)}var Ke={get:function(){var e=De,t=rt;function n(n,r){var i=this,o=!e.global&&(e!==De||t!==rt),s=o&&!at(),a=new Ie(function(t,a){ze(i,new $e(pt(n,e,o,s),pt(r,e,o,s),t,a,e))});return this._consoleTask&&(a._consoleTask=this._consoleTask),a}return n.prototype=ge,n},set:function(e){d(this,"then",e&&e.prototype===ge?Ke:{get:function(){return e},set:Ke.set})}};function $e(e,t,n,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=i}function qe(e,t){try{t(function(t){if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&Ue();t&&"function"==typeof t.then?qe(e,function(e,n){t instanceof Ie?t._then(e,n):t.then(e,n)}):(e._state=!0,e._value=t,Le(e)),n&&Qe()}},Fe.bind(null,e))}catch(t){Fe(e,t)}}function Fe(e,t){if(Ee.push(t),null===e._state){var n=e._lib&&Ue();t=Te(t),e._state=!1,e._value=t,Ye(e),Le(e),n&&Qe()}}function Le(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)ze(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),0===Re&&(++Re,Ce(function(){0===--Re&&He()},[]))}function ze(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Re,Ce(Ne,[n,e,t])}else e._listeners.push(t)}function Ne(e,t,n){try{var r,i=t._value;!t._state&&Ee.length&&(Ee=[]),r=de&&t._consoleTask?t._consoleTask.run(function(){return e(i)}):e(i),t._state||-1!==Ee.indexOf(i)||Ge(t),n.resolve(r)}catch(e){n.reject(e)}finally{0===--Re&&He(),--n.psd.ref||n.psd.finalize()}}function We(){dt(Oe,function(){Ue()&&Qe()})}function Ue(){var e=Se;return Se=!1,je=!1,e}function Qe(){var e,t,n;do{for(;Me.length>0;)for(e=Me,Me=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(Me.length>0);Se=!0,je=!0}function He(){var e=Pe;Pe=[],e.forEach(function(e){e._PSD.onunhandled.call(null,e._value,e)});for(var t=Be.slice(0),n=t.length;n;)t[--n]()}function Ve(e){function t(){e(),Be.splice(Be.indexOf(t),1)}Be.push(t),++Re,Ce(function(){0===--Re&&He()},[])}function Ye(e){Pe.some(function(t){return t._value===e._value})||Pe.push(e)}function Ge(e){for(var t=Pe.length;t;)if(Pe[--t]._value===e._value)return void Pe.splice(t,1)}function Je(e){return new Ie(ge,!1,e)}function Xe(e,t){var n=De;return function(){var r=Ue(),i=De;try{return ht(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{ht(i,!1),r&&Qe()}}}h(Ie.prototype,{then:Ke,_then:function(e,t){ze(this,new $e(null,null,e,t,De))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,function(e){return e instanceof t?n(e):Je(e)}):this.then(null,function(e){return e&&e.name===t?n(e):Je(e)})},finally:function(e){return this.then(function(t){return Ie.resolve(e()).then(function(){return t})},function(t){return Ie.resolve(e()).then(function(){return Je(t)})})},timeout:function(e,t){var n=this;return e<1/0?new Ie(function(r,i){var o=setTimeout(function(){return i(new Z.Timeout(t))},e);n.then(r,i).finally(clearTimeout.bind(null,o))}):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&d(Ie.prototype,Symbol.toStringTag,"Dexie.Promise"),Oe.env=ft(),h(Ie,{all:function(){var e=z.apply(null,arguments).map(ct);return new Ie(function(t,n){0===e.length&&t([]);var r=e.length;e.forEach(function(i,o){return Ie.resolve(i).then(function(n){e[o]=n,--r||t(e)},n)})})},resolve:function(e){return e instanceof Ie?e:e&&"function"==typeof e.then?new Ie(function(t,n){e.then(t,n)}):new Ie(ge,!0,e)},reject:Je,race:function(){var e=z.apply(null,arguments).map(ct);return new Ie(function(t,n){e.map(function(e){return Ie.resolve(e).then(t,n)})})},PSD:{get:function(){return De},set:function(e){return De=e}},totalEchoes:{get:function(){return rt}},newPSD:ot,usePSD:dt,scheduler:{get:function(){return Ce},set:function(e){Ce=e}},rejectionMapper:{get:function(){return Te},set:function(e){Te=e}},follow:function(e,t){return new Ie(function(n,r){return ot(function(t,n){var r=De;r.unhandleds=[],r.onunhandled=n,r.finalize=se(function(){var e=this;Ve(function(){0===e.unhandleds.length?t():n(e.unhandleds[0])})},r.finalize),e()},t,n,r)})}}),ke&&(ke.allSettled&&d(Ie,"allSettled",function(){var e=z.apply(null,arguments).map(ct);return new Ie(function(t){0===e.length&&t([]);var n=e.length,r=new Array(n);e.forEach(function(e,i){return Ie.resolve(e).then(function(e){return r[i]={status:"fulfilled",value:e}},function(e){return r[i]={status:"rejected",reason:e}}).then(function(){return--n||t(r)})})})}),ke.any&&"undefined"!=typeof AggregateError&&d(Ie,"any",function(){var e=z.apply(null,arguments).map(ct);return new Ie(function(t,n){0===e.length&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach(function(e,o){return Ie.resolve(e).then(function(e){return t(e)},function(e){i[o]=e,--r||n(new AggregateError(i))})})})}),ke.withResolvers&&(Ie.withResolvers=ke.withResolvers));var Ze={awaits:0,echoes:0,id:0},et=0,tt=[],nt=0,rt=0,it=0;function ot(e,t,n,r){var i=De,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++it,Oe.env,o.env=_e?{Promise:Ie,PromiseProp:{value:Ie,configurable:!0,writable:!0},all:Ie.all,race:Ie.race,allSettled:Ie.allSettled,any:Ie.any,resolve:Ie.resolve,reject:Ie.reject}:{},t&&a(o,t),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var s=dt(o,e,n,r);return 0===o.ref&&o.finalize(),s}function st(){return Ze.id||(Ze.id=++et),++Ze.awaits,Ze.echoes+=me,Ze.id}function at(){return!!Ze.awaits&&(0===--Ze.awaits&&(Ze.id=0),Ze.echoes=Ze.awaits*me,!0)}function ct(e){return Ze.echoes&&e&&e.constructor===ke?(st(),e.then(function(e){return at(),e},function(e){return at(),mt(e)})):e}function lt(e){++rt,Ze.echoes&&0!==--Ze.echoes||(Ze.echoes=Ze.awaits=Ze.id=0),tt.push(De),ht(e,!0)}function ut(){var e=tt[tt.length-1];tt.pop(),ht(e,!1)}function ht(e,t){var n=De;if((t?!Ze.echoes||nt++&&e===De:!nt||--nt&&e===De)||queueMicrotask(t?lt.bind(null,e):ut),e!==De&&(De=e,n===Oe&&(Oe.env=ft()),_e)){var r=Oe.env.Promise,o=e.env;(n.global||e.global)&&(Object.defineProperty(i,"Promise",o.PromiseProp),r.all=o.all,r.race=o.race,r.resolve=o.resolve,r.reject=o.reject,o.allSettled&&(r.allSettled=o.allSettled),o.any&&(r.any=o.any))}}function ft(){var e=i.Promise;return _e?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function dt(e,t,n,r,i){var o=De;try{return ht(e,!0),t(n,r,i)}finally{ht(o,!1)}}function pt(e,t,n,r){return"function"!=typeof e?e:function(){var i=De;n&&st(),ht(t,!0);try{return e.apply(this,arguments)}finally{ht(i,!1),r&&queueMicrotask(at)}}}function gt(e){Promise===ke&&0===Ze.echoes?0===nt?e():enqueueNativeMicroTask(e):setTimeout(e,0)}-1===(""+xe).indexOf("[native code]")&&(st=at=re);var mt=Ie.reject;function yt(e,t,n,r){if(e.idbdb&&(e._state.openComplete||De.letThrough||e._vip)){var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(i){return i.name===J.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return yt(e,t,n,r)})):mt(i)}return i._promise(t,function(e,t){return ot(function(){return De.trans=i,r(e,t,i)})}).then(function(e){if("readwrite"===t)try{i.idbtrans.commit()}catch(e){}return"readonly"===t?e:i._completion.then(function(){return e})})}if(e._state.openComplete)return mt(new Z.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return mt(new Z.DatabaseClosed);e.open().catch(re)}return e._state.dbReadyPromise.then(function(){return yt(e,t,n,r)})}var vt="4.2.1",bt=String.fromCharCode(65535),wt=-1/0,xt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",kt="String expected.",_t=[],At="__dbnames",Ct="readonly",St="readwrite";function jt(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Pt={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Et(e){return"string"!=typeof e||/\./.test(e)?function(e){return e}:function(t){return void 0===t[e]&&e in t&&delete(t=R(t))[e],t}}function Tt(){throw Z.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function Ot(e,t){try{var n=Rt(e),r=Rt(t);if(n!==r)return"Array"===n?1:"Array"===r?-1:"binary"===n?1:"binary"===r?-1:"string"===n?1:"string"===r?-1:"Date"===n?1:"Date"!==r?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return Mt(Bt(e),Bt(t));case"Array":return Dt(e,t)}}catch(e){}return NaN}function Dt(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,o=0;o<i;++o){var s=Ot(e[o],t[o]);if(0!==s)return s}return n===r?0:n<r?-1:1}function Mt(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,o=0;o<i;++o)if(e[o]!==t[o])return e[o]<t[o]?-1:1;return n===r?0:n<r?-1:1}function Rt(e){var t=typeof e;if("object"!==t)return t;if(ArrayBuffer.isView(e))return"binary";var n=K(e);return"ArrayBuffer"===n?"binary":n}function Bt(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function It(e,t,n){var r=e.schema.yProps;return r?(t&&n.numFailures>0&&(t=t.filter(function(e,t){return!n.failures[t]})),Promise.all(r.map(function(n){var r=n.updatesTable;return t?e.db.table(r).where("k").anyOf(t).delete():e.db.table(r).clear()})).then(function(){return n})):n}var Kt=function(){function e(e){this["@@propmod"]=e}return e.prototype.execute=function(e){var t,n=this["@@propmod"];if(void 0!==n.add){var i=n.add;if(s(i))return r(r([],s(e)?e:[],!0),i,!0).sort();if("number"==typeof i)return(Number(e)||0)+i;if("bigint"==typeof i)try{return BigInt(e)+i}catch(e){return BigInt(0)+i}throw new TypeError("Invalid term ".concat(i))}if(void 0!==n.remove){var o=n.remove;if(s(o))return s(e)?e.filter(function(e){return!o.includes(e)}).sort():[];if("number"==typeof o)return Number(e)-o;if("bigint"==typeof o)try{return BigInt(e)-o}catch(e){return BigInt(0)-o}throw new TypeError("Invalid subtrahend ".concat(o))}var a=null===(t=n.replacePrefix)||void 0===t?void 0:t[0];return a&&"string"==typeof e&&e.startsWith(a)?n.replacePrefix[1]+e.substring(a.length):e},e}();function $t(e,t){for(var n=o(t),r=n.length,i=!1,s=0;s<r;++s){var a=n[s],c=t[a],l=_(e,a);c instanceof Kt?(A(e,a,c.execute(l)),i=!0):l!==c&&(A(e,a,c),i=!0)}return i}var qt=function(){function e(){}return e.prototype._trans=function(e,t,n){var r=this._tx||De.trans,i=this.name,o=de&&"undefined"!=typeof console&&console.createTask&&console.createTask("Dexie: ".concat("readonly"===e?"read":"write"," ").concat(this.name));function s(e,n,r){if(!r.schema[i])throw new Z.NotFound("Table "+i+" not part of transaction");return t(r.idbtrans,r)}var a=Ue();try{var c=r&&r.db._novip===this.db._novip?r===De.trans?r._promise(e,s,n):ot(function(){return r._promise(e,s,n)},{trans:r,transless:De.transless||De}):yt(this.db,e,[this.name],s);return o&&(c._consoleTask=o,c=c.catch(function(e){return console.trace(e),mt(e)})),c}finally{a&&Qe()}},e.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):null==e?mt(new Z.Type("Invalid argument to Table.get()")):this._trans("readonly",function(t){return n.core.get({trans:t,key:e}).then(function(e){return n.hook.reading.fire(e)})}).then(t)},e.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(s(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=o(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(e){if(e.compound&&t.every(function(t){return e.keyPath.indexOf(t)>=0})){for(var n=0;n<t.length;++n)if(-1===t.indexOf(e.keyPath[n]))return!1;return!0}return!1}).sort(function(e,t){return e.keyPath.length-t.keyPath.length})[0];if(n&&this.db._maxKey!==bt){var r=n.keyPath.slice(0,t.length);return this.where(r).equals(r.map(function(t){return e[t]}))}!n&&de&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var i=this.schema.idxByName;function a(e,t){return 0===Ot(e,t)}var c=t.reduce(function(t,n){var r=t[0],o=t[1],c=i[n],l=e[n];return[r||c,r||!c?jt(o,c&&c.multi?function(e){var t=_(e,n);return s(t)&&t.some(function(e){return a(l,e)})}:function(e){return a(l,_(e,n))}):o]},[null,null]),l=c[0],u=c[1];return l?this.where(l.name).equals(e[l.keyPath]).filter(u):n?this.filter(u):this.where(t).equals("")},e.prototype.filter=function(e){return this.toCollection().and(e)},e.prototype.count=function(e){return this.toCollection().count(e)},e.prototype.offset=function(e){return this.toCollection().offset(e)},e.prototype.limit=function(e){return this.toCollection().limit(e)},e.prototype.each=function(e){return this.toCollection().each(e)},e.prototype.toArray=function(e){return this.toCollection().toArray(e)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,s(e)?"[".concat(e.join("+"),"]"):e))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(e){var n=this,r=n.db,i=n.name;this.schema.mappedClass=e,e.prototype instanceof Tt&&(e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),Object.defineProperty(n.prototype,"db",{get:function(){return r},enumerable:!1,configurable:!0}),n.prototype.table=function(){return i},n}(e));for(var o=new Set,s=e.prototype;s;s=c(s))Object.getOwnPropertyNames(s).forEach(function(e){return o.add(e)});var a=function(t){if(!t)return t;var n=Object.create(e.prototype);for(var r in t)if(!o.has(r))try{n[r]=t[r]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=a,this.hook("reading",a),e},e.prototype.defineClass=function(){function e(e){a(this,e)}return this.mapToClass(e)},e.prototype.add=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,s=e;return o&&i&&(s=Et(o)(e)),this._trans("readwrite",function(e){return n.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[s]})}).then(function(e){return e.numFailures?Ie.reject(e.failures[0]):e.lastResult}).then(function(t){if(o)try{A(e,o,t)}catch(e){}return t})},e.prototype.upsert=function(e,t){var n=this,r=this.schema.primKey.keyPath;return this._trans("readwrite",function(i){return n.core.get({trans:i,key:e}).then(function(o){var s=null!=o?o:{};return $t(s,t),r&&A(s,r,e),n.core.mutate({trans:i,type:"put",values:[s],keys:[e],upsert:!0,updates:{keys:[e],changeSpecs:[t]}}).then(function(e){return e.numFailures?Ie.reject(e.failures[0]):!!o})})})},e.prototype.update=function(e,t){if("object"!=typeof e||s(e))return this.where(":id").equals(e).modify(t);var n=_(e,this.schema.primKey.keyPath);return void 0===n?mt(new Z.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(t)},e.prototype.put=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,s=e;return o&&i&&(s=Et(o)(e)),this._trans("readwrite",function(e){return n.core.mutate({trans:e,type:"put",values:[s],keys:null!=t?[t]:null})}).then(function(e){return e.numFailures?Ie.reject(e.failures[0]):e.lastResult}).then(function(t){if(o)try{A(e,o,t)}catch(e){}return t})},e.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]}).then(function(n){return It(t,[e],n)}).then(function(e){return e.numFailures?Ie.reject(e.failures[0]):void 0})})},e.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Pt}).then(function(t){return It(e,null,t)})}).then(function(e){return e.numFailures?Ie.reject(e.failures[0]):void 0})},e.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(n){return t.core.getMany({keys:e,trans:n}).then(function(e){return e.map(function(e){return t.hook.reading.fire(e)})})})},e.prototype.bulkAdd=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(t){var n=r.schema.primKey,s=n.auto,a=n.keyPath;if(a&&i)throw new Z.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new Z.InvalidArgument("Arguments objects and keys must have the same length");var c=e.length,l=a&&s?e.map(Et(a)):e;return r.core.mutate({trans:t,type:"add",keys:i,values:l,wantResults:o}).then(function(e){var t=e.numFailures,n=e.results,i=e.lastResult,s=e.failures;if(0===t)return o?n:i;throw new G("".concat(r.name,".bulkAdd(): ").concat(t," of ").concat(c," operations failed"),s)})})},e.prototype.bulkPut=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(t){var n=r.schema.primKey,s=n.auto,a=n.keyPath;if(a&&i)throw new Z.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new Z.InvalidArgument("Arguments objects and keys must have the same length");var c=e.length,l=a&&s?e.map(Et(a)):e;return r.core.mutate({trans:t,type:"put",keys:i,values:l,wantResults:o}).then(function(e){var t=e.numFailures,n=e.results,i=e.lastResult,s=e.failures;if(0===t)return o?n:i;throw new G("".concat(r.name,".bulkPut(): ").concat(t," of ").concat(c," operations failed"),s)})})},e.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map(function(e){return e.key}),i=e.map(function(e){return e.changes}),o=[];return this._trans("readwrite",function(s){return n.getMany({trans:s,keys:r,cache:"clone"}).then(function(a){var c=[],l=[];e.forEach(function(e,n){var r=e.key,i=e.changes,s=a[n];if(s){for(var u=0,h=Object.keys(i);u<h.length;u++){var f=h[u],d=i[f];if(f===t.schema.primKey.keyPath){if(0!==Ot(d,r))throw new Z.Constraint("Cannot update primary key in bulkUpdate()")}else A(s,f,d)}o.push(n),c.push(r),l.push(s)}});var u=c.length;return n.mutate({trans:s,type:"put",keys:c,values:l,updates:{keys:r,changeSpecs:i}}).then(function(e){var n=e.numFailures,r=e.failures;if(0===n)return u;for(var i=0,s=Object.keys(r);i<s.length;i++){var a=s[i],c=o[Number(a)];if(null!=c){var l=r[a];delete r[a],r[c]=l}}throw new G("".concat(t.name,".bulkUpdate(): ").concat(n," of ").concat(u," operations failed"),r)})})})},e.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:e}).then(function(n){return It(t,e,n)})}).then(function(e){var r=e.numFailures,i=e.lastResult,o=e.failures;if(0===r)return i;throw new G("".concat(t.name,".bulkDelete(): ").concat(r," of ").concat(n," operations failed"),o)})},e}();function Ft(e){var t={},n=function(n,r){if(r){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return t[n].subscribe.apply(null,o),e}if("string"==typeof n)return t[n]};n.addEventType=a;for(var r=1,i=arguments.length;r<i;++r)a(arguments[r]);return n;function a(e,r,i){if("object"==typeof e)return c(e);r||(r=he),i||(i=re);var o={subscribers:[],fire:i,subscribe:function(e){-1===o.subscribers.indexOf(e)&&(o.subscribers.push(e),o.fire=r(o.fire,e))},unsubscribe:function(e){o.subscribers=o.subscribers.filter(function(t){return t!==e}),o.fire=o.subscribers.reduce(r,i)}};return t[e]=n[e]=o,o}function c(e){o(e).forEach(function(t){var n=e[t];if(s(n))a(t,e[t][0],e[t][1]);else{if("asap"!==n)throw new Z.InvalidArgument("Invalid event config");var r=a(t,ie,function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];r.subscribers.forEach(function(e){x(function(){e.apply(null,t)})})})}})}}function Lt(e,t){return p(t).from({prototype:e}),t}function zt(e){return Lt(qt.prototype,function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:Ft(null,{creating:[ae,re],reading:[oe,ie],updating:[ue,re],deleting:[le,re]})})}function Nt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Wt(e,t){e.filter=jt(e.filter,t)}function Ut(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return jt(r(),t())}:t,e.justLimit=n&&!r}function Qt(e,t){e.isMatch=jt(e.isMatch,t)}function Ht(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new Z.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Vt(e,t,n){var r=Ht(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function Yt(e,t,n,r){var i=e.replayFilter?jt(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},s=function(e,n,r){if(!i||i(n,r,function(e){return n.stop(e)},function(e){return n.fail(e)})){var s=n.primaryKey,a=""+s;"[object ArrayBuffer]"===a&&(a=""+new Uint8Array(s)),u(o,a)||(o[a]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(s,n),Gt(Vt(e,r,n),e.algorithm,s,!e.keysOnly&&e.valueMapper)])}return Gt(Vt(e,r,n),jt(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function Gt(e,t,n,r){var i=Xe(r?function(e,t,i){return n(r(e),t,i)}:n);return e.then(function(e){if(e)return e.start(function(){var n=function(){return e.continue()};t&&!t(e,function(e){return n=e},function(t){e.stop(t),n=re},function(t){e.fail(t),n=re})||i(e.value,e,function(e){return n=e}),n()})})}var Jt=function(){function e(){}return e.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,mt.bind(null,n.error)):n.table._trans("readonly",e).then(t)},e.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,mt.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},e.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=jt(t.algorithm,e)},e.prototype._iterate=function(e,t){return Yt(this._ctx,e,t,this._ctx.table.core)},e.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&a(n,e),t._ctx=n,t},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return Yt(t,e,n,t.table.core)})},e.prototype.count=function(e){var t=this;return this._read(function(e){var n=t._ctx,r=n.table.core;if(Nt(n,!0))return r.count({trans:e,query:{index:Ht(n,r.schema),range:n.range}}).then(function(e){return Math.min(e,n.limit)});var i=0;return Yt(n,function(){return++i,!1},e,r).then(function(){return i})}).then(e)},e.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],i=n.length-1;function o(e,t){return t?o(e[n[t]],t-1):e[r]}var s="next"===this._ctx.dir?1:-1;function a(e,t){return Ot(o(e,i),o(t,i))*s}return this.toArray(function(e){return e.sort(a)}).then(t)},e.prototype.toArray=function(e){var t=this;return this._read(function(e){var n=t._ctx;if("next"===n.dir&&Nt(n,!0)&&n.limit>0){var r=n.valueMapper,i=Ht(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:i,range:n.range}}).then(function(e){var t=e.result;return r?t.map(r):t})}var o=[];return Yt(n,function(e){return o.push(e)},e,n.table.core).then(function(){return o})},e)},e.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Nt(t)?Ut(t,function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n(function(){e.advance(t),t=0}),!1))}}):Ut(t,function(){var t=e;return function(){return--t<0}})),this},e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Ut(this._ctx,function(){var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}},!0),this},e.prototype.until=function(e,t){return Wt(this._ctx,function(n,r,i){return!e(n.value)||(r(i),t)}),this},e.prototype.first=function(e){return this.limit(1).toArray(function(e){return e[0]}).then(e)},e.prototype.last=function(e){return this.reverse().first(e)},e.prototype.filter=function(e){return Wt(this._ctx,function(t){return e(t.value)}),Qt(this._ctx,e),this},e.prototype.and=function(e){return this.filter(e)},e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},e.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.key,n)})},e.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},e.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.primaryKey,n)})},e.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(e,t){n.push(t.key)}).then(function(){return n}).then(e)},e.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&Nt(t,!0)&&t.limit>0)return this._read(function(e){var n=Ht(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})}).then(function(e){return e.result}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(e,t){n.push(t.primaryKey)}).then(function(){return n}).then(e)},e.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},e.prototype.firstKey=function(e){return this.limit(1).keys(function(e){return e[0]}).then(e)},e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},e.prototype.distinct=function(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return Wt(this._ctx,function(e){var t=e.primaryKey.toString(),r=u(n,t);return n[t]=!0,!r}),this},e.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(r){var i;i="function"==typeof e?e:function(t){return $t(t,e)};var s=n.table.core,a=s.schema.primaryKey,c=a.outbound,l=a.extractKey,u=200,h=t.db._options.modifyChunkSize;h&&(u="object"==typeof h?h[s.name]||h["*"]||200:h);var f=[],d=0,p=[],g=function(e,t){var n=t.failures,r=t.numFailures;d+=e-r;for(var i=0,s=o(n);i<s.length;i++){var a=s[i];f.push(n[a])}},m=e===Xt;return t.clone().primaryKeys().then(function(t){var o=Nt(n)&&n.limit===1/0&&("function"!=typeof e||m)&&{index:n.index,range:n.range},a=function(h){var f=Math.min(u,t.length-h),d=t.slice(h,h+f);return(m?Promise.resolve([]):s.getMany({trans:r,keys:d,cache:"immutable"})).then(function(p){var y=[],v=[],b=c?[]:null,w=m?d:[];if(!m)for(var x=0;x<f;++x){var k=p[x],_={value:R(k),primKey:t[h+x]};!1!==i.call(_,_.value,_)&&(null==_.value?w.push(t[h+x]):c||0===Ot(l(k),l(_.value))?(v.push(_.value),c&&b.push(t[h+x])):(w.push(t[h+x]),y.push(_.value)))}return Promise.resolve(y.length>0&&s.mutate({trans:r,type:"add",values:y}).then(function(e){for(var t in e.failures)w.splice(parseInt(t),1);g(y.length,e)})).then(function(){return(v.length>0||o&&"object"==typeof e)&&s.mutate({trans:r,type:"put",keys:b,values:v,criteria:o,changeSpec:"function"!=typeof e&&e,isAdditionalChunk:h>0}).then(function(e){return g(v.length,e)})}).then(function(){return(w.length>0||o&&m)&&s.mutate({trans:r,type:"delete",keys:w,criteria:o,isAdditionalChunk:h>0}).then(function(e){return It(n.table,w,e)}).then(function(e){return g(w.length,e)})}).then(function(){return t.length>h+f&&a(h+u)})})};return a(0).then(function(){if(f.length>0)throw new Y("Error modifying one or more objects",f,d,p);return t.length})})})},e.prototype.delete=function(){var e=this._ctx,t=e.range;return!Nt(e)||e.table.schema.yProps||!e.isPrimKey&&3!==t.type?this.modify(Xt):this._write(function(n){var r=e.table.core.schema.primaryKey,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then(function(t){return e.table.core.mutate({trans:n,type:"deleteRange",range:i}).then(function(e){var n=e.failures,r=e.numFailures;if(r)throw new Y("Could not delete some values",Object.keys(n).map(function(e){return n[e]}),t-r);return t-r})})})},e}(),Xt=function(e,t){return t.value=null};function Zt(e){return Lt(Jt.prototype,function(t,n){this.db=e;var r=Pt,i=null;if(n)try{r=n()}catch(e){i=e}var o=t._ctx,s=o.table,a=s.hook.reading.fire;this._ctx={table:s,index:o.index,isPrimKey:!o.index||s.schema.primKey.keyPath&&o.index===s.schema.primKey.name,range:r,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:i,or:o.or,valueMapper:a!==ie?a:null}})}function en(e,t){return e<t?-1:e===t?0:1}function tn(e,t){return e>t?-1:e===t?0:1}function nn(e,t,n){var r=e instanceof hn?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function rn(e){return new e.Collection(e,function(){return un("")}).limit(0)}function on(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}function sn(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}function an(e,t,n,r,i,o){for(var s=Math.min(e.length,r.length),a=-1,c=0;c<s;++c){var l=t[c];if(l!==r[c])return i(e[c],n[c])<0?e.substr(0,c)+n[c]+n.substr(c+1):i(e[c],r[c])<0?e.substr(0,c)+r[c]+n.substr(c+1):a>=0?e.substr(0,a)+t[a]+n.substr(a+1):null;i(e[c],l)<0&&(a=c)}return s<r.length&&"next"===o?e+n.substr(e.length):s<e.length&&"prev"===o?e.substr(0,n.length):a<0?null:e.substr(0,a)+r[a]+n.substr(a+1)}function cn(e,t,n,r){var i,o,s,a,c,l,u,h=n.length;if(!n.every(function(e){return"string"==typeof e}))return nn(e,kt);function f(e){i=on(e),o=sn(e),s="next"===e?en:tn;var t=n.map(function(e){return{lower:o(e),upper:i(e)}}).sort(function(e,t){return s(e.lower,t.lower)});a=t.map(function(e){return e.upper}),c=t.map(function(e){return e.lower}),l=e,u="next"===e?"":r}f("next");var d=new e.Collection(e,function(){return ln(a[0],c[h-1]+r)});d._ondirectionchange=function(e){f(e)};var p=0;return d._addAlgorithm(function(e,n,r){var i=e.key;if("string"!=typeof i)return!1;var f=o(i);if(t(f,c,p))return!0;for(var d=null,g=p;g<h;++g){var m=an(i,f,a[g],c[g],s,l);null===m&&null===d?p=g+1:(null===d||s(d,m)>0)&&(d=m)}return n(null!==d?function(){e.continue(d+u)}:r),!1}),d}function ln(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function un(e){return{type:1,lower:e,upper:e}}var hn=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?rn(this):new this.Collection(this,function(){return ln(e,t,!n,!r)})}catch(e){return nn(this,xt)}},e.prototype.equals=function(e){return null==e?nn(this,xt):new this.Collection(this,function(){return un(e)})},e.prototype.above=function(e){return null==e?nn(this,xt):new this.Collection(this,function(){return ln(e,void 0,!0)})},e.prototype.aboveOrEqual=function(e){return null==e?nn(this,xt):new this.Collection(this,function(){return ln(e,void 0,!1)})},e.prototype.below=function(e){return null==e?nn(this,xt):new this.Collection(this,function(){return ln(void 0,e,!1,!0)})},e.prototype.belowOrEqual=function(e){return null==e?nn(this,xt):new this.Collection(this,function(){return ln(void 0,e)})},e.prototype.startsWith=function(e){return"string"!=typeof e?nn(this,kt):this.between(e,e+bt,!0,!0)},e.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):cn(this,function(e,t){return 0===e.indexOf(t[0])},[e],bt)},e.prototype.equalsIgnoreCase=function(e){return cn(this,function(e,t){return e===t[0]},[e],"")},e.prototype.anyOfIgnoreCase=function(){var e=z.apply(L,arguments);return 0===e.length?rn(this):cn(this,function(e,t){return-1!==t.indexOf(e)},e,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var e=z.apply(L,arguments);return 0===e.length?rn(this):cn(this,function(e,t){return t.some(function(t){return 0===e.indexOf(t)})},e,bt)},e.prototype.anyOf=function(){var e=this,t=z.apply(L,arguments),n=this._cmp;try{t.sort(n)}catch(e){return nn(this,xt)}if(0===t.length)return rn(this);var r=new this.Collection(this,function(){return ln(t[0],t[t.length-1])});r._ondirectionchange=function(r){n="next"===r?e._ascending:e._descending,t.sort(n)};var i=0;return r._addAlgorithm(function(e,r,o){for(var s=e.key;n(s,t[i])>0;)if(++i===t.length)return r(o),!1;return 0===n(s,t[i])||(r(function(){e.continue(t[i])}),!1)}),r},e.prototype.notEqual=function(e){return this.inAnyRange([[wt,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var e=z.apply(L,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return nn(this,xt)}var t=e.reduce(function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[wt,t]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(e,t){var n=this,r=this._cmp,i=this._ascending,o=this._descending,s=this._min,a=this._max;if(0===e.length)return rn(this);if(!e.every(function(e){return void 0!==e[0]&&void 0!==e[1]&&i(e[0],e[1])<=0}))return nn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Z.InvalidArgument);var c=!t||!1!==t.includeLowers,l=t&&!0===t.includeUppers;function u(e,t){for(var n=0,i=e.length;n<i;++n){var o=e[n];if(r(t[0],o[1])<0&&r(t[1],o[0])>0){o[0]=s(o[0],t[0]),o[1]=a(o[1],t[1]);break}}return n===i&&e.push(t),e}var h,f=i;function d(e,t){return f(e[0],t[0])}try{(h=e.reduce(u,[])).sort(d)}catch(e){return nn(this,xt)}var p=0,g=l?function(e){return i(e,h[p][1])>0}:function(e){return i(e,h[p][1])>=0},m=c?function(e){return o(e,h[p][0])>0}:function(e){return o(e,h[p][0])>=0};function y(e){return!g(e)&&!m(e)}var v=g,b=new this.Collection(this,function(){return ln(h[0][0],h[h.length-1][1],!c,!l)});return b._ondirectionchange=function(e){"next"===e?(v=g,f=i):(v=m,f=o),h.sort(d)},b._addAlgorithm(function(e,t,r){for(var o=e.key;v(o);)if(++p===h.length)return t(r),!1;return!!y(o)||(0===n._cmp(o,h[p][1])||0===n._cmp(o,h[p][0])||t(function(){f===i?e.continue(h[p][0]):e.continue(h[p][1])}),!1)}),b},e.prototype.startsWithAnyOf=function(){var e=z.apply(L,arguments);return e.every(function(e){return"string"==typeof e})?0===e.length?rn(this):this.inAnyRange(e.map(function(e){return[e,e+bt]})):nn(this,"startsWithAnyOf() only works with strings")},e}();function fn(e){return Lt(hn.prototype,function(t,n,r){if(this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r},this._cmp=this._ascending=Ot,this._descending=function(e,t){return Ot(t,e)},this._max=function(e,t){return Ot(e,t)>0?e:t},this._min=function(e,t){return Ot(e,t)<0?e:t},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new Z.MissingAPI})}function dn(e){return Xe(function(t){return pn(t),e(t.target.error),!1})}function pn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var gn="storagemutated",mn="x-storagemutated-1",yn=Ft(null,gn),vn=function(){function e(){}return e.prototype._lock=function(){return w(!De.global),++this._reculock,1!==this._reculock||De.global||(De.lockOwnerFor=this),this},e.prototype._unlock=function(){if(w(!De.global),0===--this._reculock)for(De.global||(De.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{dt(e[1],e[0])}catch(e){}}return this},e.prototype._locked=function(){return this._reculock&&De.lockOwnerFor!==this},e.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(w(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new Z.DatabaseClosed(r);case"MissingAPIError":throw new Z.MissingAPI(r.message,r);default:throw new Z.OpenFailed(r)}if(!this.active)throw new Z.TransactionInactive;return w(null===this._completion._state),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Xe(function(n){pn(n),t._reject(e.error)}),e.onabort=Xe(function(n){pn(n),t.active&&t._reject(new Z.Abort(e.error)),t.active=!1,t.on("abort").fire(n)}),e.oncomplete=Xe(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&yn.storagemutated.fire(e.mutatedParts)}),this},e.prototype._promise=function(e,t,n){var r=this;if("readwrite"===e&&"readwrite"!==this.mode)return mt(new Z.ReadOnly("Transaction is readonly"));if(!this.active)return mt(new Z.TransactionInactive);if(this._locked())return new Ie(function(i,o){r._blockedFuncs.push([function(){r._promise(e,t,n).then(i,o)},De])});if(n)return ot(function(){var e=new Ie(function(e,n){r._lock();var i=t(e,n,r);i&&i.then&&i.then(e,n)});return e.finally(function(){return r._unlock()}),e._lib=!0,e});var i=new Ie(function(e,n){var i=t(e,n,r);i&&i.then&&i.then(e,n)});return i._lib=!0,i},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(e){var t=this._root(),n=Ie.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then(function(){return n});else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var i=t._waitingFor;return new Ie(function(e,r){n.then(function(n){return t._waitingQueue.push(Xe(e.bind(null,n)))},function(e){return t._waitingQueue.push(Xe(r.bind(null,e)))}).finally(function(){t._waitingFor===i&&(t._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Z.Abort))},e.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(u(t,e))return t[e];var n=this.schema[e];if(!n)throw new Z.NotFound("Table "+e+" not part of transaction");var r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r},e}();function bn(e){return Lt(vn.prototype,function(t,n,r,i,o){var s=this;"readonly"!==t&&n.forEach(function(e){var t,i=null===(t=r[e])||void 0===t?void 0:t.yProps;i&&(n=n.concat(i.map(function(e){return e.updatesTable})))}),this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.chromeTransactionDurability=i,this.idbtrans=null,this.on=Ft(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Ie(function(e,t){s._resolve=e,s._reject=t}),this._completion.then(function(){s.active=!1,s.on.complete.fire()},function(e){var t=s.active;return s.active=!1,s.on.error.fire(e),s.parent?s.parent._reject(e):t&&s.idbtrans&&s.idbtrans.abort(),mt(e)})})}function wn(e,t,n,r,i,o,s,a){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:o,src:(n&&!s?"&":"")+(r?"*":"")+(i?"++":"")+xn(t),type:a}}function xn(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function kn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:k(n,function(e){return[e.name,e]})}}function _n(e){return 1===e.length?e[0]:e}var An=function(e){try{return e.only([[]]),An=function(){return[[]]},[[]]}catch(e){return An=function(){return bt},bt}};function Cn(e){return null==e?function(){}:"string"==typeof e?Sn(e):function(t){return _(t,e)}}function Sn(e){return 1===e.split(".").length?function(t){return t[e]}:function(t){return _(t,e)}}function jn(e){return[].slice.call(e)}var Pn=0;function En(e){return null==e?":id":"string"==typeof e?e:"[".concat(e.join("+"),"]")}function Tn(e,t,n){function r(e,t){var n=jn(e.objectStoreNames);return{schema:{name:e.name,tables:n.map(function(e){return t.objectStore(e)}).map(function(e){var t=e.keyPath,n=e.autoIncrement,r=s(t),i=null==t,o={},a={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:Cn(t)},indexes:jn(e.indexNames).map(function(t){return e.index(t)}).map(function(e){var t=e.name,n=e.unique,r=e.multiEntry,i=e.keyPath,a={name:t,compound:s(i),keyPath:i,unique:n,multiEntry:r,extractKey:Cn(i)};return o[En(i)]=a,a}),getIndexByKeyPath:function(e){return o[En(e)]}};return o[":id"]=a.primaryKey,null!=t&&(o[En(t)]=a.primaryKey),a})},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var n=e.lower,r=e.upper,i=e.lowerOpen,o=e.upperOpen;return void 0===n?void 0===r?null:t.upperBound(r,!!o):void 0===r?t.lowerBound(n,!!i):t.bound(n,r,!!i,!!o)}function o(e){var t=e.name;function n(e){var n=e.trans,r=e.type,o=e.keys,s=e.values,a=e.range;return new Promise(function(e,c){e=Xe(e);var l=n.objectStore(t),u=null==l.keyPath,h="put"===r||"add"===r;if(!h&&"delete"!==r&&"deleteRange"!==r)throw new Error("Invalid operation type: "+r);var f,d=(o||s||{length:1}).length;if(o&&s&&o.length!==s.length)throw new Error("Given keys array must have same length as given values array.");if(0===d)return e({numFailures:0,failures:{},results:[],lastResult:void 0});var p=[],g=[],m=0,y=function(e){++m,pn(e)};if("deleteRange"===r){if(4===a.type)return e({numFailures:m,failures:g,results:[],lastResult:void 0});3===a.type?p.push(f=l.clear()):p.push(f=l.delete(i(a)))}else{var v=h?u?[s,o]:[s,null]:[o,null],b=v[0],w=v[1];if(h)for(var x=0;x<d;++x)p.push(f=w&&void 0!==w[x]?l[r](b[x],w[x]):l[r](b[x])),f.onerror=y;else for(x=0;x<d;++x)p.push(f=l[r](b[x])),f.onerror=y}var k=function(t){var n=t.target.result;p.forEach(function(e,t){return null!=e.error&&(g[t]=e.error)}),e({numFailures:m,failures:g,results:"delete"===r?o:p.map(function(e){return e.result}),lastResult:n})};f.onerror=function(e){y(e),k(e)},f.onsuccess=k})}function r(e){var n=e.trans,r=e.values,o=e.query,s=e.reverse,a=e.unique;return new Promise(function(e,c){e=Xe(e);var l=o.index,u=o.range,h=n.objectStore(t),f=l.isPrimaryKey?h:h.index(l.name),d=s?a?"prevunique":"prev":a?"nextunique":"next",p=r||!("openKeyCursor"in f)?f.openCursor(i(u),d):f.openKeyCursor(i(u),d);p.onerror=dn(c),p.onsuccess=Xe(function(t){var r=p.result;if(r){r.___id=++Pn,r.done=!1;var i=r.continue.bind(r),o=r.continuePrimaryKey;o&&(o=o.bind(r));var s=r.advance.bind(r),a=function(){throw new Error("Cursor not started")},l=function(){throw new Error("Cursor not stopped")};r.trans=n,r.stop=r.continue=r.continuePrimaryKey=r.advance=a,r.fail=Xe(c),r.next=function(){var e=this,t=1;return this.start(function(){return t--?e.continue():e.stop()}).then(function(){return e})},r.start=function(e){var t=new Promise(function(e,t){e=Xe(e),p.onerror=dn(t),r.fail=t,r.stop=function(t){r.stop=r.continue=r.continuePrimaryKey=r.advance=l,e(t)}}),n=function(){if(p.result)try{e()}catch(e){r.fail(e)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()};return p.onsuccess=Xe(function(e){p.onsuccess=n,n()}),r.continue=i,r.continuePrimaryKey=o,r.advance=s,n(),t},e(r)}else e(null)},c)})}function o(e){return function(n){return new Promise(function(r,o){r=Xe(r);var s=n.trans,a=n.values,c=n.limit,l=n.query,u=c===1/0?void 0:c,h=l.index,f=l.range,d=s.objectStore(t),p=h.isPrimaryKey?d:d.index(h.name),g=i(f);if(0===c)return r({result:[]});if(e){var m=a?p.getAll(g,u):p.getAllKeys(g,u);m.onsuccess=function(e){return r({result:e.target.result})},m.onerror=dn(o)}else{var y=0,v=a||!("openKeyCursor"in p)?p.openCursor(g):p.openKeyCursor(g),b=[];v.onsuccess=function(e){var t=v.result;return t?(b.push(a?t.value:t.primaryKey),++y===c?r({result:b}):void t.continue()):r({result:b})},v.onerror=dn(o)}})}}return{name:t,schema:e,mutate:n,getMany:function(e){var n=e.trans,r=e.keys;return new Promise(function(e,i){e=Xe(e);for(var o,s=n.objectStore(t),a=r.length,c=new Array(a),l=0,u=0,h=function(t){var n=t.target;c[n._pos]=n.result,++u===l&&e(c)},f=dn(i),d=0;d<a;++d)null!=r[d]&&((o=s.get(r[d]))._pos=d,o.onsuccess=h,o.onerror=f,++l);0===l&&e(c)})},get:function(e){var n=e.trans,r=e.key;return new Promise(function(e,i){e=Xe(e);var o=n.objectStore(t).get(r);o.onsuccess=function(t){return e(t.target.result)},o.onerror=dn(i)})},query:o(l),openCursor:r,count:function(e){var n=e.query,r=e.trans,o=n.index,s=n.range;return new Promise(function(e,n){var a=r.objectStore(t),c=o.isPrimaryKey?a:a.index(o.name),l=i(s),u=l?c.count(l):c.count();u.onsuccess=Xe(function(t){return e(t.target.result)}),u.onerror=dn(n)})}}}var a=r(e,n),c=a.schema,l=a.hasGetAll,u=c.tables.map(function(e){return o(e)}),h={};return u.forEach(function(e){return h[e.name]=e}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!h[e])throw new Error("Table '".concat(e,"' not found"));return h[e]},MIN_KEY:-1/0,MAX_KEY:An(t),schema:c}}function On(e,t){return t.reduce(function(e,t){var r=t.create;return n(n({},e),r(e))},e)}function Dn(e,t,n,r){var i=n.IDBKeyRange;return n.indexedDB,{dbcore:On(Tn(t,i,r),e.dbcore)}}function Mn(e,t){var n=t.db,r=Dn(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach(function(t){var n=t.name;e.core.schema.tables.some(function(e){return e.name===n})&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))})}function Rn(e,t,n,r){n.forEach(function(n){var i=r[n];t.forEach(function(t){var r=m(t,n);(!r||"value"in r&&void 0===r.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?d(t,n,{get:function(){return this.table(n)},set:function(e){f(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,i))})})}function Bn(e,t){t.forEach(function(t){for(var n in t)t[n]instanceof e.Table&&delete t[n]})}function In(e,t){return e._cfg.version-t._cfg.version}function Kn(e,t,n,r){var i=e._dbSchema;n.objectStoreNames.contains("$meta")&&!i.$meta&&(i.$meta=kn("$meta",Gn("")[0],[]),e._storeNames.push("$meta"));var s=e._createTransaction("readwrite",e._storeNames,i);s.create(n),s._completion.catch(r);var a=s._reject.bind(s),c=De.transless||De;ot(function(){if(De.trans=s,De.transless=c,0!==t)return Mn(e,n),qn(e,s,t).then(function(t){return Fn(e,t,s,n)}).catch(a);o(i).forEach(function(e){zn(n,e,i[e].primKey,i[e].indexes)}),Mn(e,n),Ie.follow(function(){return e.on.populate.fire(s)}).catch(a)})}function $n(e,t){Nn(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=Qn(e,e.idbdb,t);Yn(e,e._dbSchema,t);for(var r=function(e){if(e.change.length||e.recreate)return console.warn("Unable to patch indexes of table ".concat(e.name," because it has changes on the type of index or primary key.")),{value:void 0};var n=t.objectStore(e.name);e.add.forEach(function(t){de&&console.debug("Dexie upgrade patch: Creating missing index ".concat(e.name,".").concat(t.src)),Un(n,t)})},i=0,o=Ln(n,e._dbSchema).change;i<o.length;i++){var s=r(o[i]);if("object"==typeof s)return s.value}}function qn(e,t,n){return t.storeNames.includes("$meta")?t.table("$meta").get("version").then(function(e){return null!=e?e:n}):Ie.resolve(n)}function Fn(e,t,n,r){var i=[],s=e._versions,a=e._dbSchema=Qn(e,e.idbdb,r),c=s.filter(function(e){return e._cfg.version>=t});if(0===c.length)return Ie.resolve();function l(){return i.length?Ie.resolve(i.shift()(n.idbtrans)).then(l):Ie.resolve()}return c.forEach(function(s){i.push(function(){var i=a,c=s._cfg.dbschema;Yn(e,i,r),Yn(e,c,r),a=e._dbSchema=c;var l=Ln(i,c);l.add.forEach(function(e){zn(r,e[0],e[1].primKey,e[1].indexes)}),l.change.forEach(function(e){if(e.recreate)throw new Z.Upgrade("Not yet support for changing primary key");var t=r.objectStore(e.name);e.add.forEach(function(e){return Un(t,e)}),e.change.forEach(function(e){t.deleteIndex(e.name),Un(t,e)}),e.del.forEach(function(e){return t.deleteIndex(e)})});var u=s._cfg.contentUpgrade;if(u&&s._cfg.version>t){Mn(e,r),n._memoizedTables={};var h=S(c);l.del.forEach(function(e){h[e]=i[e]}),Bn(e,[e.Transaction.prototype]),Rn(e,[e.Transaction.prototype],o(h),h),n.schema=h;var f,d=N(u);d&&st();var p=Ie.follow(function(){if((f=u(n))&&d){var e=at.bind(null,null);f.then(e,e)}});return f&&"function"==typeof f.then?Ie.resolve(f):p.then(function(){return f})}}),i.push(function(t){Wn(s._cfg.dbschema,t),Bn(e,[e.Transaction.prototype]),Rn(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}),i.push(function(t){e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===s._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter(function(e){return"$meta"!==e})):t.objectStore("$meta").put(s._cfg.version,"version"))})}),l().then(function(){Nn(a,r)})}function Ln(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var i=e[n],o=t[n];if(i){var s={name:n,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto)s.recreate=!0,r.change.push(s);else{var a=i.idxByName,c=o.idxByName,l=void 0;for(l in a)c[l]||s.del.push(l);for(l in c){var u=a[l],h=c[l];u?u.src!==h.src&&s.change.push(h):s.add.push(h)}(s.del.length>0||s.add.length>0||s.change.length>0)&&r.change.push(s)}}else r.add.push([n,o])}return r}function zn(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(e){return Un(i,e)}),i}function Nn(e,t){o(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(de&&console.debug("Dexie: Creating missing table",n),zn(t,n,e[n].primKey,e[n].indexes))})}function Wn(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(n){return null==e[n]&&t.db.deleteObjectStore(n)})}function Un(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Qn(e,t,n){var r={};return v(t.objectStoreNames,0).forEach(function(e){for(var t=n.objectStore(e),i=t.keyPath,o=wn(xn(i),i||"",!0,!1,!!t.autoIncrement,i&&"string"!=typeof i,!0),s=[],a=0;a<t.indexNames.length;++a){var c=t.index(t.indexNames[a]);i=c.keyPath;var l=wn(c.name,i,!!c.unique,!!c.multiEntry,!1,i&&"string"!=typeof i,!1);s.push(l)}r[e]=kn(e,o,s)}),r}function Hn(e,t,n){e.verno=t.version/10;var r=e._dbSchema=Qn(e,t,n);e._storeNames=v(t.objectStoreNames,0),Rn(e,[e._allTables],o(r),r)}function Vn(e,t){var n=Ln(Qn(e,e.idbdb,t),e._dbSchema);return!(n.add.length||n.change.some(function(e){return e.add.length||e.change.length}))}function Yn(e,t,n){for(var r=n.db.objectStoreNames,o=0;o<r.length;++o){var s=r[o],a=n.objectStore(s);e._hasGetAll="getAll"in a;for(var c=0;c<a.indexNames.length;++c){var l=a.indexNames[c],u=a.index(l).keyPath,h="string"==typeof u?u:"["+v(u).join("+")+"]";if(t[s]){var f=t[s].idxByName[h];f&&(f.name=l,delete t[s].idxByName[h],t[s].idxByName[l]=f)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function Gn(e){return e.split(",").map(function(e,t){var n,r=e.split(":"),i=null===(n=r[1])||void 0===n?void 0:n.trim(),o=(e=r[0].trim()).replace(/([&*]|\+\+)/g,""),a=/^\[/.test(o)?o.match(/^\[(.*)\]$/)[1].split("+"):o;return wn(o,a||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),s(a),0===t,i)})}var Jn,Xn=function(){function e(){}return e.prototype._createTableSchema=function(e,t,n){return kn(e,t,n)},e.prototype._parseIndexSyntax=function(e){return Gn(e)},e.prototype._parseStoresSpec=function(e,t){var n=this;o(e).forEach(function(r){if(null!==e[r]){var i=n._parseIndexSyntax(e[r]),o=i.shift();if(!o)throw new Z.Schema("Invalid schema for table "+r+": "+e[r]);if(o.unique=!0,o.multi)throw new Z.Schema("Primary key cannot be multiEntry*");i.forEach(function(e){if(e.auto)throw new Z.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new Z.Schema("Index must have a name and cannot be an empty string")});var s=n._createTableSchema(r,o,i);t[r]=s}})},e.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?a(this._cfg.storesSource,e):e;var n=t._versions,r={},i={};return n.forEach(function(e){a(r,e._cfg.storesSource),i=e._cfg.dbschema={},e._parseStoresSpec(r,i)}),t._dbSchema=i,Bn(t,[t._allTables,t,t.Transaction.prototype]),Rn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],o(i),i),t._storeNames=o(i),this},e.prototype.upgrade=function(e){return this._cfg.contentUpgrade=fe(this._cfg.contentUpgrade||re,e),this},e}();function Zn(e){return Lt(Xn.prototype,function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function er(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new ti(At,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function tr(e){return e&&"function"==typeof e.databases}function nr(e){var t=e.indexedDB,n=e.IDBKeyRange;return tr(t)?Promise.resolve(t.databases()).then(function(e){return e.map(function(e){return e.name}).filter(function(e){return e!==At})}):er(t,n).toCollection().primaryKeys()}function rr(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!tr(n)&&t!==At&&er(n,r).put({name:t}).catch(re)}function ir(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!tr(n)&&t!==At&&er(n,r).delete(t).catch(re)}function or(e){return ot(function(){return De.letThrough=!0,e()})}function sr(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(t){var n=function(){return indexedDB.databases().finally(t)};e=setInterval(n,100),n()}).finally(function(){return clearInterval(e)}):Promise.resolve()}function ar(e){return!("from"in e)}var cr=function(e,t){if(!this){var n=new cr;return e&&"d"in e&&a(n,e),n}a(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function lr(e,t,n){var r=Ot(t,n);if(!isNaN(r)){if(r>0)throw RangeError();if(ar(e))return a(e,{from:t,to:n,d:1});var i=e.l,o=e.r;if(Ot(n,e.from)<0)return i?lr(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},dr(e);if(Ot(t,e.to)>0)return o?lr(o,t,n):e.r={from:t,to:n,d:1,l:null,r:null},dr(e);Ot(t,e.from)<0&&(e.from=t,e.l=null,e.d=o?o.d+1:1),Ot(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var s=!e.r;i&&!e.l&&ur(e,i),o&&s&&ur(e,o)}}function ur(e,t){function n(e,t){var r=t.from,i=t.to,o=t.l,s=t.r;lr(e,r,i),o&&n(e,o),s&&n(e,s)}ar(t)||n(e,t)}function hr(e,t){var n=fr(t),r=n.next();if(r.done)return!1;for(var i=r.value,o=fr(e),s=o.next(i.from),a=s.value;!r.done&&!s.done;){if(Ot(a.from,i.to)<=0&&Ot(a.to,i.from)>=0)return!0;Ot(i.from,a.from)<0?i=(r=n.next(a.from)).value:a=(s=o.next(i.from)).value}return!1}function fr(e){var t=ar(e)?null:{s:0,n:e};return{next:function(e){for(var n=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&Ot(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||Ot(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function dr(e){var t,r,i=((null===(t=e.r)||void 0===t?void 0:t.d)||0)-((null===(r=e.l)||void 0===r?void 0:r.d)||0),o=i>1?"r":i<-1?"l":"";if(o){var s="r"===o?"l":"r",a=n({},e),c=e[o];e.from=c.from,e.to=c.to,e[o]=c[o],a[o]=c[s],e[s]=a,a.d=pr(a)}e.d=pr(e)}function pr(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function gr(e,t){return o(t).forEach(function(n){e[n]?ur(e[n],t[n]):e[n]=O(t[n])}),e}function mr(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&hr(t[n],e[n])})}h(cr.prototype,((Jn={add:function(e){return ur(this,e),this},addKey:function(e){return lr(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(e){return lr(t,e,e)}),this},hasKey:function(e){var t=fr(this).next(e).value;return t&&Ot(t.from,e)<=0&&Ot(t.to,e)>=0}})[$]=function(){return fr(this)},Jn));var yr={},vr={},br=!1;function wr(e,t){gr(vr,e),br||(br=!0,setTimeout(function(){br=!1;var e=vr;vr={},xr(e,!1)},0))}function xr(e,t){void 0===t&&(t=!1);var n=new Set;if(e.all)for(var r=0,i=Object.values(yr);r<i.length;r++)kr(a=i[r],e,n,t);else for(var o in e){var s=/^idb\:\/\/(.*)\/(.*)\//.exec(o);if(s){var a,c=s[1],l=s[2];(a=yr["idb://".concat(c,"/").concat(l)])&&kr(a,e,n,t)}}n.forEach(function(e){return e()})}function kr(e,t,n,r){for(var i=[],o=0,s=Object.entries(e.queries.query);o<s.length;o++){for(var a=s[o],c=a[0],l=[],u=0,h=a[1];u<h.length;u++){var f=h[u];mr(t,f.obsSet)?f.subscribers.forEach(function(e){return n.add(e)}):r&&l.push(f)}r&&i.push([c,l])}if(r)for(var d=0,p=i;d<p.length;d++){var g=p[d];c=g[0],l=g[1],e.queries.query[c]=l}}function _r(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?mt(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,i=Math.round(10*e.verno),o=!1;function s(){if(t.openCanceller!==r)throw new Z.DatabaseClosed("db.open() was cancelled")}var a=t.dbReadyResolve,c=null,l=!1,u=function(){return new Ie(function(r,a){if(s(),!n)throw new Z.MissingAPI;var h=e.name,f=t.autoSchema||!i?n.open(h):n.open(h,i);if(!f)throw new Z.MissingAPI;f.onerror=dn(a),f.onblocked=Xe(e._fireOnBlocked),f.onupgradeneeded=Xe(function(r){if(c=f.transaction,t.autoSchema&&!e._options.allowEmptyDB){f.onerror=pn,c.abort(),f.result.close();var i=n.deleteDatabase(h);i.onsuccess=i.onerror=Xe(function(){a(new Z.NoSuchDatabase("Database ".concat(h," doesnt exist")))})}else{c.onerror=dn(a);var s=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;l=s<1,e.idbdb=f.result,o&&$n(e,c),Kn(e,s/10,c,a)}},a),f.onsuccess=Xe(function(){c=null;var n=e.idbdb=f.result,s=v(n.objectStoreNames);if(s.length>0)try{var a=n.transaction(_n(s),"readonly");if(t.autoSchema)Hn(e,n,a);else if(Yn(e,e._dbSchema,a),!Vn(e,a)&&!o)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),n.close(),i=n.version+1,o=!0,r(u());Mn(e,a)}catch(e){}_t.push(e),n.onversionchange=Xe(function(n){t.vcFired=!0,e.on("versionchange").fire(n)}),n.onclose=Xe(function(){e.close({disableAutoOpen:!1})}),l&&rr(e._deps,h),r()},a)}).catch(function(e){switch(null==e?void 0:e.name){case"UnknownError":if(t.PR1398_maxLoop>0)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),u();break;case"VersionError":if(i>0)return i=0,u()}return Ie.reject(e)})};return Ie.race([r,("undefined"==typeof navigator?Ie.resolve():sr()).then(u)]).then(function(){return s(),t.onReadyBeingFired=[],Ie.resolve(or(function(){return e.on.ready.fire(e.vip)})).then(function n(){if(t.onReadyBeingFired.length>0){var r=t.onReadyBeingFired.reduce(fe,re);return t.onReadyBeingFired=[],Ie.resolve(or(function(){return r(e.vip)})).then(n)}})}).finally(function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(n){t.dbOpenError=n;try{c&&c.abort()}catch(e){}return r===t.openCanceller&&e._close(),mt(n)}).finally(function(){t.openComplete=!0,a()}).then(function(){if(l){var t={};e.tables.forEach(function(n){n.schema.indexes.forEach(function(r){r.name&&(t["idb://".concat(e.name,"/").concat(n.name,"/").concat(r.name)]=new cr(-1/0,[[[]]]))}),t["idb://".concat(e.name,"/").concat(n.name,"/")]=t["idb://".concat(e.name,"/").concat(n.name,"/:dels")]=new cr(-1/0,[[[]]])}),yn(gn).fire(t),xr(t,!0)}return e})}function Ar(e){var t=function(t){return e.next(t)},n=function(t){return e.throw(t)},r=o(t),i=o(n);function o(e){return function(t){var n=e(t),o=n.value;return n.done?o:o&&"function"==typeof o.then?o.then(r,i):s(o)?Promise.all(o).then(r,i):r(o)}}return o(t)()}function Cr(e,t,n){var r=arguments.length;if(r<2)throw new Z.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];return n=i.pop(),[e,P(i),n]}function Sr(e,t,n,r,i){return Ie.resolve().then(function(){var o=De.transless||De,s=e._createTransaction(t,n,e._dbSchema,r);s.explicit=!0;var a={trans:s,transless:o};if(r)s.idbtrans=r.idbtrans;else try{s.create(),s.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(r){return r.name===J.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return Sr(e,t,n,null,i)})):mt(r)}var c,l=N(i);l&&st();var u=Ie.follow(function(){if(c=i.call(s,s))if(l){var e=at.bind(null,null);c.then(e,e)}else"function"==typeof c.next&&"function"==typeof c.throw&&(c=Ar(c))},a);return(c&&"function"==typeof c.then?Ie.resolve(c).then(function(e){return s.active?e:mt(new Z.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):u.then(function(){return c})).then(function(e){return r&&s._resolve(),s._completion.then(function(){return e})}).catch(function(e){return s._reject(e),mt(e)})})}function jr(e,t,n){for(var r=s(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}function Pr(e){return n(n({},e),{table:function(t){var r=e.table(t),i=r.schema,o={},s=[];function a(e,t,r){var i=En(e),c=o[i]=o[i]||[],l=null==e?0:"string"==typeof e?1:e.length,u=t>0,h=n(n({},r),{name:u?"".concat(i,"(virtual-from:").concat(r.name,")"):r.name,lowLevelIndex:r,isVirtual:u,keyTail:t,keyLength:l,extractKey:Cn(e),unique:!u&&r.unique});return c.push(h),h.isPrimaryKey||s.push(h),l>1&&a(2===l?e[0]:e.slice(0,l-1),t+1,r),c.sort(function(e,t){return e.keyTail-t.keyTail}),h}var c=a(i.primaryKey.keyPath,0,i.primaryKey);o[":id"]=[c];for(var l=0,u=i.indexes;l<u.length;l++){var h=u[l];a(h.keyPath,0,h)}function f(e){var t=o[En(e)];return t&&t[0]}function d(t,n){return{type:1===t.type?2:t.type,lower:jr(t.lower,t.lowerOpen?e.MAX_KEY:e.MIN_KEY,n),lowerOpen:!0,upper:jr(t.upper,t.upperOpen?e.MIN_KEY:e.MAX_KEY,n),upperOpen:!0}}function p(e){var t=e.query.index;return t.isVirtual?n(n({},e),{query:{index:t.lowLevelIndex,range:d(e.query.range,t.keyTail)}}):e}var g=n(n({},r),{schema:n(n({},i),{primaryKey:c,indexes:s,getIndexByKeyPath:f}),count:function(e){return r.count(p(e))},query:function(e){return r.query(p(e))},openCursor:function(t){var n=t.query.index,i=n.keyTail,o=n.isVirtual,s=n.keyLength;if(!o)return r.openCursor(t);function a(n){function r(r){null!=r?n.continue(jr(r,t.reverse?e.MAX_KEY:e.MIN_KEY,i)):t.unique?n.continue(n.key.slice(0,s).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,i)):n.continue()}var o=Object.create(n,{continue:{value:r},continuePrimaryKey:{value:function(t,r){n.continuePrimaryKey(jr(t,e.MAX_KEY,i),r)}},primaryKey:{get:function(){return n.primaryKey}},key:{get:function(){var e=n.key;return 1===s?e[0]:e.slice(0,s)}},value:{get:function(){return n.value}}});return o}return r.openCursor(p(t)).then(function(e){return e&&a(e)})}});return g}})}var Er={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:Pr};function Tr(e,t,n,r){return n=n||{},r=r||"",o(e).forEach(function(i){if(u(t,i)){var o=e[i],s=t[i];if("object"==typeof o&&"object"==typeof s&&o&&s){var a=K(o);a!==K(s)?n[r+i]=t[i]:"Object"===a?Tr(o,s,n,r+i+"."):o!==s&&(n[r+i]=t[i])}else o!==s&&(n[r+i]=t[i])}else n[r+i]=void 0}),o(t).forEach(function(i){u(e,i)||(n[r+i]=t[i])}),n}function Or(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}var Dr={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return n(n({},e),{table:function(t){var i=e.table(t),o=i.schema.primaryKey,s=n(n({},i),{mutate:function(e){var s=De.trans,a=s.table(t).hook,c=a.deleting,l=a.creating,h=a.updating;switch(e.type){case"add":if(l.fire===re)break;return s._promise("readwrite",function(){return f(e)},!0);case"put":if(l.fire===re&&h.fire===re)break;return s._promise("readwrite",function(){return f(e)},!0);case"delete":if(c.fire===re)break;return s._promise("readwrite",function(){return f(e)},!0);case"deleteRange":if(c.fire===re)break;return s._promise("readwrite",function(){return d(e)},!0)}return i.mutate(e);function f(e){var t=De.trans,s=e.keys||Or(o,e);if(!s)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?n(n({},e),{keys:s}):n({},e)).type&&(e.values=r([],e.values,!0)),e.keys&&(e.keys=r([],e.keys,!0)),Mr(i,e,s).then(function(n){var r=s.map(function(r,i){var s=n[i],a={onerror:null,onsuccess:null};if("delete"===e.type)c.fire.call(a,r,s,t);else if("add"===e.type||void 0===s){var f=l.fire.call(a,r,e.values[i],t);null==r&&null!=f&&(r=f,e.keys[i]=r,o.outbound||A(e.values[i],o.keyPath,r))}else{var d=Tr(s,e.values[i]),p=h.fire.call(a,d,r,s,t);if(p){var g=e.values[i];Object.keys(p).forEach(function(e){u(g,e)?g[e]=p[e]:A(g,e,p[e])})}}return a});return i.mutate(e).then(function(t){for(var i=t.failures,o=t.results,a=t.numFailures,c=t.lastResult,l=0;l<s.length;++l){var u=o?o[l]:s[l],h=r[l];null==u?h.onerror&&h.onerror(i[l]):h.onsuccess&&h.onsuccess("put"===e.type&&n[l]?e.values[l]:u)}return{failures:i,results:o,numFailures:a,lastResult:c}}).catch(function(e){return r.forEach(function(t){return t.onerror&&t.onerror(e)}),Promise.reject(e)})})}function d(e){return p(e.trans,e.range,1e4)}function p(e,t,r){return i.query({trans:e,values:!1,query:{index:o,range:t},limit:r}).then(function(i){var o=i.result;return f({type:"delete",keys:o,trans:e}).then(function(i){return i.numFailures>0?Promise.reject(i.failures[0]):o.length<r?{failures:[],numFailures:0,lastResult:void 0}:p(e,n(n({},t),{lower:o[o.length-1],lowerOpen:!0}),r)})})}}});return s}})}};function Mr(e,t,n){return"add"===t.type?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}function Rr(e,t,n){try{if(!t)return null;if(t.keys.length<e.length)return null;for(var r=[],i=0,o=0;i<t.keys.length&&o<e.length;++i)0===Ot(t.keys[i],e[o])&&(r.push(n?R(t.values[i]):t.values[i]),++o);return r.length===e.length?r:null}catch(e){return null}}var Br={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var r=e.table(t);return n(n({},r),{getMany:function(e){if(!e.cache)return r.getMany(e);var t=Rr(e.keys,e.trans._cache,"clone"===e.cache);return t?Ie.resolve(t):r.getMany(e).then(function(t){return e.trans._cache={keys:e.keys,values:"clone"===e.cache?R(t):t},t})},mutate:function(e){return"add"!==e.type&&(e.trans._cache=null),r.mutate(e)}})}}}};function Ir(e,t){return"readonly"===e.trans.mode&&!!e.subscr&&!e.trans.explicit&&"disabled"!==e.trans.db._options.cache&&!t.schema.primaryKey.outbound}function Kr(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var $r={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,r=new cr(e.MIN_KEY,e.MAX_KEY);return n(n({},e),{transaction:function(t,n,r){if(De.subscr&&"readonly"!==n)throw new Z.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(De.querier));return e.transaction(t,n,r)},table:function(i){var a=e.table(i),c=a.schema,l=c.primaryKey,u=c.indexes,h=l.extractKey,f=l.outbound,d=l.autoIncrement&&u.filter(function(e){return e.compound&&e.keyPath.includes(l.keyPath)}),p=n(n({},a),{mutate:function(n){var o,u,h=n.trans,f=n.mutatedParts||(n.mutatedParts={}),p=function(e){var n="idb://".concat(t,"/").concat(i,"/").concat(e);return f[n]||(f[n]=new cr)},g=p(""),m=p(":dels"),y=n.type,v="deleteRange"===n.type?[n.range]:"delete"===n.type?[n.keys]:n.values.length<50?[Or(l,n).filter(function(e){return e}),n.values]:[],b=v[0],w=v[1],x=n.trans._cache;if(s(b)){g.addKeys(b);var k="delete"===y||b.length===w.length?Rr(b,x):null;k||m.addKeys(b),(k||w)&&qr(p,c,k,w)}else if(b){var _={from:null!==(o=b.lower)&&void 0!==o?o:e.MIN_KEY,to:null!==(u=b.upper)&&void 0!==u?u:e.MAX_KEY};m.add(_),g.add(_)}else g.add(r),m.add(r),c.indexes.forEach(function(e){return p(e.name).add(r)});return a.mutate(n).then(function(e){return!b||"add"!==n.type&&"put"!==n.type||(g.addKeys(e.results),d&&d.forEach(function(t){for(var r=n.values.map(function(e){return t.extractKey(e)}),i=t.keyPath.findIndex(function(e){return e===l.keyPath}),o=0,s=e.results.length;o<s;++o)r[o][i]=e.results[o];p(t.name).addKeys(r)})),h.mutatedParts=gr(h.mutatedParts||{},f),e})}}),g=function(t){var n,r,i=t.query,o=i.index,s=i.range;return[o,new cr(null!==(n=s.lower)&&void 0!==n?n:e.MIN_KEY,null!==(r=s.upper)&&void 0!==r?r:e.MAX_KEY)]},m={get:function(e){return[l,new cr(e.key)]},getMany:function(e){return[l,(new cr).addKeys(e.keys)]},count:g,query:g,openCursor:g};return o(m).forEach(function(e){p[e]=function(o){var s=De.subscr,c=!!s,l=Ir(De,a)&&Kr(e,o)?o.obsSet={}:s;if(c){var u=function(e){var n="idb://".concat(t,"/").concat(i,"/").concat(e);return l[n]||(l[n]=new cr)},d=u(""),p=u(":dels"),g=m[e](o),y=g[0],v=g[1];if("query"===e&&y.isPrimaryKey&&!o.values?p.add(v):u(y.name||"").add(v),!y.isPrimaryKey){if("count"!==e){var b="query"===e&&f&&o.values&&a.query(n(n({},o),{values:!1}));return a[e].apply(this,arguments).then(function(t){if("query"===e){if(f&&o.values)return b.then(function(e){var n=e.result;return d.addKeys(n),t});var n=o.values?t.result.map(h):t.result;o.values?d.addKeys(n):p.addKeys(n)}else if("openCursor"===e){var r=t,i=o.values;return r&&Object.create(r,{key:{get:function(){return p.addKey(r.primaryKey),r.key}},primaryKey:{get:function(){var e=r.primaryKey;return p.addKey(e),e}},value:{get:function(){return i&&d.addKey(r.primaryKey),r.value}}})}return t})}p.add(r)}}return a[e].apply(this,arguments)}}),p}})}};function qr(e,t,n,r){function i(t){var i=e(t.name||"");function o(e){return null!=e?t.extractKey(e):null}var a=function(e){return t.multiEntry&&s(e)?e.forEach(function(e){return i.addKey(e)}):i.addKey(e)};(n||r).forEach(function(e,t){var i=n&&o(n[t]),s=r&&o(r[t]);0!==Ot(i,s)&&(null!=i&&a(i),null!=s&&a(s))})}t.indexes.forEach(i)}function Fr(e,t,r){if(0===r.numFailures)return t;if("deleteRange"===t.type)return null;var i=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;if(r.numFailures===i)return null;var o=n({},t);return s(o.keys)&&(o.keys=o.keys.filter(function(e,t){return!(t in r.failures)})),"values"in o&&s(o.values)&&(o.values=o.values.filter(function(e,t){return!(t in r.failures)})),o}function Lr(e,t){return void 0===t.lower||(t.lowerOpen?Ot(e,t.lower)>0:Ot(e,t.lower)>=0)}function zr(e,t){return void 0===t.upper||(t.upperOpen?Ot(e,t.upper)<0:Ot(e,t.upper)<=0)}function Nr(e,t){return Lr(e,t)&&zr(e,t)}function Wr(e,t,n,r,i,o){if(!n||0===n.length)return e;var a=t.query.index,c=a.multiEntry,l=t.query.range,u=r.schema.primaryKey.extractKey,h=a.extractKey,f=(a.lowLevelIndex||a).extractKey,d=n.reduce(function(e,n){var r=e,i=[];if("add"===n.type||"put"===n.type)for(var o=new cr,a=n.values.length-1;a>=0;--a){var f=n.values[a],d=u(f);if(!o.hasKey(d)){var p=h(f);(c&&s(p)?p.some(function(e){return Nr(e,l)}):Nr(p,l))&&(o.addKey(d),i.push(f))}}switch(n.type){case"add":var g=(new cr).addKeys(t.values?e.map(function(e){return u(e)}):e);r=e.concat(t.values?i.filter(function(e){var t=u(e);return!g.hasKey(t)&&(g.addKey(t),!0)}):i.map(function(e){return u(e)}).filter(function(e){return!g.hasKey(e)&&(g.addKey(e),!0)}));break;case"put":var m=(new cr).addKeys(n.values.map(function(e){return u(e)}));r=e.filter(function(e){return!m.hasKey(t.values?u(e):e)}).concat(t.values?i:i.map(function(e){return u(e)}));break;case"delete":var y=(new cr).addKeys(n.keys);r=e.filter(function(e){return!y.hasKey(t.values?u(e):e)});break;case"deleteRange":var v=n.range;r=e.filter(function(e){return!Nr(u(e),v)})}return r},e);return d===e?e:(d.sort(function(e,t){return Ot(f(e),f(t))||Ot(u(e),u(t))}),t.limit&&t.limit<1/0&&(d.length>t.limit?d.length=t.limit:e.length===t.limit&&d.length<t.limit&&(i.dirty=!0)),o?Object.freeze(d):d)}function Ur(e,t){return 0===Ot(e.lower,t.lower)&&0===Ot(e.upper,t.upper)&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Qr(e,t,n,r){if(void 0===e)return void 0!==t?-1:0;if(void 0===t)return 1;var i=Ot(e,t);if(0===i){if(n&&r)return 0;if(n)return 1;if(r)return-1}return i}function Hr(e,t,n,r){if(void 0===e)return void 0!==t?1:0;if(void 0===t)return-1;var i=Ot(e,t);if(0===i){if(n&&r)return 0;if(n)return-1;if(r)return 1}return i}function Vr(e,t){return Qr(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&Hr(e.upper,t.upper,e.upperOpen,t.upperOpen)>=0}function Yr(e,t,n,r){var i=yr["idb://".concat(e,"/").concat(t)];if(!i)return[];var o=i.queries[n];if(!o)return[null,!1,i,null];var s=o[(r.query?r.query.index.name:null)||""];if(!s)return[null,!1,i,null];switch(n){case"query":var a=s.find(function(e){return e.req.limit===r.limit&&e.req.values===r.values&&Ur(e.req.query.range,r.query.range)});return a?[a,!0,i,s]:[s.find(function(e){return("limit"in e.req?e.req.limit:1/0)>=r.limit&&(!r.values||e.req.values)&&Vr(e.req.query.range,r.query.range)}),!1,i,s];case"count":var c=s.find(function(e){return Ur(e.req.query.range,r.query.range)});return[c,!!c,i,s]}}function Gr(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",function(){e.subscribers.delete(n),0===e.subscribers.size&&Jr(e,t)})}function Jr(e,t){setTimeout(function(){0===e.subscribers.size&&F(t,e)},3e3)}var Xr={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name,r=n(n({},e),{transaction:function(n,r,i){var o=e.transaction(n,r,i);if("readwrite"===r){var s=new AbortController,a=s.signal,c=function(i){return function(){if(s.abort(),"readwrite"===r){for(var a=new Set,c=0,l=n;c<l.length;c++){var u=l[c],h=yr["idb://".concat(t,"/").concat(u)];if(h){var f=e.table(u),d=h.optimisticOps.filter(function(e){return e.trans===o});if(o._explicit&&i&&o.mutatedParts)for(var p=0,g=Object.values(h.queries.query);p<g.length;p++)for(var m=0,y=(w=g[p]).slice();m<y.length;m++)mr((_=y[m]).obsSet,o.mutatedParts)&&(F(w,_),_.subscribers.forEach(function(e){return a.add(e)}));else if(d.length>0){h.optimisticOps=h.optimisticOps.filter(function(e){return e.trans!==o});for(var v=0,b=Object.values(h.queries.query);v<b.length;v++)for(var w,x=0,k=(w=b[v]).slice();x<k.length;x++){var _;if(null!=(_=k[x]).res&&o.mutatedParts)if(i&&!_.dirty){var A=Object.isFrozen(_.res),C=Wr(_.res,_.req,d,f,_,A);_.dirty?(F(w,_),_.subscribers.forEach(function(e){return a.add(e)})):C!==_.res&&(_.res=C,_.promise=Ie.resolve({result:C}))}else _.dirty&&F(w,_),_.subscribers.forEach(function(e){return a.add(e)})}}}}a.forEach(function(e){return e()})}}};o.addEventListener("abort",c(!1),{signal:a}),o.addEventListener("error",c(!1),{signal:a}),o.addEventListener("complete",c(!0),{signal:a})}return o},table:function(r){var i=e.table(r),o=i.schema.primaryKey,s=n(n({},i),{mutate:function(e){var s=De.trans;if(o.outbound||"disabled"===s.db._options.cache||s.explicit||"readwrite"!==s.idbtrans.mode)return i.mutate(e);var a=yr["idb://".concat(t,"/").concat(r)];if(!a)return i.mutate(e);var c=i.mutate(e);return"add"!==e.type&&"put"!==e.type||!(e.values.length>=50||Or(o,e).some(function(e){return null==e}))?(a.optimisticOps.push(e),e.mutatedParts&&wr(e.mutatedParts),c.then(function(t){if(t.numFailures>0){F(a.optimisticOps,e);var n=Fr(a,e,t);n&&a.optimisticOps.push(n),e.mutatedParts&&wr(e.mutatedParts)}}),c.catch(function(){F(a.optimisticOps,e),e.mutatedParts&&wr(e.mutatedParts)})):c.then(function(t){var r=n(n({},e),{values:e.values.map(function(e,r){var i;if(t.failures[r])return e;var s=(null===(i=o.keyPath)||void 0===i?void 0:i.includes("."))?R(e):n({},e);return A(s,o.keyPath,t.results[r]),s})}),i=Fr(a,r,t);a.optimisticOps.push(i),queueMicrotask(function(){return e.mutatedParts&&wr(e.mutatedParts)})}),c},query:function(e){var n;if(!Ir(De,i)||!Kr("query",e))return i.query(e);var o="immutable"===(null===(n=De.trans)||void 0===n?void 0:n.db._options.cache),s=De,a=s.requery,c=s.signal,l=Yr(t,r,"query",e),u=l[0],h=l[1],f=l[2],d=l[3];if(u&&h)u.obsSet=e.obsSet;else{var p=i.query(e).then(function(e){var t=e.result;if(u&&(u.res=t),o){for(var n=0,r=t.length;n<r;++n)Object.freeze(t[n]);Object.freeze(t)}else e.result=R(t);return e}).catch(function(e){return d&&u&&F(d,u),Promise.reject(e)});u={obsSet:e.obsSet,promise:p,subscribers:new Set,type:"query",req:e,dirty:!1},d?d.push(u):(d=[u],f||(f=yr["idb://".concat(t,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),f.queries.query[e.query.index.name||""]=d)}return Gr(u,d,a,c),u.promise.then(function(t){return{result:Wr(t.result,e,null==f?void 0:f.optimisticOps,i,u,o)}})}});return s}});return r}};function Zr(e,t){return new Proxy(e,{get:function(e,n,r){return"db"===n?t:Reflect.get(e,n,r)}})}var ei,ti=function(){function e(t,r){var i=this;this._middlewares={},this.verno=0;var o=e.dependencies;this._options=r=n({addons:e.addons,autoOpen:!0,indexedDB:o.indexedDB,IDBKeyRange:o.IDBKeyRange,cache:"cloned"},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};var s=r.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:re,dbReadyPromise:null,cancelOpen:re,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:r.autoOpen};a.dbReadyPromise=new Ie(function(e){a.dbReadyResolve=e}),a.openCanceller=new Ie(function(e,t){a.cancelOpen=t}),this._state=a,this.name=t,this.on=Ft(this,"populate","blocked","versionchange","close",{ready:[fe,re]}),this.once=function(e,t){var n=function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];i.on(e).unsubscribe(n),t.apply(i,r)};return i.on(e,n)},this.on.ready.subscribe=b(this.on.ready.subscribe,function(t){return function(n,r){e.vip(function(){var e=i._state;if(e.openComplete)e.dbOpenError||Ie.resolve().then(n),r&&t(n);else if(e.onReadyBeingFired)e.onReadyBeingFired.push(n),r&&t(n);else{t(n);var o=i;r||t(function e(){o.on.ready.unsubscribe(n),o.on.ready.unsubscribe(e)})}})}}),this.Collection=Zt(this),this.Table=zt(this),this.Transaction=bn(this),this.Version=Zn(this),this.WhereClause=fn(this),this.on("versionchange",function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(i.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(i.name,"'. Closing db now to resume the delete request.")),i.close({disableAutoOpen:!1})}),this.on("blocked",function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('".concat(i.name,"') was blocked")):console.warn("Upgrade '".concat(i.name,"' blocked by other connection holding version ").concat(e.oldVersion/10))}),this._maxKey=An(r.IDBKeyRange),this._createTransaction=function(e,t,n,r){return new i.Transaction(e,t,n,i._options.chromeTransactionDurability,r)},this._fireOnBlocked=function(e){i.on("blocked").fire(e),_t.filter(function(e){return e.name===i.name&&e!==i&&!e._state.vcFired}).map(function(t){return t.on("versionchange").fire(e)})},this.use(Br),this.use(Xr),this.use($r),this.use(Er),this.use(Dr);var c=new Proxy(this,{get:function(e,t,n){if("_vip"===t)return!0;if("table"===t)return function(e){return Zr(i.table(e),c)};var r=Reflect.get(e,t,n);return r instanceof qt?Zr(r,c):"tables"===t?r.map(function(e){return Zr(e,c)}):"_createTransaction"===t?function(){return Zr(r.apply(this,arguments),c)}:r}});this.vip=c,s.forEach(function(e){return e(i)})}return e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new Z.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new Z.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(t){return t._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort(In),n.stores({}),this._state.autoSchema=!1,n)},e.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||De.letThrough||this._vip)?e():new Ie(function(e,n){if(t._state.openComplete)return n(new Z.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void n(new Z.DatabaseClosed);t.open().catch(re)}t._state.dbReadyPromise.then(e,n)}).then(e)},e.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,i=e.name;i&&this.unuse({stack:t,name:i});var o=this._middlewares[t]||(this._middlewares[t]=[]);return o.push({stack:t,create:n,level:null==r?10:r,name:i}),o.sort(function(e,t){return e.level-t.level}),this},e.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(e){return r?e.create!==r:!!n&&e.name!==n})),this},e.prototype.open=function(){var e=this;return dt(Oe,function(){return _r(e)})},e.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var e=this._state,t=_t.indexOf(this);if(t>=0&&_t.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(e){}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new Ie(function(t){e.dbReadyResolve=t}),e.openCanceller=new Ie(function(t,n){e.cancelOpen=n}))},e.prototype.close=function(e){var t=(void 0===e?{disableAutoOpen:!0}:e).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new Z.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new Z.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},e.prototype.delete=function(e){var t=this;void 0===e&&(e={disableAutoOpen:!0});var n=arguments.length>0&&"object"!=typeof arguments[0],r=this._state;return new Ie(function(i,o){var s=function(){t.close(e);var n=t._deps.indexedDB.deleteDatabase(t.name);n.onsuccess=Xe(function(){ir(t._deps,t.name),i()}),n.onerror=dn(o),n.onblocked=t._fireOnBlocked};if(n)throw new Z.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(s):s()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return null!==this.idbdb},e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},e.prototype.hasFailed=function(){return null!==this._state.dbOpenError},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var e=this;return o(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var e=Cr.apply(this,arguments);return this._transaction.apply(this,e)},e.prototype._transaction=function(e,t,n){var r=this,i=De.trans;i&&i.db===this&&-1===e.indexOf("!")||(i=null);var o,s,a=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(s=t.map(function(e){var t=e instanceof r.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t}),"r"==e||e===Ct)o=Ct;else{if("rw"!=e&&e!=St)throw new Z.InvalidArgument("Invalid transaction mode: "+e);o=St}if(i){if(i.mode===Ct&&o===St){if(!a)throw new Z.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&s.forEach(function(e){if(i&&-1===i.storeNames.indexOf(e)){if(!a)throw new Z.SubTransaction("Table "+e+" not included in parent transaction.");i=null}}),a&&i&&!i.active&&(i=null)}}catch(e){return i?i._promise(null,function(t,n){n(e)}):mt(e)}var c=Sr.bind(null,this,o,s,i,n);return i?i._promise(o,c,"lock"):De.trans?dt(De.transless,function(){return r._whenReady(c)}):this._whenReady(c)},e.prototype.table=function(e){if(!u(this._allTables,e))throw new Z.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},e}(),ni="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable",ri=function(){function e(e){this._subscribe=e}return e.prototype.subscribe=function(e,t,n){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:n})},e.prototype[ni]=function(){return this},e}();try{ei={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch(e){ei={indexedDB:null,IDBKeyRange:null}}function ii(e){var t,n=!1,r=new ri(function(r){var i=N(e);function o(t){var n=Ue();try{i&&st();var r=ot(e,t);return i&&(r=r.finally(at)),r}finally{n&&Qe()}}var s,a=!1,c={},l={},u={get closed(){return a},unsubscribe:function(){a||(a=!0,s&&s.abort(),h&&yn.storagemutated.unsubscribe(p))}};r.start&&r.start(u);var h=!1,f=function(){return gt(g)};function d(){return mr(l,c)}var p=function(e){gr(c,e),d()&&f()},g=function(){if(!a&&ei.indexedDB){c={};var i={};s&&s.abort(),s=new AbortController;var u={subscr:i,signal:s.signal,requery:f,querier:e,trans:null},d=o(u);Promise.resolve(d).then(function(e){n=!0,t=e,a||u.signal.aborted||(c={},D(l=i)||h||(yn(gn,p),h=!0),gt(function(){return!a&&r.next&&r.next(e)}))},function(e){n=!1,["DatabaseClosedError","AbortError"].includes(null==e?void 0:e.name)||a||gt(function(){a||r.error&&r.error(e)})})}};return setTimeout(f,0),u});return r.hasValue=function(){return n},r.getValue=function(){return t},r}var oi=ti;function si(e){var t=ci;try{ci=!0,yn.storagemutated.fire(e),xr(e,!0)}finally{ci=t}}h(oi,n(n({},ne),{delete:function(e){return new oi(e,{addons:[]}).delete()},exists:function(e){return new oi(e,{addons:[]}).open().then(function(e){return e.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return nr(oi.dependencies).then(e)}catch(e){return mt(new Z.MissingAPI)}},defineClass:function(){function e(e){a(this,e)}return e},ignoreTransaction:function(e){return De.trans?dt(De.transless,e):e()},vip:or,async:function(e){return function(){try{var t=Ar(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Ie.resolve(t)}catch(e){return mt(e)}}},spawn:function(e,t,n){try{var r=Ar(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:Ie.resolve(r)}catch(e){return mt(e)}},currentTransaction:{get:function(){return De.trans||null}},waitFor:function(e,t){var n=Ie.resolve("function"==typeof e?oi.ignoreTransaction(e):e).timeout(t||6e4);return De.trans?De.trans.waitFor(n):n},Promise:Ie,debug:{get:function(){return de},set:function(e){pe(e)}},derive:p,extend:a,props:h,override:b,Events:Ft,on:yn,liveQuery:ii,extendObservabilitySet:gr,getByKeyPath:_,setByKeyPath:A,delByKeyPath:C,shallowClone:S,deepClone:R,getObjectDiff:Tr,cmp:Ot,asap:x,minKey:wt,addons:[],connections:_t,errnames:J,dependencies:ei,cache:yr,semVer:vt,version:vt.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)})})),oi.maxKey=An(oi.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(yn(gn,function(e){var t;ci||(t=new CustomEvent(mn,{detail:e}),ci=!0,dispatchEvent(t),ci=!1)}),addEventListener(mn,function(e){var t=e.detail;ci||si(t)}));var ai,ci=!1,li=function(){};function ui(e){return new Kt({add:e})}function hi(e){return new Kt({remove:e})}function fi(e,t){return new Kt({replacePrefix:[e,t]})}return"undefined"!=typeof BroadcastChannel&&((li=function(){(ai=new BroadcastChannel(mn)).onmessage=function(e){return e.data&&si(e.data)}})(),"function"==typeof ai.unref&&ai.unref(),yn(gn,function(e){ci||ai.postMessage(e)})),"undefined"!=typeof addEventListener&&(addEventListener("pagehide",function(e){if(!ti.disableBfCache&&e.persisted){de&&console.debug("Dexie: handling persisted pagehide"),null==ai||ai.close();for(var t=0,n=_t;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!ti.disableBfCache&&e.persisted&&(de&&console.debug("Dexie: handling persisted pageshow"),li(),si({all:new cr(-1/0,[[]])}))})),Ie.rejectionMapper=te,pe(de),n(ti,Object.freeze({__proto__:null,Dexie:ti,liveQuery:ii,Entity:Tt,cmp:Ot,PropModification:Kt,replacePrefix:fi,add:ui,remove:hi,default:ti,RangeSet:cr,mergeRanges:ur,rangesOverlap:hr}),{default:ti}),ti}();var he=le(ue.exports);const fe=Symbol.for("Dexie"),de=globalThis[fe]||(globalThis[fe]=he);if(he.semVer!==de.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${he.semVer} and ${de.semVer}`);function pe(e){return{video:"Video",short:"Short",channel:"Channel",playlist:"Playlist",repo:"Repository",issue:"Issue",pr:"Pull Request",gist:"Gist",file:"File",wiki:"Wiki",article:"Article",profile:"Profile",question:"Question",package:"Package",subreddit:"Subreddit",post:"Post",tweet:"Tweet",home:"Home",search:"Search",page:"Page"}[e]||e}const ge=new de("BookmarkInsightsDB");async function me(){try{return await ge.bookmarks.toArray()}catch(e){return console.error("Error getting bookmarks:",e),[]}}async function ye(e,t,n=null){try{return await ge.cache.put({key:e,value:t,timestamp:Date.now(),ttl:n}),!0}catch(e){return console.error("Error setting cache:",e),!1}}ge.version(1).stores({bookmarks:"id, url, title, domain, category, dateAdded, lastAccessed, lastChecked, isAlive, parentId",enrichmentQueue:"++queueId, bookmarkId, addedAt, priority",events:"++eventId, bookmarkId, type, timestamp",cache:"key",settings:"key"}),ge.version(2).stores({bookmarks:"id, url, title, domain, category, dateAdded, lastAccessed, lastChecked, isAlive, parentId",enrichmentQueue:"++queueId, bookmarkId, addedAt, priority",events:"++eventId, bookmarkId, type, timestamp",cache:"key",settings:"key"}).upgrade(e=>{console.log("Upgrading database to version 2 - adding rawMetadata support")}),ge.version(3).stores({bookmarks:"id, url, title, domain, category, dateAdded, lastAccessed, lastChecked, isAlive, parentId",enrichmentQueue:"++queueId, bookmarkId, addedAt, priority",events:"++eventId, bookmarkId, type, timestamp",cache:"key",settings:"key",similarities:"++id, bookmark1Id, bookmark2Id, score, [bookmark1Id+bookmark2Id]",computedMetrics:"key"}).upgrade(e=>{console.log("Upgrading database to version 3 - adding similarities and computedMetrics tables")}),ge.version(4).stores({bookmarks:"id, url, title, domain, category, dateAdded, lastAccessed, lastChecked, isAlive, parentId, platform, creator, contentType",enrichmentQueue:"++queueId, bookmarkId, addedAt, priority",events:"++eventId, bookmarkId, type, timestamp",cache:"key",settings:"key",similarities:"++id, bookmark1Id, bookmark2Id, score, [bookmark1Id+bookmark2Id]",computedMetrics:"key"}).upgrade(e=>{console.log("Upgrading database to version 4 - adding platformData indexes")}),ge.version(5).stores({bookmarks:"id, url, title, domain, category, dateAdded, lastAccessed, lastChecked, isAlive, parentId, platform, creator, contentType, publishedDate",enrichmentQueue:"++queueId, bookmarkId, addedAt, priority",events:"++eventId, bookmarkId, type, timestamp",cache:"key",settings:"key",similarities:"++id, bookmark1Id, bookmark2Id, score, [bookmark1Id+bookmark2Id]",computedMetrics:"key"}).upgrade(e=>{console.log("Upgrading database to version 5 - adding deep metadata analysis fields")});const ve=36e5,be=3e5;async function we(e,t,n){try{const r=await ge.computedMetrics.get(e);if(r&&r.validUntil>Date.now())return console.log(`Cache hit for metric: ${e}`),r.data;console.log(`Cache miss for metric: ${e}, computing...`);const i=await t();return await ge.computedMetrics.put({key:e,data:i,computedAt:Date.now(),validUntil:Date.now()+n}),i}catch(n){return console.error(`Error getting cached metric ${e}:`,n),t()}}async function xe(){return we("domainAnalytics",async()=>{const e=await me(),t={};e.forEach(e=>{if(!e.domain)return;t[e.domain]||(t[e.domain]={domain:e.domain,count:0,latestDate:0,oldestDate:1/0,enrichedCount:0});const n=t[e.domain];n.count++,e.lastChecked&&n.enrichedCount++,e.dateAdded>n.latestDate&&(n.latestDate=e.dateAdded),e.dateAdded<n.oldestDate&&(n.oldestDate=e.dateAdded)});const n=Object.values(t),r=e.length;return n.forEach(e=>{e.percentage=r>0?Math.round(e.count/r*100):0,e.dateAdded=e.latestDate}),{byRecency:[...n].sort((e,t)=>t.latestDate-e.latestDate),byCount:[...n].sort((e,t)=>t.count-e.count),top10:[...n].sort((e,t)=>t.count-e.count).slice(0,10),totalDomains:n.length,totalBookmarks:r}},ve)}async function ke(){try{const e=await me(),t={};return e.forEach(e=>{e.folderPath&&(t[e.folderPath]=(t[e.folderPath]||0)+1)}),Object.entries(t).map(([e,t])=>({folder:e,count:t})).sort((e,t)=>t.count-e.count)}catch(e){return console.error("Error getting unique folders:",e),[]}}const _e=(()=>{const{subscribe:e,set:t,update:n}=se({total:0,enriched:0,pending:0,deadLinks:0,duplicates:0,uniqueDomains:0,addedThisWeek:0,addedThisMonth:0,lastUpdated:null,loading:!0});let r=null;return{subscribe:e,async refresh(){try{const e=await me(),n=Date.now(),r=6048e5,i=2592e6,o=e.length,s=e.filter(e=>e.lastChecked).length,a=e.filter(e=>!1===e.isAlive).length,c=new Set(e.map(e=>e.domain).filter(e=>e)).size,l=e.filter(e=>n-e.dateAdded<r).length,u=e.filter(e=>n-e.dateAdded<i).length,h=await we("quickDuplicateCount",async()=>{const t=new Map;return e.forEach(e=>{const n=e.url.toLowerCase().replace(/\/$/,"");t.has(n)||t.set(n,0),t.set(n,t.get(n)+1)}),Array.from(t.values()).filter(e=>e>1).length},be);t({total:o,enriched:s,pending:o-s,deadLinks:a,duplicates:h,uniqueDomains:c,addedThisWeek:l,addedThisMonth:u,lastUpdated:Date.now(),loading:!1})}catch(e){console.error("Error refreshing stats:",e),n(e=>({...e,loading:!1}))}},startAutoRefresh(e=3e4){if(this.refresh(),!r){r=setInterval(()=>{"undefined"!=typeof document&&"visible"===document.visibilityState&&this.refresh()},e),console.log("Stats auto-refresh started (visibility-aware)")}},stopAutoRefresh(){r&&(clearInterval(r),r=null,console.log("Stats auto-refresh stopped"))}}})();ae(_e,e=>0===e.total?0:Math.round(e.enriched/e.total*100)),ae(_e,e=>e.pending);const Ae=function(){const{subscribe:e,set:t,update:n}=se([]);let r=0,i=null;return{subscribe:e,set:t,getCached:async(n=3e4)=>{const o=Date.now();let s=[];if(e(e=>{s=e})(),s.length>0&&o-r<n)return s;if(i){const e=await i;return null!==e?e:s}i=(async()=>{try{const e=await me();return t(e),r=Date.now(),e}catch(e){return console.error("Error fetching bookmarks:",e),null}finally{i=null}})();const a=await i;return null!==a?a:s},refresh:async()=>{i=(async()=>{try{const e=await me();return t(e),r=Date.now(),e}catch(e){return console.error("Error refreshing bookmarks:",e),null}finally{i=null}})();const e=await i;return null!==e?e:[]},invalidate:()=>{r=0}}}();const Ce=function(){const{subscribe:e,set:t,update:n}=se({domains:[],folders:[],topics:[],types:[],creators:[],tags:[],deadLinks:!1,stale:!1,dateRange:null,readingTimeRange:null,qualityScoreRange:null,hasPublishedDate:null});return{subscribe:e,set:t,addFilter:(e,t)=>n(n=>{if(!Array.isArray(n[e]))return"boolean"==typeof n[e]?{...n,[e]:t}:{...n,[e]:t};if("creators"===e){if(!n.creators.find(e=>e.key===t.key))return{...n,creators:[...n.creators,t]}}else{const r=String(t).toLowerCase();if(!n[e].some(e=>String(e).toLowerCase()===r))return{...n,[e]:[...n[e],t]}}return n}),removeFilter:(e,t)=>n(n=>{if(Array.isArray(n[e])){if("creators"===e)return{...n,creators:n.creators.filter(e=>e.key!==t.key)};const r=String(t).toLowerCase();return{...n,[e]:n[e].filter(e=>String(e).toLowerCase()!==r)}}return"boolean"==typeof n[e]?{...n,[e]:!1}:{...n,[e]:null}}),toggleFilter:(e,t)=>n(n=>{if(Array.isArray(n[e])){if("creators"===e){return n.creators.find(e=>e.key===t.key)?{...n,creators:n.creators.filter(e=>e.key!==t.key)}:{...n,creators:[...n.creators,t]}}const r=String(t).toLowerCase(),i=n[e].findIndex(e=>String(e).toLowerCase()===r);return-1!==i?{...n,[e]:n[e].filter((e,t)=>t!==i)}:{...n,[e]:[...n[e],t]}}return"boolean"==typeof n[e]?{...n,[e]:!n[e]}:n}),setFilter:(e,t)=>n(n=>({...n,[e]:t})),clearFilters:()=>t({domains:[],folders:[],topics:[],types:[],creators:[],tags:[],deadLinks:!1,stale:!1,dateRange:null,readingTimeRange:null,qualityScoreRange:null,hasPublishedDate:null}),reset:()=>t({domains:[],folders:[],topics:[],types:[],creators:[],tags:[],deadLinks:!1,stale:!1,dateRange:null,readingTimeRange:null,qualityScoreRange:null,hasPublishedDate:null})}}();const Se=function(){const{subscribe:e,set:t,update:n}=se(new Set);return{subscribe:e,set:t,toggle:e=>n(t=>{const n=new Set(t);return n.has(e)?n.delete(e):n.add(e),n}),add:e=>n(t=>{const n=new Set(t);return n.add(e),n}),remove:e=>n(t=>{const n=new Set(t);return n.delete(e),n}),selectAll:e=>t(new Set(e)),clear:()=>t(new Set)}}();function je(e,t,n){const r=e.slice();return r[9]=t[n],r}function Pe(e,t,n){const r=e.slice();return r[12]=t[n],r}function Ee(e){let t;return{c(){t=g("span"),t.innerHTML='<svg class="w-3.5 h-3.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path></svg>',w(t,"class","text-red-500"),w(t,"title","Dead link")},m(e,n){f(e,t,n)},d(e){e&&d(t)}}}function Te(e){let t;return{c(){t=g("span"),t.innerHTML='<svg class="w-3.5 h-3.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path></svg>',w(t,"class","text-green-500"),w(t,"title","Enriched with metadata")},m(e,n){f(e,t,n)},d(e){e&&d(t)}}}function Oe(e){let t,n,r,i,o;return{c(){t=g("span"),n=m("svg"),r=m("path"),i=m("path"),w(r,"d","M10 12a2 2 0 100-4 2 2 0 000 4z"),w(i,"fill-rule","evenodd"),w(i,"d","M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z"),w(i,"clip-rule","evenodd"),w(n,"class","w-3.5 h-3.5"),w(n,"fill","currentColor"),w(n,"viewBox","0 0 20 20"),w(t,"class","text-blue-500 text-xs"),w(t,"title",o="Accessed "+e[0].accessCount+" times")},m(e,o){f(e,t,o),h(t,n),h(n,r),h(n,i)},p(e,n){1&n&&o!==(o="Accessed "+e[0].accessCount+" times")&&w(t,"title",o)},d(e){e&&d(t)}}}function De(e){let t,n,r,i,o=e[0].category+"";return{c(){t=g("span"),n=y("ðŸ·ï¸ "),r=y(o),w(t,"class","text-xs text-purple-600 bg-purple-50 px-2 py-0.5 rounded"),w(t,"title",i="Category: "+e[0].category)},m(e,i){f(e,t,i),h(t,n),h(t,r)},p(e,n){1&n&&o!==(o=e[0].category+"")&&x(r,o),1&n&&i!==(i="Category: "+e[0].category)&&w(t,"title",i)},d(e){e&&d(t)}}}function Me(e){let t,n,r=ie(e[0].description,e[1])+"";return{c(){t=g("p"),w(t,"class","text-xs text-gray-500 mt-2 line-clamp-2 w-full"),w(t,"title",n=e[0].description)},m(e,n){f(e,t,n),t.innerHTML=r},p(e,i){3&i&&r!==(r=ie(e[0].description,e[1])+"")&&(t.innerHTML=r),1&i&&n!==(n=e[0].description)&&w(t,"title",n)},d(e){e&&d(t)}}}function Re(e){let t,n,r,i=e[0].readingTime&&Be(e),o=e[0].publishedDate&&Ie(e),s=e[0].contentQualityScore&&Ke(e);return{c(){t=g("div"),i&&i.c(),n=v(),o&&o.c(),r=v(),s&&s.c(),w(t,"class","flex items-center gap-2 mt-2 flex-wrap")},m(e,a){f(e,t,a),i&&i.m(t,null),h(t,n),o&&o.m(t,null),h(t,r),s&&s.m(t,null)},p(e,a){e[0].readingTime?i?i.p(e,a):(i=Be(e),i.c(),i.m(t,n)):i&&(i.d(1),i=null),e[0].publishedDate?o?o.p(e,a):(o=Ie(e),o.c(),o.m(t,r)):o&&(o.d(1),o=null),e[0].contentQualityScore?s?s.p(e,a):(s=Ke(e),s.c(),s.m(t,null)):s&&(s.d(1),s=null)},d(e){e&&d(t),i&&i.d(),o&&o.d(),s&&s.d()}}}function Be(e){let t,n,r,i,o=e[0].readingTime+"";return{c(){t=g("span"),n=y("â±ï¸ "),r=y(o),i=y(" min"),w(t,"class","text-xs text-gray-600 bg-gray-50 px-2 py-0.5 rounded flex items-center gap-1"),w(t,"title","Estimated reading time")},m(e,o){f(e,t,o),h(t,n),h(t,r),h(t,i)},p(e,t){1&t&&o!==(o=e[0].readingTime+"")&&x(r,o)},d(e){e&&d(t)}}}function Ie(e){let t,n,r,i=Z(e[0].publishedDate)+"";return{c(){t=g("span"),n=y("ðŸ“… "),r=y(i),w(t,"class","text-xs text-gray-600 bg-gray-50 px-2 py-0.5 rounded flex items-center gap-1"),w(t,"title","Published date")},m(e,i){f(e,t,i),h(t,n),h(t,r)},p(e,t){1&t&&i!==(i=Z(e[0].publishedDate)+"")&&x(r,i)},d(e){e&&d(t)}}}function Ke(e){let t,n,r,i=e[0].contentQualityScore+"";return{c(){t=g("span"),n=y("â­ "),r=y(i),w(t,"class","text-xs px-2 py-0.5 rounded flex items-center gap-1"),w(t,"title","Content quality score"),_(t,"text-green-700",e[0].contentQualityScore>=70),_(t,"bg-green-50",e[0].contentQualityScore>=70),_(t,"text-yellow-700",e[0].contentQualityScore>=40&&e[0].contentQualityScore<70),_(t,"bg-yellow-50",e[0].contentQualityScore>=40&&e[0].contentQualityScore<70),_(t,"text-orange-700",e[0].contentQualityScore<40),_(t,"bg-orange-50",e[0].contentQualityScore<40)},m(e,i){f(e,t,i),h(t,n),h(t,r)},p(e,n){1&n&&i!==(i=e[0].contentQualityScore+"")&&x(r,i),1&n&&_(t,"text-green-700",e[0].contentQualityScore>=70),1&n&&_(t,"bg-green-50",e[0].contentQualityScore>=70),1&n&&_(t,"text-yellow-700",e[0].contentQualityScore>=40&&e[0].contentQualityScore<70),1&n&&_(t,"bg-yellow-50",e[0].contentQualityScore>=40&&e[0].contentQualityScore<70),1&n&&_(t,"text-orange-700",e[0].contentQualityScore<40),1&n&&_(t,"bg-orange-50",e[0].contentQualityScore<40)},d(e){e&&d(t)}}}function $e(e){let t,n,r=U(e[0].smartTags.slice(0,5)),i=[];for(let t=0;t<r.length;t+=1)i[t]=qe(Pe(e,r,t));let o=e[0].smartTags.length>5&&Fe(e);return{c(){t=g("div");for(let e=0;e<i.length;e+=1)i[e].c();n=v(),o&&o.c(),w(t,"class","flex items-center gap-1 mt-2 flex-wrap")},m(e,r){f(e,t,r);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);h(t,n),o&&o.m(t,null)},p(e,s){if(1&s){let o;for(r=U(e[0].smartTags.slice(0,5)),o=0;o<r.length;o+=1){const a=Pe(e,r,o);i[o]?i[o].p(a,s):(i[o]=qe(a),i[o].c(),i[o].m(t,n))}for(;o<i.length;o+=1)i[o].d(1);i.length=r.length}e[0].smartTags.length>5?o?o.p(e,s):(o=Fe(e),o.c(),o.m(t,null)):o&&(o.d(1),o=null)},d(e){e&&d(t),p(i,e),o&&o.d()}}}function qe(e){let t,n,r=e[12]+"";return{c(){t=g("span"),n=y(r),w(t,"class","text-xs text-indigo-600 bg-indigo-50 px-1.5 py-0.5 rounded"),w(t,"title","Smart tag")},m(e,r){f(e,t,r),h(t,n)},p(e,t){1&t&&r!==(r=e[12]+"")&&x(n,r)},d(e){e&&d(t)}}}function Fe(e){let t,n,r,i,o=e[0].smartTags.length-5+"";return{c(){t=g("span"),n=y("+"),r=y(o),i=y(" more"),w(t,"class","text-xs text-gray-500")},m(e,o){f(e,t,o),h(t,n),h(t,r),h(t,i)},p(e,t){1&t&&o!==(o=e[0].smartTags.length-5+"")&&x(r,o)},d(e){e&&d(t)}}}function Le(e){let t,n,r=U(e[0].topics.slice(0,4)),i=[];for(let t=0;t<r.length;t+=1)i[t]=ze(je(e,r,t));let o=e[0].topics.length>4&&Ne(e);return{c(){t=g("div");for(let e=0;e<i.length;e+=1)i[e].c();n=v(),o&&o.c(),w(t,"class","flex items-center gap-1 mt-2 flex-wrap")},m(e,r){f(e,t,r);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);h(t,n),o&&o.m(t,null)},p(e,s){if(1&s){let o;for(r=U(e[0].topics.slice(0,4)),o=0;o<r.length;o+=1){const a=je(e,r,o);i[o]?i[o].p(a,s):(i[o]=ze(a),i[o].c(),i[o].m(t,n))}for(;o<i.length;o+=1)i[o].d(1);i.length=r.length}e[0].topics.length>4?o?o.p(e,s):(o=Ne(e),o.c(),o.m(t,null)):o&&(o.d(1),o=null)},d(e){e&&d(t),p(i,e),o&&o.d()}}}function ze(e){let t,n,r,i,o=e[9]+"";return{c(){t=g("span"),n=y("ðŸ·ï¸ "),r=y(o),w(t,"class","text-xs text-teal-600 bg-teal-50 px-1.5 py-0.5 rounded"),w(t,"title",i="Topic: "+e[9])},m(e,i){f(e,t,i),h(t,n),h(t,r)},p(e,n){1&n&&o!==(o=e[9]+"")&&x(r,o),1&n&&i!==(i="Topic: "+e[9])&&w(t,"title",i)},d(e){e&&d(t)}}}function Ne(e){let t,n,r,i,o=e[0].topics.length-4+"";return{c(){t=g("span"),n=y("+"),r=y(o),i=y(" more"),w(t,"class","text-xs text-gray-500")},m(e,o){f(e,t,o),h(t,n),h(t,r),h(t,i)},p(e,t){1&t&&o!==(o=e[0].topics.length-4+"")&&x(r,o)},d(e){e&&d(t)}}}function We(e){let t,n;return{c(){t=m("svg"),n=m("path"),w(n,"stroke-linecap","round"),w(n,"stroke-linejoin","round"),w(n,"stroke-width","2"),w(n,"d","M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"),w(t,"class","w-4 h-4"),w(t,"fill","none"),w(t,"stroke","currentColor"),w(t,"viewBox","0 0 24 24")},m(e,r){f(e,t,r),h(t,n)},d(e){e&&d(t)}}}function Ue(e){let t,n;return{c(){t=m("svg"),n=m("path"),w(n,"stroke-linecap","round"),w(n,"stroke-linejoin","round"),w(n,"stroke-width","2"),w(n,"d","M5 13l4 4L19 7"),w(t,"class","w-4 h-4 text-green-500"),w(t,"fill","none"),w(t,"stroke","currentColor"),w(t,"viewBox","0 0 24 24")},m(e,r){f(e,t,r),h(t,n)},d(e){e&&d(t)}}}function Qe(e){let t,n,r,i,o=e[0].folderPath+"";return{c(){t=g("p"),n=y("ðŸ“ "),r=y(o),w(t,"class","text-xs text-gray-400 mt-1 truncate"),w(t,"title",i=e[0].folderPath)},m(e,i){f(e,t,i),h(t,n),h(t,r)},p(e,n){1&n&&o!==(o=e[0].folderPath+"")&&x(r,o),1&n&&i!==(i=e[0].folderPath)&&w(t,"title",i)},d(e){e&&d(t)}}}function He(t){let n,i,o,s,a,l,u,p,m,k,A,C,S,j,P,E,T,O,D,M,R,B,I,K,$,q,F,L,z,N,W,U,Q,H,V,Y,G,J,X,ne=ie(t[0].title,t[1])+"",re=ie(t[0].url,t[1])+"",oe=te(t[0])+"",se=Z(t[0].dateAdded)+"",ae=!1===t[0].isAlive&&Ee(),ce=(t[0].description||t[0].keywords&&t[0].keywords.length>0)&&Te(),le=t[0].accessCount>0&&Oe(t),ue=t[0].category&&De(t),he=t[0].description&&Me(t),fe=(t[0].readingTime||t[0].publishedDate||t[0].contentQualityScore)&&Re(t),de=t[0].smartTags&&t[0].smartTags.length>0&&$e(t),pe=t[0].topics&&t[0].topics.length>0&&Le(t);function ge(e,t){return e[2]?Ue:We}let me=ge(t),ye=me(t),ve=t[0].folderPath&&Qe(t);return{c(){n=g("div"),i=g("div"),o=g("input"),a=v(),l=g("div"),u=g("img"),m=v(),k=g("div"),A=g("div"),C=g("h3"),j=v(),P=g("div"),ae&&ae.c(),E=v(),ce&&ce.c(),T=v(),le&&le.c(),O=v(),D=g("p"),R=v(),B=g("div"),I=g("div"),K=g("span"),$=y(oe),q=v(),ue&&ue.c(),F=v(),he&&he.c(),L=v(),fe&&fe.c(),z=v(),de&&de.c(),N=v(),pe&&pe.c(),W=v(),U=g("div"),Q=g("button"),ye.c(),H=v(),V=g("span"),Y=y(se),G=v(),ve&&ve.c(),w(o,"type","checkbox"),o.checked=s=t[3].has(t[0].id),w(o,"class","w-4 h-4 text-blue-600 rounded border-gray-300 focus:ring-blue-500 cursor-pointer"),w(i,"class","absolute top-2 right-2 z-10"),_(i,"opacity-0",!t[3].has(t[0].id)),_(i,"group-hover:opacity-100",!0),c(u.src,p=ee(t[0]))||w(u,"src",p),w(u,"alt","Favicon"),w(u,"class","w-4 h-4 mt-1 flex-shrink-0"),w(C,"class","text-sm font-medium text-gray-900 truncate flex-1"),w(C,"title",S=t[0].title),w(P,"class","flex items-center gap-1 flex-shrink-0"),w(A,"class","flex items-center gap-1.5"),w(D,"class","text-xs text-gray-500 truncate mt-1 max-w-full"),w(D,"title",M=t[0].url),w(K,"class","text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded"),w(I,"class","flex items-center gap-1.5"),w(Q,"class","p-1 text-gray-400 hover:text-blue-600 transition-colors"),w(Q,"title","Copy URL"),w(V,"class","text-xs text-gray-400"),w(U,"class","flex items-center space-x-2"),w(B,"class","flex items-center justify-between mt-2 gap-2 flex-wrap"),w(k,"class","flex-1 min-w-0"),w(l,"class","flex items-start space-x-3"),w(n,"class","bookmark-card bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition-shadow cursor-pointer border border-gray-200 relative group svelte-1oo2sed"),w(n,"role","button"),w(n,"tabindex","0"),_(n,"border-red-200",!1===t[0].isAlive),_(n,"bg-red-50",!1===t[0].isAlive),_(n,"ring-2",t[3].has(t[0].id)),_(n,"ring-blue-500",t[3].has(t[0].id))},m(e,r){f(e,n,r),h(n,i),h(i,o),h(n,a),h(n,l),h(l,u),h(l,m),h(l,k),h(k,A),h(A,C),C.innerHTML=ne,h(A,j),h(A,P),ae&&ae.m(P,null),h(P,E),ce&&ce.m(P,null),h(P,T),le&&le.m(P,null),h(k,O),h(k,D),D.innerHTML=re,h(k,R),h(k,B),h(B,I),h(I,K),h(K,$),h(I,q),ue&&ue.m(I,null),h(B,F),he&&he.m(B,null),h(B,L),fe&&fe.m(B,null),h(B,z),de&&de.m(B,null),h(B,N),pe&&pe.m(B,null),h(B,W),h(B,U),h(U,Q),ye.m(Q,null),h(U,H),h(U,V),h(V,Y),h(k,G),ve&&ve.m(k,null),J||(X=[b(o,"click",t[6]),b(Q,"click",t[5]),b(n,"click",t[4]),b(n,"keydown",t[7])],J=!0)},p(e,[t]){9&t&&s!==(s=e[3].has(e[0].id))&&(o.checked=s),9&t&&_(i,"opacity-0",!e[3].has(e[0].id)),1&t&&!c(u.src,p=ee(e[0]))&&w(u,"src",p),3&t&&ne!==(ne=ie(e[0].title,e[1])+"")&&(C.innerHTML=ne),1&t&&S!==(S=e[0].title)&&w(C,"title",S),!1===e[0].isAlive?ae||(ae=Ee(),ae.c(),ae.m(P,E)):ae&&(ae.d(1),ae=null),e[0].description||e[0].keywords&&e[0].keywords.length>0?ce||(ce=Te(),ce.c(),ce.m(P,T)):ce&&(ce.d(1),ce=null),e[0].accessCount>0?le?le.p(e,t):(le=Oe(e),le.c(),le.m(P,null)):le&&(le.d(1),le=null),3&t&&re!==(re=ie(e[0].url,e[1])+"")&&(D.innerHTML=re),1&t&&M!==(M=e[0].url)&&w(D,"title",M),1&t&&oe!==(oe=te(e[0])+"")&&x($,oe),e[0].category?ue?ue.p(e,t):(ue=De(e),ue.c(),ue.m(I,null)):ue&&(ue.d(1),ue=null),e[0].description?he?he.p(e,t):(he=Me(e),he.c(),he.m(B,L)):he&&(he.d(1),he=null),e[0].readingTime||e[0].publishedDate||e[0].contentQualityScore?fe?fe.p(e,t):(fe=Re(e),fe.c(),fe.m(B,z)):fe&&(fe.d(1),fe=null),e[0].smartTags&&e[0].smartTags.length>0?de?de.p(e,t):(de=$e(e),de.c(),de.m(B,N)):de&&(de.d(1),de=null),e[0].topics&&e[0].topics.length>0?pe?pe.p(e,t):(pe=Le(e),pe.c(),pe.m(B,W)):pe&&(pe.d(1),pe=null),me!==(me=ge(e))&&(ye.d(1),ye=me(e),ye&&(ye.c(),ye.m(Q,null))),1&t&&se!==(se=Z(e[0].dateAdded)+"")&&x(Y,se),e[0].folderPath?ve?ve.p(e,t):(ve=Qe(e),ve.c(),ve.m(k,null)):ve&&(ve.d(1),ve=null),1&t&&_(n,"border-red-200",!1===e[0].isAlive),1&t&&_(n,"bg-red-50",!1===e[0].isAlive),9&t&&_(n,"ring-2",e[3].has(e[0].id)),9&t&&_(n,"ring-blue-500",e[3].has(e[0].id))},i:e,o:e,d(e){e&&d(n),ae&&ae.d(),ce&&ce.d(),le&&le.d(),ue&&ue.d(),he&&he.d(),fe&&fe.d(),de&&de.d(),pe&&pe.d(),ye.d(),ve&&ve.d(),J=!1,r(X)}}}function Ve(e,t,n){let r;u(e,Se,e=>n(3,r=e));let{bookmark:i}=t,{parsedSearchQuery:o=null}=t;j();let s=!1;function a(e){const t=!(e&&(e.shiftKey||e.metaKey||e.ctrlKey));!function(e,t=!0){chrome.tabs.create({url:e,active:t})}(i.url,t)}return e.$$set=e=>{"bookmark"in e&&n(0,i=e.bookmark),"parsedSearchQuery"in e&&n(1,o=e.parsedSearchQuery)},[i,o,s,r,a,async function(e){e.stopPropagation();const t=await async function(e){try{return await navigator.clipboard.writeText(e),!0}catch(e){return console.error("Failed to copy to clipboard:",e),!1}}(i.url);t&&(n(2,s=!0),setTimeout(()=>n(2,s=!1),2e3))},function(e){e.stopPropagation(),Se.toggle(i.id)},e=>"Enter"===e.key&&a(e)]}class Ye extends X{constructor(e){super(),J(this,e,Ve,He,o,{bookmark:0,parsedSearchQuery:1})}}function Ge(e,t,n){const r=e.slice();return r[13]=t[n],r}function Je(e,t,n){const r=e.slice();return r[16]=t[n],r}function Xe(e,t,n){const r=e.slice();return r[19]=t[n],r}function Ze(e,t,n){const r=e.slice();return r[19]=t[n],r}function et(t){let n,r,i;return{c(){n=g("button"),n.innerHTML='<svg class="h-5 w-5 text-gray-400 hover:text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',w(n,"class","absolute inset-y-0 right-0 pr-3 flex items-center"),w(n,"type","button"),w(n,"title","Clear search (Esc)")},m(e,o){f(e,n,o),r||(i=b(n,"click",t[7]),r=!0)},p:e,d(e){e&&d(n),r=!1,i()}}}function tt(e){let t,n,r,i,o=U(e[4].positive),s=[];for(let t=0;t<o.length;t+=1)s[t]=nt(Ze(e,o,t));let a=U(e[4].negative),c=[];for(let t=0;t<a.length;t+=1)c[t]=rt(Xe(e,a,t));let l=U(e[4].phrases),u=[];for(let t=0;t<l.length;t+=1)u[t]=it(Je(e,l,t));let m=U(e[4].regexPatterns),y=[];for(let t=0;t<m.length;t+=1)y[t]=ot(Ge(e,m,t));return{c(){t=g("div");for(let e=0;e<s.length;e+=1)s[e].c();n=v();for(let e=0;e<c.length;e+=1)c[e].c();r=v();for(let e=0;e<u.length;e+=1)u[e].c();i=v();for(let e=0;e<y.length;e+=1)y[e].c();w(t,"class","flex flex-wrap gap-1.5 mt-2")},m(e,o){f(e,t,o);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(t,null);h(t,n);for(let e=0;e<c.length;e+=1)c[e]&&c[e].m(t,null);h(t,r);for(let e=0;e<u.length;e+=1)u[e]&&u[e].m(t,null);h(t,i);for(let e=0;e<y.length;e+=1)y[e]&&y[e].m(t,null)},p(e,h){if(16&h){let r;for(o=U(e[4].positive),r=0;r<o.length;r+=1){const i=Ze(e,o,r);s[r]?s[r].p(i,h):(s[r]=nt(i),s[r].c(),s[r].m(t,n))}for(;r<s.length;r+=1)s[r].d(1);s.length=o.length}if(16&h){let n;for(a=U(e[4].negative),n=0;n<a.length;n+=1){const i=Xe(e,a,n);c[n]?c[n].p(i,h):(c[n]=rt(i),c[n].c(),c[n].m(t,r))}for(;n<c.length;n+=1)c[n].d(1);c.length=a.length}if(16&h){let n;for(l=U(e[4].phrases),n=0;n<l.length;n+=1){const r=Je(e,l,n);u[n]?u[n].p(r,h):(u[n]=it(r),u[n].c(),u[n].m(t,i))}for(;n<u.length;n+=1)u[n].d(1);u.length=l.length}if(16&h){let n;for(m=U(e[4].regexPatterns),n=0;n<m.length;n+=1){const r=Ge(e,m,n);y[n]?y[n].p(r,h):(y[n]=ot(r),y[n].c(),y[n].m(t,null))}for(;n<y.length;n+=1)y[n].d(1);y.length=m.length}},d(e){e&&d(t),p(s,e),p(c,e),p(u,e),p(y,e)}}}function nt(e){let t,n,r,i,o,s=e[19]+"";return{c(){t=g("span"),n=m("svg"),r=m("path"),i=v(),o=y(s),w(r,"fill-rule","evenodd"),w(r,"d","M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"),w(r,"clip-rule","evenodd"),w(n,"class","w-3 h-3 mr-1"),w(n,"fill","currentColor"),w(n,"viewBox","0 0 20 20"),w(t,"class","inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800")},m(e,s){f(e,t,s),h(t,n),h(n,r),h(t,i),h(t,o)},p(e,t){16&t&&s!==(s=e[19]+"")&&x(o,s)},d(e){e&&d(t)}}}function rt(e){let t,n,r,i,o,s=e[19]+"";return{c(){t=g("span"),n=m("svg"),r=m("path"),i=v(),o=y(s),w(r,"fill-rule","evenodd"),w(r,"d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"),w(r,"clip-rule","evenodd"),w(n,"class","w-3 h-3 mr-1"),w(n,"fill","currentColor"),w(n,"viewBox","0 0 20 20"),w(t,"class","inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800")},m(e,s){f(e,t,s),h(t,n),h(n,r),h(t,i),h(t,o)},p(e,t){16&t&&s!==(s=e[19]+"")&&x(o,s)},d(e){e&&d(t)}}}function it(e){let t,n,r,i,o,s,a=e[16]+"";return{c(){t=g("span"),n=m("svg"),r=m("path"),i=y('\n          "'),o=y(a),s=y('"'),w(r,"fill-rule","evenodd"),w(r,"d","M18 13V5a2 2 0 00-2-2H4a2 2 0 00-2 2v8a2 2 0 002 2h3l3 3 3-3h3a2 2 0 002-2zM5 7a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1zm1 3a1 1 0 100 2h3a1 1 0 100-2H6z"),w(r,"clip-rule","evenodd"),w(n,"class","w-3 h-3 mr-1"),w(n,"fill","currentColor"),w(n,"viewBox","0 0 20 20"),w(t,"class","inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800")},m(e,a){f(e,t,a),h(t,n),h(n,r),h(t,i),h(t,o),h(t,s)},p(e,t){16&t&&a!==(a=e[16]+"")&&x(o,a)},d(e){e&&d(t)}}}function ot(e){let t,n,r,i,o,s,a=e[13]+"";return{c(){t=g("span"),n=m("svg"),r=m("path"),i=v(),o=y(a),s=v(),w(r,"stroke-linecap","round"),w(r,"stroke-linejoin","round"),w(r,"stroke-width","2"),w(r,"d","M10 20l4-16m4 4l-4 4 4 4M6 16l-4-4 4-4"),w(n,"class","w-3 h-3 mr-1"),w(n,"fill","none"),w(n,"stroke","currentColor"),w(n,"viewBox","0 0 20 20"),w(t,"class","inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800")},m(e,a){f(e,t,a),h(t,n),h(n,r),h(t,i),h(t,o),h(t,s)},p(e,t){16&t&&a!==(a=e[13]+"")&&x(o,a)},d(e){e&&d(t)}}}function st(e){let t;return{c(){t=g("div"),t.innerHTML='<h4 class="font-medium text-gray-900 mb-3 flex items-center gap-2"><svg class="w-4 h-4 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>\n        Search Syntax</h4> <div class="space-y-2 text-sm"><div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-green-100 text-green-800 rounded text-xs whitespace-nowrap">+term</code> <span class="text-gray-600">Must include this term</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-red-100 text-red-800 rounded text-xs whitespace-nowrap">-term</code> <span class="text-gray-600">Must NOT include this term</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-blue-100 text-blue-800 rounded text-xs whitespace-nowrap">&quot;exact phrase&quot;</code> <span class="text-gray-600">Match exact phrase</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-gray-100 text-gray-700 rounded text-xs whitespace-nowrap">word</code> <span class="text-gray-600">Regular search term</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-purple-100 text-purple-800 rounded text-xs whitespace-nowrap">/regex/</code> <span class="text-gray-600">Regular expression pattern</span></div></div> <div class="mt-4 pt-3 border-t border-gray-100"><h5 class="font-medium text-gray-800 mb-2 flex items-center gap-2 text-sm"><svg class="w-4 h-4 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z"></path></svg>\n          Special Filters</h5> <div class="space-y-2 text-sm"><div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-indigo-100 text-indigo-800 rounded text-xs whitespace-nowrap">category:tech</code> <span class="text-gray-600">ðŸ“ Filter by category</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-indigo-100 text-indigo-800 rounded text-xs whitespace-nowrap">domain:github.com</code> <span class="text-gray-600">ðŸŒ Filter by domain</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-indigo-100 text-indigo-800 rounded text-xs whitespace-nowrap">folder:&quot;Work/Projects&quot;</code> <span class="text-gray-600">ðŸ“‚ Filter by folder path</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-amber-100 text-amber-800 rounded text-xs whitespace-nowrap">accessed:yes</code> <span class="text-gray-600">ðŸ‘† Has been accessed (yes/no)</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-amber-100 text-amber-800 rounded text-xs whitespace-nowrap">stale:yes</code> <span class="text-gray-600">â° Old &amp; never accessed</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-teal-100 text-teal-800 rounded text-xs whitespace-nowrap">enriched:yes</code> <span class="text-gray-600">âœ¨ Has metadata (yes/no)</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-red-100 text-red-700 rounded text-xs whitespace-nowrap">dead:yes</code> <span class="text-gray-600">ðŸ’€ Dead links (yes/no)</span></div></div></div> <div class="mt-4 pt-3 border-t border-gray-100"><h5 class="font-medium text-gray-800 mb-2 flex items-center gap-2 text-sm"><span class="text-lg">ðŸ“±</span>\n          Platform Filters</h5> <div class="space-y-2 text-sm"><div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-pink-100 text-pink-800 rounded text-xs whitespace-nowrap">platform:youtube</code> <span class="text-gray-600">ðŸ“º Filter by platform (youtube, github, medium, etc.)</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-pink-100 text-pink-800 rounded text-xs whitespace-nowrap">channel:@mkbhd</code> <span class="text-gray-600">ðŸ“º YouTube channel (with or without @)</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-pink-100 text-pink-800 rounded text-xs whitespace-nowrap">repo:facebook/react</code> <span class="text-gray-600">ðŸ’» GitHub repository (owner/repo)</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-pink-100 text-pink-800 rounded text-xs whitespace-nowrap">author:username</code> <span class="text-gray-600">âœï¸ Blog/article author</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-pink-100 text-pink-800 rounded text-xs whitespace-nowrap">type:video</code> <span class="text-gray-600">ðŸ“ Content type (video, issue, article, repo, pr)</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-pink-100 text-pink-800 rounded text-xs whitespace-nowrap">hasimage:yes</code> <span class="text-gray-600">ðŸ–¼ï¸ Has thumbnail image (yes/no)</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-pink-100 text-pink-800 rounded text-xs whitespace-nowrap">playlist:PLxxx</code> <span class="text-gray-600">ðŸŽµ YouTube playlist ID</span></div></div></div> <div class="mt-4 pt-3 border-t border-gray-100"><p class="text-xs text-gray-500"><strong>Example:</strong> <code class="bg-gray-100 px-1 rounded">javascript +tutorial -video &quot;best practices&quot;</code></p> <p class="text-xs text-gray-500 mt-1"><strong>With filters:</strong> <code class="bg-gray-100 px-1 rounded">domain:github.com category:development enriched:yes</code></p> <p class="text-xs text-gray-500 mt-1"><strong>Platform:</strong> <code class="bg-gray-100 px-1 rounded">platform:youtube channel:@fireship type:video</code></p> <p class="text-xs text-gray-500 mt-1"><strong>Regex:</strong> <code class="bg-gray-100 px-1 rounded">/react.*hooks?/</code></p></div>',w(t,"class","absolute z-20 w-full mt-2 p-4 bg-white border border-gray-200 rounded-lg shadow-lg max-h-[70vh] overflow-y-auto")},m(e,n){f(e,t,n)},d(e){e&&d(t)}}}function at(t){let n,i,o,s,a,c,l,u,p,m,y,x,_,A=t[0]&&et(t),C=t[0]&&(t[4].positive.length>0||t[4].negative.length>0||t[4].phrases.length>0||t[4].regexPatterns.length>0)&&tt(t),S=t[3]&&st();return{c(){n=g("div"),i=g("div"),o=g("div"),s=g("div"),s.innerHTML='<svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>',a=v(),c=g("input"),l=v(),A&&A.c(),u=v(),p=g("button"),p.innerHTML='<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>',m=v(),C&&C.c(),y=v(),S&&S.c(),w(s,"class","absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"),w(c,"type","text"),w(c,"placeholder",t[1]),w(c,"class","block w-full pl-10 pr-10 py-2.5 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"),w(c,"autocomplete","off"),w(c,"spellcheck","false"),w(o,"class","relative flex-1"),w(p,"class","p-2.5 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg border border-gray-300 transition-colors"),w(p,"type","button"),w(p,"title","Search help"),w(i,"class","flex items-center gap-2"),w(n,"class","relative mb-4 search-container")},m(e,r){f(e,n,r),h(n,i),h(i,o),h(o,s),h(o,a),h(o,c),t[9](c),k(c,t[0]),h(o,l),A&&A.m(o,null),h(i,u),h(i,p),h(n,m),C&&C.m(n,null),h(n,y),S&&S.m(n,null),x||(_=[b(c,"input",t[10]),b(c,"input",t[5]),b(c,"focus",ct),b(c,"keydown",t[6]),b(p,"click",t[8])],x=!0)},p(e,[t]){2&t&&w(c,"placeholder",e[1]),1&t&&c.value!==e[0]&&k(c,e[0]),e[0]?A?A.p(e,t):(A=et(e),A.c(),A.m(o,null)):A&&(A.d(1),A=null),e[0]&&(e[4].positive.length>0||e[4].negative.length>0||e[4].phrases.length>0||e[4].regexPatterns.length>0)?C?C.p(e,t):(C=tt(e),C.c(),C.m(n,y)):C&&(C.d(1),C=null),e[3]?S||(S=st(),S.c(),S.m(n,null)):S&&(S.d(1),S=null)},i:e,o:e,d(e){e&&d(n),t[9](null),A&&A.d(),C&&C.d(),S&&S.d(),x=!1,r(_)}}}function ct(){}function lt(e,t,n){let r;const i=j();let o,s,{value:a=""}=t,{placeholder:c='Search: use +term (must include), -term (exclude), "exact phrase"'}=t,l=!1;function u(){n(0,a=""),i("search",{query:""}),s?.focus()}return S(()=>{}),e.$$set=e=>{"value"in e&&n(0,a=e.value),"placeholder"in e&&n(1,c=e.placeholder)},e.$$.update=()=>{1&e.$$.dirty&&n(4,r=function(e){if(!e)return{positive:[],negative:[],phrases:[],regular:[],regexPatterns:[]};const t=[],n=[],r=[],i=[],o=[];(e.match(/\/([^\/]+)\/([gimsuvy]*)?/g)||[]).forEach(e=>o.push(e));let s=e.replace(/\/[^\/]+\/[gimsuvy]*/g,"").trim();return(s.match(/"([^"]+)"/g)||[]).forEach(e=>r.push(e.slice(1,-1))),s=s.replace(/"[^"]+"/g,"").trim(),s.split(/\s+/).filter(e=>e.length>0).forEach(e=>{e.startsWith("+")&&e.length>1?t.push(e.slice(1)):e.startsWith("-")&&e.length>1?n.push(e.slice(1)):i.push(e)}),{positive:t,negative:n,phrases:r,regular:i,regexPatterns:o}}(a))},[a,c,s,l,r,function(e){n(0,a=e.target.value),clearTimeout(o),o=setTimeout(()=>{i("search",{query:a})},200)},function(e){"Escape"===e.key?u():"Enter"===e.key&&(clearTimeout(o),i("search",{query:a}))},u,function(){n(3,l=!l)},function(e){E[e?"unshift":"push"](()=>{s=e,n(2,s)})},function(){a=this.value,n(0,a)}]}class ut extends X{constructor(e){super(),J(this,e,lt,at,o,{value:0,placeholder:1})}}const ht={tech:{id:"tech",name:"Technology",icon:"ðŸ’»",keywords:["technology","tech","software","hardware","computer","digital","gadget","device","smartphone","laptop","pc","server","cloud","saas","startup","silicon valley","innovation"],domains:["techcrunch.com","theverge.com","arstechnica.com","wired.com","engadget.com","gizmodo.com","cnet.com","zdnet.com","venturebeat.com"],subtopics:{ai:{id:"tech/ai",name:"AI & Machine Learning",keywords:["artificial intelligence","machine learning","deep learning","neural network","nlp","natural language","computer vision","llm","gpt","transformer","reinforcement learning","supervised learning","unsupervised","chatgpt","openai","anthropic","claude","gemini","stable diffusion","midjourney","data science","ml ops","model training","inference","embeddings"],domains:["openai.com","huggingface.co","arxiv.org","paperswithcode.com"]},web3:{id:"tech/web3",name:"Web3 & Blockchain",keywords:["blockchain","cryptocurrency","crypto","bitcoin","ethereum","web3","defi","nft","smart contract","solidity","wallet","token","dao"],domains:["coinbase.com","binance.com","etherscan.io","opensea.io"]}}},coding:{id:"coding",name:"Programming",icon:"ðŸ‘¨â€ðŸ’»",keywords:["programming","coding","developer","development","code","software engineering","backend","frontend","fullstack","full-stack","devops","api","sdk","framework","library","package","module","dependency","npm","pip","git","version control","debugging","testing","deployment","ci/cd"],domains:["github.com","gitlab.com","bitbucket.org","stackoverflow.com","npmjs.com","pypi.org","crates.io","packagist.org","rubygems.org"],subtopics:{javascript:{id:"coding/javascript",name:"JavaScript",keywords:["javascript","typescript","node.js","nodejs","react","vue","angular","svelte","nextjs","next.js","nuxt","express","deno","bun","vite","webpack","esbuild","rollup","jsx","tsx","ecmascript","es6","es2020"],domains:["nodejs.org","reactjs.org","vuejs.org","svelte.dev"]},python:{id:"coding/python",name:"Python",keywords:["python","django","flask","fastapi","pandas","numpy","pytorch","tensorflow","scikit-learn","jupyter","notebook","pip","conda","virtualenv","asyncio","pydantic","sqlalchemy"],domains:["python.org","pypi.org","realpython.com","djangoproject.com"]},rust:{id:"coding/rust",name:"Rust",keywords:["rust","rustlang","cargo","crate","tokio","async-std","wasm"],domains:["rust-lang.org","crates.io","docs.rs"]},go:{id:"coding/go",name:"Go",keywords:["golang","go language","goroutine","gin","fiber","echo"],domains:["golang.org","go.dev","pkg.go.dev"]}}},tutorials:{id:"tutorials",name:"Tutorials",icon:"ðŸ“š",keywords:["tutorial","how to","howto","how-to","guide","learn","learning","beginner","introduction","intro to","getting started","step by step","step-by-step","walkthrough","explained","crash course","masterclass","fundamentals","basics","complete guide","definitive guide","cheatsheet","cheat sheet","quick start","quickstart"],domains:["tutorialspoint.com","w3schools.com","freecodecamp.org","codecademy.com","coursera.org","udemy.com","pluralsight.com","egghead.io","frontendmasters.com","levelup.gitconnected.com"]},blogs:{id:"blogs",name:"Blogs & Articles",icon:"ðŸ“",keywords:["blog","article","post","opinion","essay","thoughts on","my experience","story","journey","lessons learned","reflection","review"],domains:["medium.com","dev.to","hashnode.com","substack.com","wordpress.com","blogger.com","ghost.io","mirror.xyz"]},videos:{id:"videos",name:"Videos",icon:"ðŸŽ¬",keywords:["video","watch","stream","streaming","episode","podcast","webinar","talk","presentation","conference talk","keynote","demo","screencast"],domains:["youtube.com","youtu.be","vimeo.com","twitch.tv","dailymotion.com","loom.com","wistia.com","ted.com"]},religious:{id:"religious",name:"Religious & Spiritual",icon:"ðŸ•Œ",keywords:["islam","islamic","muslim","quran","hadith","sunnah","prophet","allah","prayer","salah","fasting","ramadan","hajj","zakat","mosque","masjid","imam","sheikh","fatwa","halal","haram","christianity","christian","bible","jesus","church","gospel","judaism","jewish","torah","synagogue","rabbi","buddhism","buddhist","meditation","dharma","zen","hinduism","hindu","yoga","vedic","spirituality","spiritual","faith","belief","worship","religious","religion","scripture","sermon","dua","tafsir","recitation","tilawah"],domains:["islamqa.info","sunnah.com","quran.com","islamweb.net","biblegateway.com","gotquestions.org","chabad.org","myjewishlearning.com"]},news:{id:"news",name:"News",icon:"ðŸ“°",keywords:["news","breaking","headline","report","latest","update","announcement","press release","coverage","journalism","current events","world news"],domains:["reuters.com","apnews.com","bbc.com","cnn.com","nytimes.com","theguardian.com","washingtonpost.com","wsj.com","bloomberg.com","aljazeera.com","news.ycombinator.com"]},tools:{id:"tools",name:"Tools & Apps",icon:"ðŸ› ï¸",keywords:["tool","app","application","utility","extension","plugin","addon","software","platform","service","saas","free tool","online tool","generator","converter","calculator","formatter","validator","linter"],domains:["notion.so","figma.com","canva.com","trello.com","asana.com","slack.com","discord.com","vercel.com","netlify.com","heroku.com","postman.com","insomnia.rest"]},documentation:{id:"documentation",name:"Documentation",icon:"ðŸ“–",keywords:["documentation","docs","api reference","api docs","reference","specification","spec","manual","handbook","wiki","changelog","release notes","readme"],domains:["docs.github.com","developer.mozilla.org","devdocs.io","readthedocs.org","gitbook.io","notion.site","confluence.atlassian.com"]},research:{id:"research",name:"Research & Papers",icon:"ðŸ”¬",keywords:["research","paper","study","academic","journal","publication","thesis","dissertation","peer-reviewed","scientific","experiment","findings","methodology","abstract","citation","arxiv"],domains:["arxiv.org","scholar.google.com","researchgate.net","academia.edu","semanticscholar.org","paperswithcode.com","nature.com","sciencedirect.com"]},design:{id:"design",name:"Design & UI/UX",icon:"ðŸŽ¨",keywords:["design","ui","ux","user interface","user experience","graphic design","web design","visual design","typography","color","layout","wireframe","prototype","mockup","figma","sketch","adobe","illustration","icon","logo","branding","animation","motion design"],domains:["figma.com","dribbble.com","behance.net","awwwards.com","uxdesign.cc","smashingmagazine.com","nngroup.com","invisionapp.com"]},career:{id:"career",name:"Career & Jobs",icon:"ðŸ’¼",keywords:["career","job","hiring","interview","resume","cv","portfolio","salary","remote work","freelance","contract","employment","recruiting","linkedin","networking","job search","tech job"],domains:["linkedin.com","indeed.com","glassdoor.com","levels.fyi","wellfound.com","remoteok.io","weworkremotely.com","dice.com"]},entertainment:{id:"entertainment",name:"Entertainment",icon:"ðŸŽ®",keywords:["entertainment","game","gaming","movie","film","tv","series","anime","manga","comic","music","song","album","artist","sports","esports","hobby","fun","leisure"],domains:["imdb.com","rottentomatoes.com","ign.com","gamespot.com","spotify.com","netflix.com","twitch.tv","steamcommunity.com"]},finance:{id:"finance",name:"Finance & Investing",icon:"ðŸ’°",keywords:["finance","investing","investment","stock","market","trading","portfolio","dividend","etf","mutual fund","retirement","401k","savings","budgeting","financial planning","wealth","money"],domains:["yahoo.com/finance","investopedia.com","fool.com","seekingalpha.com","morningstar.com","robinhood.com","fidelity.com","vanguard.com"]},productivity:{id:"productivity",name:"Productivity",icon:"âš¡",keywords:["productivity","workflow","automation","efficiency","time management","task management","project management","organization","habit","goal setting","focus","gtd","getting things done","lifehack"],domains:["notion.so","todoist.com","asana.com","monday.com","clickup.com","obsidian.md","roamresearch.com","zapier.com","make.com"]},security:{id:"security",name:"Security & Privacy",icon:"ðŸ”’",keywords:["security","cybersecurity","privacy","hacking","vulnerability","exploit","penetration testing","pentest","encryption","authentication","authorization","oauth","jwt","ssl","tls","firewall","vpn","password","malware","ransomware","phishing","data breach"],domains:["owasp.org","hackerone.com","security.stackexchange.com","krebsonsecurity.com","schneier.com","thehackernews.com"]}};function ft(e){const t=function(e){if(!e)return null;const t=e.split("/"),n=ht[t[0]];if(!n)return null;if(1===t.length)return{id:n.id,name:n.name,icon:n.icon,isSubtopic:!1};const r=n.subtopics?.[t[1]];return r?{id:r.id,name:r.name,icon:n.icon,isSubtopic:!0,parentId:n.id,parentName:n.name}:null}(e);return t?`${t.icon} ${t.name}`:e}function dt(e,t,n){const r=e.slice();return r[75]=t[n],r}function pt(e,t,n){const r=e.slice();r[78]=t[n];const i=r[22]("creators",`${r[78].platform}:${r[78].creator}`);return r[79]=i,r}function gt(e,t,n){const r=e.slice();return r[82]=t[n],r}function mt(e,t,n){const r=e.slice();return r[85]=t[n],r}function yt(e,t,n){const r=e.slice();return r[88]=t[n],r}function vt(e,t,n){const r=e.slice();return r[91]=t[n],r}function bt(e,t,n){const r=e.slice();return r[94]=t[n],r}function wt(e,t,n){const r=e.slice();return r[97]=t[n],r}function xt(e,t,n){const r=e.slice();return r[100]=t[n],r}function kt(e,t,n){const r=e.slice();return r[103]=t[n],r}function _t(t){let n,r,i;return{c(){n=g("button"),n.textContent="Clear All",w(n,"class","text-xs text-blue-600 hover:text-blue-800")},m(e,o){f(e,n,o),r||(i=b(n,"click",t[28]),r=!0)},p:e,d(e){e&&d(n),r=!1,i()}}}function At(e){let t,n,r,i,o,s,a=U(e[3].topics),c=[];for(let t=0;t<a.length;t+=1)c[t]=Ct(kt(e,a,t));let l=U(e[3].creators),u=[];for(let t=0;t<l.length;t+=1)u[t]=St(xt(e,l,t));let m=U(e[3].types),y=[];for(let t=0;t<m.length;t+=1)y[t]=jt(wt(e,m,t));let b=U(e[3].domains),x=[];for(let t=0;t<b.length;t+=1)x[t]=Pt(bt(e,b,t));let k=U(e[3].folders),_=[];for(let t=0;t<k.length;t+=1)_[t]=Et(vt(e,k,t));let A=e[3].dateRange&&Tt(e);return{c(){t=g("div");for(let e=0;e<c.length;e+=1)c[e].c();n=v();for(let e=0;e<u.length;e+=1)u[e].c();r=v();for(let e=0;e<y.length;e+=1)y[e].c();i=v();for(let e=0;e<x.length;e+=1)x[e].c();o=v();for(let e=0;e<_.length;e+=1)_[e].c();s=v(),A&&A.c(),w(t,"class","mb-4 flex flex-wrap gap-2")},m(e,a){f(e,t,a);for(let e=0;e<c.length;e+=1)c[e]&&c[e].m(t,null);h(t,n);for(let e=0;e<u.length;e+=1)u[e]&&u[e].m(t,null);h(t,r);for(let e=0;e<y.length;e+=1)y[e]&&y[e].m(t,null);h(t,i);for(let e=0;e<x.length;e+=1)x[e]&&x[e].m(t,null);h(t,o);for(let e=0;e<_.length;e+=1)_[e]&&_[e].m(t,null);h(t,s),A&&A.m(t,null)},p(e,h){if(33554440&h[0]){let r;for(a=U(e[3].topics),r=0;r<a.length;r+=1){const i=kt(e,a,r);c[r]?c[r].p(i,h):(c[r]=Ct(i),c[r].c(),c[r].m(t,n))}for(;r<c.length;r+=1)c[r].d(1);c.length=a.length}if(67108872&h[0]){let n;for(l=U(e[3].creators),n=0;n<l.length;n+=1){const i=xt(e,l,n);u[n]?u[n].p(i,h):(u[n]=St(i),u[n].c(),u[n].m(t,r))}for(;n<u.length;n+=1)u[n].d(1);u.length=l.length}if(134217736&h[0]){let n;for(m=U(e[3].types),n=0;n<m.length;n+=1){const r=wt(e,m,n);y[n]?y[n].p(r,h):(y[n]=jt(r),y[n].c(),y[n].m(t,i))}for(;n<y.length;n+=1)y[n].d(1);y.length=m.length}if(8388616&h[0]){let n;for(b=U(e[3].domains),n=0;n<b.length;n+=1){const r=bt(e,b,n);x[n]?x[n].p(r,h):(x[n]=Pt(r),x[n].c(),x[n].m(t,o))}for(;n<x.length;n+=1)x[n].d(1);x.length=b.length}if(16777224&h[0]){let n;for(k=U(e[3].folders),n=0;n<k.length;n+=1){const r=vt(e,k,n);_[n]?_[n].p(r,h):(_[n]=Et(r),_[n].c(),_[n].m(t,s))}for(;n<_.length;n+=1)_[n].d(1);_.length=k.length}e[3].dateRange?A?A.p(e,h):(A=Tt(e),A.c(),A.m(t,null)):A&&(A.d(1),A=null)},d(e){e&&d(t),p(c,e),p(u,e),p(y,e),p(x,e),p(_,e),A&&A.d()}}}function Ct(e){let t,n,r,i,o,s,a,c=ft(e[103])+"";function l(){return e[42](e[103])}return{c(){t=g("div"),n=g("div"),r=y(c),i=v(),o=g("button"),o.textContent="Ã—",w(n,"class","text-[10px] text-indigo-800"),w(o,"class","text-indigo-600 hover:text-indigo-800 font-bold"),w(t,"class","flex items-center space-x-1 p-1.5 bg-indigo-50 rounded-md border border-indigo-100")},m(e,c){f(e,t,c),h(t,n),h(n,r),h(t,i),h(t,o),s||(a=b(o,"click",l),s=!0)},p(t,n){e=t,8&n[0]&&c!==(c=ft(e[103])+"")&&x(r,c)},d(e){e&&d(t),s=!1,a()}}}function St(e){let t,n,r,i,o,s,a,c=e[100].creator+"";function l(){return e[43](e[100])}return{c(){t=g("div"),n=g("div"),r=y(c),i=v(),o=g("button"),o.textContent="Ã—",w(n,"class","text-[10px] text-pink-800"),w(o,"class","text-pink-600 hover:text-pink-800 font-bold"),w(t,"class","flex items-center space-x-1 p-1.5 bg-pink-50 rounded-md border border-pink-100")},m(e,c){f(e,t,c),h(t,n),h(n,r),h(t,i),h(t,o),s||(a=b(o,"click",l),s=!0)},p(t,n){e=t,8&n[0]&&c!==(c=e[100].creator+"")&&x(r,c)},d(e){e&&d(t),s=!1,a()}}}function jt(e){let t,n,r,i,o,s,a,c=pe(e[97])+"";function l(){return e[44](e[97])}return{c(){t=g("div"),n=g("div"),r=y(c),i=v(),o=g("button"),o.textContent="Ã—",w(n,"class","text-[10px] text-orange-800"),w(o,"class","text-orange-600 hover:text-orange-800 font-bold"),w(t,"class","flex items-center space-x-1 p-1.5 bg-orange-50 rounded-md border border-orange-100")},m(e,c){f(e,t,c),h(t,n),h(n,r),h(t,i),h(t,o),s||(a=b(o,"click",l),s=!0)},p(t,n){e=t,8&n[0]&&c!==(c=pe(e[97])+"")&&x(r,c)},d(e){e&&d(t),s=!1,a()}}}function Pt(e){let t,n,r,i,o,s,a,c=e[94]+"";function l(){return e[45](e[94])}return{c(){t=g("div"),n=g("div"),r=y(c),i=v(),o=g("button"),o.textContent="Ã—",w(n,"class","text-[10px] text-blue-800"),w(o,"class","text-blue-600 hover:text-blue-800 font-bold"),w(t,"class","flex items-center space-x-1 p-1.5 bg-blue-50 rounded-md border border-blue-100")},m(e,c){f(e,t,c),h(t,n),h(n,r),h(t,i),h(t,o),s||(a=b(o,"click",l),s=!0)},p(t,n){e=t,8&n[0]&&c!==(c=e[94]+"")&&x(r,c)},d(e){e&&d(t),s=!1,a()}}}function Et(e){let t,n,r,i,o,s,a,c=e[91]+"";function l(){return e[46](e[91])}return{c(){t=g("div"),n=g("div"),r=y(c),i=v(),o=g("button"),o.textContent="Ã—",w(n,"class","text-[10px] text-green-800"),w(o,"class","text-green-600 hover:text-green-800 font-bold"),w(t,"class","flex items-center space-x-1 p-1.5 bg-green-50 rounded-md border border-green-100")},m(e,c){f(e,t,c),h(t,n),h(n,r),h(t,i),h(t,o),s||(a=b(o,"click",l),s=!0)},p(t,n){e=t,8&n[0]&&c!==(c=e[91]+"")&&x(r,c)},d(e){e&&d(t),s=!1,a()}}}function Tt(e){let t,n,r,i,o,s,a,c="week"===e[3].dateRange.period?"This Week":"twoWeek"===e[3].dateRange.period?"This 2-Week":"month"===e[3].dateRange.period?"This Month":"threeMonth"===e[3].dateRange.period?"This 3-Month":"sixMonth"===e[3].dateRange.period?"This 6-Month":"year"===e[3].dateRange.period?"This Year":"Older";return{c(){t=g("div"),n=g("div"),r=y(c),i=v(),o=g("button"),o.textContent="Ã—",w(n,"class","text-[10px] text-purple-800"),w(o,"class","text-purple-600 hover:text-purple-800 font-bold"),w(t,"class","flex items-center space-x-1 p-1.5 bg-purple-50 rounded-md border border-purple-100")},m(c,l){f(c,t,l),h(t,n),h(n,r),h(t,i),h(t,o),s||(a=b(o,"click",e[47]),s=!0)},p(e,t){8&t[0]&&c!==(c="week"===e[3].dateRange.period?"This Week":"twoWeek"===e[3].dateRange.period?"This 2-Week":"month"===e[3].dateRange.period?"This Month":"threeMonth"===e[3].dateRange.period?"This 3-Month":"sixMonth"===e[3].dateRange.period?"This 6-Month":"year"===e[3].dateRange.period?"This Year":"Older")&&x(r,c)},d(e){e&&d(t),s=!1,a()}}}function Ot(e){let t,n,r,i=e[15].length+"";return{c(){t=y("ðŸŒ Domains ("),n=y(i),r=y(")")},m(e,i){f(e,t,i),f(e,n,i),f(e,r,i)},p(e,t){32768&t[0]&&i!==(i=e[15].length+"")&&x(n,i)},d(e){e&&(d(t),d(n),d(r))}}}function Dt(e){let t,n,r,i,o=e[15].length+"";return{c(){t=g("span"),n=y("Matching Domains ("),r=y(o),i=y(")"),w(t,"class","text-blue-600")},m(e,o){f(e,t,o),h(t,n),h(t,r),h(t,i)},p(e,t){32768&t[0]&&o!==(o=e[15].length+"")&&x(r,o)},d(e){e&&d(t)}}}function Mt(e){let t,n,r,i=!e[0]&&Rt(e),o=U(e[15].slice(0,e[4])),s=[];for(let t=0;t<o.length;t+=1)s[t]=Bt(yt(e,o,t));let a=e[15].length>e[4]&&It(e);return{c(){i&&i.c(),t=v(),n=g("div");for(let e=0;e<s.length;e+=1)s[e].c();r=v(),a&&a.c(),w(n,"class","grid grid-cols-1 gap-1 max-h-64 overflow-y-auto pr-1")},m(e,o){i&&i.m(e,o),f(e,t,o),f(e,n,o);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(n,null);h(n,r),a&&a.m(n,null)},p(e,c){if(e[0]?i&&(i.d(1),i=null):i?i.p(e,c):(i=Rt(e),i.c(),i.m(t.parentNode,t)),12615696&c[0]){let t;for(o=U(e[15].slice(0,e[4])),t=0;t<o.length;t+=1){const i=yt(e,o,t);s[t]?s[t].p(i,c):(s[t]=Bt(i),s[t].c(),s[t].m(n,r))}for(;t<s.length;t+=1)s[t].d(1);s.length=o.length}e[15].length>e[4]?a?a.p(e,c):(a=It(e),a.c(),a.m(n,null)):a&&(a.d(1),a=null)},d(e){e&&(d(t),d(n)),i&&i.d(e),p(s,e),a&&a.d()}}}function Rt(e){let t,n,i,o,s,a;return{c(){t=g("div"),n=g("button"),n.textContent="Recent",i=v(),o=g("button"),o.textContent="Count",w(n,"class","text-[10px] px-1.5 py-0.5 rounded"),w(n,"title","Sort by most recent bookmark"),_(n,"bg-blue-100","recency"===e[1]),_(n,"text-blue-700","recency"===e[1]),_(n,"text-gray-500","recency"!==e[1]),w(o,"class","text-[10px] px-1.5 py-0.5 rounded"),w(o,"title","Sort by bookmark count"),_(o,"bg-blue-100","count"===e[1]),_(o,"text-blue-700","count"===e[1]),_(o,"text-gray-500","count"!==e[1]),w(t,"class","flex space-x-1 mb-2")},m(r,c){f(r,t,c),h(t,n),h(t,i),h(t,o),s||(a=[b(n,"click",e[49]),b(o,"click",e[50])],s=!0)},p(e,t){2&t[0]&&_(n,"bg-blue-100","recency"===e[1]),2&t[0]&&_(n,"text-blue-700","recency"===e[1]),2&t[0]&&_(n,"text-gray-500","recency"!==e[1]),2&t[0]&&_(o,"bg-blue-100","count"===e[1]),2&t[0]&&_(o,"text-blue-700","count"===e[1]),2&t[0]&&_(o,"text-gray-500","count"!==e[1])},d(e){e&&d(t),s=!1,r(a)}}}function Bt(e){let t,n,r,i,o,s,a,c,l,u,p=e[88].domain+"",m=e[88].count+"";function k(){return e[51](e[88])}return{c(){t=g("button"),n=g("span"),r=y(p),i=v(),o=g("div"),s=g("span"),a=y(m),w(n,"class","truncate font-medium text-xs"),w(o,"class","flex items-center text-[10px] text-gray-400 ml-2"),w(t,"class","w-full text-left px-1 py-0.5 text-sm hover:bg-gray-100 rounded border flex items-center justify-between"),w(t,"title",c=e[88].domain),_(t,"bg-blue-50",e[22]("domains",e[88].domain)),_(t,"text-blue-700",e[22]("domains",e[88].domain)),_(t,"border-blue-200",e[22]("domains",e[88].domain)),_(t,"text-gray-600",!e[22]("domains",e[88].domain)),_(t,"border-transparent",!e[22]("domains",e[88].domain))},m(e,c){f(e,t,c),h(t,n),h(n,r),h(t,i),h(t,o),h(o,s),h(s,a),l||(u=b(t,"click",k),l=!0)},p(n,i){e=n,32784&i[0]&&p!==(p=e[88].domain+"")&&x(r,p),32784&i[0]&&m!==(m=e[88].count+"")&&x(a,m),32784&i[0]&&c!==(c=e[88].domain)&&w(t,"title",c),4227088&i[0]&&_(t,"bg-blue-50",e[22]("domains",e[88].domain)),4227088&i[0]&&_(t,"text-blue-700",e[22]("domains",e[88].domain)),4227088&i[0]&&_(t,"border-blue-200",e[22]("domains",e[88].domain)),4227088&i[0]&&_(t,"text-gray-600",!e[22]("domains",e[88].domain)),4227088&i[0]&&_(t,"border-transparent",!e[22]("domains",e[88].domain))},d(e){e&&d(t),l=!1,u()}}}function It(t){let n,r,i;return{c(){n=g("button"),n.textContent="Load More",w(n,"class","w-full text-center px-2 py-1.5 text-xs text-blue-600 hover:bg-blue-50 rounded border border-blue-200 mt-2")},m(e,o){f(e,n,o),r||(i=b(n,"click",t[16]),r=!0)},p:e,d(e){e&&d(n),r=!1,i()}}}function Kt(e){let t,n,r,i=e[14].length+"";return{c(){t=y("ðŸ“ Folders ("),n=y(i),r=y(")")},m(e,i){f(e,t,i),f(e,n,i),f(e,r,i)},p(e,t){16384&t[0]&&i!==(i=e[14].length+"")&&x(n,i)},d(e){e&&(d(t),d(n),d(r))}}}function $t(e){let t,n,r,i,o=e[14].length+"";return{c(){t=g("span"),n=y("Matching Folders ("),r=y(o),i=y(")"),w(t,"class","text-blue-600")},m(e,o){f(e,t,o),h(t,n),h(t,r),h(t,i)},p(e,t){16384&t[0]&&o!==(o=e[14].length+"")&&x(r,o)},d(e){e&&d(t)}}}function qt(e){let t,n,r=U(e[14].slice(0,e[5])),i=[];for(let t=0;t<r.length;t+=1)i[t]=Ft(mt(e,r,t));let o=e[14].length>e[5]&&Lt(e);return{c(){t=g("div");for(let e=0;e<i.length;e+=1)i[e].c();n=v(),o&&o.c(),w(t,"class","grid grid-cols-1 gap-1 max-h-64 overflow-y-auto pr-1")},m(e,r){f(e,t,r);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);h(t,n),o&&o.m(t,null)},p(e,s){if(20987936&s[0]){let o;for(r=U(e[14].slice(0,e[5])),o=0;o<r.length;o+=1){const a=mt(e,r,o);i[o]?i[o].p(a,s):(i[o]=Ft(a),i[o].c(),i[o].m(t,n))}for(;o<i.length;o+=1)i[o].d(1);i.length=r.length}e[14].length>e[5]?o?o.p(e,s):(o=Lt(e),o.c(),o.m(t,null)):o&&(o.d(1),o=null)},d(e){e&&d(t),p(i,e),o&&o.d()}}}function Ft(e){let t,n,r,i,o,s,a,c,l,u,p=e[85].folder.toLowerCase().replace("bookmarks","")+"",m=e[85].count+"";function k(){return e[53](e[85])}return{c(){t=g("button"),n=g("span"),r=y("ðŸ“ "),i=y(p),o=v(),s=g("span"),a=y(m),w(n,"class","truncate block text-xs"),w(s,"class","text-[10px] text-gray-400 ml-1"),w(t,"class","w-full text-left px-2 py-1 text-sm hover:bg-gray-100 rounded border flex items-center justify-between"),w(t,"title",c=e[85].folder),_(t,"bg-green-50",e[22]("folders",e[85].folder)),_(t,"text-green-700",e[22]("folders",e[85].folder)),_(t,"border-green-200",e[22]("folders",e[85].folder)),_(t,"text-gray-600",!e[22]("folders",e[85].folder)),_(t,"border-transparent",!e[22]("folders",e[85].folder))},m(e,c){f(e,t,c),h(t,n),h(n,r),h(n,i),h(t,o),h(t,s),h(s,a),l||(u=b(t,"click",k),l=!0)},p(n,r){e=n,16416&r[0]&&p!==(p=e[85].folder.toLowerCase().replace("bookmarks","")+"")&&x(i,p),16416&r[0]&&m!==(m=e[85].count+"")&&x(a,m),16416&r[0]&&c!==(c=e[85].folder)&&w(t,"title",c),4210720&r[0]&&_(t,"bg-green-50",e[22]("folders",e[85].folder)),4210720&r[0]&&_(t,"text-green-700",e[22]("folders",e[85].folder)),4210720&r[0]&&_(t,"border-green-200",e[22]("folders",e[85].folder)),4210720&r[0]&&_(t,"text-gray-600",!e[22]("folders",e[85].folder)),4210720&r[0]&&_(t,"border-transparent",!e[22]("folders",e[85].folder))},d(e){e&&d(t),l=!1,u()}}}function Lt(t){let n,r,i;return{c(){n=g("button"),n.textContent="Load More",w(n,"class","w-full text-center px-2 py-1.5 text-xs text-green-600 hover:bg-green-50 rounded border border-green-200 mt-2")},m(e,o){f(e,n,o),r||(i=b(n,"click",t[17]),r=!0)},p:e,d(e){e&&d(n),r=!1,i()}}}function zt(e){let t,n,r,i,o,s,a,c,l,u,p,m,k=e[13].length+"",_=e[9].topics?"â–¼":"â–¶",A=e[9].topics&&Nt(e);return{c(){t=g("div"),n=g("button"),r=g("span"),i=y("ðŸ·ï¸ Topics ("),o=y(k),s=y(")"),a=v(),c=g("span"),l=y(_),u=v(),A&&A.c(),w(c,"class","text-gray-400"),w(n,"class","w-full flex items-center justify-between text-xs font-medium text-gray-700 uppercase tracking-wide mb-2 hover:text-gray-900"),w(t,"class","mb-0")},m(d,g){f(d,t,g),h(t,n),h(n,r),h(r,i),h(r,o),h(r,s),h(n,a),h(n,c),h(c,l),h(t,u),A&&A.m(t,null),p||(m=b(n,"click",e[54]),p=!0)},p(e,n){8192&n[0]&&k!==(k=e[13].length+"")&&x(o,k),512&n[0]&&_!==(_=e[9].topics?"â–¼":"â–¶")&&x(l,_),e[9].topics?A?A.p(e,n):(A=Nt(e),A.c(),A.m(t,null)):A&&(A.d(1),A=null)},d(e){e&&d(t),A&&A.d(),p=!1,m()}}}function Nt(e){let t,n,r=U(e[13].slice(0,e[8])),i=[];for(let t=0;t<r.length;t+=1)i[t]=Wt(gt(e,r,t));let o=e[13].length>e[8]&&Ut(e);return{c(){t=g("div");for(let e=0;e<i.length;e+=1)i[e].c();n=v(),o&&o.c(),w(t,"class","grid grid-cols-1 gap-1 max-h-64 overflow-y-auto pr-1")},m(e,r){f(e,t,r);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);h(t,n),o&&o.m(t,null)},p(e,s){if(37757184&s[0]){let o;for(r=U(e[13].slice(0,e[8])),o=0;o<r.length;o+=1){const a=gt(e,r,o);i[o]?i[o].p(a,s):(i[o]=Wt(a),i[o].c(),i[o].m(t,n))}for(;o<i.length;o+=1)i[o].d(1);i.length=r.length}e[13].length>e[8]?o?o.p(e,s):(o=Ut(e),o.c(),o.m(t,null)):o&&(o.d(1),o=null)},d(e){e&&d(t),p(i,e),o&&o.d()}}}function Wt(e){let t,n,r,i,o,s,a,c,l=ft(e[82].topic)+"",u=e[82].count+"";function p(){return e[55](e[82])}return{c(){t=g("button"),n=g("span"),r=y(l),i=v(),o=g("span"),s=y(u),w(n,"class","text-xs"),w(o,"class","text-[10px] text-gray-400"),w(t,"class","w-full text-left px-2 py-1.5 text-sm hover:bg-gray-100 rounded border flex items-center justify-between"),_(t,"bg-indigo-50",e[22]("topics",e[82].topic)),_(t,"text-indigo-700",e[22]("topics",e[82].topic)),_(t,"border-indigo-200",e[22]("topics",e[82].topic)),_(t,"text-gray-600",!e[22]("topics",e[82].topic)),_(t,"border-transparent",!e[22]("topics",e[82].topic))},m(e,l){f(e,t,l),h(t,n),h(n,r),h(t,i),h(t,o),h(o,s),a||(c=b(t,"click",p),a=!0)},p(n,i){e=n,8448&i[0]&&l!==(l=ft(e[82].topic)+"")&&x(r,l),8448&i[0]&&u!==(u=e[82].count+"")&&x(s,u),4202752&i[0]&&_(t,"bg-indigo-50",e[22]("topics",e[82].topic)),4202752&i[0]&&_(t,"text-indigo-700",e[22]("topics",e[82].topic)),4202752&i[0]&&_(t,"border-indigo-200",e[22]("topics",e[82].topic)),4202752&i[0]&&_(t,"text-gray-600",!e[22]("topics",e[82].topic)),4202752&i[0]&&_(t,"border-transparent",!e[22]("topics",e[82].topic))},d(e){e&&d(t),a=!1,c()}}}function Ut(t){let n,r,i;return{c(){n=g("button"),n.textContent="Show more",w(n,"class","w-full text-center px-2 py-1.5 text-xs text-indigo-600 hover:bg-indigo-50 rounded border border-indigo-200 mt-2")},m(e,o){f(e,n,o),r||(i=b(n,"click",t[20]),r=!0)},p:e,d(e){e&&d(n),r=!1,i()}}}function Qt(e){let t,n,r,i,o,s,a,c,l,u,p,m,k=e[12].length+"",_=e[9].creators?"â–¼":"â–¶",A=e[9].creators&&Ht(e);return{c(){t=g("div"),n=g("button"),r=g("span"),i=y("ðŸ‘¤ Top Creators ("),o=y(k),s=y(")"),a=v(),c=g("span"),l=y(_),u=v(),A&&A.c(),w(c,"class","text-gray-400"),w(n,"class","w-full flex items-center justify-between text-xs font-medium text-gray-700 uppercase tracking-wide mb-2 hover:text-gray-900"),w(t,"class","mb-0")},m(d,g){f(d,t,g),h(t,n),h(n,r),h(r,i),h(r,o),h(r,s),h(n,a),h(n,c),h(c,l),h(t,u),A&&A.m(t,null),p||(m=b(n,"click",e[56]),p=!0)},p(e,n){4096&n[0]&&k!==(k=e[12].length+"")&&x(o,k),512&n[0]&&_!==(_=e[9].creators?"â–¼":"â–¶")&&x(l,_),e[9].creators?A?A.p(e,n):(A=Ht(e),A.c(),A.m(t,null)):A&&(A.d(1),A=null)},d(e){e&&d(t),A&&A.d(),p=!1,m()}}}function Ht(e){let t,n,r=U(e[12].slice(0,e[6])),i=[];for(let t=0;t<r.length;t+=1)i[t]=Vt(pt(e,r,t));let o=e[12].length>e[6]&&Yt(e);return{c(){t=g("div");for(let e=0;e<i.length;e+=1)i[e].c();n=v(),o&&o.c(),w(t,"class","grid grid-cols-1 gap-1 max-h-48 overflow-y-auto pr-1")},m(e,r){f(e,t,r);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);h(t,n),o&&o.m(t,null)},p(e,s){if(71307328&s[0]){let o;for(r=U(e[12].slice(0,e[6])),o=0;o<r.length;o+=1){const a=pt(e,r,o);i[o]?i[o].p(a,s):(i[o]=Vt(a),i[o].c(),i[o].m(t,n))}for(;o<i.length;o+=1)i[o].d(1);i.length=r.length}e[12].length>e[6]?o?o.p(e,s):(o=Yt(e),o.c(),o.m(t,null)):o&&(o.d(1),o=null)},d(e){e&&d(t),p(i,e),o&&o.d()}}}function Vt(e){let t,n,r,i,o,s,a,c,l,u,p=e[78].creator+"",m=e[78].count+"";function k(){return e[57](e[78])}return{c(){t=g("button"),n=g("div"),r=g("span"),i=y("ðŸ‘¤ "),o=y(p),s=v(),a=g("span"),c=y(m),w(r,"class","truncate text-xs"),w(a,"class","text-[10px] text-gray-400 ml-1"),w(n,"class","flex items-center justify-between"),w(t,"class","w-full text-left px-2 py-1.5 text-sm hover:bg-gray-100 rounded border"),_(t,"bg-pink-50",e[79]),_(t,"text-pink-700",e[79]),_(t,"border-pink-200",e[79]),_(t,"text-gray-600",!e[79]),_(t,"border-transparent",!e[79])},m(e,d){f(e,t,d),h(t,n),h(n,r),h(r,i),h(r,o),h(n,s),h(n,a),h(a,c),l||(u=b(t,"click",k),l=!0)},p(n,r){e=n,4160&r[0]&&p!==(p=e[78].creator+"")&&x(o,p),4160&r[0]&&m!==(m=e[78].count+"")&&x(c,m),4198464&r[0]&&_(t,"bg-pink-50",e[79]),4198464&r[0]&&_(t,"text-pink-700",e[79]),4198464&r[0]&&_(t,"border-pink-200",e[79]),4198464&r[0]&&_(t,"text-gray-600",!e[79]),4198464&r[0]&&_(t,"border-transparent",!e[79])},d(e){e&&d(t),l=!1,u()}}}function Yt(t){let n,r,i;return{c(){n=g("button"),n.textContent="Show more",w(n,"class","w-full text-center px-2 py-1 text-xs text-pink-600 hover:bg-pink-50 rounded")},m(e,o){f(e,n,o),r||(i=b(n,"click",t[18]),r=!0)},p:e,d(e){e&&d(n),r=!1,i()}}}function Gt(e){let t,n,r,i,o,s,a,c,l,u,p,m,k=e[11].length+"",_=e[9].contentTypes?"â–¼":"â–¶",A=e[9].contentTypes&&Jt(e);return{c(){t=g("div"),n=g("button"),r=g("span"),i=y("ðŸ“ Content Types ("),o=y(k),s=y(")"),a=v(),c=g("span"),l=y(_),u=v(),A&&A.c(),w(c,"class","text-gray-400"),w(n,"class","w-full flex items-center justify-between text-xs font-medium text-gray-700 uppercase tracking-wide mb-2 hover:text-gray-900"),w(t,"class","mb-0")},m(d,g){f(d,t,g),h(t,n),h(n,r),h(r,i),h(r,o),h(r,s),h(n,a),h(n,c),h(c,l),h(t,u),A&&A.m(t,null),p||(m=b(n,"click",e[58]),p=!0)},p(e,n){2048&n[0]&&k!==(k=e[11].length+"")&&x(o,k),512&n[0]&&_!==(_=e[9].contentTypes?"â–¼":"â–¶")&&x(l,_),e[9].contentTypes?A?A.p(e,n):(A=Jt(e),A.c(),A.m(t,null)):A&&(A.d(1),A=null)},d(e){e&&d(t),A&&A.d(),p=!1,m()}}}function Jt(e){let t,n,r=U(e[11].slice(0,e[7])),i=[];for(let t=0;t<r.length;t+=1)i[t]=Xt(dt(e,r,t));let o=e[11].length>e[7]&&Zt(e);return{c(){t=g("div");for(let e=0;e<i.length;e+=1)i[e].c();n=v(),o&&o.c(),w(t,"class","grid grid-cols-1 gap-1 max-h-48 overflow-y-auto pr-1")},m(e,r){f(e,t,r);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);h(t,n),o&&o.m(t,null)},p(e,s){if(138414208&s[0]){let o;for(r=U(e[11].slice(0,e[7])),o=0;o<r.length;o+=1){const a=dt(e,r,o);i[o]?i[o].p(a,s):(i[o]=Xt(a),i[o].c(),i[o].m(t,n))}for(;o<i.length;o+=1)i[o].d(1);i.length=r.length}e[11].length>e[7]?o?o.p(e,s):(o=Zt(e),o.c(),o.m(t,null)):o&&(o.d(1),o=null)},d(e){e&&d(t),p(i,e),o&&o.d()}}}function Xt(e){let t,n,r,i,o,s,a,c,l=pe(e[75].type)+"",u=e[75].count+"";function p(){return e[59](e[75])}return{c(){t=g("button"),n=g("span"),r=y(l),i=v(),o=g("span"),s=y(u),w(n,"class","text-xs"),w(o,"class","text-[10px] text-gray-400"),w(t,"class","w-full text-left px-2 py-1.5 text-sm hover:bg-gray-100 rounded border flex items-center justify-between"),_(t,"bg-orange-50",e[22]("types",e[75].type)),_(t,"text-orange-700",e[22]("types",e[75].type)),_(t,"border-orange-200",e[22]("types",e[75].type)),_(t,"text-gray-600",!e[22]("types",e[75].type)),_(t,"border-transparent",!e[22]("types",e[75].type))},m(e,l){f(e,t,l),h(t,n),h(n,r),h(t,i),h(t,o),h(o,s),a||(c=b(t,"click",p),a=!0)},p(n,i){e=n,2176&i[0]&&l!==(l=pe(e[75].type)+"")&&x(r,l),2176&i[0]&&u!==(u=e[75].count+"")&&x(s,u),4196480&i[0]&&_(t,"bg-orange-50",e[22]("types",e[75].type)),4196480&i[0]&&_(t,"text-orange-700",e[22]("types",e[75].type)),4196480&i[0]&&_(t,"border-orange-200",e[22]("types",e[75].type)),4196480&i[0]&&_(t,"text-gray-600",!e[22]("types",e[75].type)),4196480&i[0]&&_(t,"border-transparent",!e[22]("types",e[75].type))},d(e){e&&d(t),a=!1,c()}}}function Zt(t){let n,r,i;return{c(){n=g("button"),n.textContent="Show more",w(n,"class","w-full text-center px-2 py-1 text-xs text-orange-600 hover:bg-orange-50 rounded")},m(e,o){f(e,n,o),r||(i=b(n,"click",t[19]),r=!0)},p:e,d(e){e&&d(n),r=!1,i()}}}function en(t){let n,i,o,s,a,c,l,u,p,m,k,A,C,S,j,P,E,T,O,D,M,R,B,I,K,$,q,F,L,z,N,W,U,Q,H,V,Y,G,J,X,Z,ee,te,ne,re,ie,oe,se,ae,ce,le,ue,he,fe,de,pe,ge,me,ye,ve,be,we,xe,ke,_e,Ae,Ce,Se,je,Pe,Ee,Te,Oe,De,Me=t[9].domains?"â–¼":"â–¶",Re=t[9].folders?"â–¼":"â–¶",Be=t[10].week+"",Ie=t[10].twoWeek+"",Ke=t[10].month+"",$e=t[10].threeMonth+"",qe=t[10].sixMonth+"",Fe=t[10].year+"",Le=t[10].older+"",ze=t[2]&&_t(t),Ne=t[2]&&At(t);function We(e,t){return e[0]?Dt:Ot}let Ue=We(t),Qe=Ue(t),He=t[9].domains&&Mt(t);function Ve(e,t){return e[0]?$t:Kt}let Ye=Ve(t),Ge=Ye(t),Je=t[9].folders&&qt(t),Xe=t[13].length>0&&zt(t),Ze=t[12].length>0&&Qt(t),et=t[11].length>0&&Gt(t);return{c(){n=g("div"),i=g("div"),o=g("div"),s=g("h3"),s.textContent="Filters",a=v(),ze&&ze.c(),c=v(),Ne&&Ne.c(),l=v(),u=g("div"),p=g("div"),m=g("button"),k=g("span"),Qe.c(),A=v(),C=g("span"),S=y(Me),j=v(),He&&He.c(),P=v(),E=g("div"),T=g("button"),O=g("span"),Ge.c(),D=v(),M=g("span"),R=y(Re),B=v(),Je&&Je.c(),I=v(),Xe&&Xe.c(),K=v(),Ze&&Ze.c(),$=v(),et&&et.c(),q=v(),F=g("div"),L=g("h4"),L.textContent="Date Added",z=v(),N=g("div"),W=g("button"),U=g("span"),U.textContent="This Week",Q=v(),H=g("span"),V=y(Be),Y=v(),G=g("button"),J=g("span"),J.textContent="This 2-Week",X=v(),Z=g("span"),ee=y(Ie),te=v(),ne=g("button"),re=g("span"),re.textContent="This Month",ie=v(),oe=g("span"),se=y(Ke),ae=v(),ce=g("button"),le=g("span"),le.textContent="This 3-Month",ue=v(),he=g("span"),fe=y($e),de=v(),pe=g("button"),ge=g("span"),ge.textContent="This 6-Month",me=v(),ye=g("span"),ve=y(qe),be=v(),we=g("button"),xe=g("span"),xe.textContent="This Year",ke=v(),_e=g("span"),Ae=y(Fe),Ce=v(),Se=g("button"),je=g("span"),je.textContent="Older",Pe=v(),Ee=g("span"),Te=y(Le),w(s,"class","text-sm font-medium text-gray-900"),w(o,"class","flex items-center justify-between mb-3"),w(i,"class","mb-6"),w(C,"class","text-gray-400"),w(m,"class","w-full flex items-center justify-between text-xs font-medium text-gray-700 uppercase tracking-wide mb-2 hover:text-gray-900"),w(p,"class","mb-0"),w(M,"class","text-gray-400"),w(T,"class","w-full flex items-center justify-between text-xs font-medium text-gray-700 uppercase tracking-wide mb-2 hover:text-gray-900"),w(E,"class","mb-0"),w(L,"class","text-xs font-medium text-gray-700 uppercase tracking-wide mb-2"),w(U,"class","text-xs"),w(H,"class","text-[10px] text-gray-400"),w(W,"class","w-full text-left px-2 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded flex items-center justify-between"),_(W,"bg-blue-50","week"===t[3].dateRange?.period),_(W,"text-blue-700","week"===t[3].dateRange?.period),w(J,"class","text-xs"),w(Z,"class","text-[10px] text-gray-400"),w(G,"class","w-full text-left px-2 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded flex items-center justify-between"),_(G,"bg-blue-50","twoWeek"===t[3].dateRange?.period),_(G,"text-blue-700","twoWeek"===t[3].dateRange?.period),w(re,"class","text-xs"),w(oe,"class","text-[10px] text-gray-400"),w(ne,"class","w-full text-left px-2 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded flex items-center justify-between"),_(ne,"bg-blue-50","month"===t[3].dateRange?.period),_(ne,"text-blue-700","month"===t[3].dateRange?.period),w(le,"class","text-xs"),w(he,"class","text-[10px] text-gray-400"),w(ce,"class","w-full text-left px-2 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded flex items-center justify-between"),_(ce,"bg-blue-50","threeMonth"===t[3].dateRange?.period),_(ce,"text-blue-700","threeMonth"===t[3].dateRange?.period),w(ge,"class","text-xs"),w(ye,"class","text-[10px] text-gray-400"),w(pe,"class","w-full text-left px-2 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded flex items-center justify-between"),_(pe,"bg-blue-50","sixMonth"===t[3].dateRange?.period),_(pe,"text-blue-700","sixMonth"===t[3].dateRange?.period),w(xe,"class","text-xs"),w(_e,"class","text-[10px] text-gray-400"),w(we,"class","w-full text-left px-2 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded flex items-center justify-between"),_(we,"bg-blue-50","year"===t[3].dateRange?.period),_(we,"text-blue-700","year"===t[3].dateRange?.period),w(je,"class","text-xs"),w(Ee,"class","text-[10px] text-gray-400"),w(Se,"class","w-full text-left px-2 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded flex items-center justify-between"),_(Se,"bg-blue-50","older"===t[3].dateRange?.period),_(Se,"text-blue-700","older"===t[3].dateRange?.period),w(N,"class","grid grid-cols-1 gap-1"),w(F,"class","mb-0"),w(u,"class","grid grid-cols-2 gap-x-6 gap-y-6"),w(n,"class","w-[24rem] bg-gray-50 border-r border-gray-200 p-4 overflow-y-auto flex-shrink-0")},m(e,r){f(e,n,r),h(n,i),h(i,o),h(o,s),h(o,a),ze&&ze.m(o,null),h(i,c),Ne&&Ne.m(i,null),h(n,l),h(n,u),h(u,p),h(p,m),h(m,k),Qe.m(k,null),h(m,A),h(m,C),h(C,S),h(p,j),He&&He.m(p,null),h(u,P),h(u,E),h(E,T),h(T,O),Ge.m(O,null),h(T,D),h(T,M),h(M,R),h(E,B),Je&&Je.m(E,null),h(u,I),Xe&&Xe.m(u,null),h(u,K),Ze&&Ze.m(u,null),h(u,$),et&&et.m(u,null),h(u,q),h(u,F),h(F,L),h(F,z),h(F,N),h(N,W),h(W,U),h(W,Q),h(W,H),h(H,V),h(N,Y),h(N,G),h(G,J),h(G,X),h(G,Z),h(Z,ee),h(N,te),h(N,ne),h(ne,re),h(ne,ie),h(ne,oe),h(oe,se),h(N,ae),h(N,ce),h(ce,le),h(ce,ue),h(ce,he),h(he,fe),h(N,de),h(N,pe),h(pe,ge),h(pe,me),h(pe,ye),h(ye,ve),h(N,be),h(N,we),h(we,xe),h(we,ke),h(we,_e),h(_e,Ae),h(N,Ce),h(N,Se),h(Se,je),h(Se,Pe),h(Se,Ee),h(Ee,Te),Oe||(De=[b(m,"click",t[48]),b(T,"click",t[52]),b(W,"click",t[60]),b(G,"click",t[61]),b(ne,"click",t[62]),b(ce,"click",t[63]),b(pe,"click",t[64]),b(we,"click",t[65]),b(Se,"click",t[66])],Oe=!0)},p(e,t){e[2]?ze?ze.p(e,t):(ze=_t(e),ze.c(),ze.m(o,null)):ze&&(ze.d(1),ze=null),e[2]?Ne?Ne.p(e,t):(Ne=At(e),Ne.c(),Ne.m(i,null)):Ne&&(Ne.d(1),Ne=null),Ue===(Ue=We(e))&&Qe?Qe.p(e,t):(Qe.d(1),Qe=Ue(e),Qe&&(Qe.c(),Qe.m(k,null))),512&t[0]&&Me!==(Me=e[9].domains?"â–¼":"â–¶")&&x(S,Me),e[9].domains?He?He.p(e,t):(He=Mt(e),He.c(),He.m(p,null)):He&&(He.d(1),He=null),Ye===(Ye=Ve(e))&&Ge?Ge.p(e,t):(Ge.d(1),Ge=Ye(e),Ge&&(Ge.c(),Ge.m(O,null))),512&t[0]&&Re!==(Re=e[9].folders?"â–¼":"â–¶")&&x(R,Re),e[9].folders?Je?Je.p(e,t):(Je=qt(e),Je.c(),Je.m(E,null)):Je&&(Je.d(1),Je=null),e[13].length>0?Xe?Xe.p(e,t):(Xe=zt(e),Xe.c(),Xe.m(u,K)):Xe&&(Xe.d(1),Xe=null),e[12].length>0?Ze?Ze.p(e,t):(Ze=Qt(e),Ze.c(),Ze.m(u,$)):Ze&&(Ze.d(1),Ze=null),e[11].length>0?et?et.p(e,t):(et=Gt(e),et.c(),et.m(u,q)):et&&(et.d(1),et=null),1024&t[0]&&Be!==(Be=e[10].week+"")&&x(V,Be),8&t[0]&&_(W,"bg-blue-50","week"===e[3].dateRange?.period),8&t[0]&&_(W,"text-blue-700","week"===e[3].dateRange?.period),1024&t[0]&&Ie!==(Ie=e[10].twoWeek+"")&&x(ee,Ie),8&t[0]&&_(G,"bg-blue-50","twoWeek"===e[3].dateRange?.period),8&t[0]&&_(G,"text-blue-700","twoWeek"===e[3].dateRange?.period),1024&t[0]&&Ke!==(Ke=e[10].month+"")&&x(se,Ke),8&t[0]&&_(ne,"bg-blue-50","month"===e[3].dateRange?.period),8&t[0]&&_(ne,"text-blue-700","month"===e[3].dateRange?.period),1024&t[0]&&$e!==($e=e[10].threeMonth+"")&&x(fe,$e),8&t[0]&&_(ce,"bg-blue-50","threeMonth"===e[3].dateRange?.period),8&t[0]&&_(ce,"text-blue-700","threeMonth"===e[3].dateRange?.period),1024&t[0]&&qe!==(qe=e[10].sixMonth+"")&&x(ve,qe),8&t[0]&&_(pe,"bg-blue-50","sixMonth"===e[3].dateRange?.period),8&t[0]&&_(pe,"text-blue-700","sixMonth"===e[3].dateRange?.period),1024&t[0]&&Fe!==(Fe=e[10].year+"")&&x(Ae,Fe),8&t[0]&&_(we,"bg-blue-50","year"===e[3].dateRange?.period),8&t[0]&&_(we,"text-blue-700","year"===e[3].dateRange?.period),1024&t[0]&&Le!==(Le=e[10].older+"")&&x(Te,Le),8&t[0]&&_(Se,"bg-blue-50","older"===e[3].dateRange?.period),8&t[0]&&_(Se,"text-blue-700","older"===e[3].dateRange?.period)},i:e,o:e,d(e){e&&d(n),ze&&ze.d(),Ne&&Ne.d(),Qe.d(),He&&He.d(),Ge.d(),Je&&Je.d(),Xe&&Xe.d(),Ze&&Ze.d(),et&&et.d(),Oe=!1,r(De)}}}function tn(e,t,n){let r,i,o,s,a,c,l,h,f;u(e,Ce,e=>n(3,f=e));let{searchResultStats:d=null}=t,{isSearchActive:p=!1}=t,g=[],m=[],y=[],v=[],b=[],w=[],x={week:0,twoWeek:0,month:0,threeMonth:0,sixMonth:0,year:0,older:0},k="count",_=40,A=10,C=10,j=10,P=15,E={topics:!0,creators:!0,contentTypes:!0,domains:!0,folders:!0};async function T(){const e=await Ae.getCached(),t=Date.now(),r=864e5,i=7*r,o=14*r,s=90*r,a=180*r,c=new Date,l=c.getFullYear(),u=new Date(l,c.getMonth(),1).getTime(),h=new Date(l,0,1).getTime();let f=0,d=0,p=0,g=0,m=0,y=0,v=0;e.forEach(e=>{const n=e.dateAdded;t-n<i&&f++,t-n<o&&d++,n>=u&&p++,t-n<s&&g++,t-n<a&&m++,n>=h&&y++,n<h&&v++}),n(40,x={week:f,twoWeek:d,month:p,threeMonth:g,sixMonth:m,year:y,older:v})}async function O(){n(34,g=await async function(){return(await xe()).byRecency}()),n(35,m=await async function(){return(await xe()).byCount}())}async function D(){const e=await Ae.getCached(),t={},r={},i={};e.forEach(e=>{const n=e.topics||[];for(const e of n)t[e]=(t[e]||0)+1;if(e.creator){const t=`${e.platform||"other"}:${e.creator}`;r[t]||(r[t]={creator:e.creator,platform:e.platform||"other",count:0}),r[t].count++}e.contentType&&(i[e.contentType]=(i[e.contentType]||0)+1)}),n(37,v=Object.entries(t).map(([e,t])=>({topic:e,count:t})).sort((e,t)=>t.count-e.count)),n(38,b=Object.values(r).sort((e,t)=>t.count-e.count)),n(39,w=Object.entries(i).map(([e,t])=>({type:e,count:t})).sort((e,t)=>t.count-e.count))}function M(e){n(9,E[e]=!E[e],E)}function R(e){Ce.toggleFilter("domains",e)}function B(e){Ce.toggleFilter("folders",e)}function I(e){Ce.toggleFilter("topics",e)}function K(e,t){const n=`${t}:${e}`;Ce.toggleFilter("creators",{key:n,creator:e,platform:t})}function $(e){Ce.toggleFilter("types",e)}function q(e){if(f.dateRange?.period===e)return void Ce.setFilter("dateRange",null);const t=new Date,n=t.getFullYear();let r,i=t.getTime();switch(e){case"week":r=new Date(t.getTime()-6048e5);break;case"twoWeek":r=new Date(t.getTime()-12096e5);break;case"month":r=new Date(n,t.getMonth(),1);break;case"threeMonth":r=new Date(t.getTime()-7776e6);break;case"sixMonth":r=new Date(t.getTime()-15552e6);break;case"year":r=new Date(n,0,1);break;case"older":r=new Date(0),i=new Date(n,0,1).getTime()-1}!function(e,t,n){Ce.setFilter("dateRange",{startDate:e,endDate:t,period:n})}(r.getTime(),i,e)}S(async()=>{try{await O(),await D(),await T(),n(36,y=await ke())}catch(e){console.error("Error loading filters:",e)}});return e.$$set=e=>{"searchResultStats"in e&&n(30,d=e.searchResultStats),"isSearchActive"in e&&n(0,p=e.isSearchActive)},e.$$.update=()=>{8&e.$$.dirty[0]&&n(2,r=f.domains.length>0||f.folders.length>0||f.topics.length>0||f.creators.length>0||f.types.length>0||f.tags&&f.tags.length>0||f.deadLinks||f.stale||null!==f.dateRange||null!==f.readingTimeRange||null!==f.qualityScoreRange||null!==f.hasPublishedDate),1073741829&e.$$.dirty[0]&&n(41,i=(p||r)&&null!=d),1073741826&e.$$.dirty[0]|1048&e.$$.dirty[1]&&n(15,o=i&&d?.domains?d.domains:"recency"===k?g:m),1073741824&e.$$.dirty[0]|1056&e.$$.dirty[1]&&n(14,s=i&&d?.folders?d.folders:y),1073741824&e.$$.dirty[0]|1088&e.$$.dirty[1]&&n(13,a=i&&d?.topics?d.topics:v),1073741824&e.$$.dirty[0]|1152&e.$$.dirty[1]&&n(12,c=i&&d?.creators?d.creators:b),1073741824&e.$$.dirty[0]|1280&e.$$.dirty[1]&&n(11,l=i&&d?.contentTypes?d.contentTypes:w),1073741824&e.$$.dirty[0]|1536&e.$$.dirty[1]&&n(10,h=i&&d?.dateCounts?d.dateCounts:x)},[p,k,r,f,_,A,C,j,P,E,h,l,c,a,s,o,function(){n(4,_+=30)},function(){n(5,A+=15)},function(){n(6,C+=10)},function(){n(7,j+=10)},function(){n(8,P+=10)},M,function(e,t){return void 0!==f[e]&&(Array.isArray(f[e])?"creators"===e?f[e].some(e=>e.key===t):f[e].some(e=>String(e).toLowerCase()===String(t).toLowerCase()):f[e]===t)},R,B,I,K,$,function(){Ce.clearFilters()},q,d,function(){return r},function(){Ce.clearFilters()},async function(){try{await O(),await D(),await T(),n(36,y=await ke())}catch(e){console.error("Error refreshing sidebar:",e)}},g,m,y,v,b,w,x,i,e=>I(e),e=>K(e.creator,e.platform),e=>$(e),e=>R(e),e=>B(e),()=>{Ce.setFilter("dateRange",null)},()=>M("domains"),()=>n(1,k="recency"),()=>n(1,k="count"),e=>R(e.domain),()=>M("folders"),e=>B(e.folder),()=>M("topics"),e=>I(e.topic),()=>M("creators"),e=>K(e.creator,e.platform),()=>M("contentTypes"),e=>$(e.type),()=>q("week"),()=>q("twoWeek"),()=>q("month"),()=>q("threeMonth"),()=>q("sixMonth"),()=>q("year"),()=>q("older")]}class nn extends X{constructor(e){super(),J(this,e,tn,en,o,{searchResultStats:30,isSearchActive:0,getHasActiveFilters:31,clearAllFilters:32,refresh:33},null,[-1,-1,-1,-1])}get getHasActiveFilters(){return this.$$.ctx[31]}get clearAllFilters(){return this.$$.ctx[32]}get refresh(){return this.$$.ctx[33]}}
/**!
 * FlexSearch.js v0.8.212 (Bundle/Module)
 * Author and Copyright: Thomas Wilkerling
 * Licence: Apache-2.0
 * Hosted by Nextapps GmbH
 * https://github.com/nextapps-de/flexsearch
 */var rn;function on(e,t,n){const r=typeof n,i=typeof e;if("undefined"!==r){if("undefined"!==i){if(n){if("function"===i&&r===i)return function(t){return e(n(t))};if((t=e.constructor)===n.constructor){if(t===Array)return n.concat(e);if(t===Map){var o=new Map(n);for(var s of e)o.set(s[0],s[1]);return o}if(t===Set){for(o of(s=new Set(n),e.values()))s.add(o);return s}}}return e}return n}return"undefined"===i?t:e}function sn(e,t){return void 0===e?t:e}function an(){return Object.create(null)}function cn(e){return"string"==typeof e}function ln(e){return"object"==typeof e}function un(e,t){if(cn(t))e=e[t];else for(let n=0;e&&n<t.length;n++)e=e[t[n]];return e}const hn=/[^\p{L}\p{N}]+/u,fn=/(\d{3})/g,dn=/(\D)(\d{3})/g,pn=/(\d{3})(\D)/g,gn=/[\u0300-\u036f]/g;function mn(e={}){if(!this||this.constructor!==mn)return new mn(...arguments);if(arguments.length)for(e=0;e<arguments.length;e++)this.assign(arguments[e]);else this.assign(e)}function yn(e){e.F=null,e.B.clear(),e.D.clear()}function vn(e,t,n){n||(t||"object"!=typeof e?"object"==typeof t&&(n=t,t=0):n=e),n&&(e=n.query||e,t=n.limit||t);let r=""+(t||0);n&&(r+=(n.offset||0)+!!n.context+!!n.suggest+(!1!==n.resolve)+(n.resolution||this.resolution)+(n.boost||0)),e=(""+e).toLowerCase(),this.cache||(this.cache=new bn);let i=this.cache.get(e+r);if(!i){const o=n&&n.cache;o&&(n.cache=!1),i=this.search(e,t,n),o&&(n.cache=o),this.cache.set(e+r,i)}return i}function bn(e){this.limit=e&&!0!==e?e:1e3,this.cache=new Map,this.h=""}(rn=mn.prototype).assign=function(e){this.normalize=on(e.normalize,!0,this.normalize);let t,n=e.include,r=n||e.exclude||e.split;if(r||""===r){if("object"==typeof r&&r.constructor!==RegExp){let e="";t=!n,n||(e+="\\p{Z}"),r.letter&&(e+="\\p{L}"),r.number&&(e+="\\p{N}",t=!!n),r.symbol&&(e+="\\p{S}"),r.punctuation&&(e+="\\p{P}"),r.control&&(e+="\\p{C}"),(r=r.char)&&(e+="object"==typeof r?r.join(""):r);try{this.split=new RegExp("["+(n?"^":"")+e+"]+","u")}catch(e){this.split=/\s+/}}else this.split=r,t=!1===r||"a1a".split(r).length<2;this.numeric=on(e.numeric,t)}else{try{this.split=on(this.split,hn)}catch(e){this.split=/\s+/}this.numeric=on(e.numeric,on(this.numeric,!0))}if(this.prepare=on(e.prepare,null,this.prepare),this.finalize=on(e.finalize,null,this.finalize),r=e.filter,this.filter="function"==typeof r?r:on(r&&new Set(r),null,this.filter),this.dedupe=on(e.dedupe,!0,this.dedupe),this.matcher=on((r=e.matcher)&&new Map(r),null,this.matcher),this.mapper=on((r=e.mapper)&&new Map(r),null,this.mapper),this.stemmer=on((r=e.stemmer)&&new Map(r),null,this.stemmer),this.replacer=on(e.replacer,null,this.replacer),this.minlength=on(e.minlength,1,this.minlength),this.maxlength=on(e.maxlength,1024,this.maxlength),this.rtl=on(e.rtl,!1,this.rtl),(this.cache=r=on(e.cache,!0,this.cache))&&(this.F=null,this.L="number"==typeof r?r:2e5,this.B=new Map,this.D=new Map,this.I=this.H=128),this.h="",this.J=null,this.A="",this.K=null,this.matcher)for(const e of this.matcher.keys())this.h+=(this.h?"|":"")+e;if(this.stemmer)for(const e of this.stemmer.keys())this.A+=(this.A?"|":"")+e;return this},rn.addStemmer=function(e,t){return this.stemmer||(this.stemmer=new Map),this.stemmer.set(e,t),this.A+=(this.A?"|":"")+e,this.K=null,this.cache&&yn(this),this},rn.addFilter=function(e){return"function"==typeof e?this.filter=e:(this.filter||(this.filter=new Set),this.filter.add(e)),this.cache&&yn(this),this},rn.addMapper=function(e,t){return"object"==typeof e?this.addReplacer(e,t):e.length>1?this.addMatcher(e,t):(this.mapper||(this.mapper=new Map),this.mapper.set(e,t),this.cache&&yn(this),this)},rn.addMatcher=function(e,t){return"object"==typeof e?this.addReplacer(e,t):e.length<2&&(this.dedupe||this.mapper)?this.addMapper(e,t):(this.matcher||(this.matcher=new Map),this.matcher.set(e,t),this.h+=(this.h?"|":"")+e,this.J=null,this.cache&&yn(this),this)},rn.addReplacer=function(e,t){return"string"==typeof e?this.addMatcher(e,t):(this.replacer||(this.replacer=[]),this.replacer.push(e,t),this.cache&&yn(this),this)},rn.encode=function(e,t){if(this.cache&&e.length<=this.H)if(this.F){if(this.B.has(e))return this.B.get(e)}else this.F=setTimeout(yn,50,this);this.normalize&&(e="function"==typeof this.normalize?this.normalize(e):gn?e.normalize("NFKD").replace(gn,"").toLowerCase():e.toLowerCase()),this.prepare&&(e=this.prepare(e)),this.numeric&&e.length>3&&(e=e.replace(dn,"$1 $2").replace(pn,"$1 $2").replace(fn,"$1 "));const n=!(this.dedupe||this.mapper||this.filter||this.matcher||this.stemmer||this.replacer);let r,i,o=[],s=an(),a=this.split||""===this.split?e.split(this.split):[e];for(let e,l,u=0;u<a.length;u++)if((e=l=a[u])&&!(e.length<this.minlength||e.length>this.maxlength)){if(t){if(s[e])continue;s[e]=1}else{if(r===e)continue;r=e}if(n)o.push(e);else if(!this.filter||("function"==typeof this.filter?this.filter(e):!this.filter.has(e))){if(this.cache&&e.length<=this.I)if(this.F){var c=this.D.get(e);if(c||""===c){c&&o.push(c);continue}}else this.F=setTimeout(yn,50,this);if(this.stemmer){let t;for(this.K||(this.K=new RegExp("(?!^)("+this.A+")$"));t!==e&&e.length>2;)t=e,e=e.replace(this.K,e=>this.stemmer.get(e))}if(e&&(this.mapper||this.dedupe&&e.length>1)){c="";for(let t,n,r=0,i="";r<e.length;r++)t=e.charAt(r),t===i&&this.dedupe||((n=this.mapper&&this.mapper.get(t))||""===n?n===i&&this.dedupe||!(i=n)||(c+=n):c+=i=t);e=c}if(this.matcher&&e.length>1&&(this.J||(this.J=new RegExp("("+this.h+")","g")),e=e.replace(this.J,e=>this.matcher.get(e))),e&&this.replacer)for(c=0;e&&c<this.replacer.length;c+=2)e=e.replace(this.replacer[c],this.replacer[c+1]);if(this.cache&&l.length<=this.I&&(this.D.set(l,e),this.D.size>this.L&&(this.D.clear(),this.I=this.I/1.1|0)),e){if(e!==l)if(t){if(s[e])continue;s[e]=1}else{if(i===e)continue;i=e}o.push(e)}}}return this.finalize&&(o=this.finalize(o)||o),this.cache&&e.length<=this.H&&(this.B.set(e,o),this.B.size>this.L&&(this.B.clear(),this.H=this.H/1.1|0)),o},bn.prototype.set=function(e,t){this.cache.set(this.h=e,t),this.cache.size>this.limit&&this.cache.delete(this.cache.keys().next().value)},bn.prototype.get=function(e){const t=this.cache.get(e);return t&&this.h!==e&&(this.cache.delete(e),this.cache.set(this.h=e,t)),t},bn.prototype.remove=function(e){for(const t of this.cache){const n=t[0];t[1].includes(e)&&this.cache.delete(n)}},bn.prototype.clear=function(){this.cache.clear(),this.h=""};const wn={normalize:!1,numeric:!1,dedupe:!1},xn={},kn=new Map([["b","p"],["v","f"],["w","f"],["z","s"],["x","s"],["d","t"],["n","m"],["c","k"],["g","k"],["j","k"],["q","k"],["i","e"],["y","e"],["u","o"]]),_n=new Map([["ae","a"],["oe","o"],["sh","s"],["kh","k"],["th","t"],["ph","f"],["pf","f"]]),An=[/([^aeo])h(.)/g,"$1$2",/([aeo])h([^aeo]|$)/g,"$1$2",/(.)\1+/g,"$1"],Cn={a:"",e:"",i:"",o:"",u:"",y:"",b:1,f:1,p:1,v:1,c:2,g:2,j:2,k:2,q:2,s:2,x:2,z:2,"ÃŸ":2,d:3,t:3,l:4,m:5,n:5,r:6};var Sn={Exact:wn,Default:xn,Normalize:xn,LatinBalance:{mapper:kn},LatinAdvanced:{mapper:kn,matcher:_n,replacer:An},LatinExtra:{mapper:kn,replacer:An.concat([/(?!^)[aeo]/g,""]),matcher:_n},LatinSoundex:{dedupe:!1,include:{letter:!0},finalize:function(e){for(let n=0;n<e.length;n++){var t=e[n];let r=t.charAt(0),i=Cn[r];for(let e,n=1;n<t.length&&(e=t.charAt(n),"h"===e||"w"===e||!(e=Cn[e])||e===i||(r+=e,i=e,4!==r.length));n++);e[n]=r}}},CJK:{split:""},LatinExact:wn,LatinDefault:xn,LatinSimple:xn};function jn(e,t,n,r){let i=[];for(let o,s=0;s<e.index.length;s++)if(o=e.index[s],t>=o.length)t-=o.length;else{const s=(t=o[r?"splice":"slice"](t,n)).length;if(s&&(i=i.length?i.concat(t):t,n-=s,r&&(e.length-=s),!n))break;t=0}return i}function Pn(e){if(!this||this.constructor!==Pn)return new Pn(e);this.index=e?[e]:[],this.length=e?e.length:0;const t=this;return new Proxy([],{get:(e,n)=>"length"===n?t.length:"push"===n?function(e){t.index[t.index.length-1].push(e),t.length++}:"pop"===n?function(){if(t.length)return t.length--,t.index[t.index.length-1].pop()}:"indexOf"===n?function(e){let n=0;for(let r,i,o=0;o<t.index.length;o++){if(r=t.index[o],i=r.indexOf(e),i>=0)return n+i;n+=r.length}return-1}:"includes"===n?function(e){for(let n=0;n<t.index.length;n++)if(t.index[n].includes(e))return!0;return!1}:"slice"===n?function(e,n){return jn(t,e||0,n||t.length,!1)}:"splice"===n?function(e,n){return jn(t,e||0,n||t.length,!0)}:"constructor"===n?Array:"symbol"!=typeof n?(e=t.index[n/2**31|0])&&e[n]:void 0,set:(e,n,r)=>(e=n/2**31|0,(t.index[e]||(t.index[e]=[]))[n]=r,t.length++,!0)})}function En(e=8){if(!this||this.constructor!==En)return new En(e);this.index=an(),this.h=[],this.size=0,e>32?(this.B=Dn,this.A=BigInt(e)):(this.B=On,this.A=e)}function Tn(e=8){if(!this||this.constructor!==Tn)return new Tn(e);this.index=an(),this.h=[],this.size=0,e>32?(this.B=Dn,this.A=BigInt(e)):(this.B=On,this.A=e)}function On(e){let t=2**this.A-1;if("number"==typeof e)return e&t;let n=0,r=this.A+1;for(let i=0;i<e.length;i++)n=(n*r^e.charCodeAt(i))&t;return 32===this.A?n+2**31:n}function Dn(e){let t=BigInt(2)**this.A-BigInt(1);var n=typeof e;if("bigint"===n)return e&t;if("number"===n)return BigInt(e)&t;n=BigInt(0);let r=this.A+BigInt(1);for(let i=0;i<e.length;i++)n=(n*r^BigInt(e.charCodeAt(i)))&t;return n}let Mn,Rn,Bn,In,Kn;async function $n(e){var t=(e=e.data).task;const n=e.id;let r=e.args;if("init"===t)Rn=e.options||{},(t=e.factory)?(Function("return "+t)()(self),Mn=new self.FlexSearch.Index(Rn),delete self.FlexSearch):Mn=new Pr(Rn),postMessage({id:n});else{let i;"export"===t&&(r[1]?(r[0]=Rn.export,r[2]=0,r[3]=1):r=null),"import"===t?r[0]&&(e=await Rn.import.call(Mn,r[0]),Mn.import(r[0],e)):((i=r&&Mn[t].apply(Mn,r))&&i.then&&(i=await i),i&&i.await&&(i=await i.await),"search"===t&&i.result&&(i=i.result)),postMessage("search"===t?{id:n,msg:i}:{id:n})}}function qn(e){Ln.call(e,"add"),Ln.call(e,"append"),Ln.call(e,"search"),Ln.call(e,"update"),Ln.call(e,"remove"),Ln.call(e,"searchCache")}function Fn(){Bn=Kn=0}function Ln(e){this[e+"Async"]=function(){const t=arguments;var n=t[t.length-1];let r;if("function"==typeof n&&(r=n,delete t[t.length-1]),Bn?Kn||(Kn=Date.now()-In>=this.priority*this.priority*3):(Bn=setTimeout(Fn,0),In=Date.now()),Kn){const n=this;return new Promise(r=>{setTimeout(function(){r(n[e+"Async"].apply(n,t))},0)})}const i=this[e].apply(this,t);return n=i.then?i:new Promise(e=>e(i)),r&&n.then(r),n}}Pn.prototype.clear=function(){this.index.length=0},Pn.prototype.push=function(){},En.prototype.get=function(e){const t=this.index[this.B(e)];return t&&t.get(e)},En.prototype.set=function(e,t){var n=this.B(e);let r=this.index[n];r?(n=r.size,r.set(e,t),(n-=r.size)&&this.size++):(this.index[n]=r=new Map([[e,t]]),this.h.push(r),this.size++)},Tn.prototype.add=function(e){var t=this.B(e);let n=this.index[t];n?(t=n.size,n.add(e),(t-=n.size)&&this.size++):(this.index[t]=n=new Set([e]),this.h.push(n),this.size++)},(rn=En.prototype).has=Tn.prototype.has=function(e){const t=this.index[this.B(e)];return t&&t.has(e)},rn.delete=Tn.prototype.delete=function(e){const t=this.index[this.B(e)];t&&t.delete(e)&&this.size--},rn.clear=Tn.prototype.clear=function(){this.index=an(),this.h=[],this.size=0},rn.values=Tn.prototype.values=function*(){for(let e=0;e<this.h.length;e++)for(let t of this.h[e].values())yield t},rn.keys=Tn.prototype.keys=function*(){for(let e=0;e<this.h.length;e++)for(let t of this.h[e].keys())yield t},rn.entries=Tn.prototype.entries=function*(){for(let e=0;e<this.h.length;e++)for(let t of this.h[e].entries())yield t};let zn=0;function Nn(e={},t){function n(n){function s(e){const t=(e=e.data||e).id,n=t&&o.h[t];n&&(n(e.msg),delete o.h[t])}if(this.worker=n,this.h=an(),this.worker)return i?this.worker.on("message",s):this.worker.onmessage=s,e.config?new Promise(function(t){zn>1e9&&(zn=0),o.h[++zn]=function(){t(o)},o.worker.postMessage({id:zn,task:"init",factory:r,options:e})}):(this.priority=e.priority||4,this.encoder=t||null,this.worker.postMessage({task:"init",factory:r,options:e}),this)}if(!this||this.constructor!==Nn)return new Nn(e);let r="undefined"!=typeof self?self._factory:"undefined"!=typeof window?window._factory:null;r&&(r=r.toString());const i="undefined"==typeof window,o=this,s=function(e,t,n){return t?"undefined"!=typeof module?new(require("worker_threads").Worker)(__dirname+"/worker/node.js"):Promise.resolve().then(function(){return ii}).then(function(e){return new e.Worker(import.meta.dirname+"/node/node.mjs")}):e?new window.Worker(URL.createObjectURL(new Blob(["onmessage="+$n.toString()],{type:"text/javascript"}))):new window.Worker("string"==typeof n?n:import.meta.url.replace("/worker.js","/worker/worker.js").replace("flexsearch.bundle.module.min.js","module/worker/worker.js").replace("flexsearch.bundle.module.min.mjs","module/worker/worker.js"),{type:"module"})}(r,i,e.worker);return s.then?s.then(function(e){return n.call(o,e)}):n.call(this,s)}function Wn(e){Nn.prototype[e]=function(){const t=this,n=[].slice.call(arguments);var r=n[n.length-1];let i;return"function"==typeof r&&(i=r,n.pop()),r=new Promise(function(r){"export"===e&&"function"==typeof n[0]&&(n[0]=null),zn>1e9&&(zn=0),t.h[++zn]=r,t.worker.postMessage({task:e,id:zn,args:n})}),i?(r.then(i),this):r}}function Un(e,t,n,r,i,o){if(e=e[i],r===n.length-1)t[i]=o||e;else if(e)if(e.constructor===Array)for(t=t[i]=Array(e.length),i=0;i<e.length;i++)Un(e,t,n,r,i);else t=t[i]||(t[i]=an()),i=n[++r],Un(e,t,n,r,i)}function Qn(e,t,n,r,i,o,s,a){if(e=e[s])if(r===t.length-1){if(e.constructor===Array){if(n[r]){for(t=0;t<e.length;t++)i.add(o,e[t],!0,!0);return}e=e.join(" ")}i.add(o,e,a,!0)}else if(e.constructor===Array)for(s=0;s<e.length;s++)Qn(e,t,n,r,i,o,s,a);else s=t[++r],Qn(e,t,n,r,i,o,s,a)}function Hn(e,t,n,r){if(!e.length)return e;if(1===e.length)return e=e[0],e=n||e.length>t?e.slice(n,n+t):e,r?cr.call(this,e):e;let i=[];for(let o,s,a=0;a<e.length;a++)if((o=e[a])&&(s=o.length)){if(n){if(n>=s){n-=s;continue}o=o.slice(n,n+t),s=o.length,n=0}if(s>t&&(o=o.slice(0,t),s=t),!i.length&&s>=t)return r?cr.call(this,o):o;if(i.push(o),!(t-=s))break}return i=i.length>1?[].concat.apply([],i):i[0],r?cr.call(this,i):i}function Vn(e,t,n,r){var i=r[0];if(i[0]&&i[0].query)return e[t].apply(e,i);if(!("and"!==t&&"not"!==t||e.result.length||e.await||i.suggest))return r.length>1&&(i=r[r.length-1]),(r=i.resolve)?e.await||e.result:e;let o,s,a,c,l,u=[],h=0,f=0;for(t=0;t<r.length;t++)if(i=r[t]){var d=void 0;if(i.constructor===tr)d=i.await||i.result;else if(i.then||i.constructor===Array)d=i;else{h=i.limit||0,f=i.offset||0,a=i.suggest,s=i.resolve,o=((c=i.highlight||e.highlight)||i.enrich)&&s,d=i.queue;let n=i.async||d,r=i.index,p=i.query;if(r?e.index||(e.index=r):r=e.index,p||i.tag){const o=i.field||i.pluck;if(o&&(!p||e.query&&!c||(e.query=p,e.field=o,e.highlight=c),r=r.index.get(o)),d&&(l||e.await)){let o;l=1;const s=e.C.length,a=new Promise(function(e){o=e});(function(t,r){a.h=function(){r.index=null,r.resolve=!1;let i=n?t.searchAsync(r):t.search(r);return i.then?i.then(function(t){return e.C[s]=t=t.result||t,o(t),t}):(i=i.result||i,o(i),i)}})(r,Object.assign({},i)),e.C.push(a),u[t]=a;continue}i.resolve=!1,i.index=null,d=n?r.searchAsync(i):r.search(i),i.resolve=s,i.index=r}else if(i.and)d=Yn(i,"and",r);else if(i.or)d=Yn(i,"or",r);else if(i.not)d=Yn(i,"not",r);else{if(!i.xor)continue;d=Yn(i,"xor",r)}}d.await?(l=1,d=d.await):d.then?(l=1,d=d.then(function(e){return e.result||e})):d=d.result||d,u[t]=d}if(l&&!e.await&&(e.await=new Promise(function(t){e.return=t})),l){const t=Promise.all(u).then(function(r){for(let i=0;i<e.C.length;i++)if(e.C[i]===t){e.C[i]=function(){return n.call(e,r,h,f,o,s,a,c)};break}nr(e)});e.C.push(t)}else{if(!e.await)return n.call(e,u,h,f,o,s,a,c);e.C.push(function(){return n.call(e,u,h,f,o,s,a,c)})}return s?e.await||e.result:e}function Yn(e,t,n){const r=(e=e[t])[0]||e;return r.index||(r.index=n),n=new tr(r),e.length>1&&(n=n[t].apply(n,e.slice(1))),n}function Gn(e,t,n,r,i,o,s){return e.length&&(this.result.length&&e.push(this.result),e.length<2?this.result=e[0]:(this.result=ir(e,t,n,!1,this.h),n=0)),i&&(this.await=null),i?this.resolve(t,n,r,s):this}function Jn(e,t,n,r,i,o,s){if(!o&&!this.result.length)return i?this.result:this;let a;if(e.length)if(this.result.length&&e.unshift(this.result),e.length<2)this.result=e[0];else{let r=0;for(let t,n,i=0;i<e.length;i++)if((t=e[i])&&(n=t.length))r<n&&(r=n);else if(!o){r=0;break}r?(this.result=rr(e,r,t,n,o,this.h,i),a=!0):this.result=[]}else o||(this.result=e);return i&&(this.await=null),i?this.resolve(t,n,r,s,a):this}function Xn(e,t,n,r,i,o,s){if(e.length)if(this.result.length&&e.unshift(this.result),e.length<2)this.result=e[0];else{e:{o=n;var a=this.h;const r=[],s=an();let c=0;for(let t,n=0;n<e.length;n++)if(t=e[n]){c<t.length&&(c=t.length);for(let e,n=0;n<t.length;n++)if(e=t[n])for(let t,n=0;n<e.length;n++)t=e[n],s[t]=s[t]?2:1}for(let n,l=0,u=0;l<c;l++)for(let c,h=0;h<e.length;h++)if((c=e[h])&&(n=c[l]))for(let c,f=0;f<n.length;f++)if(c=n[f],1===s[c])if(o)o--;else if(i){if(r.push(c),r.length===t){e=r;break e}}else{const n=l+(h?a:0);if(r[n]||(r[n]=[]),r[n].push(c),++u===t){e=r;break e}}e=r}this.result=e,a=!0}else o||(this.result=e);return i&&(this.await=null),i?this.resolve(t,n,r,s,a):this}function Zn(e,t,n,r,i,o,s){if(!o&&!this.result.length)return i?this.result:this;if(e.length&&this.result.length){e:{o=n;var a=[];e=new Set(e.flat().flat());for(let n,r=0,s=0;r<this.result.length;r++)if(n=this.result[r])for(let c,l=0;l<n.length;l++)if(c=n[l],!e.has(c))if(o)o--;else if(i){if(a.push(c),a.length===t){e=a;break e}}else if(a[r]||(a[r]=[]),a[r].push(c),++s===t){e=a;break e}e=a}this.result=e,a=!0}return i&&(this.await=null),i?this.resolve(t,n,r,s,a):this}function er(e,t,n,r,i){let o,s,a;"string"==typeof i?(o=i,i=""):o=i.template,s=o.indexOf("$1"),a=o.substring(s+2),s=o.substring(0,s);let c=i&&i.boundary,l=!i||!1!==i.clip,u=i&&i.merge&&a&&s&&new RegExp(a+" "+s,"g");var h=0;if("object"==typeof(i=i&&i.ellipsis)){var f=i.template;h=f.length-2,i=i.pattern}let d,p;"string"!=typeof i&&(i=!1===i?"":"..."),h&&(i=f.replace("$1",i)),f=i.length-h,"object"==typeof c&&(d=c.before,0===d&&(d=-1),p=c.after,0===p&&(p=-1),c=c.total||9e5),h=new Map;for(let M,R,B,I=0;I<t.length;I++){let K;if(r)K=t,B=r;else{var g=t[I];if(B=g.field,!B)continue;K=g.result}R=n.get(B),M=R.encoder,"string"!=typeof(g=h.get(M))&&(g=M.encode(e),h.set(M,g));for(let e=0;e<K.length;e++){var m=K[e].doc;if(!m)continue;if(!(m=un(m,B)))continue;var y=m.trim().split(/\s+/);if(!y.length)continue;m="";var v=[];let t=[];for(var b=-1,w=-1,x=0,k=0;k<y.length;k++){var _=y[k],A=M.encode(_);let e;if((A=A.length>1?A.join(" "):A[0])&&_){for(var C=_.length,S=(M.split?_.replace(M.split,""):_).length-A.length,j="",P=0,E=0;E<g.length;E++){var T=g[E];if(T){var O=T.length;O+=S<0?0:S,P&&O<=P||(T=A.indexOf(T))>-1&&(j=(T?_.substring(0,T):"")+s+_.substring(T,T+O)+a+(T+O<C?_.substring(T+O):""),P=O,e=!0)}}j&&(c&&(b<0&&(b=m.length+(m?1:0)),w=m.length+(m?1:0)+j.length,x+=C,t.push(v.length),v.push({match:j})),m+=(m?" ":"")+j)}if(e){if(c&&x>=c)break}else m+=(m?" ":"")+(_=y[k]),c&&v.push({text:_})}if(x=t.length*(o.length-2),d||p||c&&m.length-x>c)if(k=w-b,d>0&&(k+=d),p>0&&(k+=p),k<=(x=c+x-2*f))y=d?b-(d>0?d:0):b-((x-k)/2|0),v=p?w+(p>0?p:0):y+x,l||(y>0&&" "!==m.charAt(y)&&" "!==m.charAt(y-1)&&((y=m.indexOf(" ",y))<0&&(y=0)),v<m.length&&" "!==m.charAt(v-1)&&" "!==m.charAt(v)&&((v=m.lastIndexOf(" ",v))<w?v=w:++v)),m=(y?i:"")+m.substring(y,v)+(v<m.length?i:"");else{for(w=[],b={},x={},k={},_={},A={},j=S=C=0,E=P=1;;){var D=void 0;for(let e,n=0;n<t.length;n++){if(e=t[n],j)if(S!==j){if(k[n+1])continue;if(e+=j,b[e]){C-=f,x[n+1]=1,k[n+1]=1;continue}if(e>=v.length-1){if(e>=v.length){k[n+1]=1,e>=y.length&&(x[n+1]=1);continue}C-=f}if(m=v[e].text,O=p&&A[n]){if(!(O>0)){k[n+1]=1;continue}if(m.length>O){if(k[n+1]=1,!l)continue;m=m.substring(0,O)}(O-=m.length)||(O=-1),A[n]=O}if(C+m.length+1<=c)m=" "+m,w[n]+=m;else{if(!l){k[n+1]=1;continue}(D=c-C-1)>0&&(m=" "+m.substring(0,D),w[n]+=m),k[n+1]=1}}else{if(k[n])continue;if(e-=S,b[e]){C-=f,k[n]=1,x[n]=1;continue}if(e<=0){if(e<0){k[n]=1,x[n]=1;continue}C-=f}if(m=v[e].text,O=d&&_[n]){if(!(O>0)){k[n]=1;continue}if(m.length>O){if(k[n]=1,!l)continue;m=m.substring(m.length-O)}(O-=m.length)||(O=-1),_[n]=O}if(C+m.length+1<=c)m+=" ",w[n]=m+w[n];else{if(!l){k[n]=1;continue}(D=m.length+1-(c-C))>=0&&D<m.length&&(m=m.substring(D)+" ",w[n]=m+w[n]),k[n]=1}}else{let t;if(m=v[e].match,d&&(_[n]=d),p&&(A[n]=p),n&&C++,e?!n&&f&&(C+=f):(x[n]=1,k[n]=1),e>=y.length-1||e<v.length-1&&v[e+1].match?t=1:f&&(C+=f),C-=o.length-2,n&&!(C+m.length<=c)){D=P=E=x[n]=0;break}w[n]=m,t&&(x[n+1]=1,k[n+1]=1)}C+=m.length,D=b[e]=1}if(D)S===j?j++:S++;else{if(S===j?P=0:E=0,!P&&!E)break;P?j=++S:j++}}m="";for(let e,t=0;t<w.length;t++)e=(x[t]?t?" ":"":(t&&!i?" ":"")+i)+w[t],m+=e;i&&!x[w.length]&&(m+=i)}u&&(m=m.replace(u," ")),K[e].highlight=m}if(r)break}return t}function tr(e,t){if(!this||this.constructor!==tr)return new tr(e,t);let n,r,i,o,s,a,c=0;if(e&&e.index){const n=e;if(t=n.index,c=n.boost||0,r=n.query){i=n.field||n.pluck,o=n.highlight;const r=n.resolve;e=n.async||n.queue,n.resolve=!1,n.index=null,e=e?t.searchAsync(n):t.search(n),n.resolve=r,n.index=t,e=e.result||e}else e=[]}if(e&&e.then){const t=this;n=[e=e.then(function(e){t.C[0]=t.result=e.result||e,nr(t)})],e=[],s=new Promise(function(e){a=e})}this.index=t||null,this.result=e||[],this.h=c,this.C=n||[],this.await=s||null,this.return=a||null,this.highlight=o||null,this.query=r||"",this.field=i||""}function nr(e,t){let n=e.result;var r=e.await;e.await=null;for(let t,i=0;i<e.C.length;i++)if(t=e.C[i])if("function"==typeof t)n=t(),e.C[i]=n=n.result||n,i--;else if(t.h)n=t.h(),e.C[i]=n=n.result||n,i--;else if(t.then)return e.await=r;return r=e.return,e.C=[],e.return=null,t||r(n),n}function rr(e,t,n,r,i,o,s){const a=e.length;let c,l,u=[];c=an();for(let h,f,d,p,g=0;g<t;g++)for(let t=0;t<a;t++)if(d=e[t],g<d.length&&(h=d[g]))for(let e=0;e<h.length;e++){if(f=h[e],(l=c[f])?c[f]++:(l=0,c[f]=1),p=u[l]||(u[l]=[]),!s){let e=g+(t||!i?0:o||0);p=p[e]||(p[e]=[])}if(p.push(f),s&&n&&l===a-1&&p.length-r===n)return r?p.slice(r):p}if(e=u.length)if(i)u=u.length>1?ir(u,n,r,s,o):(u=u[0])&&n&&u.length>n||r?u.slice(r,n+r):u;else{if(e<a)return[];if(u=u[e-1],n||r)if(s)(u.length>n||r)&&(u=u.slice(r,n+r));else{i=[];for(let e,t=0;t<u.length;t++)if(e=u[t])if(r&&e.length>r)r-=e.length;else if((n&&e.length>n||r)&&(e=e.slice(r,n+r),n-=e.length,r&&(r-=e.length)),i.push(e),!n)break;u=i}}return u}function ir(e,t,n,r,i){const o=[],s=an();let a;var c=e.length;let l;if(r){for(i=c-1;i>=0;i--)if(l=(r=e[i])&&r.length)for(c=0;c<l;c++)if(a=r[c],!s[a])if(s[a]=1,n)n--;else if(o.push(a),o.length===t)return o}else for(let u,h=c-1,f=0;h>=0;h--){u=e[h];for(let e=0;e<u.length;e++)if(l=(r=u[e])&&r.length)for(let u=0;u<l;u++)if(a=r[u],!s[a])if(s[a]=1,n)n--;else{let n=(e+(h<c-1&&i||0))/(h+1)|0;if((o[n]||(o[n]=[])).push(a),++f===t)return o}}return o}function or(e,t,n,r,i){const o=an(),s=[];for(let e,n=0;n<t.length;n++){e=t[n];for(let t=0;t<e.length;t++)o[e[t]]=1}if(i){for(let t,i=0;i<e.length;i++)if(t=e[i],o[t])if(r)r--;else if(s.push(t),o[t]=0,n&&0===--n)break}else for(let n,r,i=0;i<e.result.length;i++)for(n=e.result[i],t=0;t<n.length;t++)r=n[t],o[r]&&((s[i]||(s[i]=[])).push(r),o[r]=0);return s}function sr(e){const t=[],n=an(),r=an();for(let i,o,s,a,c,l,u,h=0;h<e.length;h++){i=e[h],o=i.field,s=i.result;for(let e=0;e<s.length;e++)c=s[e],"object"!=typeof c?c={id:a=c}:a=c.id,(l=n[a])?l.push(o):(c.field=n[a]=[o],t.push(c)),(u=c.highlight)&&(l=r[a],l||(r[a]=l={},c.highlight=l),l[o]=u)}return t}function ar(e,t,n,r,i){return(e=this.tag.get(e))&&(e=e.get(t))?((t=e.length-r)>0&&((n&&t>n||r)&&(e=e.slice(r,r+n)),i&&(e=cr.call(this,e))),e):[]}function cr(e){if(!this||!this.store)return e;if(this.db)return this.index.get(this.field[0]).db.enrich(e);const t=Array(e.length);for(let n,r=0;r<e.length;r++)n=e[r],t[r]={id:n,doc:this.store.get(n)};return t}function lr(e){if(!this||this.constructor!==lr)return new lr(e);const t=e.document||e.doc||e;let n,r;if(this.B=[],this.field=[],this.D=[],this.key=(n=t.key||t.id)&&hr(n,this.D)||"id",(r=e.keystore||0)&&(this.keystore=r),this.fastupdate=!!e.fastupdate,this.reg=!this.fastupdate||e.worker||e.db?r?new Tn(r):new Set:r?new En(r):new Map,this.h=(n=t.store||null)&&n&&!0!==n&&[],this.store=n?r?new En(r):new Map:null,this.cache=(n=e.cache||null)&&new bn(n),e.cache=!1,this.worker=e.worker||!1,this.priority=e.priority||4,this.index=ur.call(this,e,t),this.tag=null,(n=t.tag)&&("string"==typeof n&&(n=[n]),n.length)){this.tag=new Map,this.A=[],this.F=[];for(let e,t,r=0;r<n.length;r++){if(e=n[r],t=e.field||e,!t)throw Error("The tag field from the document descriptor is undefined.");e.custom?this.A[r]=e.custom:(this.A[r]=hr(t,this.D),e.filter&&("string"==typeof this.A[r]&&(this.A[r]=new String(this.A[r])),this.A[r].G=e.filter)),this.F[r]=t,this.tag.set(t,new Map)}}if(this.worker){this.fastupdate=!1,e=[];for(const t of this.index.values())t.then&&e.push(t);if(e.length){const t=this;return Promise.all(e).then(function(e){let n=0;for(const r of t.index.entries()){const i=r[0];let o=r[1];o.then&&(o=e[n],t.index.set(i,o),n++)}return t})}}else e.db&&(this.fastupdate=!1,this.mount(e.db))}function ur(e,t){const n=new Map;let r=t.index||t.field||t;cn(r)&&(r=[r]);for(let t,o,s=0;s<r.length;s++){if(t=r[s],cn(t)||(o=t,t=t.field),o=ln(o)?Object.assign({},e,o):e,this.worker){var i=void 0;i=new Nn(o,i=(i=o.encoder)&&i.encode?i:new mn("string"==typeof i?Sn[i]:i||{})),n.set(t,i)}this.worker||n.set(t,new Pr(o,this.reg)),o.custom?this.B[s]=o.custom:(this.B[s]=hr(t,this.D),o.filter&&("string"==typeof this.B[s]&&(this.B[s]=new String(this.B[s])),this.B[s].G=o.filter)),this.field[s]=t}if(this.h){cn(e=t.store)&&(e=[e]);for(let t,n,r=0;r<e.length;r++)t=e[r],n=t.field||t,t.custom?(this.h[r]=t.custom,t.custom.O=n):(this.h[r]=hr(n,this.D),t.filter&&("string"==typeof this.h[r]&&(this.h[r]=new String(this.h[r])),this.h[r].G=t.filter))}return n}function hr(e,t){const n=e.split(":");let r=0;for(let i=0;i<n.length;i++)"]"===(e=n[i])[e.length-1]&&(e=e.substring(0,e.length-2))&&(t[r]=!0),e&&(n[r++]=e);return r<n.length&&(n.length=r),r>1?n:n[0]}function fr(e,t=0){let n=[],r=[];t&&(t=25e4/t*5e3|0);for(const i of e.entries())r.push(i),r.length===t&&(n.push(r),r=[]);return r.length&&n.push(r),n}function dr(e,t){t||(t=new Map);for(let n,r=0;r<e.length;r++)n=e[r],t.set(n[0],n[1]);return t}function pr(e,t=0){let n=[],r=[];t&&(t=25e4/t*1e3|0);for(const i of e.entries())r.push([i[0],fr(i[1])[0]||[]]),r.length===t&&(n.push(r),r=[]);return r.length&&n.push(r),n}function gr(e,t){t||(t=new Map);for(let n,r,i=0;i<e.length;i++)n=e[i],r=t.get(n[0]),t.set(n[0],dr(n[1],r));return t}function mr(e){let t=[],n=[];for(const r of e.keys())n.push(r),25e4===n.length&&(t.push(n),n=[]);return n.length&&t.push(n),t}function yr(e,t){t||(t=new Set);for(let n=0;n<e.length;n++)t.add(e[n]);return t}function vr(e,t,n,r,i,o,s=0){const a=r&&r.constructor===Array;var c=a?r.shift():r;if(!c)return this.export(e,t,i,o+1);if((c=e((t?t+".":"")+(s+1)+"."+n,JSON.stringify(c)))&&c.then){const l=this;return c.then(function(){return vr.call(l,e,t,n,a?r:null,i,o,s+1)})}return vr.call(this,e,t,n,a?r:null,i,o,s+1)}function br(e,t){let n="";for(const r of e.entries()){e=r[0];const i=r[1];let o="";for(let e,n=0;n<i.length;n++){e=i[n]||[""];let r="";for(let n=0;n<e.length;n++)r+=(r?",":"")+("string"===t?'"'+e[n]+'"':e[n]);r="["+r+"]",o+=(o?",":"")+r}o='["'+e+'",['+o+"]]",n+=(n?",":"")+o}return n}function wr(e,t){let n=0;var r=void 0===t;if(e.constructor===Array){for(let i,o,s,a=0;a<e.length;a++)if((i=e[a])&&i.length){if(r)return 1;if(o=i.indexOf(t),o>=0){if(i.length>1)return i.splice(o,1),1;if(delete e[a],n)return 1;s=1}else{if(s)return 1;n++}}}else for(let i of e.entries())r=i[0],wr(i[1],t)?n++:e.delete(r);return n}Wn("add"),Wn("append"),Wn("search"),Wn("update"),Wn("remove"),Wn("clear"),Wn("export"),Wn("import"),Nn.prototype.searchCache=vn,qn(Nn.prototype),lr.prototype.add=function(e,t,n){if(ln(e)&&(e=un(t=e,this.key)),t&&(e||0===e)){if(!n&&this.reg.has(e))return this.update(e,t);for(let o,s=0;s<this.field.length;s++){o=this.B[s];var r=this.index.get(this.field[s]);if("function"==typeof o){var i=o(t);i&&r.add(e,i,n,!0)}else(!(i=o.G)||i(t))&&(o.constructor===String?o=[""+o]:cn(o)&&(o=[o]),Qn(t,o,this.D,0,r,e,o[0],n))}if(this.tag)for(r=0;r<this.A.length;r++){var o=this.A[r];i=this.tag.get(this.F[r]);let a=an();if("function"==typeof o){if(!(o=o(t)))continue}else{var s=o.G;if(s&&!s(t))continue;o.constructor===String&&(o=""+o),o=un(t,o)}if(i&&o){cn(o)&&(o=[o]);for(let t,r,c=0;c<o.length;c++)if(t=o[c],!a[t]&&(a[t]=1,(s=i.get(t))?r=s:i.set(t,r=[]),!n||!r.includes(e))){if(r.length===2**31-1){if(s=new Pn(r),this.fastupdate)for(let e of this.reg.values())e.includes(r)&&(e[e.indexOf(r)]=s);i.set(t,r=s)}r.push(e),this.fastupdate&&((s=this.reg.get(e))?s.push(r):this.reg.set(e,[r]))}}}if(this.store&&(!n||!this.store.has(e))){let r;if(this.h){r=an();for(let e,i=0;i<this.h.length;i++){if(e=this.h[i],(n=e.G)&&!n(t))continue;let o;if("function"==typeof e){if(o=e(t),!o)continue;e=[e.O]}else if(cn(e)||e.constructor===String){r[e]=t[e];continue}Un(t,r,e,0,e[0],o)}}this.store.set(e,r||t)}this.worker&&(this.fastupdate||this.reg.add(e))}return this},tr.prototype.or=function(){return Vn(this,"or",Gn,arguments)},tr.prototype.and=function(){return Vn(this,"and",Jn,arguments)},tr.prototype.xor=function(){return Vn(this,"xor",Xn,arguments)},tr.prototype.not=function(){return Vn(this,"not",Zn,arguments)},(rn=tr.prototype).limit=function(e){if(this.await){const t=this;this.C.push(function(){return t.limit(e).result})}else if(this.result.length){const t=[];for(let n,r=0;r<this.result.length;r++)if(n=this.result[r]){if(!(n.length<=e)){t[r]=n.slice(0,e);break}if(t[r]=n,!(e-=n.length))break}this.result=t}return this},rn.offset=function(e){if(this.await){const t=this;this.C.push(function(){return t.offset(e).result})}else if(this.result.length){const t=[];for(let n,r=0;r<this.result.length;r++)(n=this.result[r])&&(n.length<=e?e-=n.length:(t[r]=n.slice(e),e=0));this.result=t}return this},rn.boost=function(e){if(this.await){const t=this;this.C.push(function(){return t.boost(e).result})}else this.h+=e;return this},rn.resolve=function(e,t,n,r,i){let o=this.await?nr(this,!0):this.result;if(o.then){const s=this;return o.then(function(){return s.resolve(e,t,n,r,i)})}return o.length&&("object"==typeof e?(r=e.highlight||this.highlight,n=!!r||e.enrich,t=e.offset,e=e.limit):(r=r||this.highlight,n=!!r||n),o=i?n?cr.call(this.index,o):o:Hn.call(this.index,o,e||100,t,n)),this.finalize(o,r)},rn.finalize=function(e,t){if(e.then){const n=this;return e.then(function(e){return n.finalize(e,t)})}t&&e.length&&this.query&&(e=er(this.query,e,this.index.index,this.field,t));const n=this.return;return this.highlight=this.index=this.result=this.C=this.await=this.return=null,this.query=this.field="",n&&n(e),e},lr.prototype.search=function(e,t,n,r){n||(!t&&ln(e)?(n=e,e=""):ln(t)&&(n=t,t=0));let i=[];var o=[];let s,a,c,l,u,h,f,d,p=0,g=!0;if(n){n.constructor===Array&&(n={index:n}),e=n.query||e,s=n.pluck,a=n.merge,l=n.boost,h=s||n.field||(h=n.index)&&(h.index?null:h);var m=this.tag&&n.tag;c=n.suggest,g=!1!==n.resolve,u=n.cache,f=g&&this.store&&n.highlight;var y=!!f||g&&this.store&&n.enrich;t=n.limit||t;var v=n.offset||0;if(t||(t=g?100:0),m&&(!this.db||!r)){m.constructor!==Array&&(m=[m]);var b=[];for(let e,t=0;t<m.length;t++)if(e=m[t],e.field&&e.tag){var w=e.tag;if(w.constructor===Array)for(var x=0;x<w.length;x++)b.push(e.field,w[x]);else b.push(e.field,w)}else{w=Object.keys(e);for(let t,n,r=0;r<w.length;r++)if(t=w[r],n=e[t],n.constructor===Array)for(x=0;x<n.length;x++)b.push(t,n[x]);else b.push(t,n)}if(m=b,!e){if(o=[],b.length)for(m=0;m<b.length;m+=2){if(this.db){if(!(r=this.index.get(b[m])))continue;o.push(r=r.db.tag(b[m+1],t,v,y))}else r=ar.call(this,b[m],b[m+1],t,v,y);i.push(g?{field:b[m],tag:b[m+1],result:r}:[r])}if(o.length){const e=this;return Promise.all(o).then(function(t){for(let e=0;e<t.length;e++)g?i[e].result=t[e]:i[e]=t[e];return g?i:new tr(i.length>1?rr(i,1,0,0,c,l):i[0],e)})}return g?i:new tr(i.length>1?rr(i,1,0,0,c,l):i[0],this)}}g||s||!(h=h||this.field)||(cn(h)?s=h:(h.constructor===Array&&1===h.length&&(h=h[0]),s=h.field||h.index)),h&&h.constructor!==Array&&(h=[h])}h||(h=this.field),b=(this.worker||this.db)&&!r&&[];for(let s,a,l,_=0;_<h.length;_++){if(a=h[_],this.db&&this.tag&&!this.B[_])continue;let A;if(cn(a)||(A=a,a=A.field,e=A.query||e,t=sn(A.limit,t),v=sn(A.offset,v),c=sn(A.suggest,c),f=g&&this.store&&sn(A.highlight,f),y=!!f||g&&this.store&&sn(A.enrich,y),u=sn(A.cache,u)),r)s=r[_];else{x=(w=A||n||{}).enrich;var k=this.index.get(a);if(m&&(this.db&&(w.tag=m,w.field=h,d=k.db.support_tag_search),!d&&x&&(w.enrich=!1),d||(w.limit=0,w.offset=0)),s=u?k.searchCache(e,m&&!d?0:t,w):k.search(e,m&&!d?0:t,w),m&&!d&&(w.limit=t,w.offset=v),x&&(w.enrich=x),b){b[_]=s;continue}}if(l=(s=s.result||s)&&s.length,m&&l){if(w=[],x=0,this.db&&r){if(!d)for(k=h.length;k<r.length;k++){let e=r[k];if(e&&e.length)x++,w.push(e);else if(!c)return g?i:new tr(i,this)}}else for(let e,t,n=0;n<m.length;n+=2){if(e=this.tag.get(m[n]),!e){if(c)continue;return g?i:new tr(i,this)}if(t=(e=e&&e.get(m[n+1]))&&e.length)x++,w.push(e);else if(!c)return g?i:new tr(i,this)}if(x){if(s=or(s,w,t,v,g),l=s.length,!l&&!c)return g?s:new tr(s,this);x--}}if(l)o[p]=a,i.push(s),p++;else if(1===h.length)return g?i:new tr(i,this)}if(b){if(this.db&&m&&m.length&&!d)for(y=0;y<m.length;y+=2){if(!(o=this.index.get(m[y]))){if(c)continue;return g?i:new tr(i,this)}b.push(o.db.tag(m[y+1],t,v,!1))}const r=this;return Promise.all(b).then(function(i){return n&&(n.resolve=g),i.length&&(i=r.search(e,t,n,i)),i})}if(!p)return g?i:new tr(i,this);if(s&&(!y||!this.store))return i=i[0],g?i:new tr(i,this);for(b=[],v=0;v<o.length;v++){if(m=i[v],y&&m.length&&void 0===m[0].doc&&(this.db?b.push(m=this.index.get(this.field[0]).db.enrich(m)):m=cr.call(this,m)),s)return g?f?er(e,m,this.index,s,f):m:new tr(m,this);i[v]={field:o[v],result:m}}if(y&&this.db&&b.length){const t=this;return Promise.all(b).then(function(n){for(let e=0;e<n.length;e++)i[e].result=n[e];return f&&(i=er(e,i,t.index,s,f)),a?sr(i):i})}return f&&(i=er(e,i,this.index,s,f)),a?sr(i):i},(rn=lr.prototype).mount=function(e){let t=this.field;if(this.tag)for(let e,r=0;r<this.F.length;r++){e=this.F[r];var n=void 0;this.index.set(e,n=new Pr({},this.reg)),t===this.field&&(t=t.slice(0)),t.push(e),n.tag=this.tag.get(e)}n=[];const r={db:e.db,type:e.type,fastupdate:e.fastupdate};for(let i,o,s=0;s<t.length;s++){r.field=o=t[s],i=this.index.get(o);const a=new e.constructor(e.id,r);a.id=e.id,n[s]=a.mount(i),i.document=!0,s?i.bypass=!0:i.store=this.store}const i=this;return this.db=Promise.all(n).then(function(){i.db=!0})},rn.commit=async function(){const e=[];for(const t of this.index.values())e.push(t.commit());await Promise.all(e),this.reg.clear()},rn.destroy=function(){const e=[];for(const t of this.index.values())e.push(t.destroy());return Promise.all(e)},rn.append=function(e,t){return this.add(e,t,!0)},rn.update=function(e,t){return this.remove(e).add(e,t)},rn.remove=function(e){for(var t of(ln(e)&&(e=un(e,this.key)),this.index.values()))t.remove(e,!0);if(this.reg.has(e)){if(this.tag&&!this.fastupdate)for(let n of this.tag.values())for(let r of n){t=r[0];const i=r[1],o=i.indexOf(e);o>-1&&(i.length>1?i.splice(o,1):n.delete(t))}this.store&&this.store.delete(e),this.reg.delete(e)}return this.cache&&this.cache.remove(e),this},rn.clear=function(){const e=[];for(const t of this.index.values()){const n=t.clear();n.then&&e.push(n)}if(this.tag)for(const e of this.tag.values())e.clear();return this.store&&this.store.clear(),this.cache&&this.cache.clear(),e.length?Promise.all(e):this},rn.contain=function(e){return this.db?this.index.get(this.field[0]).db.has(e):this.reg.has(e)},rn.cleanup=function(){for(const e of this.index.values())e.cleanup();return this},rn.get=function(e){return this.db?this.index.get(this.field[0]).db.enrich(e).then(function(e){return e[0]&&e[0].doc||null}):this.store.get(e)||null},rn.set=function(e,t){return"object"==typeof e&&(e=un(t=e,this.key)),this.store.set(e,t),this},rn.searchCache=vn,rn.export=function(e,t,n=0,r=0){if(n<this.field.length){const i=this.field[n];if((t=this.index.get(i).export(e,i,n,r=1))&&t.then){const r=this;return t.then(function(){return r.export(e,i,n+1)})}return this.export(e,i,n+1)}let i,o;switch(r){case 0:i="reg",o=mr(this.reg),t=null;break;case 1:i="tag",o=this.tag&&pr(this.tag,this.reg.size),t=null;break;case 2:i="doc",o=this.store&&fr(this.store),t=null;break;default:return}return vr.call(this,e,t,i,o||null,n,r)},rn.import=function(e,t){var n=e.split(".");"json"===n[n.length-1]&&n.pop();const r=n.length>2?n[0]:"";if(n=n.length>2?n[2]:n[1],this.worker&&r)return this.index.get(r).import(e);if(t){if("string"==typeof t&&(t=JSON.parse(t)),r)return this.index.get(r).import(n,t);switch(n){case"reg":this.fastupdate=!1,this.reg=yr(t,this.reg);for(let e,t=0;t<this.field.length;t++)e=this.index.get(this.field[t]),e.fastupdate=!1,e.reg=this.reg;if(this.worker){t=[];for(const n of this.index.values())t.push(n.import(e));return Promise.all(t)}break;case"tag":this.tag=gr(t,this.tag);break;case"doc":this.store=dr(t,this.store)}}},qn(lr.prototype),Pr.prototype.remove=function(e,t){const n=this.reg.size&&(this.fastupdate?this.reg.get(e):this.reg.has(e));if(n){if(this.fastupdate){for(let t,r,i=0;i<n.length;i++)if((t=n[i])&&(r=t.length))if(t[r-1]===e)t.pop();else{const n=t.indexOf(e);n>=0&&t.splice(n,1)}}else wr(this.map,e),this.depth&&wr(this.ctx,e);t||this.reg.delete(e)}return this.db&&(this.commit_task.push({del:e}),this.M&&Er(this)),this.cache&&this.cache.remove(e),this};const xr={memory:{resolution:1},performance:{resolution:3,fastupdate:!0,context:{depth:1,resolution:1}},match:{tokenize:"forward"},score:{resolution:9,context:{depth:2,resolution:3}}};function kr(e,t,n,r,i,o,s){let a,c;if(!(a=t[n])||s&&!a[s]){if(s?((t=a||(t[n]=an()))[s]=1,c=e.ctx,(a=c.get(s))?c=a:c.set(s,c=e.keystore?new En(e.keystore):new Map)):(c=e.map,t[n]=1),(a=c.get(n))?c=a:c.set(n,c=a=[]),o)for(let n,o=0;o<a.length;o++)if((n=a[o])&&n.includes(i)){if(o<=r)return;n.splice(n.indexOf(i),1),e.fastupdate&&(t=e.reg.get(i))&&t.splice(t.indexOf(n),1);break}if(c=c[r]||(c[r]=[]),c.push(i),c.length===2**31-1){if(t=new Pn(c),e.fastupdate)for(let n of e.reg.values())n.includes(c)&&(n[n.indexOf(c)]=t);a[r]=c=t}e.fastupdate&&((r=e.reg.get(i))?r.push(c):e.reg.set(i,[c]))}}function _r(e,t,n,r,i){return n&&e>1?t+(r||0)<=e?n+(i||0):(e-1)/(t+(r||0))*(n+(i||0))+1|0:0}function Ar(e,t,n,r,i,o,s){let a=e.length,c=e;if(a>1)c=rr(e,t,n,r,i,o,s);else if(1===a)return s?Hn.call(null,e[0],n,r):new tr(e[0],this);return s?c:new tr(c,this)}function Cr(e,t,n,r,i,o,s){return e=jr(this,e,t,n,r,i,o,s),this.db?e.then(function(e){return i?e||[]:new tr(e,this)}):e&&e.length?i?Hn.call(this,e,n,r):new tr(e,this):i?[]:new tr([],this)}function Sr(e,t,n,r){let i=[];if(e&&e.length){if(e.length<=r)return void t.push(e);for(let t,n=0;n<r;n++)(t=e[n])&&(i[n]=t);if(i.length)return void t.push(i)}if(!n)return i}function jr(e,t,n,r,i,o,s,a){let c;return n&&(c=e.bidirectional&&t>n)&&(c=n,n=t,t=c),e.db?e.db.get(t,n,r,i,o,s,a):e=n?(e=e.ctx.get(n))&&e.get(t):e.map.get(t)}function Pr(e,t){if(!this||this.constructor!==Pr)return new Pr(e);if(e){var n=cn(e)?e:e.preset;n&&(e=Object.assign({},xr[n],e))}else e={};const r=!0===(n=e.context)?{depth:1}:n||{},i=cn(e.encoder)?Sn[e.encoder]:e.encode||e.encoder||{};this.encoder=i.encode?i:"object"==typeof i?new mn(i):{encode:i},this.resolution=e.resolution||9,this.tokenize=n=(n=e.tokenize)&&"default"!==n&&"exact"!==n&&n||"strict",this.depth="strict"===n&&r.depth||0,this.bidirectional=!1!==r.bidirectional,this.fastupdate=!!e.fastupdate,this.score=e.score||null,(n=e.keystore||0)&&(this.keystore=n),this.map=n?new En(n):new Map,this.ctx=n?new En(n):new Map,this.reg=t||(this.fastupdate?n?new En(n):new Map:n?new Tn(n):new Set),this.N=r.resolution||3,this.rtl=i.rtl||e.rtl||!1,this.cache=(n=e.cache||null)&&new bn(n),this.resolve=!1!==e.resolve,(n=e.db)&&(this.db=this.mount(n)),this.M=!1!==e.commit,this.commit_task=[],this.commit_timer=null,this.priority=e.priority||4}function Er(e){e.commit_timer||(e.commit_timer=setTimeout(function(){e.commit_timer=null,e.db.commit(e)},1))}Pr.prototype.add=function(e,t,n,r){if(t&&(e||0===e)){if(!r&&!n&&this.reg.has(e))return this.update(e,t);r=this.depth;const l=(t=this.encoder.encode(t,!r)).length;if(l){const u=an(),h=an(),f=this.resolution;for(let d=0;d<l;d++){let p=t[this.rtl?l-1-d:d];var i=p.length;if(i&&(r||!h[p])){var o=this.score?this.score(t,p,d,null,0):_r(f,l,d),s="";switch(this.tokenize){case"tolerant":if(kr(this,h,p,o,e,n),i>2){for(let t,r,a,c,l=1;l<i-1;l++)t=p.charAt(l),r=p.charAt(l+1),a=p.substring(0,l)+r,c=p.substring(l+2),kr(this,h,s=a+t+c,o,e,n),kr(this,h,s=a+c,o,e,n);kr(this,h,p.substring(0,p.length-1),o,e,n)}break;case"full":if(i>2){for(let r,c=0;c<i;c++)for(o=i;o>c;o--){s=p.substring(c,o),r=this.rtl?i-1-c:c;var a=this.score?this.score(t,p,d,s,r):_r(f,l,d,i,r);kr(this,h,s,a,e,n)}break}case"bidirectional":case"reverse":if(i>1){for(a=i-1;a>0;a--){s=p[this.rtl?i-1-a:a]+s;var c=this.score?this.score(t,p,d,s,a):_r(f,l,d,i,a);kr(this,h,s,c,e,n)}s=""}case"forward":if(i>1){for(a=0;a<i;a++)kr(this,h,s+=p[this.rtl?i-1-a:a],o,e,n);break}default:if(kr(this,h,p,o,e,n),r&&l>1&&d<l-1)for(i=this.N,s=p,o=Math.min(r+1,this.rtl?d+1:l-d),a=1;a<o;a++){p=t[this.rtl?l-1-d-a:d+a];kr(this,u,(c=this.bidirectional&&p>s)?s:p,this.score?this.score(t,s,d,p,a-1):_r(i+(l/2>i?0:1),l,d,o-1,a-1),e,n,c?p:s)}}}}this.fastupdate||this.reg.add(e)}}return this.db&&(this.commit_task.push(n?{ins:e}:{del:e}),this.M&&Er(this)),this},Pr.prototype.search=function(e,t,n){if(n||(t||"object"!=typeof e?"object"==typeof t&&(n=t,t=0):(n=e,e="")),n&&n.cache)return n.cache=!1,e=this.searchCache(e,t,n),n.cache=!0,e;let r,i,o,s,a,c,l,u,h=[],f=0;n&&(e=n.query||e,t=n.limit||t,f=n.offset||0,i=n.context,o=n.suggest,u=(s=n.resolve)&&n.enrich,c=n.boost,l=n.resolution,a=this.db&&n.tag),void 0===s&&(s=this.resolve),i=this.depth&&!1!==i;let d=this.encoder.encode(e,!i);if(r=d.length,t=t||(s?100:0),1===r)return Cr.call(this,d[0],"",t,f,s,u,a);if(2===r&&i&&!o)return Cr.call(this,d[1],d[0],t,f,s,u,a);let p,g=an(),m=0;if(i&&(p=d[0],m=1),l||0===l||(l=p?this.N:this.resolution),this.db){if(this.db.search&&!1!==(n=this.db.search(this,d,t,f,o,s,u,a)))return n;const e=this;return async function(){for(let t,n;m<r;m++){if((n=d[m])&&!g[n]){if(g[n]=1,t=await jr(e,n,p,0,0,!1,!1),t=Sr(t,h,o,l)){h=t;break}p&&(o&&t&&h.length||(p=n))}o&&p&&m===r-1&&!h.length&&(l=e.resolution,p="",m=-1,g=an())}return Ar(h,l,t,f,o,c,s)}()}for(let e,t;m<r;m++){if((t=d[m])&&!g[t]){if(g[t]=1,e=jr(this,t,p,0,0,!1,!1),e=Sr(e,h,o,l)){h=e;break}p&&(o&&e&&h.length||(p=t))}o&&p&&m===r-1&&!h.length&&(l=this.resolution,p="",m=-1,g=an())}return Ar(h,l,t,f,o,c,s)},(rn=Pr.prototype).mount=function(e){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),e.mount(this)},rn.commit=function(){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),this.db.commit(this)},rn.destroy=function(){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),this.db.destroy()},rn.clear=function(){return this.map.clear(),this.ctx.clear(),this.reg.clear(),this.cache&&this.cache.clear(),this.db?(this.commit_timer&&clearTimeout(this.commit_timer),this.commit_timer=null,this.commit_task=[],this.db.clear()):this},rn.append=function(e,t){return this.add(e,t,!0)},rn.contain=function(e){return this.db?this.db.has(e):this.reg.has(e)},rn.update=function(e,t){const n=this,r=this.remove(e);return r&&r.then?r.then(()=>n.add(e,t)):this.add(e,t)},rn.cleanup=function(){return this.fastupdate?(wr(this.map),this.depth&&wr(this.ctx),this):this},rn.searchCache=vn,rn.export=function(e,t,n=0,r=0){let i,o;switch(r){case 0:i="reg",o=mr(this.reg);break;case 1:i="cfg",o=null;break;case 2:i="map",o=fr(this.map,this.reg.size);break;case 3:i="ctx",o=pr(this.ctx,this.reg.size);break;default:return}return vr.call(this,e,t,i,o,n,r)},rn.import=function(e,t){if(t)switch("string"==typeof t&&(t=JSON.parse(t)),e=e.split("."),"json"===e[e.length-1]&&e.pop(),3===e.length&&e.shift(),e=e.length>1?e[1]:e[0],e){case"reg":this.fastupdate=!1,this.reg=yr(t,this.reg);break;case"map":this.map=dr(t,this.map);break;case"ctx":this.ctx=gr(t,this.ctx)}},rn.serialize=function(e=!0){let t="",n="",r="";if(this.reg.size){let e;for(var i of this.reg.keys())e||(e=typeof i),t+=(t?",":"")+("string"===e?'"'+i+'"':i);t="index.reg=new Set(["+t+"]);",n=br(this.map,e),n="index.map=new Map(["+n+"]);";for(const t of this.ctx.entries()){i=t[0];let n=br(t[1],e);n="new Map(["+n+"])",n='["'+i+'",'+n+"]",r+=(r?",":"")+n}r="index.ctx=new Map(["+r+"]);"}return e?"function inject(index){"+t+n+r+"}":t+n+r},qn(Pr.prototype);const Tr="undefined"!=typeof window&&(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB),Or=["map","ctx","tag","reg","cfg"],Dr=an();function Mr(e,t,n){const r=e.value;let i,o=0;for(let e,s=0;s<r.length;s++){if(e=n?r:r[s]){for(let n,o,a=0;a<t.length;a++)if(o=t[a],n=e.indexOf(o),n>=0){if(i=1,!(e.length>1)){r[s]=[];break}e.splice(n,1)}o+=e.length}if(n)break}o?i&&e.update(r):e.delete(),e.continue()}function Rr(e,t){return new Promise((n,r)=>{e.onsuccess=e.oncomplete=function(){t&&t(this.result),t=null,n(this.result)},e.onerror=e.onblocked=r,e=null})}rn=function e(t,n={}){if(!this||this.constructor!==e)return new e(t,n);"object"==typeof t&&(n=t,t=t.name),t||console.info("Default storage space was used, because a name was not passed."),this.id="flexsearch"+(t?":"+t.toLowerCase().replace(/[^a-z0-9_\-]/g,""):""),this.field=n.field?n.field.toLowerCase().replace(/[^a-z0-9_\-]/g,""):"",this.type=n.type,this.fastupdate=this.support_tag_search=!1,this.db=null,this.h={}}.prototype,rn.mount=function(e){return e.index?e.mount(this):(e.db=this,this.open())},rn.open=function(){if(this.db)return this.db;let e=this;navigator.storage&&navigator.storage.persist&&navigator.storage.persist(),Dr[e.id]||(Dr[e.id]=[]),Dr[e.id].push(e.field);const t=Tr.open(e.id,1);return t.onupgradeneeded=function(){const t=e.db=this.result;for(let n,r=0;r<Or.length;r++){n=Or[r];for(let r,i=0;i<Dr[e.id].length;i++)r=Dr[e.id][i],t.objectStoreNames.contains(n+("reg"!==n&&r?":"+r:""))||t.createObjectStore(n+("reg"!==n&&r?":"+r:""))}},e.db=Rr(t,function(t){e.db=t,e.db.onversionchange=function(){e.close()}})},rn.close=function(){this.db&&this.db.close(),this.db=null},rn.destroy=function(){return Rr(Tr.deleteDatabase(this.id))},rn.clear=function(){const e=[];for(let t,n=0;n<Or.length;n++){t=Or[n];for(let n,r=0;r<Dr[this.id].length;r++)n=Dr[this.id][r],e.push(t+("reg"!==t&&n?":"+n:""))}const t=this.db.transaction(e,"readwrite");for(let n=0;n<e.length;n++)t.objectStore(e[n]).clear();return Rr(t)},rn.get=function(e,t,n=0,r=0,i=!0,o=!1){e=this.db.transaction((t?"ctx":"map")+(this.field?":"+this.field:""),"readonly").objectStore((t?"ctx":"map")+(this.field?":"+this.field:"")).get(t?t+":"+e:e);const s=this;return Rr(e).then(function(e){let t=[];if(!e||!e.length)return t;if(i){if(!n&&!r&&1===e.length)return e[0];for(let i,o=0;o<e.length;o++)if((i=e[o])&&i.length){if(r>=i.length){r-=i.length;continue}const e=n?r+Math.min(i.length-r,n):i.length;for(let n=r;n<e;n++)t.push(i[n]);if(r=0,t.length===n)break}return o?s.enrich(t):t}return e})},rn.tag=function(e,t=0,n=0,r=!1){e=this.db.transaction("tag"+(this.field?":"+this.field:""),"readonly").objectStore("tag"+(this.field?":"+this.field:"")).get(e);const i=this;return Rr(e).then(function(e){return!e||!e.length||n>=e.length?[]:t||n?(e=e.slice(n,n+t),r?i.enrich(e):e):e})},rn.enrich=function(e){"object"!=typeof e&&(e=[e]);const t=this.db.transaction("reg","readonly").objectStore("reg"),n=[];for(let r=0;r<e.length;r++)n[r]=Rr(t.get(e[r]));return Promise.all(n).then(function(t){for(let n=0;n<t.length;n++)t[n]={id:e[n],doc:t[n]?JSON.parse(t[n]):null};return t})},rn.has=function(e){return Rr(e=this.db.transaction("reg","readonly").objectStore("reg").getKey(e)).then(function(e){return!!e})},rn.search=null,rn.info=function(){},rn.transaction=function(e,t,n){e+="reg"!==e&&this.field?":"+this.field:"";let r=this.h[e+":"+t];if(r)return n.call(this,r);let i=this.db.transaction(e,t);this.h[e+":"+t]=r=i.objectStore(e);const o=n.call(this,r);return this.h[e+":"+t]=null,Rr(i).finally(function(){return o})},rn.commit=async function(e){let t=e.commit_task,n=[];e.commit_task=[];for(let e,r=0;r<t.length;r++)e=t[r],e.del&&n.push(e.del);n.length&&await this.remove(n),e.reg.size&&(await this.transaction("map","readwrite",function(t){for(const n of e.map){const e=n[0],r=n[1];r.length&&(t.get(e).onsuccess=function(){let n=this.result;var i;if(n&&n.length){const e=Math.max(n.length,r.length);for(let t,o,s=0;s<e;s++)if((o=r[s])&&o.length){if((t=n[s])&&t.length)for(i=0;i<o.length;i++)t.push(o[i]);else n[s]=o;i=1}}else n=r,i=1;i&&t.put(n,e)})}}),await this.transaction("ctx","readwrite",function(t){for(const n of e.ctx){const e=n[0],r=n[1];for(const n of r){const r=n[0],i=n[1];i.length&&(t.get(e+":"+r).onsuccess=function(){let n=this.result;var o;if(n&&n.length){const e=Math.max(n.length,i.length);for(let t,r,s=0;s<e;s++)if((r=i[s])&&r.length){if((t=n[s])&&t.length)for(o=0;o<r.length;o++)t.push(r[o]);else n[s]=r;o=1}}else n=i,o=1;o&&t.put(n,e+":"+r)})}}}),e.store?await this.transaction("reg","readwrite",function(t){for(const n of e.store){const e=n[0],r=n[1];t.put("object"==typeof r?JSON.stringify(r):1,e)}}):e.bypass||await this.transaction("reg","readwrite",function(t){for(const n of e.reg.keys())t.put(1,n)}),e.tag&&await this.transaction("tag","readwrite",function(t){for(const n of e.tag){const e=n[0],r=n[1];r.length&&(t.get(e).onsuccess=function(){let n=this.result;n=n&&n.length?n.concat(r):r,t.put(n,e)})}}),e.map.clear(),e.ctx.clear(),e.tag&&e.tag.clear(),e.store&&e.store.clear(),e.document||e.reg.clear())},rn.remove=function(e){return"object"!=typeof e&&(e=[e]),Promise.all([this.transaction("map","readwrite",function(t){t.openCursor().onsuccess=function(){const t=this.result;t&&Mr(t,e)}}),this.transaction("ctx","readwrite",function(t){t.openCursor().onsuccess=function(){const t=this.result;t&&Mr(t,e)}}),this.transaction("tag","readwrite",function(t){t.openCursor().onsuccess=function(){const t=this.result;t&&Mr(t,e,!0)}}),this.transaction("reg","readwrite",function(t){for(let n=0;n<e.length;n++)t.delete(e[n])})])};const Br=lr;let Ir=null,Kr=!1;async function $r(){return await me()}function qr(e,t){const{positive:n,negative:r,phrases:i,regular:o,regexPatterns:s=[]}=t,a=[e.title||"",e.url||"",e.description||"",e.domain||"",e.category||"",Array.isArray(e.keywords)?e.keywords.join(" "):""].join(" ").toLowerCase(),c=[e.title||"",e.url||"",e.description||"",e.domain||"",e.category||"",Array.isArray(e.keywords)?e.keywords.join(" "):""].join(" ");for(const e of n)if(!a.includes(e))return!1;for(const e of r)if(a.includes(e))return!1;for(const e of i)if(!a.includes(e))return!1;for(const e of s){const t=e.flags.includes("i")?a:c;if(!e.test(t))return!1}if(o.length>0){if(!o.some(e=>a.includes(e)))return!1}return!0}function Fr(e,t){const{positive:n,phrases:r,regular:i,regexPatterns:o=[]}=t;let s=0;const a=(e.title||"").toLowerCase(),c=(e.url||"").toLowerCase(),l=(e.domain||"").toLowerCase(),u=(e.description||"").toLowerCase(),h=(e.category||"").toLowerCase(),f=[...n,...r,...i];for(const e of f)a.includes(e)&&(s+=10,a.startsWith(e)&&(s+=5)),l.includes(e)&&(s+=5),h.includes(e)&&(s+=4),u.includes(e)&&(s+=2),c.includes(e)&&(s+=1);for(const t of o)t.test(e.title||"")&&(s+=8),t.test(e.url||"")&&(s+=3),t.test(e.description||"")&&(s+=2);return s}async function Lr(){if(Kr)return Ir;console.log("Initializing FlexSearch index...");const e=await async function(e){try{const t=await ge.cache.get(e);return t?t.ttl&&Date.now()-t.timestamp>t.ttl?(await ge.cache.delete(e),null):t.value:null}catch(e){return console.error("Error getting cache:",e),null}}("flexsearch_index");if(e&&e.serialized)try{Ir=new Br({document:{id:"id",index:["title","url","description","keywords","category","domain"],store:!0},tokenize:"forward",cache:!0,optimize:!0,resolution:9,context:{depth:3,bidirectional:!0}});const t=Object.keys(e.serialized);for(const n of t)await Ir.import(n,e.serialized[n]);return Kr=!0,console.log("Loaded FlexSearch index from cache"),Ir}catch(e){console.error("Error loading cached index:",e)}return await async function(){console.log("Building FlexSearch index..."),Ir=new Br({document:{id:"id",index:["title","url","description","keywords","category","domain"],store:!0},tokenize:"forward",cache:!0,optimize:!0,resolution:9,context:{depth:3,bidirectional:!0}});const e=await $r();for(const t of e)await zr(t,!1);Kr=!0;try{const t={};await Ir.export((e,n)=>{t[e]=n}),await ye("flexsearch_index",{serialized:t,timestamp:Date.now()}),console.log(`Indexed ${e.length} bookmarks`)}catch(e){console.error("Error caching index:",e)}return Ir}(),Ir}async function zr(e,t=!0){Ir||await Lr();const n={id:e.id,title:e.title||"",url:e.url||"",description:e.description||"",keywords:Array.isArray(e.keywords)?e.keywords.join(" "):"",category:e.category||"",domain:e.domain||""};await Ir.add(n),t&&await async function(){if(!Ir)return;try{const e={};await Ir.export((t,n)=>{e[t]=n}),await ye("flexsearch_index",{serialized:e,timestamp:Date.now()})}catch(e){console.error("Error caching index:",e)}}()}async function Nr(e,t=null,n={}){!t||t.domains||Array.isArray(t.domains)||(n=t,t=null);const{limit:r=50,offset:i=0,computeStats:o=!1}=n;let s=await $r();if(t){const e=Date.now()-2592e6;s=s.filter(n=>{if(t.domains&&t.domains.length>0){const e=(n.domain||"").toLowerCase();if(!t.domains.some(t=>e.includes(t.toLowerCase())))return!1}if(t.folders&&t.folders.length>0){const e=(n.folderPath||"").toLowerCase();if(!t.folders.some(t=>e.includes(t.toLowerCase())))return!1}if(t.topics&&t.topics.length>0){const e=n.topics||[];if(!t.topics.some(t=>e.some(e=>e.toLowerCase()===t.toLowerCase()||e.toLowerCase().startsWith(t.toLowerCase()+"/"))))return!1}if(t.types&&t.types.length>0){const e=(n.contentType||"").toLowerCase();if(!t.types.some(t=>e===t.toLowerCase()))return!1}if(t.creators&&t.creators.length>0){const e=`${n.platform||"other"}:${n.creator}`;if(!t.creators.some(t=>t.key===e))return!1}if(t.tags&&t.tags.length>0){if(!n.tags||!Array.isArray(n.tags))return!1;if(!t.tags.some(e=>n.tags.includes(e)))return!1}if(t.deadLinks&&!1!==n.isAlive)return!1;if(t.stale){const t=n.dateAdded<e,r=!n.accessCount||0===n.accessCount,i=!1!==n.isAlive;if(!(t&&r&&i))return!1}if(t.dateRange){const{startDate:e,endDate:r}=t.dateRange;if(n.dateAdded<e||n.dateAdded>r)return!1}if(t.readingTimeRange){const{min:e,max:r}=t.readingTimeRange,i=n.readingTime||0;if(null!=e&&i<e)return!1;if(null!=r&&i>r)return!1}if(t.qualityScoreRange){const{min:e,max:r}=t.qualityScoreRange,i=n.qualityScore||0;if(null!=e&&i<e)return!1;if(null!=r&&i>r)return!1}if(null!==t.hasPublishedDate&&void 0!==t.hasPublishedDate){const e=Boolean(n.publishedDate||n.rawMetadata?.publishedDate);if(t.hasPublishedDate!==e)return!1}return!0})}if(!e||!e.trim()){const e=re(n.sortBy||"date_desc"),t={results:s.sort(e).slice(i,i+r),total:s.length,hasMore:i+r<s.length,parsedQuery:null};return o&&(t.stats=Wr(s)),t}const{filters:a,remainingQuery:c}=function(e){if(!e||!e.trim())return{filters:{},remainingQuery:""};const t={};let n=e;const r=n.match(/category:(\S+)/i);r&&(t.category=r[1].toLowerCase(),n=n.replace(r[0],"").trim());const i=n.match(/domain:(\S+)/i);i&&(t.domain=i[1].toLowerCase(),n=n.replace(i[0],"").trim());const o=n.match(/platform:(\S+)/i);o&&(t.platform=o[1].toLowerCase(),n=n.replace(o[0],"").trim());const s=n.match(/channel:(@?\S+)/i);s&&(t.creator=s[1],n=n.replace(s[0],"").trim());const a=n.match(/author:(@?\S+)/i);a&&(t.creator=a[1],n=n.replace(a[0],"").trim());const c=n.match(/repo:(\S+)/i);c&&(t.repo=c[1].toLowerCase(),n=n.replace(c[0],"").trim());const l=n.match(/type:(\S+)/i);l&&(t.contentType=l[1].toLowerCase(),n=n.replace(l[0],"").trim());const u=n.match(/hasimage:(yes|no)/i);u&&(t.hasImage="yes"===u[1].toLowerCase(),n=n.replace(u[0],"").trim());const h=n.match(/playlist:(\S+)/i);h&&(t.playlist=h[1],n=n.replace(h[0],"").trim());const f=n.match(/accessed:(yes|no)/i);f&&(t.accessed="yes"===f[1].toLowerCase(),n=n.replace(f[0],"").trim());const d=n.match(/stale:(yes|no)/i);d&&(t.stale="yes"===d[1].toLowerCase(),n=n.replace(d[0],"").trim());const p=n.match(/enriched:(yes|no)/i);p&&(t.enriched="yes"===p[1].toLowerCase(),n=n.replace(p[0],"").trim());const g=n.match(/dead:(yes|no)/i);g&&(t.dead="yes"===g[1].toLowerCase(),n=n.replace(g[0],"").trim());const m=n.match(/folder:(?:"([^"]+)"|(\S+))/i);return m&&(t.folder=(m[1]||m[2]).toLowerCase(),n=n.replace(m[0],"").trim()),{filters:t,remainingQuery:n}}(e),l=function(e){if(!e||!e.trim())return{positive:[],negative:[],phrases:[],regular:[],regexPatterns:[],hasModifiers:!1};const t=[],n=[],r=[],i=[],o=[],s=/\/([^\/]+)\/([gimsuvy]*)?/g;let a,c=e;for(;null!==(a=s.exec(e));)try{const e=a[1],t=a[2]||"i",n=new RegExp(e,t);o.push(n)}catch(e){console.warn("Invalid regex pattern:",a[0],e.message)}c=c.replace(/\/[^\/]+\/[gimsuvy]*/g,"").trim();const l=/([+-]?)"([^"]+)"/g;for(;null!==(a=l.exec(c));){const e=a[1],i=a[2].toLowerCase();"+"===e?t.push(i):"-"===e?n.push(i):r.push(i)}c=c.replace(/[+-]?"[^"]+"/g,"").trim();const u=c.split(/\s+/).filter(e=>e.length>0);for(const e of u){const r=e.toLowerCase();e.startsWith("+")&&e.length>1?t.push(r.slice(1)):e.startsWith("-")&&e.length>1?n.push(r.slice(1)):i.push(r)}return{positive:t,negative:n,phrases:r,regular:i,regexPatterns:o,hasModifiers:t.length>0||n.length>0||r.length>0||o.length>0}}(c);if(Object.keys(a).length>0&&(s=function(e,t){const n=Date.now()-2592e6;return e.filter(e=>{if(t.category&&(e.category||"uncategorized").toLowerCase()!==t.category)return!1;if(t.domain&&!(e.domain||"").toLowerCase().includes(t.domain))return!1;if(void 0!==t.accessed){const n=e.accessCount&&e.accessCount>0;if(t.accessed!==n)return!1}if(t.stale){const t=e.dateAdded<n,r=!e.accessCount||0===e.accessCount,i=!1!==e.isAlive;if(!(t&&r&&i))return!1}if(void 0!==t.enriched){const n=Boolean(e.description||e.keywords&&e.keywords.length>0||e.contentSnippet);if(t.enriched!==n)return!1}if(void 0!==t.dead){const n=!1===e.isAlive;if(t.dead!==n)return!1}if(t.folder&&!(e.folderPath||"").toLowerCase().includes(t.folder))return!1;if(t.platform&&(e.platform||"other").toLowerCase()!==t.platform)return!1;if(t.creator){const n=(e.creator||"").toLowerCase(),r=t.creator.toLowerCase();if(!n.includes(r)&&!n.includes(r.replace(/^@/,""))&&!`@${n}`.includes(r))return!1}if(t.repo&&!(e.platformData?.extra?.owner&&e.platformData?.extra?.repo?`${e.platformData.extra.owner}/${e.platformData.extra.repo}`.toLowerCase():"").includes(t.repo))return!1;if(t.contentType){const n=(e.contentType||"").toLowerCase();if(!t.contentType.split("|").map(e=>e.trim()).includes(n))return!1}if(void 0!==t.hasImage){const n=Boolean(e.platformData?.extra?.thumbnail||e.rawMetadata?.openGraph?.["og:image"]||e.rawMetadata?.twitterCard?.["twitter:image"]);if(t.hasImage!==n)return!1}return!(t.playlist&&!(e.platformData?.extra?.playlistId||"").includes(t.playlist))})}(s,a)),c.trim()){if(l.regular.length>0)try{const e=await Lr(),t=l.regular.join(" "),n=await e.search(t,{limit:1e4,suggest:!0}),r=new Set;Array.isArray(n)&&n.forEach(e=>{e&&Array.isArray(e.result)&&e.result.forEach(e=>r.add(e))}),s=s.filter(e=>r.has(e.id)),s=s.filter(e=>qr(e,l))}catch(e){console.error("FlexSearch failed, falling back to manual search:",e),s=s.filter(e=>qr(e,l))}else s=s.filter(e=>qr(e,l));s=s.map(e=>({...e,_searchScore:Fr(e,l)}));const e=re(n.sortBy||"relevance");s.sort(e)}else{const e=re(n.sortBy||"date_desc");s.sort(e)}const u=s.length,h={results:s.slice(i,i+r),total:u,hasMore:i+r<u,parsedQuery:l,specialFilters:a};return o&&(h.stats=Wr(s)),h}function Wr(e){const t=new Map,n=new Map,r=new Map,i=new Map,o=new Map,s=Date.now(),a=864e5,c=7*a,l=14*a,u=90*a,h=180*a,f=new Date,d=f.getFullYear(),p=new Date(d,f.getMonth(),1).getTime(),g=new Date(d,0,1).getTime();let m=0,y=0,v=0,b=0,w=0,x=0,k=0;for(const a of e){if(a.domain){const e=t.get(a.domain)||{count:0,latestDate:0};e.count++,a.dateAdded>e.latestDate&&(e.latestDate=a.dateAdded),t.set(a.domain,e)}if(a.folderPath){const e=n.get(a.folderPath)||0;n.set(a.folderPath,e+1)}const e=a.topics||[];for(const t of e)r.set(t,(r.get(t)||0)+1);if(a.creator){const e=`${a.platform||"other"}:${a.creator}`;i.has(e)||i.set(e,{creator:a.creator,platform:a.platform||"other",count:0}),i.get(e).count++}a.contentType&&o.set(a.contentType,(o.get(a.contentType)||0)+1);const f=a.dateAdded;s-f<c&&m++,s-f<l&&y++,f>=p&&v++,s-f<u&&b++,s-f<h&&w++,f>=g&&x++,f<g&&k++}return{domains:Array.from(t.entries()).map(([e,t])=>({domain:e,count:t.count,latestDate:t.latestDate})).sort((e,t)=>t.count-e.count),folders:Array.from(n.entries()).map(([e,t])=>({folder:e,count:t})).sort((e,t)=>t.count-e.count),topics:Array.from(r.entries()).map(([e,t])=>({topic:e,count:t})).sort((e,t)=>t.count-e.count),creators:Array.from(i.values()).sort((e,t)=>t.count-e.count),contentTypes:Array.from(o.entries()).map(([e,t])=>({type:e,count:t})).sort((e,t)=>t.count-e.count),dateCounts:{week:m,twoWeek:y,month:v,threeMonth:b,sixMonth:w,year:x,older:k}}}function Ur(e,t,n){const r=e.slice();return r[9]=t[n],r}function Qr(t){let n,r;return n=new nn({}),n.$on("filter",t[7]),{c(){H(n.$$.fragment)},m(e,t){V(n,e,t),r=!0},p:e,i(e){r||(N(n.$$.fragment,e),r=!0)},o(e){W(n.$$.fragment,e),r=!1},d(e){Y(n,e)}}}function Hr(e){let t,n,i=[],o=new Map,s=U(e[0]);const a=e=>e[9].id;for(let t=0;t<s.length;t+=1){let n=Ur(e,s,t),r=a(n);o.set(r,i[t]=Jr(r,n))}return{c(){t=g("div");for(let e=0;e<i.length;e+=1)i[e].c();w(t,"class","space-y-3")},m(e,r){f(e,t,r);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);n=!0},p(e,n){1&n&&(s=U(e[0]),L(),i=function(e,t,n,i,o,s,a,c,l,u,h,f){let d=e.length,p=s.length,g=d;const m={};for(;g--;)m[e[g].key]=g;const y=[],v=new Map,b=new Map,w=[];for(g=p;g--;){const e=f(o,s,g),r=n(e);let c=a.get(r);c?i&&w.push(()=>c.p(e,t)):(c=u(r,e),c.c()),v.set(r,y[g]=c),r in m&&b.set(r,Math.abs(g-m[r]))}const x=new Set,k=new Set;function _(e){N(e,1),e.m(c,h),a.set(e.key,e),h=e.first,p--}for(;d&&p;){const t=y[p-1],n=e[d-1],r=t.key,i=n.key;t===n?(h=t.first,d--,p--):v.has(i)?!a.has(r)||x.has(r)?_(t):k.has(i)?d--:b.get(r)>b.get(i)?(k.add(r),_(t)):(x.add(i),d--):(l(n,a),d--)}for(;d--;){const t=e[d];v.has(t.key)||l(t,a)}for(;p;)_(y[p-1]);return r(w),y}(i,n,a,1,e,s,o,t,Q,Jr,null,Ur),z())},i(e){if(!n){for(let e=0;e<s.length;e+=1)N(i[e]);n=!0}},o(e){for(let e=0;e<i.length;e+=1)W(i[e]);n=!1},d(e){e&&d(t);for(let e=0;e<i.length;e+=1)i[e].d()}}}function Vr(t){let n;function r(e,t){return e[3]?Zr:Xr}let i=r(t),o=i(t);return{c(){n=g("div"),o.c(),w(n,"class","text-center text-gray-500 p-4")},m(e,t){f(e,n,t),o.m(n,null)},p(e,t){i===(i=r(e))&&o?o.p(e,t):(o.d(1),o=i(e),o&&(o.c(),o.m(n,null)))},i:e,o:e,d(e){e&&d(n),o.d()}}}function Yr(t){let n,r,i,o,s,a,c,l;return{c(){n=g("div"),r=g("p"),i=y("Error: "),o=y(t[2]),s=v(),a=g("button"),a.textContent="Retry",w(a,"class","mt-2 px-3 py-1 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700"),w(n,"class","text-center text-red-600 p-4")},m(e,u){f(e,n,u),h(n,r),h(r,i),h(r,o),h(n,s),h(n,a),c||(l=b(a,"click",t[5]),c=!0)},p(e,t){4&t&&x(o,e[2])},i:e,o:e,d(e){e&&d(n),c=!1,l()}}}function Gr(t){let n;return{c(){n=g("div"),n.innerHTML='<div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>',w(n,"class","flex items-center justify-center h-32")},m(e,t){f(e,n,t)},p:e,i:e,o:e,d(e){e&&d(n)}}}function Jr(e,t){let n,r,i;return r=new Ye({props:{bookmark:t[9]}}),{key:e,first:null,c(){n=y(""),H(r.$$.fragment),this.first=n},m(e,t){f(e,n,t),V(r,e,t),i=!0},p(e,n){t=e;const i={};1&n&&(i.bookmark=t[9]),r.$set(i)},i(e){i||(N(r.$$.fragment,e),i=!0)},o(e){W(r.$$.fragment,e),i=!1},d(e){e&&d(n),Y(r,e)}}}function Xr(t){let n;return{c(){n=g("p"),n.textContent="No bookmarks found"},m(e,t){f(e,n,t)},p:e,d(e){e&&d(n)}}}function Zr(e){let t,n,r,i;return{c(){t=g("p"),n=y('No bookmarks found for "'),r=y(e[3]),i=y('"')},m(e,o){f(e,t,o),h(t,n),h(t,r),h(t,i)},p(e,t){8&t&&x(r,e[3])},d(e){e&&d(t)}}}function ei(e){let t,n,i,o,s,a,c,l,u,p,m,k,_,A,C,S,j,P,E,T,O,D,M,R,B,I=e[0].length+"",K=1!==e[0].length?"s":"";m=new ut({}),m.$on("search",e[6]);let $=e[4]&&Qr(e);const q=[Gr,Yr,Vr,Hr],F=[];function U(e,t){return e[1]?0:e[2]?1:0===e[0].length?2:3}return O=U(e),D=F[O]=q[O](e),{c(){t=g("div"),n=g("div"),i=g("div"),o=g("h1"),o.textContent="Bookmark Insight",s=v(),a=g("div"),c=g("button"),c.innerHTML='<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z"></path></svg>',l=v(),u=g("button"),u.textContent="Dashboard",p=v(),H(m.$$.fragment),k=v(),_=g("div"),A=y(I),C=y(" bookmark"),S=y(K),j=v(),P=g("div"),$&&$.c(),E=v(),T=g("div"),D.c(),w(o,"class","text-lg font-semibold text-gray-900"),w(c,"class","p-2 text-gray-400 hover:text-gray-600 rounded-md hover:bg-gray-100"),w(c,"title","Toggle Filters"),w(u,"class","px-3 py-1 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700"),w(a,"class","flex space-x-2"),w(i,"class","flex items-center justify-between mb-3"),w(_,"class","text-xs text-gray-500"),w(n,"class","p-4 border-b border-gray-200 bg-gray-50"),w(T,"class","flex-1 overflow-y-auto p-4"),w(P,"class","flex flex-1 overflow-hidden"),w(t,"class","w-96 h-96 bg-white flex flex-col")},m(r,d){f(r,t,d),h(t,n),h(n,i),h(i,o),h(i,s),h(i,a),h(a,c),h(a,l),h(a,u),h(n,p),V(m,n,null),h(n,k),h(n,_),h(_,A),h(_,C),h(_,S),h(t,j),h(t,P),$&&$.m(P,null),h(P,E),h(P,T),F[O].m(T,null),M=!0,R||(B=[b(c,"click",e[8]),b(u,"click",ti)],R=!0)},p(e,[t]){(!M||1&t)&&I!==(I=e[0].length+"")&&x(A,I),(!M||1&t)&&K!==(K=1!==e[0].length?"s":"")&&x(S,K),e[4]?$?($.p(e,t),16&t&&N($,1)):($=Qr(e),$.c(),N($,1),$.m(P,E)):$&&(L(),W($,1,1,()=>{$=null}),z());let n=O;O=U(e),O===n?F[O].p(e,t):(L(),W(F[n],1,1,()=>{F[n]=null}),z(),D=F[O],D?D.p(e,t):(D=F[O]=q[O](e),D.c()),N(D,1),D.m(T,null))},i(e){M||(N(m.$$.fragment,e),N($),N(D),M=!0)},o(e){W(m.$$.fragment,e),W($),W(D),M=!1},d(e){e&&d(t),Y(m),$&&$.d(),F[O].d(),R=!1,r(B)}}}function ti(){chrome.tabs.create({url:chrome.runtime.getURL("dashboard.html")}),window.close()}function ni(e,t,n){let r=[],i=!0,o=null,s="",a=!1;async function c(){n(0,r=await me())}return S(async()=>{try{await c()}catch(e){n(2,o=e.message)}finally{n(1,i=!1)}}),[r,i,o,s,a,c,async function(e){const t=e.detail.query;n(3,s=t);try{n(1,i=!0);const e=await Nr(t);n(0,r=e.results||[])}catch(e){n(2,o=e.message)}finally{n(1,i=!1)}},async function(e){const{type:t,value:s}=e.detail;try{switch(n(1,i=!0),t){case"clear":n(0,r=await me());break;case"domain":n(0,r=await async function(e){try{return await ge.bookmarks.where("domain").equals(e).toArray()}catch(e){return console.error("Error getting bookmarks by domain:",e),[]}}(s));break;case"folder":n(0,r=await async function(e){try{return(await me()).filter(t=>t.folderPath===e)}catch(e){return console.error("Error getting bookmarks by folder:",e),[]}}(s));break;case"date":n(0,r=await async function(e,t){try{return await ge.bookmarks.where("dateAdded").between(e,t,!0,!0).toArray()}catch(e){return console.error("Error getting bookmarks by date range:",e),[]}}(s.startDate,s.endDate))}}catch(e){n(2,o=e.message)}finally{n(1,i=!1)}},function(){n(4,a=!a)}]}const ri=new class extends X{constructor(e){super(),J(this,e,ni,ei,o,{})}}({target:document.body});var ii=Object.freeze({__proto__:null,default:{}});export{ri as default};
