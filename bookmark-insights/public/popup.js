function e(){}function t(e){return e()}function n(){return Object.create(null)}function r(e){e.forEach(t)}function o(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let a,u;function s(e,t){return e===t||(a||(a=document.createElement("a")),a.href=t,e===a.href)}function c(e,t){e.appendChild(t)}function l(e,t,n){e.insertBefore(t,n||null)}function f(e){e.parentNode&&e.parentNode.removeChild(e)}function d(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function h(e){return document.createElement(e)}function p(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function y(e){return document.createTextNode(e)}function m(){return y(" ")}function v(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function g(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function b(e,t){t=""+t,e.data!==t&&(e.data=t)}function w(e,t){e.value=null==t?"":t}function x(e,t,n){e.classList.toggle(t,!!n)}function k(e){u=e}function _(){if(!u)throw new Error("Function called outside component initialization");return u}function E(e){_().$$.on_mount.push(e)}function O(){const e=_();return(t,n,{cancelable:r=!1}={})=>{const o=e.$$.callbacks[t];if(o){const i=function(e,t,{bubbles:n=!1,cancelable:r=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:r})}(t,n,{cancelable:r});return o.slice().forEach(t=>{t.call(e,i)}),!i.defaultPrevented}return!0}}const P=[],A=[];let C=[];const S=[],K=Promise.resolve();let j=!1;function D(e){C.push(e)}const T=new Set;let B=0;function I(){if(0!==B)return;const e=u;do{try{for(;B<P.length;){const e=P[B];B++,k(e),R(e.$$)}}catch(e){throw P.length=0,B=0,e}for(k(null),P.length=0,B=0;A.length;)A.pop()();for(let e=0;e<C.length;e+=1){const t=C[e];T.has(t)||(T.add(t),t())}C.length=0}while(P.length);for(;S.length;)S.pop()();j=!1,T.clear(),k(e)}function R(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(D)}}const q=new Set;let M;function $(){M={r:0,c:[],p:M}}function F(){M.r||r(M.c),M=M.p}function N(e,t){e&&e.i&&(q.delete(e),e.i(t))}function L(e,t,n,r){if(e&&e.o){if(q.has(e))return;q.add(e),M.c.push(()=>{q.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}else r&&r()}function z(e){return void 0!==e?.length?e:Array.from(e)}function U(e,t){L(e,1,1,()=>{t.delete(e.key)})}function V(e){e&&e.c()}function W(e,n,i){const{fragment:a,after_update:u}=e.$$;a&&a.m(n,i),D(()=>{const n=e.$$.on_mount.map(t).filter(o);e.$$.on_destroy?e.$$.on_destroy.push(...n):r(n),e.$$.on_mount=[]}),u.forEach(D)}function Y(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];C.forEach(r=>-1===e.indexOf(r)?t.push(r):n.push(r)),n.forEach(e=>e()),C=t}(n.after_update),r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function H(e,t){-1===e.$$.dirty[0]&&(P.push(e),j||(j=!0,K.then(I)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Q(t,o,i,a,s,c,l=null,d=[-1]){const h=u;k(t);const p=t.$$={fragment:null,ctx:[],props:c,update:e,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o.context||(h?h.$$.context:[])),callbacks:n(),dirty:d,skip_bound:!1,root:o.target||h.$$.root};l&&l(p.root);let y=!1;if(p.ctx=i?i(t,o.props||{},(e,n,...r)=>{const o=r.length?r[0]:n;return p.ctx&&s(p.ctx[e],p.ctx[e]=o)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](o),y&&H(t,e)),n}):[],p.update(),y=!0,r(p.before_update),p.fragment=!!a&&a(p.ctx),o.target){if(o.hydrate){const e=function(e){return Array.from(e.childNodes)}(o.target);p.fragment&&p.fragment.l(e),e.forEach(f)}else p.fragment&&p.fragment.c();o.intro&&N(t.$$.fragment),W(t,o.target,o.anchor),I()}k(h)}class G{$$=void 0;$$set=void 0;$destroy(){Y(this,1),this.$destroy=e}$on(t,n){if(!o(n))return e;const r=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return r.push(n),()=>{const e=r.indexOf(n);-1!==e&&r.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function X(e){return new Date(e).toLocaleDateString()}function J(e){if(e.url.startsWith("http://")||e.url.startsWith("https://")){const t=e.domain.charAt(0).toUpperCase(),n=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899"];return`data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="${n[e.domain.length%n.length]}"/><text x="8" y="12" font-family="Arial" font-size="10" text-anchor="middle" fill="white" font-weight="bold">${t}</text></svg>`}switch(e.domain){case"chrome-internal":return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%23EA4335"/><circle cx="8" cy="8" r="3" fill="white"/></svg>';case"local-file":return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%23F59E0B"/><text x="8" y="12" font-family="Arial" font-size="10" text-anchor="middle" fill="white">ðŸ“„</text></svg>';case"javascript-bookmarklet":return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%23F7DF1E"/><text x="8" y="12" font-family="Arial" font-size="8" text-anchor="middle" fill="black" font-weight="bold">JS</text></svg>';case"data-uri":return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%2310B981"/><text x="8" y="12" font-family="Arial" font-size="8" text-anchor="middle" fill="white" font-weight="bold">D</text></svg>';case"contact-link":return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%238B5CF6"/><text x="8" y="12" font-family="Arial" font-size="10" text-anchor="middle" fill="white">@</text></svg>';case"other-protocol":return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%236B7280"/><text x="8" y="12" font-family="Arial" font-size="10" text-anchor="middle" fill="white">âš¡</text></svg>';default:return'data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><rect width="16" height="16" fill="%23E5E7EB"/><text x="8" y="12" font-family="Arial" font-size="10" text-anchor="middle" fill="%236B7280">?</text></svg>'}}function Z(e){switch(e.domain){case"chrome-internal":return"Chrome";case"local-file":return"Local File";case"javascript-bookmarklet":return"Bookmarklet";case"data-uri":return"Data URI";case"contact-link":return"Contact";case"other-protocol":return"Other";case"invalid-url":return"Invalid URL";default:return e.domain}}function ee(e){let t,n;return{c(){t=p("svg"),n=p("path"),g(n,"stroke-linecap","round"),g(n,"stroke-linejoin","round"),g(n,"stroke-width","2"),g(n,"d","M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"),g(t,"class","w-4 h-4"),g(t,"fill","none"),g(t,"stroke","currentColor"),g(t,"viewBox","0 0 24 24")},m(e,r){l(e,t,r),c(t,n)},d(e){e&&f(t)}}}function te(e){let t,n;return{c(){t=p("svg"),n=p("path"),g(n,"stroke-linecap","round"),g(n,"stroke-linejoin","round"),g(n,"stroke-width","2"),g(n,"d","M5 13l4 4L19 7"),g(t,"class","w-4 h-4 text-green-500"),g(t,"fill","none"),g(t,"stroke","currentColor"),g(t,"viewBox","0 0 24 24")},m(e,r){l(e,t,r),c(t,n)},d(e){e&&f(t)}}}function ne(e){let t,n,r,o,i=e[0].folderPath+"";return{c(){t=h("p"),n=y("ðŸ“ "),r=y(i),g(t,"class","text-xs text-gray-400 mt-1 truncate"),g(t,"title",o=e[0].folderPath)},m(e,o){l(e,t,o),c(t,n),c(t,r)},p(e,n){1&n&&i!==(i=e[0].folderPath+"")&&b(r,i),1&n&&o!==(o=e[0].folderPath)&&g(t,"title",o)},d(e){e&&f(t)}}}function re(t){let n,o,i,a,u,d,p,w,x,k,_,E,O,P,A,C,S,K,j,D,T,B,I,R,q,M,$=t[0].title+"",F=t[0].url+"",N=Z(t[0])+"",L=X(t[0].dateAdded)+"";function z(e,t){return e[1]?te:ee}let U=z(t),V=U(t),W=t[0].folderPath&&ne(t);return{c(){n=h("div"),o=h("div"),i=h("img"),u=m(),d=h("div"),p=h("h3"),w=y($),k=m(),_=h("p"),E=y(F),P=m(),A=h("div"),C=h("span"),S=y(N),K=m(),j=h("div"),D=h("button"),V.c(),T=m(),B=h("span"),I=y(L),R=m(),W&&W.c(),s(i.src,a=J(t[0]))||g(i,"src",a),g(i,"alt","Favicon"),g(i,"class","w-4 h-4 mt-1 flex-shrink-0"),g(p,"class","text-sm font-medium text-gray-900 truncate"),g(p,"title",x=t[0].title),g(_,"class","text-xs text-gray-500 truncate mt-1"),g(_,"title",O=t[0].url),g(C,"class","text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded"),g(D,"class","p-1 text-gray-400 hover:text-blue-600 transition-colors"),g(D,"title","Copy URL"),g(B,"class","text-xs text-gray-400"),g(j,"class","flex items-center space-x-2"),g(A,"class","flex items-center justify-between mt-2"),g(d,"class","flex-1 min-w-0"),g(o,"class","flex items-start space-x-3"),g(n,"class","bookmark-card bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition-shadow cursor-pointer border border-gray-200 svelte-1oo2sed"),g(n,"role","button"),g(n,"tabindex","0")},m(e,r){l(e,n,r),c(n,o),c(o,i),c(o,u),c(o,d),c(d,p),c(p,w),c(d,k),c(d,_),c(_,E),c(d,P),c(d,A),c(A,C),c(C,S),c(A,K),c(A,j),c(j,D),V.m(D,null),c(j,T),c(j,B),c(B,I),c(d,R),W&&W.m(d,null),q||(M=[v(D,"click",t[2]),v(n,"click",t[3]),v(n,"keydown",t[4])],q=!0)},p(e,[t]){1&t&&!s(i.src,a=J(e[0]))&&g(i,"src",a),1&t&&$!==($=e[0].title+"")&&b(w,$),1&t&&x!==(x=e[0].title)&&g(p,"title",x),1&t&&F!==(F=e[0].url+"")&&b(E,F),1&t&&O!==(O=e[0].url)&&g(_,"title",O),1&t&&N!==(N=Z(e[0])+"")&&b(S,N),U!==(U=z(e))&&(V.d(1),V=U(e),V&&(V.c(),V.m(D,null))),1&t&&L!==(L=X(e[0].dateAdded)+"")&&b(I,L),e[0].folderPath?W?W.p(e,t):(W=ne(e),W.c(),W.m(d,null)):W&&(W.d(1),W=null)},i:e,o:e,d(e){e&&f(n),V.d(),W&&W.d(),q=!1,r(M)}}}function oe(e){chrome.tabs.create({url:e})}function ie(e,t,n){let{bookmark:r}=t;O();let o=!1;return e.$$set=e=>{"bookmark"in e&&n(0,r=e.bookmark)},[r,o,async function(e){e.stopPropagation();const t=await async function(e){try{return await navigator.clipboard.writeText(e),!0}catch(e){return console.error("Failed to copy to clipboard:",e),!1}}(r.url);t&&(n(1,o=!0),setTimeout(()=>n(1,o=!1),2e3))},()=>oe(r.url),e=>"Enter"===e.key&&oe(r.url)]}"undefined"!=typeof window&&(window.__svelte||(window.__svelte={v:new Set})).v.add("4");class ae extends G{constructor(e){super(),Q(this,e,ie,re,i,{bookmark:0})}}function ue(e,t,n){const r=e.slice();return r[13]=t[n],r}function se(e,t,n){const r=e.slice();return r[16]=t[n],r}function ce(e,t,n){const r=e.slice();return r[16]=t[n],r}function le(t){let n,r,o;return{c(){n=h("button"),n.innerHTML='<svg class="h-5 w-5 text-gray-400 hover:text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',g(n,"class","absolute inset-y-0 right-0 pr-3 flex items-center"),g(n,"type","button"),g(n,"title","Clear search (Esc)")},m(e,i){l(e,n,i),r||(o=v(n,"click",t[7]),r=!0)},p:e,d(e){e&&f(n),r=!1,o()}}}function fe(e){let t,n,r,o=z(e[4].positive),i=[];for(let t=0;t<o.length;t+=1)i[t]=de(ce(e,o,t));let a=z(e[4].negative),u=[];for(let t=0;t<a.length;t+=1)u[t]=he(se(e,a,t));let s=z(e[4].phrases),p=[];for(let t=0;t<s.length;t+=1)p[t]=pe(ue(e,s,t));return{c(){t=h("div");for(let e=0;e<i.length;e+=1)i[e].c();n=m();for(let e=0;e<u.length;e+=1)u[e].c();r=m();for(let e=0;e<p.length;e+=1)p[e].c();g(t,"class","flex flex-wrap gap-1.5 mt-2")},m(e,o){l(e,t,o);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);c(t,n);for(let e=0;e<u.length;e+=1)u[e]&&u[e].m(t,null);c(t,r);for(let e=0;e<p.length;e+=1)p[e]&&p[e].m(t,null)},p(e,c){if(16&c){let r;for(o=z(e[4].positive),r=0;r<o.length;r+=1){const a=ce(e,o,r);i[r]?i[r].p(a,c):(i[r]=de(a),i[r].c(),i[r].m(t,n))}for(;r<i.length;r+=1)i[r].d(1);i.length=o.length}if(16&c){let n;for(a=z(e[4].negative),n=0;n<a.length;n+=1){const o=se(e,a,n);u[n]?u[n].p(o,c):(u[n]=he(o),u[n].c(),u[n].m(t,r))}for(;n<u.length;n+=1)u[n].d(1);u.length=a.length}if(16&c){let n;for(s=z(e[4].phrases),n=0;n<s.length;n+=1){const r=ue(e,s,n);p[n]?p[n].p(r,c):(p[n]=pe(r),p[n].c(),p[n].m(t,null))}for(;n<p.length;n+=1)p[n].d(1);p.length=s.length}},d(e){e&&f(t),d(i,e),d(u,e),d(p,e)}}}function de(e){let t,n,r,o,i,a=e[16]+"";return{c(){t=h("span"),n=p("svg"),r=p("path"),o=m(),i=y(a),g(r,"fill-rule","evenodd"),g(r,"d","M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"),g(r,"clip-rule","evenodd"),g(n,"class","w-3 h-3 mr-1"),g(n,"fill","currentColor"),g(n,"viewBox","0 0 20 20"),g(t,"class","inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800")},m(e,a){l(e,t,a),c(t,n),c(n,r),c(t,o),c(t,i)},p(e,t){16&t&&a!==(a=e[16]+"")&&b(i,a)},d(e){e&&f(t)}}}function he(e){let t,n,r,o,i,a=e[16]+"";return{c(){t=h("span"),n=p("svg"),r=p("path"),o=m(),i=y(a),g(r,"fill-rule","evenodd"),g(r,"d","M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z"),g(r,"clip-rule","evenodd"),g(n,"class","w-3 h-3 mr-1"),g(n,"fill","currentColor"),g(n,"viewBox","0 0 20 20"),g(t,"class","inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800")},m(e,a){l(e,t,a),c(t,n),c(n,r),c(t,o),c(t,i)},p(e,t){16&t&&a!==(a=e[16]+"")&&b(i,a)},d(e){e&&f(t)}}}function pe(e){let t,n,r,o,i,a,u=e[13]+"";return{c(){t=h("span"),n=p("svg"),r=p("path"),o=y('\n          "'),i=y(u),a=y('"\n        '),g(r,"fill-rule","evenodd"),g(r,"d","M18 13V5a2 2 0 00-2-2H4a2 2 0 00-2 2v8a2 2 0 002 2h3l3 3 3-3h3a2 2 0 002-2zM5 7a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1zm1 3a1 1 0 100 2h3a1 1 0 100-2H6z"),g(r,"clip-rule","evenodd"),g(n,"class","w-3 h-3 mr-1"),g(n,"fill","currentColor"),g(n,"viewBox","0 0 20 20"),g(t,"class","inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800")},m(e,u){l(e,t,u),c(t,n),c(n,r),c(t,o),c(t,i),c(t,a)},p(e,t){16&t&&u!==(u=e[13]+"")&&b(i,u)},d(e){e&&f(t)}}}function ye(e){let t;return{c(){t=h("div"),t.innerHTML='<h4 class="font-medium text-gray-900 mb-3">Search Syntax</h4> <div class="space-y-2 text-sm"><div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-green-100 text-green-800 rounded text-xs whitespace-nowrap">+term</code> <span class="text-gray-600">Must include this term</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-red-100 text-red-800 rounded text-xs whitespace-nowrap">-term</code> <span class="text-gray-600">Must NOT include this term</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-blue-100 text-blue-800 rounded text-xs whitespace-nowrap">&quot;exact phrase&quot;</code> <span class="text-gray-600">Match exact phrase</span></div> <div class="flex items-start gap-3"><code class="px-1.5 py-0.5 bg-gray-100 text-gray-700 rounded text-xs whitespace-nowrap">word</code> <span class="text-gray-600">Regular search term</span></div></div> <div class="mt-3 pt-3 border-t border-gray-100"><p class="text-xs text-gray-500"><strong>Example:</strong> <code class="bg-gray-100 px-1 rounded">javascript +tutorial -video &quot;best practices&quot;</code></p></div>',g(t,"class","absolute z-20 w-full mt-2 p-4 bg-white border border-gray-200 rounded-lg shadow-lg")},m(e,n){l(e,t,n)},d(e){e&&f(t)}}}function me(t){let n,o,i,a,u,s,d,p,y,b,x,k,_,E=t[0]&&le(t),O=t[0]&&(t[4].positive.length>0||t[4].negative.length>0||t[4].phrases.length>0)&&fe(t),P=t[3]&&ye();return{c(){n=h("div"),o=h("div"),i=h("div"),a=h("div"),a.innerHTML='<svg class="h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>',u=m(),s=h("input"),d=m(),E&&E.c(),p=m(),y=h("button"),y.innerHTML='<svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>',b=m(),O&&O.c(),x=m(),P&&P.c(),g(a,"class","absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"),g(s,"type","text"),g(s,"placeholder",t[1]),g(s,"class","block w-full pl-10 pr-10 py-2.5 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm"),g(s,"autocomplete","off"),g(s,"spellcheck","false"),g(i,"class","relative flex-1"),g(y,"class","p-2.5 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg border border-gray-300 transition-colors"),g(y,"type","button"),g(y,"title","Search help"),g(o,"class","flex items-center gap-2"),g(n,"class","relative mb-4")},m(e,r){l(e,n,r),c(n,o),c(o,i),c(i,a),c(i,u),c(i,s),t[9](s),w(s,t[0]),c(i,d),E&&E.m(i,null),c(o,p),c(o,y),c(n,b),O&&O.m(n,null),c(n,x),P&&P.m(n,null),k||(_=[v(s,"input",t[10]),v(s,"input",t[5]),v(s,"keydown",t[6]),v(y,"click",t[8])],k=!0)},p(e,[t]){2&t&&g(s,"placeholder",e[1]),1&t&&s.value!==e[0]&&w(s,e[0]),e[0]?E?E.p(e,t):(E=le(e),E.c(),E.m(i,null)):E&&(E.d(1),E=null),e[0]&&(e[4].positive.length>0||e[4].negative.length>0||e[4].phrases.length>0)?O?O.p(e,t):(O=fe(e),O.c(),O.m(n,x)):O&&(O.d(1),O=null),e[3]?P||(P=ye(),P.c(),P.m(n,null)):P&&(P.d(1),P=null)},i:e,o:e,d(e){e&&f(n),t[9](null),E&&E.d(),O&&O.d(),P&&P.d(),k=!1,r(_)}}}function ve(e,t,n){let r;const o=O();let i,a,{value:u=""}=t,{placeholder:s='Search: use +term (must include), -term (exclude), "exact phrase"'}=t,c=!1;function l(){n(0,u=""),o("search",{query:""}),a?.focus()}return e.$$set=e=>{"value"in e&&n(0,u=e.value),"placeholder"in e&&n(1,s=e.placeholder)},e.$$.update=()=>{1&e.$$.dirty&&n(4,r=function(e){if(!e)return{positive:[],negative:[],phrases:[],regular:[]};const t=[],n=[],r=[],o=[];return(e.match(/"([^"]+)"/g)||[]).forEach(e=>r.push(e.slice(1,-1))),e.replace(/"[^"]+"/g,"").trim().split(/\s+/).filter(e=>e.length>0).forEach(e=>{e.startsWith("+")&&e.length>1?t.push(e.slice(1)):e.startsWith("-")&&e.length>1?n.push(e.slice(1)):o.push(e)}),{positive:t,negative:n,phrases:r,regular:o}}(u))},[u,s,a,c,r,function(e){n(0,u=e.target.value),clearTimeout(i),i=setTimeout(()=>{o("search",{query:u})},200)},function(e){"Escape"===e.key?l():"Enter"===e.key&&(clearTimeout(i),o("search",{query:u}))},l,function(){n(3,c=!c)},function(e){A[e?"unshift":"push"](()=>{a=e,n(2,a)})},function(){u=this.value,n(0,u)}]}class ge extends G{constructor(e){super(),Q(this,e,ve,me,i,{value:0,placeholder:1})}}var be="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function we(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var xe={exports:{}};xe.exports=function(){
/*! *****************************************************************************
	    Copyright (c) Microsoft Corporation.
	    Permission to use, copy, modify, and/or distribute this software for any
	    purpose with or without fee is hereby granted.
	    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	    PERFORMANCE OF THIS SOFTWARE.
	    ***************************************************************************** */
var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};function t(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var n=function(){return n=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},n.apply(this,arguments)};function r(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}var o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:be,i=Object.keys,a=Array.isArray;function u(e,t){return"object"!=typeof t||i(t).forEach(function(n){e[n]=t[n]}),e}"undefined"==typeof Promise||o.Promise||(o.Promise=Promise);var s=Object.getPrototypeOf,c={}.hasOwnProperty;function l(e,t){return c.call(e,t)}function f(e,t){"function"==typeof t&&(t=t(s(e))),("undefined"==typeof Reflect?i:Reflect.ownKeys)(t).forEach(function(n){h(e,n,t[n])})}var d=Object.defineProperty;function h(e,t,n,r){d(e,t,u(n&&l(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function p(e){return{from:function(t){return e.prototype=Object.create(t.prototype),h(e.prototype,"constructor",e),{extend:f.bind(null,e.prototype)}}}}var y=Object.getOwnPropertyDescriptor;function m(e,t){var n;return y(e,t)||(n=s(e))&&m(n,t)}var v=[].slice;function g(e,t,n){return v.call(e,t,n)}function b(e,t){return t(e)}function w(e){if(!e)throw new Error("Assertion Failed")}function x(e){o.setImmediate?setImmediate(e):setTimeout(e,0)}function k(e,t){return e.reduce(function(e,n,r){var o=t(n,r);return o&&(e[o[0]]=o[1]),e},{})}function _(e,t){if("string"==typeof t&&l(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,o=t.length;r<o;++r){var i=_(e,t[r]);n.push(i)}return n}var a=t.indexOf(".");if(-1!==a){var u=e[t.substr(0,a)];return null==u?void 0:_(u,t.substr(a+1))}}function E(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){w("string"!=typeof n&&"length"in n);for(var r=0,o=t.length;r<o;++r)E(e,t[r],n[r])}else{var i=t.indexOf(".");if(-1!==i){var u=t.substr(0,i),s=t.substr(i+1);if(""===s)void 0===n?a(e)&&!isNaN(parseInt(u))?e.splice(u,1):delete e[u]:e[u]=n;else{var c=e[u];c&&l(e,u)||(c=e[u]={}),E(c,s,n)}}else void 0===n?a(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function O(e,t){"string"==typeof t?E(e,t,void 0):"length"in t&&[].map.call(t,function(t){E(e,t,void 0)})}function P(e){var t={};for(var n in e)l(e,n)&&(t[n]=e[n]);return t}var A=[].concat;function C(e){return A.apply([],e)}var S="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(C([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return o[e]}),K=new Set(S.map(function(e){return o[e]}));function j(e){var t={};for(var n in e)if(l(e,n)){var r=e[n];t[n]=!r||"object"!=typeof r||K.has(r.constructor)?r:j(r)}return t}function D(e){for(var t in e)if(l(e,t))return!1;return!0}var T=null;function B(e){T=new WeakMap;var t=I(e);return T=null,t}function I(e){if(!e||"object"!=typeof e)return e;var t=T.get(e);if(t)return t;if(a(e)){t=[],T.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(I(e[n]))}else if(K.has(e.constructor))t=e;else{var o=s(e);for(var i in t=o===Object.prototype?{}:Object.create(o),T.set(e,t),e)l(e,i)&&(t[i]=I(e[i]))}return t}var R={}.toString;function q(e){return R.call(e).slice(8,-1)}var M="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",$="symbol"==typeof M?function(e){var t;return null!=e&&(t=e[M])&&t.apply(e)}:function(){return null};function F(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),n>=0}var N={};function L(e){var t,n,r,o;if(1===arguments.length){if(a(e))return e.slice();if(this===N&&"string"==typeof e)return[e];if(o=$(e)){for(n=[];!(r=o.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var z="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},U=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],V=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(U),W={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Y(e,t){this.name=e,this.message=t}function H(e,t){return e+". Errors: "+Object.keys(t).map(function(e){return t[e].toString()}).filter(function(e,t,n){return n.indexOf(e)===t}).join("\n")}function Q(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=H(e,t)}function G(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(e){return t[e]}),this.failuresByPos=t,this.message=H(e,this.failures)}p(Y).from(Error).extend({toString:function(){return this.name+": "+this.message}}),p(Q).from(Y),p(G).from(Y);var X=V.reduce(function(e,t){return e[t]=t+"Error",e},{}),J=Y,Z=V.reduce(function(e,t){var n=t+"Error";function r(e,r){this.name=n,e?"string"==typeof e?(this.message="".concat(e).concat(r?"\n "+r:""),this.inner=r||null):"object"==typeof e&&(this.message="".concat(e.name," ").concat(e.message),this.inner=e):(this.message=W[t]||n,this.inner=null)}return p(r).from(J),e[t]=r,e},{});Z.Syntax=SyntaxError,Z.Type=TypeError,Z.Range=RangeError;var ee=U.reduce(function(e,t){return e[t+"Error"]=Z[t],e},{});function te(e,t){if(!e||e instanceof Y||e instanceof TypeError||e instanceof SyntaxError||!e.name||!ee[e.name])return e;var n=new ee[e.name](t||e.message,e);return"stack"in e&&h(n,"stack",{get:function(){return this.inner.stack}}),n}var ne=V.reduce(function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=Z[t]),e},{});function re(){}function oe(e){return e}function ie(e,t){return null==e||e===oe?t:function(n){return t(e(n))}}function ae(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function ue(e,t){return e===re?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var i=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?ae(r,this.onsuccess):r),o&&(this.onerror=this.onerror?ae(o,this.onerror):o),void 0!==i?i:n}}function se(e,t){return e===re?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?ae(n,this.onsuccess):n),r&&(this.onerror=this.onerror?ae(r,this.onerror):r)}}function ce(e,t){return e===re?t:function(n){var r=e.apply(this,arguments);u(n,r);var o=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return o&&(this.onsuccess=this.onsuccess?ae(o,this.onsuccess):o),i&&(this.onerror=this.onerror?ae(i,this.onerror):i),void 0===r?void 0===a?void 0:a:u(r,a)}}function le(e,t){return e===re?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function fe(e,t){return e===re?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,o=arguments.length,i=new Array(o);o--;)i[o]=arguments[o];return n.then(function(){return t.apply(r,i)})}return t.apply(this,arguments)}}ne.ModifyError=Q,ne.DexieError=Y,ne.BulkError=G;var de="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function he(e,t){de=e}var pe={},ye=100,me="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,s(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,s(t),e]}(),ve=me[0],ge=me[1],we=me[2],xe=ge&&ge.then,ke=ve&&ve.constructor,_e=!!we;function Ee(){queueMicrotask(Ue)}var Oe=function(e,t){Te.push([e,t]),Ae&&(Ee(),Ae=!1)},Pe=!0,Ae=!0,Ce=[],Se=[],Ke=oe,je={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:re,pgp:!1,env:{},finalize:re},De=je,Te=[],Be=0,Ie=[];function Re(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=De;if("function"!=typeof e){if(e!==pe)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&Fe(this,this._value))}this._state=null,this._value=null,++t.ref,$e(this,e)}var qe={get:function(){var e=De,t=rt;function n(n,r){var o=this,i=!e.global&&(e!==De||t!==rt),a=i&&!ut(),u=new Re(function(t,u){Le(o,new Me(pt(n,e,i,a),pt(r,e,i,a),t,u,e))});return this._consoleTask&&(u._consoleTask=this._consoleTask),u}return n.prototype=pe,n},set:function(e){h(this,"then",e&&e.prototype===pe?qe:{get:function(){return e},set:qe.set})}};function Me(e,t,n,r,o){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=o}function $e(e,t){try{t(function(t){if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&Ve();t&&"function"==typeof t.then?$e(e,function(e,n){t instanceof Re?t._then(e,n):t.then(e,n)}):(e._state=!0,e._value=t,Ne(e)),n&&We()}},Fe.bind(null,e))}catch(t){Fe(e,t)}}function Fe(e,t){if(Se.push(t),null===e._state){var n=e._lib&&Ve();t=Ke(t),e._state=!1,e._value=t,Qe(e),Ne(e),n&&We()}}function Ne(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Le(e,t[n]);var o=e._PSD;--o.ref||o.finalize(),0===Be&&(++Be,Oe(function(){0===--Be&&Ye()},[]))}function Le(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Be,Oe(ze,[n,e,t])}else e._listeners.push(t)}function ze(e,t,n){try{var r,o=t._value;!t._state&&Se.length&&(Se=[]),r=de&&t._consoleTask?t._consoleTask.run(function(){return e(o)}):e(o),t._state||-1!==Se.indexOf(o)||Ge(t),n.resolve(r)}catch(e){n.reject(e)}finally{0===--Be&&Ye(),--n.psd.ref||n.psd.finalize()}}function Ue(){ht(je,function(){Ve()&&We()})}function Ve(){var e=Pe;return Pe=!1,Ae=!1,e}function We(){var e,t,n;do{for(;Te.length>0;)for(e=Te,Te=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(Te.length>0);Pe=!0,Ae=!0}function Ye(){var e=Ce;Ce=[],e.forEach(function(e){e._PSD.onunhandled.call(null,e._value,e)});for(var t=Ie.slice(0),n=t.length;n;)t[--n]()}function He(e){function t(){e(),Ie.splice(Ie.indexOf(t),1)}Ie.push(t),++Be,Oe(function(){0===--Be&&Ye()},[])}function Qe(e){Ce.some(function(t){return t._value===e._value})||Ce.push(e)}function Ge(e){for(var t=Ce.length;t;)if(Ce[--t]._value===e._value)return void Ce.splice(t,1)}function Xe(e){return new Re(pe,!1,e)}function Je(e,t){var n=De;return function(){var r=Ve(),o=De;try{return ft(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{ft(o,!1),r&&We()}}}f(Re.prototype,{then:qe,_then:function(e,t){Le(this,new Me(null,null,e,t,De))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,function(e){return e instanceof t?n(e):Xe(e)}):this.then(null,function(e){return e&&e.name===t?n(e):Xe(e)})},finally:function(e){return this.then(function(t){return Re.resolve(e()).then(function(){return t})},function(t){return Re.resolve(e()).then(function(){return Xe(t)})})},timeout:function(e,t){var n=this;return e<1/0?new Re(function(r,o){var i=setTimeout(function(){return o(new Z.Timeout(t))},e);n.then(r,o).finally(clearTimeout.bind(null,i))}):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&h(Re.prototype,Symbol.toStringTag,"Dexie.Promise"),je.env=dt(),f(Re,{all:function(){var e=L.apply(null,arguments).map(st);return new Re(function(t,n){0===e.length&&t([]);var r=e.length;e.forEach(function(o,i){return Re.resolve(o).then(function(n){e[i]=n,--r||t(e)},n)})})},resolve:function(e){return e instanceof Re?e:e&&"function"==typeof e.then?new Re(function(t,n){e.then(t,n)}):new Re(pe,!0,e)},reject:Xe,race:function(){var e=L.apply(null,arguments).map(st);return new Re(function(t,n){e.map(function(e){return Re.resolve(e).then(t,n)})})},PSD:{get:function(){return De},set:function(e){return De=e}},totalEchoes:{get:function(){return rt}},newPSD:it,usePSD:ht,scheduler:{get:function(){return Oe},set:function(e){Oe=e}},rejectionMapper:{get:function(){return Ke},set:function(e){Ke=e}},follow:function(e,t){return new Re(function(n,r){return it(function(t,n){var r=De;r.unhandleds=[],r.onunhandled=n,r.finalize=ae(function(){var e=this;He(function(){0===e.unhandleds.length?t():n(e.unhandleds[0])})},r.finalize),e()},t,n,r)})}}),ke&&(ke.allSettled&&h(Re,"allSettled",function(){var e=L.apply(null,arguments).map(st);return new Re(function(t){0===e.length&&t([]);var n=e.length,r=new Array(n);e.forEach(function(e,o){return Re.resolve(e).then(function(e){return r[o]={status:"fulfilled",value:e}},function(e){return r[o]={status:"rejected",reason:e}}).then(function(){return--n||t(r)})})})}),ke.any&&"undefined"!=typeof AggregateError&&h(Re,"any",function(){var e=L.apply(null,arguments).map(st);return new Re(function(t,n){0===e.length&&n(new AggregateError([]));var r=e.length,o=new Array(r);e.forEach(function(e,i){return Re.resolve(e).then(function(e){return t(e)},function(e){o[i]=e,--r||n(new AggregateError(o))})})})}),ke.withResolvers&&(Re.withResolvers=ke.withResolvers));var Ze={awaits:0,echoes:0,id:0},et=0,tt=[],nt=0,rt=0,ot=0;function it(e,t,n,r){var o=De,i=Object.create(o);i.parent=o,i.ref=0,i.global=!1,i.id=++ot,je.env,i.env=_e?{Promise:Re,PromiseProp:{value:Re,configurable:!0,writable:!0},all:Re.all,race:Re.race,allSettled:Re.allSettled,any:Re.any,resolve:Re.resolve,reject:Re.reject}:{},t&&u(i,t),++o.ref,i.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=ht(i,e,n,r);return 0===i.ref&&i.finalize(),a}function at(){return Ze.id||(Ze.id=++et),++Ze.awaits,Ze.echoes+=ye,Ze.id}function ut(){return!!Ze.awaits&&(0===--Ze.awaits&&(Ze.id=0),Ze.echoes=Ze.awaits*ye,!0)}function st(e){return Ze.echoes&&e&&e.constructor===ke?(at(),e.then(function(e){return ut(),e},function(e){return ut(),mt(e)})):e}function ct(e){++rt,Ze.echoes&&0!==--Ze.echoes||(Ze.echoes=Ze.awaits=Ze.id=0),tt.push(De),ft(e,!0)}function lt(){var e=tt[tt.length-1];tt.pop(),ft(e,!1)}function ft(e,t){var n=De;if((t?!Ze.echoes||nt++&&e===De:!nt||--nt&&e===De)||queueMicrotask(t?ct.bind(null,e):lt),e!==De&&(De=e,n===je&&(je.env=dt()),_e)){var r=je.env.Promise,i=e.env;(n.global||e.global)&&(Object.defineProperty(o,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function dt(){var e=o.Promise;return _e?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(o,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function ht(e,t,n,r,o){var i=De;try{return ft(e,!0),t(n,r,o)}finally{ft(i,!1)}}function pt(e,t,n,r){return"function"!=typeof e?e:function(){var o=De;n&&at(),ft(t,!0);try{return e.apply(this,arguments)}finally{ft(o,!1),r&&queueMicrotask(ut)}}}function yt(e){Promise===ke&&0===Ze.echoes?0===nt?e():enqueueNativeMicroTask(e):setTimeout(e,0)}-1===(""+xe).indexOf("[native code]")&&(at=ut=re);var mt=Re.reject;function vt(e,t,n,r){if(e.idbdb&&(e._state.openComplete||De.letThrough||e._vip)){var o=e._createTransaction(t,n,e._dbSchema);try{o.create(),e._state.PR1398_maxLoop=3}catch(o){return o.name===X.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return vt(e,t,n,r)})):mt(o)}return o._promise(t,function(e,t){return it(function(){return De.trans=o,r(e,t,o)})}).then(function(e){if("readwrite"===t)try{o.idbtrans.commit()}catch(e){}return"readonly"===t?e:o._completion.then(function(){return e})})}if(e._state.openComplete)return mt(new Z.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return mt(new Z.DatabaseClosed);e.open().catch(re)}return e._state.dbReadyPromise.then(function(){return vt(e,t,n,r)})}var gt="4.2.1",bt=String.fromCharCode(65535),wt=-1/0,xt="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",kt="String expected.",_t=[],Et="__dbnames",Ot="readonly",Pt="readwrite";function At(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var Ct={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function St(e){return"string"!=typeof e||/\./.test(e)?function(e){return e}:function(t){return void 0===t[e]&&e in t&&delete(t=B(t))[e],t}}function Kt(){throw Z.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function jt(e,t){try{var n=Bt(e),r=Bt(t);if(n!==r)return"Array"===n?1:"Array"===r?-1:"binary"===n?1:"binary"===r?-1:"string"===n?1:"string"===r?-1:"Date"===n?1:"Date"!==r?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return Tt(It(e),It(t));case"Array":return Dt(e,t)}}catch(e){}return NaN}function Dt(e,t){for(var n=e.length,r=t.length,o=n<r?n:r,i=0;i<o;++i){var a=jt(e[i],t[i]);if(0!==a)return a}return n===r?0:n<r?-1:1}function Tt(e,t){for(var n=e.length,r=t.length,o=n<r?n:r,i=0;i<o;++i)if(e[i]!==t[i])return e[i]<t[i]?-1:1;return n===r?0:n<r?-1:1}function Bt(e){var t=typeof e;if("object"!==t)return t;if(ArrayBuffer.isView(e))return"binary";var n=q(e);return"ArrayBuffer"===n?"binary":n}function It(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function Rt(e,t,n){var r=e.schema.yProps;return r?(t&&n.numFailures>0&&(t=t.filter(function(e,t){return!n.failures[t]})),Promise.all(r.map(function(n){var r=n.updatesTable;return t?e.db.table(r).where("k").anyOf(t).delete():e.db.table(r).clear()})).then(function(){return n})):n}var qt=function(){function e(e){this["@@propmod"]=e}return e.prototype.execute=function(e){var t,n=this["@@propmod"];if(void 0!==n.add){var o=n.add;if(a(o))return r(r([],a(e)?e:[],!0),o,!0).sort();if("number"==typeof o)return(Number(e)||0)+o;if("bigint"==typeof o)try{return BigInt(e)+o}catch(e){return BigInt(0)+o}throw new TypeError("Invalid term ".concat(o))}if(void 0!==n.remove){var i=n.remove;if(a(i))return a(e)?e.filter(function(e){return!i.includes(e)}).sort():[];if("number"==typeof i)return Number(e)-i;if("bigint"==typeof i)try{return BigInt(e)-i}catch(e){return BigInt(0)-i}throw new TypeError("Invalid subtrahend ".concat(i))}var u=null===(t=n.replacePrefix)||void 0===t?void 0:t[0];return u&&"string"==typeof e&&e.startsWith(u)?n.replacePrefix[1]+e.substring(u.length):e},e}();function Mt(e,t){for(var n=i(t),r=n.length,o=!1,a=0;a<r;++a){var u=n[a],s=t[u],c=_(e,u);s instanceof qt?(E(e,u,s.execute(c)),o=!0):c!==s&&(E(e,u,s),o=!0)}return o}var $t=function(){function e(){}return e.prototype._trans=function(e,t,n){var r=this._tx||De.trans,o=this.name,i=de&&"undefined"!=typeof console&&console.createTask&&console.createTask("Dexie: ".concat("readonly"===e?"read":"write"," ").concat(this.name));function a(e,n,r){if(!r.schema[o])throw new Z.NotFound("Table "+o+" not part of transaction");return t(r.idbtrans,r)}var u=Ve();try{var s=r&&r.db._novip===this.db._novip?r===De.trans?r._promise(e,a,n):it(function(){return r._promise(e,a,n)},{trans:r,transless:De.transless||De}):vt(this.db,e,[this.name],a);return i&&(s._consoleTask=i,s=s.catch(function(e){return console.trace(e),mt(e)})),s}finally{u&&We()}},e.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):null==e?mt(new Z.Type("Invalid argument to Table.get()")):this._trans("readonly",function(t){return n.core.get({trans:t,key:e}).then(function(e){return n.hook.reading.fire(e)})}).then(t)},e.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(a(e))return new this.db.WhereClause(this,"[".concat(e.join("+"),"]"));var t=i(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(e){if(e.compound&&t.every(function(t){return e.keyPath.indexOf(t)>=0})){for(var n=0;n<t.length;++n)if(-1===t.indexOf(e.keyPath[n]))return!1;return!0}return!1}).sort(function(e,t){return e.keyPath.length-t.keyPath.length})[0];if(n&&this.db._maxKey!==bt){var r=n.keyPath.slice(0,t.length);return this.where(r).equals(r.map(function(t){return e[t]}))}!n&&de&&console.warn("The query ".concat(JSON.stringify(e)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(t.join("+"),"]"));var o=this.schema.idxByName;function u(e,t){return 0===jt(e,t)}var s=t.reduce(function(t,n){var r=t[0],i=t[1],s=o[n],c=e[n];return[r||s,r||!s?At(i,s&&s.multi?function(e){var t=_(e,n);return a(t)&&t.some(function(e){return u(c,e)})}:function(e){return u(c,_(e,n))}):i]},[null,null]),c=s[0],l=s[1];return c?this.where(c.name).equals(e[c.keyPath]).filter(l):n?this.filter(l):this.where(t).equals("")},e.prototype.filter=function(e){return this.toCollection().and(e)},e.prototype.count=function(e){return this.toCollection().count(e)},e.prototype.offset=function(e){return this.toCollection().offset(e)},e.prototype.limit=function(e){return this.toCollection().limit(e)},e.prototype.each=function(e){return this.toCollection().each(e)},e.prototype.toArray=function(e){return this.toCollection().toArray(e)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,a(e)?"[".concat(e.join("+"),"]"):e))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(e){var n=this,r=n.db,o=n.name;this.schema.mappedClass=e,e.prototype instanceof Kt&&(e=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),Object.defineProperty(n.prototype,"db",{get:function(){return r},enumerable:!1,configurable:!0}),n.prototype.table=function(){return o},n}(e));for(var i=new Set,a=e.prototype;a;a=s(a))Object.getOwnPropertyNames(a).forEach(function(e){return i.add(e)});var u=function(t){if(!t)return t;var n=Object.create(e.prototype);for(var r in t)if(!i.has(r))try{n[r]=t[r]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=u,this.hook("reading",u),e},e.prototype.defineClass=function(){function e(e){u(this,e)}return this.mapToClass(e)},e.prototype.add=function(e,t){var n=this,r=this.schema.primKey,o=r.auto,i=r.keyPath,a=e;return i&&o&&(a=St(i)(e)),this._trans("readwrite",function(e){return n.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[a]})}).then(function(e){return e.numFailures?Re.reject(e.failures[0]):e.lastResult}).then(function(t){if(i)try{E(e,i,t)}catch(e){}return t})},e.prototype.upsert=function(e,t){var n=this,r=this.schema.primKey.keyPath;return this._trans("readwrite",function(o){return n.core.get({trans:o,key:e}).then(function(i){var a=null!=i?i:{};return Mt(a,t),r&&E(a,r,e),n.core.mutate({trans:o,type:"put",values:[a],keys:[e],upsert:!0,updates:{keys:[e],changeSpecs:[t]}}).then(function(e){return e.numFailures?Re.reject(e.failures[0]):!!i})})})},e.prototype.update=function(e,t){if("object"!=typeof e||a(e))return this.where(":id").equals(e).modify(t);var n=_(e,this.schema.primKey.keyPath);return void 0===n?mt(new Z.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(n).modify(t)},e.prototype.put=function(e,t){var n=this,r=this.schema.primKey,o=r.auto,i=r.keyPath,a=e;return i&&o&&(a=St(i)(e)),this._trans("readwrite",function(e){return n.core.mutate({trans:e,type:"put",values:[a],keys:null!=t?[t]:null})}).then(function(e){return e.numFailures?Re.reject(e.failures[0]):e.lastResult}).then(function(t){if(i)try{E(e,i,t)}catch(e){}return t})},e.prototype.delete=function(e){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]}).then(function(n){return Rt(t,[e],n)}).then(function(e){return e.numFailures?Re.reject(e.failures[0]):void 0})})},e.prototype.clear=function(){var e=this;return this._trans("readwrite",function(t){return e.core.mutate({trans:t,type:"deleteRange",range:Ct}).then(function(t){return Rt(e,null,t)})}).then(function(e){return e.numFailures?Re.reject(e.failures[0]):void 0})},e.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",function(n){return t.core.getMany({keys:e,trans:n}).then(function(e){return e.map(function(e){return t.hook.reading.fire(e)})})})},e.prototype.bulkAdd=function(e,t,n){var r=this,o=Array.isArray(t)?t:void 0,i=(n=n||(o?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(t){var n=r.schema.primKey,a=n.auto,u=n.keyPath;if(u&&o)throw new Z.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new Z.InvalidArgument("Arguments objects and keys must have the same length");var s=e.length,c=u&&a?e.map(St(u)):e;return r.core.mutate({trans:t,type:"add",keys:o,values:c,wantResults:i}).then(function(e){var t=e.numFailures,n=e.results,o=e.lastResult,a=e.failures;if(0===t)return i?n:o;throw new G("".concat(r.name,".bulkAdd(): ").concat(t," of ").concat(s," operations failed"),a)})})},e.prototype.bulkPut=function(e,t,n){var r=this,o=Array.isArray(t)?t:void 0,i=(n=n||(o?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",function(t){var n=r.schema.primKey,a=n.auto,u=n.keyPath;if(u&&o)throw new Z.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(o&&o.length!==e.length)throw new Z.InvalidArgument("Arguments objects and keys must have the same length");var s=e.length,c=u&&a?e.map(St(u)):e;return r.core.mutate({trans:t,type:"put",keys:o,values:c,wantResults:i}).then(function(e){var t=e.numFailures,n=e.results,o=e.lastResult,a=e.failures;if(0===t)return i?n:o;throw new G("".concat(r.name,".bulkPut(): ").concat(t," of ").concat(s," operations failed"),a)})})},e.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map(function(e){return e.key}),o=e.map(function(e){return e.changes}),i=[];return this._trans("readwrite",function(a){return n.getMany({trans:a,keys:r,cache:"clone"}).then(function(u){var s=[],c=[];e.forEach(function(e,n){var r=e.key,o=e.changes,a=u[n];if(a){for(var l=0,f=Object.keys(o);l<f.length;l++){var d=f[l],h=o[d];if(d===t.schema.primKey.keyPath){if(0!==jt(h,r))throw new Z.Constraint("Cannot update primary key in bulkUpdate()")}else E(a,d,h)}i.push(n),s.push(r),c.push(a)}});var l=s.length;return n.mutate({trans:a,type:"put",keys:s,values:c,updates:{keys:r,changeSpecs:o}}).then(function(e){var n=e.numFailures,r=e.failures;if(0===n)return l;for(var o=0,a=Object.keys(r);o<a.length;o++){var u=a[o],s=i[Number(u)];if(null!=s){var c=r[u];delete r[u],r[s]=c}}throw new G("".concat(t.name,".bulkUpdate(): ").concat(n," of ").concat(l," operations failed"),r)})})})},e.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"delete",keys:e}).then(function(n){return Rt(t,e,n)})}).then(function(e){var r=e.numFailures,o=e.lastResult,i=e.failures;if(0===r)return o;throw new G("".concat(t.name,".bulkDelete(): ").concat(r," of ").concat(n," operations failed"),i)})},e}();function Ft(e){var t={},n=function(n,r){if(r){for(var o=arguments.length,i=new Array(o-1);--o;)i[o-1]=arguments[o];return t[n].subscribe.apply(null,i),e}if("string"==typeof n)return t[n]};n.addEventType=u;for(var r=1,o=arguments.length;r<o;++r)u(arguments[r]);return n;function u(e,r,o){if("object"==typeof e)return s(e);r||(r=le),o||(o=re);var i={subscribers:[],fire:o,subscribe:function(e){-1===i.subscribers.indexOf(e)&&(i.subscribers.push(e),i.fire=r(i.fire,e))},unsubscribe:function(e){i.subscribers=i.subscribers.filter(function(t){return t!==e}),i.fire=i.subscribers.reduce(r,o)}};return t[e]=n[e]=i,i}function s(e){i(e).forEach(function(t){var n=e[t];if(a(n))u(t,e[t][0],e[t][1]);else{if("asap"!==n)throw new Z.InvalidArgument("Invalid event config");var r=u(t,oe,function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];r.subscribers.forEach(function(e){x(function(){e.apply(null,t)})})})}})}}function Nt(e,t){return p(t).from({prototype:e}),t}function Lt(e){return Nt($t.prototype,function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:Ft(null,{creating:[ue,re],reading:[ie,oe],updating:[ce,re],deleting:[se,re]})})}function zt(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function Ut(e,t){e.filter=At(e.filter,t)}function Vt(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return At(r(),t())}:t,e.justLimit=n&&!r}function Wt(e,t){e.isMatch=At(e.isMatch,t)}function Yt(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new Z.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function Ht(e,t,n){var r=Yt(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function Qt(e,t,n,r){var o=e.replayFilter?At(e.filter,e.replayFilter()):e.filter;if(e.or){var i={},a=function(e,n,r){if(!o||o(n,r,function(e){return n.stop(e)},function(e){return n.fail(e)})){var a=n.primaryKey,u=""+a;"[object ArrayBuffer]"===u&&(u=""+new Uint8Array(a)),l(i,u)||(i[u]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(a,n),Gt(Ht(e,r,n),e.algorithm,a,!e.keysOnly&&e.valueMapper)])}return Gt(Ht(e,r,n),At(e.algorithm,o),t,!e.keysOnly&&e.valueMapper)}function Gt(e,t,n,r){var o=Je(r?function(e,t,o){return n(r(e),t,o)}:n);return e.then(function(e){if(e)return e.start(function(){var n=function(){return e.continue()};t&&!t(e,function(e){return n=e},function(t){e.stop(t),n=re},function(t){e.fail(t),n=re})||o(e.value,e,function(e){return n=e}),n()})})}var Xt=function(){function e(){}return e.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,mt.bind(null,n.error)):n.table._trans("readonly",e).then(t)},e.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,mt.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},e.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=At(t.algorithm,e)},e.prototype._iterate=function(e,t){return Qt(this._ctx,e,t,this._ctx.table.core)},e.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&u(n,e),t._ctx=n,t},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return Qt(t,e,n,t.table.core)})},e.prototype.count=function(e){var t=this;return this._read(function(e){var n=t._ctx,r=n.table.core;if(zt(n,!0))return r.count({trans:e,query:{index:Yt(n,r.schema),range:n.range}}).then(function(e){return Math.min(e,n.limit)});var o=0;return Qt(n,function(){return++o,!1},e,r).then(function(){return o})}).then(e)},e.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],o=n.length-1;function i(e,t){return t?i(e[n[t]],t-1):e[r]}var a="next"===this._ctx.dir?1:-1;function u(e,t){return jt(i(e,o),i(t,o))*a}return this.toArray(function(e){return e.sort(u)}).then(t)},e.prototype.toArray=function(e){var t=this;return this._read(function(e){var n=t._ctx;if("next"===n.dir&&zt(n,!0)&&n.limit>0){var r=n.valueMapper,o=Yt(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:o,range:n.range}}).then(function(e){var t=e.result;return r?t.map(r):t})}var i=[];return Qt(n,function(e){return i.push(e)},e,n.table.core).then(function(){return i})},e)},e.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,zt(t)?Vt(t,function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n(function(){e.advance(t),t=0}),!1))}}):Vt(t,function(){var t=e;return function(){return--t<0}})),this},e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Vt(this._ctx,function(){var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}},!0),this},e.prototype.until=function(e,t){return Ut(this._ctx,function(n,r,o){return!e(n.value)||(r(o),t)}),this},e.prototype.first=function(e){return this.limit(1).toArray(function(e){return e[0]}).then(e)},e.prototype.last=function(e){return this.reverse().first(e)},e.prototype.filter=function(e){return Ut(this._ctx,function(t){return e(t.value)}),Wt(this._ctx,e),this},e.prototype.and=function(e){return this.filter(e)},e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},e.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.key,n)})},e.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},e.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.primaryKey,n)})},e.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(e,t){n.push(t.key)}).then(function(){return n}).then(e)},e.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&zt(t,!0)&&t.limit>0)return this._read(function(e){var n=Yt(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})}).then(function(e){return e.result}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(e,t){n.push(t.primaryKey)}).then(function(){return n}).then(e)},e.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},e.prototype.firstKey=function(e){return this.limit(1).keys(function(e){return e[0]}).then(e)},e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},e.prototype.distinct=function(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return Ut(this._ctx,function(e){var t=e.primaryKey.toString(),r=l(n,t);return n[t]=!0,!r}),this},e.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(r){var o;o="function"==typeof e?e:function(t){return Mt(t,e)};var a=n.table.core,u=a.schema.primaryKey,s=u.outbound,c=u.extractKey,l=200,f=t.db._options.modifyChunkSize;f&&(l="object"==typeof f?f[a.name]||f["*"]||200:f);var d=[],h=0,p=[],y=function(e,t){var n=t.failures,r=t.numFailures;h+=e-r;for(var o=0,a=i(n);o<a.length;o++){var u=a[o];d.push(n[u])}},m=e===Jt;return t.clone().primaryKeys().then(function(t){var i=zt(n)&&n.limit===1/0&&("function"!=typeof e||m)&&{index:n.index,range:n.range},u=function(f){var d=Math.min(l,t.length-f),h=t.slice(f,f+d);return(m?Promise.resolve([]):a.getMany({trans:r,keys:h,cache:"immutable"})).then(function(p){var v=[],g=[],b=s?[]:null,w=m?h:[];if(!m)for(var x=0;x<d;++x){var k=p[x],_={value:B(k),primKey:t[f+x]};!1!==o.call(_,_.value,_)&&(null==_.value?w.push(t[f+x]):s||0===jt(c(k),c(_.value))?(g.push(_.value),s&&b.push(t[f+x])):(w.push(t[f+x]),v.push(_.value)))}return Promise.resolve(v.length>0&&a.mutate({trans:r,type:"add",values:v}).then(function(e){for(var t in e.failures)w.splice(parseInt(t),1);y(v.length,e)})).then(function(){return(g.length>0||i&&"object"==typeof e)&&a.mutate({trans:r,type:"put",keys:b,values:g,criteria:i,changeSpec:"function"!=typeof e&&e,isAdditionalChunk:f>0}).then(function(e){return y(g.length,e)})}).then(function(){return(w.length>0||i&&m)&&a.mutate({trans:r,type:"delete",keys:w,criteria:i,isAdditionalChunk:f>0}).then(function(e){return Rt(n.table,w,e)}).then(function(e){return y(w.length,e)})}).then(function(){return t.length>f+d&&u(f+l)})})};return u(0).then(function(){if(d.length>0)throw new Q("Error modifying one or more objects",d,h,p);return t.length})})})},e.prototype.delete=function(){var e=this._ctx,t=e.range;return!zt(e)||e.table.schema.yProps||!e.isPrimKey&&3!==t.type?this.modify(Jt):this._write(function(n){var r=e.table.core.schema.primaryKey,o=t;return e.table.core.count({trans:n,query:{index:r,range:o}}).then(function(t){return e.table.core.mutate({trans:n,type:"deleteRange",range:o}).then(function(e){var n=e.failures,r=e.numFailures;if(r)throw new Q("Could not delete some values",Object.keys(n).map(function(e){return n[e]}),t-r);return t-r})})})},e}(),Jt=function(e,t){return t.value=null};function Zt(e){return Nt(Xt.prototype,function(t,n){this.db=e;var r=Ct,o=null;if(n)try{r=n()}catch(e){o=e}var i=t._ctx,a=i.table,u=a.hook.reading.fire;this._ctx={table:a,index:i.index,isPrimKey:!i.index||a.schema.primKey.keyPath&&i.index===a.schema.primKey.name,range:r,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:o,or:i.or,valueMapper:u!==oe?u:null}})}function en(e,t){return e<t?-1:e===t?0:1}function tn(e,t){return e>t?-1:e===t?0:1}function nn(e,t,n){var r=e instanceof fn?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function rn(e){return new e.Collection(e,function(){return ln("")}).limit(0)}function on(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}function an(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}function un(e,t,n,r,o,i){for(var a=Math.min(e.length,r.length),u=-1,s=0;s<a;++s){var c=t[s];if(c!==r[s])return o(e[s],n[s])<0?e.substr(0,s)+n[s]+n.substr(s+1):o(e[s],r[s])<0?e.substr(0,s)+r[s]+n.substr(s+1):u>=0?e.substr(0,u)+t[u]+n.substr(u+1):null;o(e[s],c)<0&&(u=s)}return a<r.length&&"next"===i?e+n.substr(e.length):a<e.length&&"prev"===i?e.substr(0,n.length):u<0?null:e.substr(0,u)+r[u]+n.substr(u+1)}function sn(e,t,n,r){var o,i,a,u,s,c,l,f=n.length;if(!n.every(function(e){return"string"==typeof e}))return nn(e,kt);function d(e){o=on(e),i=an(e),a="next"===e?en:tn;var t=n.map(function(e){return{lower:i(e),upper:o(e)}}).sort(function(e,t){return a(e.lower,t.lower)});u=t.map(function(e){return e.upper}),s=t.map(function(e){return e.lower}),c=e,l="next"===e?"":r}d("next");var h=new e.Collection(e,function(){return cn(u[0],s[f-1]+r)});h._ondirectionchange=function(e){d(e)};var p=0;return h._addAlgorithm(function(e,n,r){var o=e.key;if("string"!=typeof o)return!1;var d=i(o);if(t(d,s,p))return!0;for(var h=null,y=p;y<f;++y){var m=un(o,d,u[y],s[y],a,c);null===m&&null===h?p=y+1:(null===h||a(h,m)>0)&&(h=m)}return n(null!==h?function(){e.continue(h+l)}:r),!1}),h}function cn(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function ln(e){return{type:1,lower:e,upper:e}}var fn=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?rn(this):new this.Collection(this,function(){return cn(e,t,!n,!r)})}catch(e){return nn(this,xt)}},e.prototype.equals=function(e){return null==e?nn(this,xt):new this.Collection(this,function(){return ln(e)})},e.prototype.above=function(e){return null==e?nn(this,xt):new this.Collection(this,function(){return cn(e,void 0,!0)})},e.prototype.aboveOrEqual=function(e){return null==e?nn(this,xt):new this.Collection(this,function(){return cn(e,void 0,!1)})},e.prototype.below=function(e){return null==e?nn(this,xt):new this.Collection(this,function(){return cn(void 0,e,!1,!0)})},e.prototype.belowOrEqual=function(e){return null==e?nn(this,xt):new this.Collection(this,function(){return cn(void 0,e)})},e.prototype.startsWith=function(e){return"string"!=typeof e?nn(this,kt):this.between(e,e+bt,!0,!0)},e.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):sn(this,function(e,t){return 0===e.indexOf(t[0])},[e],bt)},e.prototype.equalsIgnoreCase=function(e){return sn(this,function(e,t){return e===t[0]},[e],"")},e.prototype.anyOfIgnoreCase=function(){var e=L.apply(N,arguments);return 0===e.length?rn(this):sn(this,function(e,t){return-1!==t.indexOf(e)},e,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var e=L.apply(N,arguments);return 0===e.length?rn(this):sn(this,function(e,t){return t.some(function(t){return 0===e.indexOf(t)})},e,bt)},e.prototype.anyOf=function(){var e=this,t=L.apply(N,arguments),n=this._cmp;try{t.sort(n)}catch(e){return nn(this,xt)}if(0===t.length)return rn(this);var r=new this.Collection(this,function(){return cn(t[0],t[t.length-1])});r._ondirectionchange=function(r){n="next"===r?e._ascending:e._descending,t.sort(n)};var o=0;return r._addAlgorithm(function(e,r,i){for(var a=e.key;n(a,t[o])>0;)if(++o===t.length)return r(i),!1;return 0===n(a,t[o])||(r(function(){e.continue(t[o])}),!1)}),r},e.prototype.notEqual=function(e){return this.inAnyRange([[wt,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var e=L.apply(N,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return nn(this,xt)}var t=e.reduce(function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[wt,t]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(e,t){var n=this,r=this._cmp,o=this._ascending,i=this._descending,a=this._min,u=this._max;if(0===e.length)return rn(this);if(!e.every(function(e){return void 0!==e[0]&&void 0!==e[1]&&o(e[0],e[1])<=0}))return nn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Z.InvalidArgument);var s=!t||!1!==t.includeLowers,c=t&&!0===t.includeUppers;function l(e,t){for(var n=0,o=e.length;n<o;++n){var i=e[n];if(r(t[0],i[1])<0&&r(t[1],i[0])>0){i[0]=a(i[0],t[0]),i[1]=u(i[1],t[1]);break}}return n===o&&e.push(t),e}var f,d=o;function h(e,t){return d(e[0],t[0])}try{(f=e.reduce(l,[])).sort(h)}catch(e){return nn(this,xt)}var p=0,y=c?function(e){return o(e,f[p][1])>0}:function(e){return o(e,f[p][1])>=0},m=s?function(e){return i(e,f[p][0])>0}:function(e){return i(e,f[p][0])>=0};function v(e){return!y(e)&&!m(e)}var g=y,b=new this.Collection(this,function(){return cn(f[0][0],f[f.length-1][1],!s,!c)});return b._ondirectionchange=function(e){"next"===e?(g=y,d=o):(g=m,d=i),f.sort(h)},b._addAlgorithm(function(e,t,r){for(var i=e.key;g(i);)if(++p===f.length)return t(r),!1;return!!v(i)||(0===n._cmp(i,f[p][1])||0===n._cmp(i,f[p][0])||t(function(){d===o?e.continue(f[p][0]):e.continue(f[p][1])}),!1)}),b},e.prototype.startsWithAnyOf=function(){var e=L.apply(N,arguments);return e.every(function(e){return"string"==typeof e})?0===e.length?rn(this):this.inAnyRange(e.map(function(e){return[e,e+bt]})):nn(this,"startsWithAnyOf() only works with strings")},e}();function dn(e){return Nt(fn.prototype,function(t,n,r){if(this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r},this._cmp=this._ascending=jt,this._descending=function(e,t){return jt(t,e)},this._max=function(e,t){return jt(e,t)>0?e:t},this._min=function(e,t){return jt(e,t)<0?e:t},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new Z.MissingAPI})}function hn(e){return Je(function(t){return pn(t),e(t.target.error),!1})}function pn(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var yn="storagemutated",mn="x-storagemutated-1",vn=Ft(null,yn),gn=function(){function e(){}return e.prototype._lock=function(){return w(!De.global),++this._reculock,1!==this._reculock||De.global||(De.lockOwnerFor=this),this},e.prototype._unlock=function(){if(w(!De.global),0===--this._reculock)for(De.global||(De.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{ht(e[1],e[0])}catch(e){}}return this},e.prototype._locked=function(){return this._reculock&&De.lockOwnerFor!==this},e.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(w(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new Z.DatabaseClosed(r);case"MissingAPIError":throw new Z.MissingAPI(r.message,r);default:throw new Z.OpenFailed(r)}if(!this.active)throw new Z.TransactionInactive;return w(null===this._completion._state),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Je(function(n){pn(n),t._reject(e.error)}),e.onabort=Je(function(n){pn(n),t.active&&t._reject(new Z.Abort(e.error)),t.active=!1,t.on("abort").fire(n)}),e.oncomplete=Je(function(){t.active=!1,t._resolve(),"mutatedParts"in e&&vn.storagemutated.fire(e.mutatedParts)}),this},e.prototype._promise=function(e,t,n){var r=this;if("readwrite"===e&&"readwrite"!==this.mode)return mt(new Z.ReadOnly("Transaction is readonly"));if(!this.active)return mt(new Z.TransactionInactive);if(this._locked())return new Re(function(o,i){r._blockedFuncs.push([function(){r._promise(e,t,n).then(o,i)},De])});if(n)return it(function(){var e=new Re(function(e,n){r._lock();var o=t(e,n,r);o&&o.then&&o.then(e,n)});return e.finally(function(){return r._unlock()}),e._lib=!0,e});var o=new Re(function(e,n){var o=t(e,n,r);o&&o.then&&o.then(e,n)});return o._lib=!0,o},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(e){var t=this._root(),n=Re.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then(function(){return n});else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var o=t._waitingFor;return new Re(function(e,r){n.then(function(n){return t._waitingQueue.push(Je(e.bind(null,n)))},function(e){return t._waitingQueue.push(Je(r.bind(null,e)))}).finally(function(){t._waitingFor===o&&(t._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Z.Abort))},e.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(l(t,e))return t[e];var n=this.schema[e];if(!n)throw new Z.NotFound("Table "+e+" not part of transaction");var r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r},e}();function bn(e){return Nt(gn.prototype,function(t,n,r,o,i){var a=this;"readonly"!==t&&n.forEach(function(e){var t,o=null===(t=r[e])||void 0===t?void 0:t.yProps;o&&(n=n.concat(o.map(function(e){return e.updatesTable})))}),this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.chromeTransactionDurability=o,this.idbtrans=null,this.on=Ft(this,"complete","error","abort"),this.parent=i||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Re(function(e,t){a._resolve=e,a._reject=t}),this._completion.then(function(){a.active=!1,a.on.complete.fire()},function(e){var t=a.active;return a.active=!1,a.on.error.fire(e),a.parent?a.parent._reject(e):t&&a.idbtrans&&a.idbtrans.abort(),mt(e)})})}function wn(e,t,n,r,o,i,a,u){return{name:e,keyPath:t,unique:n,multi:r,auto:o,compound:i,src:(n&&!a?"&":"")+(r?"*":"")+(o?"++":"")+xn(t),type:u}}function xn(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function kn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:k(n,function(e){return[e.name,e]})}}function _n(e){return 1===e.length?e[0]:e}var En=function(e){try{return e.only([[]]),En=function(){return[[]]},[[]]}catch(e){return En=function(){return bt},bt}};function On(e){return null==e?function(){}:"string"==typeof e?Pn(e):function(t){return _(t,e)}}function Pn(e){return 1===e.split(".").length?function(t){return t[e]}:function(t){return _(t,e)}}function An(e){return[].slice.call(e)}var Cn=0;function Sn(e){return null==e?":id":"string"==typeof e?e:"[".concat(e.join("+"),"]")}function Kn(e,t,n){function r(e,t){var n=An(e.objectStoreNames);return{schema:{name:e.name,tables:n.map(function(e){return t.objectStore(e)}).map(function(e){var t=e.keyPath,n=e.autoIncrement,r=a(t),o=null==t,i={},u={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:o,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:On(t)},indexes:An(e.indexNames).map(function(t){return e.index(t)}).map(function(e){var t=e.name,n=e.unique,r=e.multiEntry,o=e.keyPath,u={name:t,compound:a(o),keyPath:o,unique:n,multiEntry:r,extractKey:On(o)};return i[Sn(o)]=u,u}),getIndexByKeyPath:function(e){return i[Sn(e)]}};return i[":id"]=u.primaryKey,null!=t&&(i[Sn(t)]=u.primaryKey),u})},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function o(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var n=e.lower,r=e.upper,o=e.lowerOpen,i=e.upperOpen;return void 0===n?void 0===r?null:t.upperBound(r,!!i):void 0===r?t.lowerBound(n,!!o):t.bound(n,r,!!o,!!i)}function i(e){var t=e.name;function n(e){var n=e.trans,r=e.type,i=e.keys,a=e.values,u=e.range;return new Promise(function(e,s){e=Je(e);var c=n.objectStore(t),l=null==c.keyPath,f="put"===r||"add"===r;if(!f&&"delete"!==r&&"deleteRange"!==r)throw new Error("Invalid operation type: "+r);var d,h=(i||a||{length:1}).length;if(i&&a&&i.length!==a.length)throw new Error("Given keys array must have same length as given values array.");if(0===h)return e({numFailures:0,failures:{},results:[],lastResult:void 0});var p=[],y=[],m=0,v=function(e){++m,pn(e)};if("deleteRange"===r){if(4===u.type)return e({numFailures:m,failures:y,results:[],lastResult:void 0});3===u.type?p.push(d=c.clear()):p.push(d=c.delete(o(u)))}else{var g=f?l?[a,i]:[a,null]:[i,null],b=g[0],w=g[1];if(f)for(var x=0;x<h;++x)p.push(d=w&&void 0!==w[x]?c[r](b[x],w[x]):c[r](b[x])),d.onerror=v;else for(x=0;x<h;++x)p.push(d=c[r](b[x])),d.onerror=v}var k=function(t){var n=t.target.result;p.forEach(function(e,t){return null!=e.error&&(y[t]=e.error)}),e({numFailures:m,failures:y,results:"delete"===r?i:p.map(function(e){return e.result}),lastResult:n})};d.onerror=function(e){v(e),k(e)},d.onsuccess=k})}function r(e){var n=e.trans,r=e.values,i=e.query,a=e.reverse,u=e.unique;return new Promise(function(e,s){e=Je(e);var c=i.index,l=i.range,f=n.objectStore(t),d=c.isPrimaryKey?f:f.index(c.name),h=a?u?"prevunique":"prev":u?"nextunique":"next",p=r||!("openKeyCursor"in d)?d.openCursor(o(l),h):d.openKeyCursor(o(l),h);p.onerror=hn(s),p.onsuccess=Je(function(t){var r=p.result;if(r){r.___id=++Cn,r.done=!1;var o=r.continue.bind(r),i=r.continuePrimaryKey;i&&(i=i.bind(r));var a=r.advance.bind(r),u=function(){throw new Error("Cursor not started")},c=function(){throw new Error("Cursor not stopped")};r.trans=n,r.stop=r.continue=r.continuePrimaryKey=r.advance=u,r.fail=Je(s),r.next=function(){var e=this,t=1;return this.start(function(){return t--?e.continue():e.stop()}).then(function(){return e})},r.start=function(e){var t=new Promise(function(e,t){e=Je(e),p.onerror=hn(t),r.fail=t,r.stop=function(t){r.stop=r.continue=r.continuePrimaryKey=r.advance=c,e(t)}}),n=function(){if(p.result)try{e()}catch(e){r.fail(e)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()};return p.onsuccess=Je(function(e){p.onsuccess=n,n()}),r.continue=o,r.continuePrimaryKey=i,r.advance=a,n(),t},e(r)}else e(null)},s)})}function i(e){return function(n){return new Promise(function(r,i){r=Je(r);var a=n.trans,u=n.values,s=n.limit,c=n.query,l=s===1/0?void 0:s,f=c.index,d=c.range,h=a.objectStore(t),p=f.isPrimaryKey?h:h.index(f.name),y=o(d);if(0===s)return r({result:[]});if(e){var m=u?p.getAll(y,l):p.getAllKeys(y,l);m.onsuccess=function(e){return r({result:e.target.result})},m.onerror=hn(i)}else{var v=0,g=u||!("openKeyCursor"in p)?p.openCursor(y):p.openKeyCursor(y),b=[];g.onsuccess=function(e){var t=g.result;return t?(b.push(u?t.value:t.primaryKey),++v===s?r({result:b}):void t.continue()):r({result:b})},g.onerror=hn(i)}})}}return{name:t,schema:e,mutate:n,getMany:function(e){var n=e.trans,r=e.keys;return new Promise(function(e,o){e=Je(e);for(var i,a=n.objectStore(t),u=r.length,s=new Array(u),c=0,l=0,f=function(t){var n=t.target;s[n._pos]=n.result,++l===c&&e(s)},d=hn(o),h=0;h<u;++h)null!=r[h]&&((i=a.get(r[h]))._pos=h,i.onsuccess=f,i.onerror=d,++c);0===c&&e(s)})},get:function(e){var n=e.trans,r=e.key;return new Promise(function(e,o){e=Je(e);var i=n.objectStore(t).get(r);i.onsuccess=function(t){return e(t.target.result)},i.onerror=hn(o)})},query:i(c),openCursor:r,count:function(e){var n=e.query,r=e.trans,i=n.index,a=n.range;return new Promise(function(e,n){var u=r.objectStore(t),s=i.isPrimaryKey?u:u.index(i.name),c=o(a),l=c?s.count(c):s.count();l.onsuccess=Je(function(t){return e(t.target.result)}),l.onerror=hn(n)})}}}var u=r(e,n),s=u.schema,c=u.hasGetAll,l=s.tables.map(function(e){return i(e)}),f={};return l.forEach(function(e){return f[e.name]=e}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!f[e])throw new Error("Table '".concat(e,"' not found"));return f[e]},MIN_KEY:-1/0,MAX_KEY:En(t),schema:s}}function jn(e,t){return t.reduce(function(e,t){var r=t.create;return n(n({},e),r(e))},e)}function Dn(e,t,n,r){var o=n.IDBKeyRange;return n.indexedDB,{dbcore:jn(Kn(t,o,r),e.dbcore)}}function Tn(e,t){var n=t.db,r=Dn(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach(function(t){var n=t.name;e.core.schema.tables.some(function(e){return e.name===n})&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))})}function Bn(e,t,n,r){n.forEach(function(n){var o=r[n];t.forEach(function(t){var r=m(t,n);(!r||"value"in r&&void 0===r.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?h(t,n,{get:function(){return this.table(n)},set:function(e){d(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,o))})})}function In(e,t){t.forEach(function(t){for(var n in t)t[n]instanceof e.Table&&delete t[n]})}function Rn(e,t){return e._cfg.version-t._cfg.version}function qn(e,t,n,r){var o=e._dbSchema;n.objectStoreNames.contains("$meta")&&!o.$meta&&(o.$meta=kn("$meta",Gn("")[0],[]),e._storeNames.push("$meta"));var a=e._createTransaction("readwrite",e._storeNames,o);a.create(n),a._completion.catch(r);var u=a._reject.bind(a),s=De.transless||De;it(function(){if(De.trans=a,De.transless=s,0!==t)return Tn(e,n),$n(e,a,t).then(function(t){return Fn(e,t,a,n)}).catch(u);i(o).forEach(function(e){Ln(n,e,o[e].primKey,o[e].indexes)}),Tn(e,n),Re.follow(function(){return e.on.populate.fire(a)}).catch(u)})}function Mn(e,t){zn(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains("$meta")||t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=Wn(e,e.idbdb,t);Qn(e,e._dbSchema,t);for(var r=function(e){if(e.change.length||e.recreate)return console.warn("Unable to patch indexes of table ".concat(e.name," because it has changes on the type of index or primary key.")),{value:void 0};var n=t.objectStore(e.name);e.add.forEach(function(t){de&&console.debug("Dexie upgrade patch: Creating missing index ".concat(e.name,".").concat(t.src)),Vn(n,t)})},o=0,i=Nn(n,e._dbSchema).change;o<i.length;o++){var a=r(i[o]);if("object"==typeof a)return a.value}}function $n(e,t,n){return t.storeNames.includes("$meta")?t.table("$meta").get("version").then(function(e){return null!=e?e:n}):Re.resolve(n)}function Fn(e,t,n,r){var o=[],a=e._versions,u=e._dbSchema=Wn(e,e.idbdb,r),s=a.filter(function(e){return e._cfg.version>=t});if(0===s.length)return Re.resolve();function c(){return o.length?Re.resolve(o.shift()(n.idbtrans)).then(c):Re.resolve()}return s.forEach(function(a){o.push(function(){var o=u,s=a._cfg.dbschema;Qn(e,o,r),Qn(e,s,r),u=e._dbSchema=s;var c=Nn(o,s);c.add.forEach(function(e){Ln(r,e[0],e[1].primKey,e[1].indexes)}),c.change.forEach(function(e){if(e.recreate)throw new Z.Upgrade("Not yet support for changing primary key");var t=r.objectStore(e.name);e.add.forEach(function(e){return Vn(t,e)}),e.change.forEach(function(e){t.deleteIndex(e.name),Vn(t,e)}),e.del.forEach(function(e){return t.deleteIndex(e)})});var l=a._cfg.contentUpgrade;if(l&&a._cfg.version>t){Tn(e,r),n._memoizedTables={};var f=P(s);c.del.forEach(function(e){f[e]=o[e]}),In(e,[e.Transaction.prototype]),Bn(e,[e.Transaction.prototype],i(f),f),n.schema=f;var d,h=z(l);h&&at();var p=Re.follow(function(){if((d=l(n))&&h){var e=ut.bind(null,null);d.then(e,e)}});return d&&"function"==typeof d.then?Re.resolve(d):p.then(function(){return d})}}),o.push(function(t){Un(a._cfg.dbschema,t),In(e,[e.Transaction.prototype]),Bn(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}),o.push(function(t){e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===a._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter(function(e){return"$meta"!==e})):t.objectStore("$meta").put(a._cfg.version,"version"))})}),c().then(function(){zn(u,r)})}function Nn(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var o=e[n],i=t[n];if(o){var a={name:n,def:i,recreate:!1,del:[],add:[],change:[]};if(""+(o.primKey.keyPath||"")!=""+(i.primKey.keyPath||"")||o.primKey.auto!==i.primKey.auto)a.recreate=!0,r.change.push(a);else{var u=o.idxByName,s=i.idxByName,c=void 0;for(c in u)s[c]||a.del.push(c);for(c in s){var l=u[c],f=s[c];l?l.src!==f.src&&a.change.push(f):a.add.push(f)}(a.del.length>0||a.add.length>0||a.change.length>0)&&r.change.push(a)}}else r.add.push([n,i])}return r}function Ln(e,t,n,r){var o=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(e){return Vn(o,e)}),o}function zn(e,t){i(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(de&&console.debug("Dexie: Creating missing table",n),Ln(t,n,e[n].primKey,e[n].indexes))})}function Un(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(n){return null==e[n]&&t.db.deleteObjectStore(n)})}function Vn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Wn(e,t,n){var r={};return g(t.objectStoreNames,0).forEach(function(e){for(var t=n.objectStore(e),o=t.keyPath,i=wn(xn(o),o||"",!0,!1,!!t.autoIncrement,o&&"string"!=typeof o,!0),a=[],u=0;u<t.indexNames.length;++u){var s=t.index(t.indexNames[u]);o=s.keyPath;var c=wn(s.name,o,!!s.unique,!!s.multiEntry,!1,o&&"string"!=typeof o,!1);a.push(c)}r[e]=kn(e,i,a)}),r}function Yn(e,t,n){e.verno=t.version/10;var r=e._dbSchema=Wn(e,t,n);e._storeNames=g(t.objectStoreNames,0),Bn(e,[e._allTables],i(r),r)}function Hn(e,t){var n=Nn(Wn(e,e.idbdb,t),e._dbSchema);return!(n.add.length||n.change.some(function(e){return e.add.length||e.change.length}))}function Qn(e,t,n){for(var r=n.db.objectStoreNames,i=0;i<r.length;++i){var a=r[i],u=n.objectStore(a);e._hasGetAll="getAll"in u;for(var s=0;s<u.indexNames.length;++s){var c=u.indexNames[s],l=u.index(c).keyPath,f="string"==typeof l?l:"["+g(l).join("+")+"]";if(t[a]){var d=t[a].idxByName[f];d&&(d.name=c,delete t[a].idxByName[f],t[a].idxByName[c]=d)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&o.WorkerGlobalScope&&o instanceof o.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function Gn(e){return e.split(",").map(function(e,t){var n,r=e.split(":"),o=null===(n=r[1])||void 0===n?void 0:n.trim(),i=(e=r[0].trim()).replace(/([&*]|\+\+)/g,""),u=/^\[/.test(i)?i.match(/^\[(.*)\]$/)[1].split("+"):i;return wn(i,u||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),a(u),0===t,o)})}var Xn,Jn=function(){function e(){}return e.prototype._createTableSchema=function(e,t,n){return kn(e,t,n)},e.prototype._parseIndexSyntax=function(e){return Gn(e)},e.prototype._parseStoresSpec=function(e,t){var n=this;i(e).forEach(function(r){if(null!==e[r]){var o=n._parseIndexSyntax(e[r]),i=o.shift();if(!i)throw new Z.Schema("Invalid schema for table "+r+": "+e[r]);if(i.unique=!0,i.multi)throw new Z.Schema("Primary key cannot be multiEntry*");o.forEach(function(e){if(e.auto)throw new Z.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new Z.Schema("Index must have a name and cannot be an empty string")});var a=n._createTableSchema(r,i,o);t[r]=a}})},e.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?u(this._cfg.storesSource,e):e;var n=t._versions,r={},o={};return n.forEach(function(e){u(r,e._cfg.storesSource),o=e._cfg.dbschema={},e._parseStoresSpec(r,o)}),t._dbSchema=o,In(t,[t._allTables,t,t.Transaction.prototype]),Bn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],i(o),o),t._storeNames=i(o),this},e.prototype.upgrade=function(e){return this._cfg.contentUpgrade=fe(this._cfg.contentUpgrade||re,e),this},e}();function Zn(e){return Nt(Jn.prototype,function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function er(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new to(Et,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function tr(e){return e&&"function"==typeof e.databases}function nr(e){var t=e.indexedDB,n=e.IDBKeyRange;return tr(t)?Promise.resolve(t.databases()).then(function(e){return e.map(function(e){return e.name}).filter(function(e){return e!==Et})}):er(t,n).toCollection().primaryKeys()}function rr(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!tr(n)&&t!==Et&&er(n,r).put({name:t}).catch(re)}function or(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!tr(n)&&t!==Et&&er(n,r).delete(t).catch(re)}function ir(e){return it(function(){return De.letThrough=!0,e()})}function ar(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(t){var n=function(){return indexedDB.databases().finally(t)};e=setInterval(n,100),n()}).finally(function(){return clearInterval(e)}):Promise.resolve()}function ur(e){return!("from"in e)}var sr=function(e,t){if(!this){var n=new sr;return e&&"d"in e&&u(n,e),n}u(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function cr(e,t,n){var r=jt(t,n);if(!isNaN(r)){if(r>0)throw RangeError();if(ur(e))return u(e,{from:t,to:n,d:1});var o=e.l,i=e.r;if(jt(n,e.from)<0)return o?cr(o,t,n):e.l={from:t,to:n,d:1,l:null,r:null},hr(e);if(jt(t,e.to)>0)return i?cr(i,t,n):e.r={from:t,to:n,d:1,l:null,r:null},hr(e);jt(t,e.from)<0&&(e.from=t,e.l=null,e.d=i?i.d+1:1),jt(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var a=!e.r;o&&!e.l&&lr(e,o),i&&a&&lr(e,i)}}function lr(e,t){function n(e,t){var r=t.from,o=t.to,i=t.l,a=t.r;cr(e,r,o),i&&n(e,i),a&&n(e,a)}ur(t)||n(e,t)}function fr(e,t){var n=dr(t),r=n.next();if(r.done)return!1;for(var o=r.value,i=dr(e),a=i.next(o.from),u=a.value;!r.done&&!a.done;){if(jt(u.from,o.to)<=0&&jt(u.to,o.from)>=0)return!0;jt(o.from,u.from)<0?o=(r=n.next(u.from)).value:u=(a=i.next(o.from)).value}return!1}function dr(e){var t=ur(e)?null:{s:0,n:e};return{next:function(e){for(var n=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&jt(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||jt(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function hr(e){var t,r,o=((null===(t=e.r)||void 0===t?void 0:t.d)||0)-((null===(r=e.l)||void 0===r?void 0:r.d)||0),i=o>1?"r":o<-1?"l":"";if(i){var a="r"===i?"l":"r",u=n({},e),s=e[i];e.from=s.from,e.to=s.to,e[i]=s[i],u[i]=s[a],e[a]=u,u.d=pr(u)}e.d=pr(e)}function pr(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function yr(e,t){return i(t).forEach(function(n){e[n]?lr(e[n],t[n]):e[n]=j(t[n])}),e}function mr(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&fr(t[n],e[n])})}f(sr.prototype,((Xn={add:function(e){return lr(this,e),this},addKey:function(e){return cr(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(e){return cr(t,e,e)}),this},hasKey:function(e){var t=dr(this).next(e).value;return t&&jt(t.from,e)<=0&&jt(t.to,e)>=0}})[M]=function(){return dr(this)},Xn));var vr={},gr={},br=!1;function wr(e,t){yr(gr,e),br||(br=!0,setTimeout(function(){br=!1;var e=gr;gr={},xr(e,!1)},0))}function xr(e,t){void 0===t&&(t=!1);var n=new Set;if(e.all)for(var r=0,o=Object.values(vr);r<o.length;r++)kr(u=o[r],e,n,t);else for(var i in e){var a=/^idb\:\/\/(.*)\/(.*)\//.exec(i);if(a){var u,s=a[1],c=a[2];(u=vr["idb://".concat(s,"/").concat(c)])&&kr(u,e,n,t)}}n.forEach(function(e){return e()})}function kr(e,t,n,r){for(var o=[],i=0,a=Object.entries(e.queries.query);i<a.length;i++){for(var u=a[i],s=u[0],c=[],l=0,f=u[1];l<f.length;l++){var d=f[l];mr(t,d.obsSet)?d.subscribers.forEach(function(e){return n.add(e)}):r&&c.push(d)}r&&o.push([s,c])}if(r)for(var h=0,p=o;h<p.length;h++){var y=p[h];s=y[0],c=y[1],e.queries.query[s]=c}}function _r(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?mt(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,o=Math.round(10*e.verno),i=!1;function a(){if(t.openCanceller!==r)throw new Z.DatabaseClosed("db.open() was cancelled")}var u=t.dbReadyResolve,s=null,c=!1,l=function(){return new Re(function(r,u){if(a(),!n)throw new Z.MissingAPI;var f=e.name,d=t.autoSchema||!o?n.open(f):n.open(f,o);if(!d)throw new Z.MissingAPI;d.onerror=hn(u),d.onblocked=Je(e._fireOnBlocked),d.onupgradeneeded=Je(function(r){if(s=d.transaction,t.autoSchema&&!e._options.allowEmptyDB){d.onerror=pn,s.abort(),d.result.close();var o=n.deleteDatabase(f);o.onsuccess=o.onerror=Je(function(){u(new Z.NoSuchDatabase("Database ".concat(f," doesnt exist")))})}else{s.onerror=hn(u);var a=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;c=a<1,e.idbdb=d.result,i&&Mn(e,s),qn(e,a/10,s,u)}},u),d.onsuccess=Je(function(){s=null;var n=e.idbdb=d.result,a=g(n.objectStoreNames);if(a.length>0)try{var u=n.transaction(_n(a),"readonly");if(t.autoSchema)Yn(e,n,u);else if(Qn(e,e._dbSchema,u),!Hn(e,u)&&!i)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),n.close(),o=n.version+1,i=!0,r(l());Tn(e,u)}catch(e){}_t.push(e),n.onversionchange=Je(function(n){t.vcFired=!0,e.on("versionchange").fire(n)}),n.onclose=Je(function(){e.close({disableAutoOpen:!1})}),c&&rr(e._deps,f),r()},u)}).catch(function(e){switch(null==e?void 0:e.name){case"UnknownError":if(t.PR1398_maxLoop>0)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),l();break;case"VersionError":if(o>0)return o=0,l()}return Re.reject(e)})};return Re.race([r,("undefined"==typeof navigator?Re.resolve():ar()).then(l)]).then(function(){return a(),t.onReadyBeingFired=[],Re.resolve(ir(function(){return e.on.ready.fire(e.vip)})).then(function n(){if(t.onReadyBeingFired.length>0){var r=t.onReadyBeingFired.reduce(fe,re);return t.onReadyBeingFired=[],Re.resolve(ir(function(){return r(e.vip)})).then(n)}})}).finally(function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(n){t.dbOpenError=n;try{s&&s.abort()}catch(e){}return r===t.openCanceller&&e._close(),mt(n)}).finally(function(){t.openComplete=!0,u()}).then(function(){if(c){var t={};e.tables.forEach(function(n){n.schema.indexes.forEach(function(r){r.name&&(t["idb://".concat(e.name,"/").concat(n.name,"/").concat(r.name)]=new sr(-1/0,[[[]]]))}),t["idb://".concat(e.name,"/").concat(n.name,"/")]=t["idb://".concat(e.name,"/").concat(n.name,"/:dels")]=new sr(-1/0,[[[]]])}),vn(yn).fire(t),xr(t,!0)}return e})}function Er(e){var t=function(t){return e.next(t)},n=function(t){return e.throw(t)},r=i(t),o=i(n);function i(e){return function(t){var n=e(t),i=n.value;return n.done?i:i&&"function"==typeof i.then?i.then(r,o):a(i)?Promise.all(i).then(r,o):r(i)}}return i(t)()}function Or(e,t,n){var r=arguments.length;if(r<2)throw new Z.InvalidArgument("Too few arguments");for(var o=new Array(r-1);--r;)o[r-1]=arguments[r];return n=o.pop(),[e,C(o),n]}function Pr(e,t,n,r,o){return Re.resolve().then(function(){var i=De.transless||De,a=e._createTransaction(t,n,e._dbSchema,r);a.explicit=!0;var u={trans:a,transless:i};if(r)a.idbtrans=r.idbtrans;else try{a.create(),a.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(r){return r.name===X.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return Pr(e,t,n,null,o)})):mt(r)}var s,c=z(o);c&&at();var l=Re.follow(function(){if(s=o.call(a,a))if(c){var e=ut.bind(null,null);s.then(e,e)}else"function"==typeof s.next&&"function"==typeof s.throw&&(s=Er(s))},u);return(s&&"function"==typeof s.then?Re.resolve(s).then(function(e){return a.active?e:mt(new Z.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):l.then(function(){return s})).then(function(e){return r&&a._resolve(),a._completion.then(function(){return e})}).catch(function(e){return a._reject(e),mt(e)})})}function Ar(e,t,n){for(var r=a(e)?e.slice():[e],o=0;o<n;++o)r.push(t);return r}function Cr(e){return n(n({},e),{table:function(t){var r=e.table(t),o=r.schema,i={},a=[];function u(e,t,r){var o=Sn(e),s=i[o]=i[o]||[],c=null==e?0:"string"==typeof e?1:e.length,l=t>0,f=n(n({},r),{name:l?"".concat(o,"(virtual-from:").concat(r.name,")"):r.name,lowLevelIndex:r,isVirtual:l,keyTail:t,keyLength:c,extractKey:On(e),unique:!l&&r.unique});return s.push(f),f.isPrimaryKey||a.push(f),c>1&&u(2===c?e[0]:e.slice(0,c-1),t+1,r),s.sort(function(e,t){return e.keyTail-t.keyTail}),f}var s=u(o.primaryKey.keyPath,0,o.primaryKey);i[":id"]=[s];for(var c=0,l=o.indexes;c<l.length;c++){var f=l[c];u(f.keyPath,0,f)}function d(e){var t=i[Sn(e)];return t&&t[0]}function h(t,n){return{type:1===t.type?2:t.type,lower:Ar(t.lower,t.lowerOpen?e.MAX_KEY:e.MIN_KEY,n),lowerOpen:!0,upper:Ar(t.upper,t.upperOpen?e.MIN_KEY:e.MAX_KEY,n),upperOpen:!0}}function p(e){var t=e.query.index;return t.isVirtual?n(n({},e),{query:{index:t.lowLevelIndex,range:h(e.query.range,t.keyTail)}}):e}var y=n(n({},r),{schema:n(n({},o),{primaryKey:s,indexes:a,getIndexByKeyPath:d}),count:function(e){return r.count(p(e))},query:function(e){return r.query(p(e))},openCursor:function(t){var n=t.query.index,o=n.keyTail,i=n.isVirtual,a=n.keyLength;if(!i)return r.openCursor(t);function u(n){function r(r){null!=r?n.continue(Ar(r,t.reverse?e.MAX_KEY:e.MIN_KEY,o)):t.unique?n.continue(n.key.slice(0,a).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,o)):n.continue()}var i=Object.create(n,{continue:{value:r},continuePrimaryKey:{value:function(t,r){n.continuePrimaryKey(Ar(t,e.MAX_KEY,o),r)}},primaryKey:{get:function(){return n.primaryKey}},key:{get:function(){var e=n.key;return 1===a?e[0]:e.slice(0,a)}},value:{get:function(){return n.value}}});return i}return r.openCursor(p(t)).then(function(e){return e&&u(e)})}});return y}})}var Sr={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:Cr};function Kr(e,t,n,r){return n=n||{},r=r||"",i(e).forEach(function(o){if(l(t,o)){var i=e[o],a=t[o];if("object"==typeof i&&"object"==typeof a&&i&&a){var u=q(i);u!==q(a)?n[r+o]=t[o]:"Object"===u?Kr(i,a,n,r+o+"."):i!==a&&(n[r+o]=t[o])}else i!==a&&(n[r+o]=t[o])}else n[r+o]=void 0}),i(t).forEach(function(o){l(e,o)||(n[r+o]=t[o])}),n}function jr(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}var Dr={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return n(n({},e),{table:function(t){var o=e.table(t),i=o.schema.primaryKey,a=n(n({},o),{mutate:function(e){var a=De.trans,u=a.table(t).hook,s=u.deleting,c=u.creating,f=u.updating;switch(e.type){case"add":if(c.fire===re)break;return a._promise("readwrite",function(){return d(e)},!0);case"put":if(c.fire===re&&f.fire===re)break;return a._promise("readwrite",function(){return d(e)},!0);case"delete":if(s.fire===re)break;return a._promise("readwrite",function(){return d(e)},!0);case"deleteRange":if(s.fire===re)break;return a._promise("readwrite",function(){return h(e)},!0)}return o.mutate(e);function d(e){var t=De.trans,a=e.keys||jr(i,e);if(!a)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?n(n({},e),{keys:a}):n({},e)).type&&(e.values=r([],e.values,!0)),e.keys&&(e.keys=r([],e.keys,!0)),Tr(o,e,a).then(function(n){var r=a.map(function(r,o){var a=n[o],u={onerror:null,onsuccess:null};if("delete"===e.type)s.fire.call(u,r,a,t);else if("add"===e.type||void 0===a){var d=c.fire.call(u,r,e.values[o],t);null==r&&null!=d&&(r=d,e.keys[o]=r,i.outbound||E(e.values[o],i.keyPath,r))}else{var h=Kr(a,e.values[o]),p=f.fire.call(u,h,r,a,t);if(p){var y=e.values[o];Object.keys(p).forEach(function(e){l(y,e)?y[e]=p[e]:E(y,e,p[e])})}}return u});return o.mutate(e).then(function(t){for(var o=t.failures,i=t.results,u=t.numFailures,s=t.lastResult,c=0;c<a.length;++c){var l=i?i[c]:a[c],f=r[c];null==l?f.onerror&&f.onerror(o[c]):f.onsuccess&&f.onsuccess("put"===e.type&&n[c]?e.values[c]:l)}return{failures:o,results:i,numFailures:u,lastResult:s}}).catch(function(e){return r.forEach(function(t){return t.onerror&&t.onerror(e)}),Promise.reject(e)})})}function h(e){return p(e.trans,e.range,1e4)}function p(e,t,r){return o.query({trans:e,values:!1,query:{index:i,range:t},limit:r}).then(function(o){var i=o.result;return d({type:"delete",keys:i,trans:e}).then(function(o){return o.numFailures>0?Promise.reject(o.failures[0]):i.length<r?{failures:[],numFailures:0,lastResult:void 0}:p(e,n(n({},t),{lower:i[i.length-1],lowerOpen:!0}),r)})})}}});return a}})}};function Tr(e,t,n){return"add"===t.type?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}function Br(e,t,n){try{if(!t)return null;if(t.keys.length<e.length)return null;for(var r=[],o=0,i=0;o<t.keys.length&&i<e.length;++o)0===jt(t.keys[o],e[i])&&(r.push(n?B(t.values[o]):t.values[o]),++i);return r.length===e.length?r:null}catch(e){return null}}var Ir={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var r=e.table(t);return n(n({},r),{getMany:function(e){if(!e.cache)return r.getMany(e);var t=Br(e.keys,e.trans._cache,"clone"===e.cache);return t?Re.resolve(t):r.getMany(e).then(function(t){return e.trans._cache={keys:e.keys,values:"clone"===e.cache?B(t):t},t})},mutate:function(e){return"add"!==e.type&&(e.trans._cache=null),r.mutate(e)}})}}}};function Rr(e,t){return"readonly"===e.trans.mode&&!!e.subscr&&!e.trans.explicit&&"disabled"!==e.trans.db._options.cache&&!t.schema.primaryKey.outbound}function qr(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Mr={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,r=new sr(e.MIN_KEY,e.MAX_KEY);return n(n({},e),{transaction:function(t,n,r){if(De.subscr&&"readonly"!==n)throw new Z.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(De.querier));return e.transaction(t,n,r)},table:function(o){var u=e.table(o),s=u.schema,c=s.primaryKey,l=s.indexes,f=c.extractKey,d=c.outbound,h=c.autoIncrement&&l.filter(function(e){return e.compound&&e.keyPath.includes(c.keyPath)}),p=n(n({},u),{mutate:function(n){var i,l,f=n.trans,d=n.mutatedParts||(n.mutatedParts={}),p=function(e){var n="idb://".concat(t,"/").concat(o,"/").concat(e);return d[n]||(d[n]=new sr)},y=p(""),m=p(":dels"),v=n.type,g="deleteRange"===n.type?[n.range]:"delete"===n.type?[n.keys]:n.values.length<50?[jr(c,n).filter(function(e){return e}),n.values]:[],b=g[0],w=g[1],x=n.trans._cache;if(a(b)){y.addKeys(b);var k="delete"===v||b.length===w.length?Br(b,x):null;k||m.addKeys(b),(k||w)&&$r(p,s,k,w)}else if(b){var _={from:null!==(i=b.lower)&&void 0!==i?i:e.MIN_KEY,to:null!==(l=b.upper)&&void 0!==l?l:e.MAX_KEY};m.add(_),y.add(_)}else y.add(r),m.add(r),s.indexes.forEach(function(e){return p(e.name).add(r)});return u.mutate(n).then(function(e){return!b||"add"!==n.type&&"put"!==n.type||(y.addKeys(e.results),h&&h.forEach(function(t){for(var r=n.values.map(function(e){return t.extractKey(e)}),o=t.keyPath.findIndex(function(e){return e===c.keyPath}),i=0,a=e.results.length;i<a;++i)r[i][o]=e.results[i];p(t.name).addKeys(r)})),f.mutatedParts=yr(f.mutatedParts||{},d),e})}}),y=function(t){var n,r,o=t.query,i=o.index,a=o.range;return[i,new sr(null!==(n=a.lower)&&void 0!==n?n:e.MIN_KEY,null!==(r=a.upper)&&void 0!==r?r:e.MAX_KEY)]},m={get:function(e){return[c,new sr(e.key)]},getMany:function(e){return[c,(new sr).addKeys(e.keys)]},count:y,query:y,openCursor:y};return i(m).forEach(function(e){p[e]=function(i){var a=De.subscr,s=!!a,c=Rr(De,u)&&qr(e,i)?i.obsSet={}:a;if(s){var l=function(e){var n="idb://".concat(t,"/").concat(o,"/").concat(e);return c[n]||(c[n]=new sr)},h=l(""),p=l(":dels"),y=m[e](i),v=y[0],g=y[1];if("query"===e&&v.isPrimaryKey&&!i.values?p.add(g):l(v.name||"").add(g),!v.isPrimaryKey){if("count"!==e){var b="query"===e&&d&&i.values&&u.query(n(n({},i),{values:!1}));return u[e].apply(this,arguments).then(function(t){if("query"===e){if(d&&i.values)return b.then(function(e){var n=e.result;return h.addKeys(n),t});var n=i.values?t.result.map(f):t.result;i.values?h.addKeys(n):p.addKeys(n)}else if("openCursor"===e){var r=t,o=i.values;return r&&Object.create(r,{key:{get:function(){return p.addKey(r.primaryKey),r.key}},primaryKey:{get:function(){var e=r.primaryKey;return p.addKey(e),e}},value:{get:function(){return o&&h.addKey(r.primaryKey),r.value}}})}return t})}p.add(r)}}return u[e].apply(this,arguments)}}),p}})}};function $r(e,t,n,r){function o(t){var o=e(t.name||"");function i(e){return null!=e?t.extractKey(e):null}var u=function(e){return t.multiEntry&&a(e)?e.forEach(function(e){return o.addKey(e)}):o.addKey(e)};(n||r).forEach(function(e,t){var o=n&&i(n[t]),a=r&&i(r[t]);0!==jt(o,a)&&(null!=o&&u(o),null!=a&&u(a))})}t.indexes.forEach(o)}function Fr(e,t,r){if(0===r.numFailures)return t;if("deleteRange"===t.type)return null;var o=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;if(r.numFailures===o)return null;var i=n({},t);return a(i.keys)&&(i.keys=i.keys.filter(function(e,t){return!(t in r.failures)})),"values"in i&&a(i.values)&&(i.values=i.values.filter(function(e,t){return!(t in r.failures)})),i}function Nr(e,t){return void 0===t.lower||(t.lowerOpen?jt(e,t.lower)>0:jt(e,t.lower)>=0)}function Lr(e,t){return void 0===t.upper||(t.upperOpen?jt(e,t.upper)<0:jt(e,t.upper)<=0)}function zr(e,t){return Nr(e,t)&&Lr(e,t)}function Ur(e,t,n,r,o,i){if(!n||0===n.length)return e;var u=t.query.index,s=u.multiEntry,c=t.query.range,l=r.schema.primaryKey.extractKey,f=u.extractKey,d=(u.lowLevelIndex||u).extractKey,h=n.reduce(function(e,n){var r=e,o=[];if("add"===n.type||"put"===n.type)for(var i=new sr,u=n.values.length-1;u>=0;--u){var d=n.values[u],h=l(d);if(!i.hasKey(h)){var p=f(d);(s&&a(p)?p.some(function(e){return zr(e,c)}):zr(p,c))&&(i.addKey(h),o.push(d))}}switch(n.type){case"add":var y=(new sr).addKeys(t.values?e.map(function(e){return l(e)}):e);r=e.concat(t.values?o.filter(function(e){var t=l(e);return!y.hasKey(t)&&(y.addKey(t),!0)}):o.map(function(e){return l(e)}).filter(function(e){return!y.hasKey(e)&&(y.addKey(e),!0)}));break;case"put":var m=(new sr).addKeys(n.values.map(function(e){return l(e)}));r=e.filter(function(e){return!m.hasKey(t.values?l(e):e)}).concat(t.values?o:o.map(function(e){return l(e)}));break;case"delete":var v=(new sr).addKeys(n.keys);r=e.filter(function(e){return!v.hasKey(t.values?l(e):e)});break;case"deleteRange":var g=n.range;r=e.filter(function(e){return!zr(l(e),g)})}return r},e);return h===e?e:(h.sort(function(e,t){return jt(d(e),d(t))||jt(l(e),l(t))}),t.limit&&t.limit<1/0&&(h.length>t.limit?h.length=t.limit:e.length===t.limit&&h.length<t.limit&&(o.dirty=!0)),i?Object.freeze(h):h)}function Vr(e,t){return 0===jt(e.lower,t.lower)&&0===jt(e.upper,t.upper)&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Wr(e,t,n,r){if(void 0===e)return void 0!==t?-1:0;if(void 0===t)return 1;var o=jt(e,t);if(0===o){if(n&&r)return 0;if(n)return 1;if(r)return-1}return o}function Yr(e,t,n,r){if(void 0===e)return void 0!==t?1:0;if(void 0===t)return-1;var o=jt(e,t);if(0===o){if(n&&r)return 0;if(n)return-1;if(r)return 1}return o}function Hr(e,t){return Wr(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&Yr(e.upper,t.upper,e.upperOpen,t.upperOpen)>=0}function Qr(e,t,n,r){var o=vr["idb://".concat(e,"/").concat(t)];if(!o)return[];var i=o.queries[n];if(!i)return[null,!1,o,null];var a=i[(r.query?r.query.index.name:null)||""];if(!a)return[null,!1,o,null];switch(n){case"query":var u=a.find(function(e){return e.req.limit===r.limit&&e.req.values===r.values&&Vr(e.req.query.range,r.query.range)});return u?[u,!0,o,a]:[a.find(function(e){return("limit"in e.req?e.req.limit:1/0)>=r.limit&&(!r.values||e.req.values)&&Hr(e.req.query.range,r.query.range)}),!1,o,a];case"count":var s=a.find(function(e){return Vr(e.req.query.range,r.query.range)});return[s,!!s,o,a]}}function Gr(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",function(){e.subscribers.delete(n),0===e.subscribers.size&&Xr(e,t)})}function Xr(e,t){setTimeout(function(){0===e.subscribers.size&&F(t,e)},3e3)}var Jr={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name,r=n(n({},e),{transaction:function(n,r,o){var i=e.transaction(n,r,o);if("readwrite"===r){var a=new AbortController,u=a.signal,s=function(o){return function(){if(a.abort(),"readwrite"===r){for(var u=new Set,s=0,c=n;s<c.length;s++){var l=c[s],f=vr["idb://".concat(t,"/").concat(l)];if(f){var d=e.table(l),h=f.optimisticOps.filter(function(e){return e.trans===i});if(i._explicit&&o&&i.mutatedParts)for(var p=0,y=Object.values(f.queries.query);p<y.length;p++)for(var m=0,v=(w=y[p]).slice();m<v.length;m++)mr((_=v[m]).obsSet,i.mutatedParts)&&(F(w,_),_.subscribers.forEach(function(e){return u.add(e)}));else if(h.length>0){f.optimisticOps=f.optimisticOps.filter(function(e){return e.trans!==i});for(var g=0,b=Object.values(f.queries.query);g<b.length;g++)for(var w,x=0,k=(w=b[g]).slice();x<k.length;x++){var _;if(null!=(_=k[x]).res&&i.mutatedParts)if(o&&!_.dirty){var E=Object.isFrozen(_.res),O=Ur(_.res,_.req,h,d,_,E);_.dirty?(F(w,_),_.subscribers.forEach(function(e){return u.add(e)})):O!==_.res&&(_.res=O,_.promise=Re.resolve({result:O}))}else _.dirty&&F(w,_),_.subscribers.forEach(function(e){return u.add(e)})}}}}u.forEach(function(e){return e()})}}};i.addEventListener("abort",s(!1),{signal:u}),i.addEventListener("error",s(!1),{signal:u}),i.addEventListener("complete",s(!0),{signal:u})}return i},table:function(r){var o=e.table(r),i=o.schema.primaryKey,a=n(n({},o),{mutate:function(e){var a=De.trans;if(i.outbound||"disabled"===a.db._options.cache||a.explicit||"readwrite"!==a.idbtrans.mode)return o.mutate(e);var u=vr["idb://".concat(t,"/").concat(r)];if(!u)return o.mutate(e);var s=o.mutate(e);return"add"!==e.type&&"put"!==e.type||!(e.values.length>=50||jr(i,e).some(function(e){return null==e}))?(u.optimisticOps.push(e),e.mutatedParts&&wr(e.mutatedParts),s.then(function(t){if(t.numFailures>0){F(u.optimisticOps,e);var n=Fr(u,e,t);n&&u.optimisticOps.push(n),e.mutatedParts&&wr(e.mutatedParts)}}),s.catch(function(){F(u.optimisticOps,e),e.mutatedParts&&wr(e.mutatedParts)})):s.then(function(t){var r=n(n({},e),{values:e.values.map(function(e,r){var o;if(t.failures[r])return e;var a=(null===(o=i.keyPath)||void 0===o?void 0:o.includes("."))?B(e):n({},e);return E(a,i.keyPath,t.results[r]),a})}),o=Fr(u,r,t);u.optimisticOps.push(o),queueMicrotask(function(){return e.mutatedParts&&wr(e.mutatedParts)})}),s},query:function(e){var n;if(!Rr(De,o)||!qr("query",e))return o.query(e);var i="immutable"===(null===(n=De.trans)||void 0===n?void 0:n.db._options.cache),a=De,u=a.requery,s=a.signal,c=Qr(t,r,"query",e),l=c[0],f=c[1],d=c[2],h=c[3];if(l&&f)l.obsSet=e.obsSet;else{var p=o.query(e).then(function(e){var t=e.result;if(l&&(l.res=t),i){for(var n=0,r=t.length;n<r;++n)Object.freeze(t[n]);Object.freeze(t)}else e.result=B(t);return e}).catch(function(e){return h&&l&&F(h,l),Promise.reject(e)});l={obsSet:e.obsSet,promise:p,subscribers:new Set,type:"query",req:e,dirty:!1},h?h.push(l):(h=[l],d||(d=vr["idb://".concat(t,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),d.queries.query[e.query.index.name||""]=h)}return Gr(l,h,u,s),l.promise.then(function(t){return{result:Ur(t.result,e,null==d?void 0:d.optimisticOps,o,l,i)}})}});return a}});return r}};function Zr(e,t){return new Proxy(e,{get:function(e,n,r){return"db"===n?t:Reflect.get(e,n,r)}})}var eo,to=function(){function e(t,r){var o=this;this._middlewares={},this.verno=0;var i=e.dependencies;this._options=r=n({addons:e.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,cache:"cloned"},r),this._deps={indexedDB:r.indexedDB,IDBKeyRange:r.IDBKeyRange};var a=r.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var u={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:re,dbReadyPromise:null,cancelOpen:re,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:r.autoOpen};u.dbReadyPromise=new Re(function(e){u.dbReadyResolve=e}),u.openCanceller=new Re(function(e,t){u.cancelOpen=t}),this._state=u,this.name=t,this.on=Ft(this,"populate","blocked","versionchange","close",{ready:[fe,re]}),this.once=function(e,t){var n=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];o.on(e).unsubscribe(n),t.apply(o,r)};return o.on(e,n)},this.on.ready.subscribe=b(this.on.ready.subscribe,function(t){return function(n,r){e.vip(function(){var e=o._state;if(e.openComplete)e.dbOpenError||Re.resolve().then(n),r&&t(n);else if(e.onReadyBeingFired)e.onReadyBeingFired.push(n),r&&t(n);else{t(n);var i=o;r||t(function e(){i.on.ready.unsubscribe(n),i.on.ready.unsubscribe(e)})}})}}),this.Collection=Zt(this),this.Table=Lt(this),this.Transaction=bn(this),this.Version=Zn(this),this.WhereClause=dn(this),this.on("versionchange",function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(o.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(o.name,"'. Closing db now to resume the delete request.")),o.close({disableAutoOpen:!1})}),this.on("blocked",function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('".concat(o.name,"') was blocked")):console.warn("Upgrade '".concat(o.name,"' blocked by other connection holding version ").concat(e.oldVersion/10))}),this._maxKey=En(r.IDBKeyRange),this._createTransaction=function(e,t,n,r){return new o.Transaction(e,t,n,o._options.chromeTransactionDurability,r)},this._fireOnBlocked=function(e){o.on("blocked").fire(e),_t.filter(function(e){return e.name===o.name&&e!==o&&!e._state.vcFired}).map(function(t){return t.on("versionchange").fire(e)})},this.use(Ir),this.use(Jr),this.use(Mr),this.use(Sr),this.use(Dr);var s=new Proxy(this,{get:function(e,t,n){if("_vip"===t)return!0;if("table"===t)return function(e){return Zr(o.table(e),s)};var r=Reflect.get(e,t,n);return r instanceof $t?Zr(r,s):"tables"===t?r.map(function(e){return Zr(e,s)}):"_createTransaction"===t?function(){return Zr(r.apply(this,arguments),s)}:r}});this.vip=s,a.forEach(function(e){return e(o)})}return e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new Z.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new Z.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(t){return t._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort(Rn),n.stores({}),this._state.autoSchema=!1,n)},e.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||De.letThrough||this._vip)?e():new Re(function(e,n){if(t._state.openComplete)return n(new Z.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void n(new Z.DatabaseClosed);t.open().catch(re)}t._state.dbReadyPromise.then(e,n)}).then(e)},e.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,o=e.name;o&&this.unuse({stack:t,name:o});var i=this._middlewares[t]||(this._middlewares[t]=[]);return i.push({stack:t,create:n,level:null==r?10:r,name:o}),i.sort(function(e,t){return e.level-t.level}),this},e.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(e){return r?e.create!==r:!!n&&e.name!==n})),this},e.prototype.open=function(){var e=this;return ht(je,function(){return _r(e)})},e.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var e=this._state,t=_t.indexOf(this);if(t>=0&&_t.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(e){}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new Re(function(t){e.dbReadyResolve=t}),e.openCanceller=new Re(function(t,n){e.cancelOpen=n}))},e.prototype.close=function(e){var t=(void 0===e?{disableAutoOpen:!0}:e).disableAutoOpen,n=this._state;t?(n.isBeingOpened&&n.cancelOpen(new Z.DatabaseClosed),this._close(),n.autoOpen=!1,n.dbOpenError=new Z.DatabaseClosed):(this._close(),n.autoOpen=this._options.autoOpen||n.isBeingOpened,n.openComplete=!1,n.dbOpenError=null)},e.prototype.delete=function(e){var t=this;void 0===e&&(e={disableAutoOpen:!0});var n=arguments.length>0&&"object"!=typeof arguments[0],r=this._state;return new Re(function(o,i){var a=function(){t.close(e);var n=t._deps.indexedDB.deleteDatabase(t.name);n.onsuccess=Je(function(){or(t._deps,t.name),o()}),n.onerror=hn(i),n.onblocked=t._fireOnBlocked};if(n)throw new Z.InvalidArgument("Invalid closeOptions argument to db.delete()");r.isBeingOpened?r.dbReadyPromise.then(a):a()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return null!==this.idbdb},e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},e.prototype.hasFailed=function(){return null!==this._state.dbOpenError},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var e=this;return i(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var e=Or.apply(this,arguments);return this._transaction.apply(this,e)},e.prototype._transaction=function(e,t,n){var r=this,o=De.trans;o&&o.db===this&&-1===e.indexOf("!")||(o=null);var i,a,u=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(a=t.map(function(e){var t=e instanceof r.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t}),"r"==e||e===Ot)i=Ot;else{if("rw"!=e&&e!=Pt)throw new Z.InvalidArgument("Invalid transaction mode: "+e);i=Pt}if(o){if(o.mode===Ot&&i===Pt){if(!u)throw new Z.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");o=null}o&&a.forEach(function(e){if(o&&-1===o.storeNames.indexOf(e)){if(!u)throw new Z.SubTransaction("Table "+e+" not included in parent transaction.");o=null}}),u&&o&&!o.active&&(o=null)}}catch(e){return o?o._promise(null,function(t,n){n(e)}):mt(e)}var s=Pr.bind(null,this,i,a,o,n);return o?o._promise(i,s,"lock"):De.trans?ht(De.transless,function(){return r._whenReady(s)}):this._whenReady(s)},e.prototype.table=function(e){if(!l(this._allTables,e))throw new Z.InvalidTable("Table ".concat(e," does not exist"));return this._allTables[e]},e}(),no="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable",ro=function(){function e(e){this._subscribe=e}return e.prototype.subscribe=function(e,t,n){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:n})},e.prototype[no]=function(){return this},e}();try{eo={indexedDB:o.indexedDB||o.mozIndexedDB||o.webkitIndexedDB||o.msIndexedDB,IDBKeyRange:o.IDBKeyRange||o.webkitIDBKeyRange}}catch(e){eo={indexedDB:null,IDBKeyRange:null}}function oo(e){var t,n=!1,r=new ro(function(r){var o=z(e);function i(t){var n=Ve();try{o&&at();var r=it(e,t);return o&&(r=r.finally(ut)),r}finally{n&&We()}}var a,u=!1,s={},c={},l={get closed(){return u},unsubscribe:function(){u||(u=!0,a&&a.abort(),f&&vn.storagemutated.unsubscribe(p))}};r.start&&r.start(l);var f=!1,d=function(){return yt(y)};function h(){return mr(c,s)}var p=function(e){yr(s,e),h()&&d()},y=function(){if(!u&&eo.indexedDB){s={};var o={};a&&a.abort(),a=new AbortController;var l={subscr:o,signal:a.signal,requery:d,querier:e,trans:null},h=i(l);Promise.resolve(h).then(function(e){n=!0,t=e,u||l.signal.aborted||(s={},D(c=o)||f||(vn(yn,p),f=!0),yt(function(){return!u&&r.next&&r.next(e)}))},function(e){n=!1,["DatabaseClosedError","AbortError"].includes(null==e?void 0:e.name)||u||yt(function(){u||r.error&&r.error(e)})})}};return setTimeout(d,0),l});return r.hasValue=function(){return n},r.getValue=function(){return t},r}var io=to;function ao(e){var t=so;try{so=!0,vn.storagemutated.fire(e),xr(e,!0)}finally{so=t}}f(io,n(n({},ne),{delete:function(e){return new io(e,{addons:[]}).delete()},exists:function(e){return new io(e,{addons:[]}).open().then(function(e){return e.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return nr(io.dependencies).then(e)}catch(e){return mt(new Z.MissingAPI)}},defineClass:function(){function e(e){u(this,e)}return e},ignoreTransaction:function(e){return De.trans?ht(De.transless,e):e()},vip:ir,async:function(e){return function(){try{var t=Er(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Re.resolve(t)}catch(e){return mt(e)}}},spawn:function(e,t,n){try{var r=Er(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:Re.resolve(r)}catch(e){return mt(e)}},currentTransaction:{get:function(){return De.trans||null}},waitFor:function(e,t){var n=Re.resolve("function"==typeof e?io.ignoreTransaction(e):e).timeout(t||6e4);return De.trans?De.trans.waitFor(n):n},Promise:Re,debug:{get:function(){return de},set:function(e){he(e)}},derive:p,extend:u,props:f,override:b,Events:Ft,on:vn,liveQuery:oo,extendObservabilitySet:yr,getByKeyPath:_,setByKeyPath:E,delByKeyPath:O,shallowClone:P,deepClone:B,getObjectDiff:Kr,cmp:jt,asap:x,minKey:wt,addons:[],connections:_t,errnames:X,dependencies:eo,cache:vr,semVer:gt,version:gt.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,2*n)})})),io.maxKey=En(io.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(vn(yn,function(e){var t;so||(t=new CustomEvent(mn,{detail:e}),so=!0,dispatchEvent(t),so=!1)}),addEventListener(mn,function(e){var t=e.detail;so||ao(t)}));var uo,so=!1,co=function(){};function lo(e){return new qt({add:e})}function fo(e){return new qt({remove:e})}function ho(e,t){return new qt({replacePrefix:[e,t]})}return"undefined"!=typeof BroadcastChannel&&((co=function(){(uo=new BroadcastChannel(mn)).onmessage=function(e){return e.data&&ao(e.data)}})(),"function"==typeof uo.unref&&uo.unref(),vn(yn,function(e){so||uo.postMessage(e)})),"undefined"!=typeof addEventListener&&(addEventListener("pagehide",function(e){if(!to.disableBfCache&&e.persisted){de&&console.debug("Dexie: handling persisted pagehide"),null==uo||uo.close();for(var t=0,n=_t;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(e){!to.disableBfCache&&e.persisted&&(de&&console.debug("Dexie: handling persisted pageshow"),co(),ao({all:new sr(-1/0,[[]])}))})),Re.rejectionMapper=te,he(de),n(to,Object.freeze({__proto__:null,Dexie:to,liveQuery:oo,Entity:Kt,cmp:jt,PropModification:qt,replacePrefix:ho,add:lo,remove:fo,default:to,RangeSet:sr,mergeRanges:lr,rangesOverlap:fr}),{default:to}),to}();var ke=we(xe.exports);const _e=Symbol.for("Dexie"),Ee=globalThis[_e]||(globalThis[_e]=ke);if(ke.semVer!==Ee.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${ke.semVer} and ${Ee.semVer}`);const Oe=new Ee("BookmarkInsightsDB");async function Pe(){try{return await Oe.bookmarks.toArray()}catch(e){return console.error("Error getting bookmarks:",e),[]}}Oe.version(1).stores({bookmarks:"id, url, title, domain, category, dateAdded, lastAccessed, lastChecked, isAlive, parentId",enrichmentQueue:"++queueId, bookmarkId, addedAt, priority",events:"++eventId, bookmarkId, type, timestamp",cache:"key",settings:"key"}),Oe.version(2).stores({bookmarks:"id, url, title, domain, category, dateAdded, lastAccessed, lastChecked, isAlive, parentId",enrichmentQueue:"++queueId, bookmarkId, addedAt, priority",events:"++eventId, bookmarkId, type, timestamp",cache:"key",settings:"key"}).upgrade(e=>{console.log("Upgrading database to version 2 - adding rawMetadata support")}),Oe.version(3).stores({bookmarks:"id, url, title, domain, category, dateAdded, lastAccessed, lastChecked, isAlive, parentId",enrichmentQueue:"++queueId, bookmarkId, addedAt, priority",events:"++eventId, bookmarkId, type, timestamp",cache:"key",settings:"key",similarities:"++id, bookmark1Id, bookmark2Id, score, [bookmark1Id+bookmark2Id]",computedMetrics:"key"}).upgrade(e=>{console.log("Upgrading database to version 3 - adding similarities and computedMetrics tables")});const Ae=36e5;async function Ce(){return async function(e,t,n){try{const r=await Oe.computedMetrics.get(e);if(r&&r.validUntil>Date.now())return console.log(`Cache hit for metric: ${e}`),r.data;console.log(`Cache miss for metric: ${e}, computing...`);const o=await t();return await Oe.computedMetrics.put({key:e,data:o,computedAt:Date.now(),validUntil:Date.now()+n}),o}catch(n){return console.error(`Error getting cached metric ${e}:`,n),t()}}("domainAnalytics",async()=>{const e=await Pe(),t={};e.forEach(e=>{if(!e.domain)return;t[e.domain]||(t[e.domain]={domain:e.domain,count:0,latestDate:0,oldestDate:1/0,enrichedCount:0});const n=t[e.domain];n.count++,e.lastChecked&&n.enrichedCount++,e.dateAdded>n.latestDate&&(n.latestDate=e.dateAdded),e.dateAdded<n.oldestDate&&(n.oldestDate=e.dateAdded)});const n=Object.values(t),r=e.length;return n.forEach(e=>{e.percentage=r>0?Math.round(e.count/r*100):0,e.dateAdded=e.latestDate}),{byRecency:[...n].sort((e,t)=>t.latestDate-e.latestDate),byCount:[...n].sort((e,t)=>t.count-e.count),top10:[...n].sort((e,t)=>t.count-e.count).slice(0,10),totalDomains:n.length,totalBookmarks:r}},Ae)}function Se(e,t,n){const r=e.slice();return r[28]=t[n],r}function Ke(e,t,n){const r=e.slice();return r[31]=t[n],r}function je(e,t,n){const r=e.slice();return r[28]=t[n],r}function De(e,t,n){const r=e.slice();return r[36]=t[n],r}function Te(e){let t,n,r,o,i,a,u,s,d=e[36]+"";function p(){return e[15](e[36])}return{c(){t=h("div"),n=h("div"),r=y("Domain: "),o=y(d),i=m(),a=h("button"),a.textContent="Ã—",g(n,"class","text-xs text-blue-800"),g(a,"class","text-blue-600 hover:text-blue-800"),g(t,"class","flex items-center justify-between p-2 bg-blue-50 rounded-md")},m(e,f){l(e,t,f),c(t,n),c(n,r),c(n,o),c(t,i),c(t,a),u||(s=v(a,"click",p),u=!0)},p(t,n){e=t,4&n[0]&&d!==(d=e[36]+"")&&b(o,d)},d(e){e&&f(t),u=!1,s()}}}function Be(e){let t,n,r,o,i,a,u,s,d=e[28]+"";function p(){return e[16](e[28])}return{c(){t=h("div"),n=h("div"),r=y("Folder: "),o=y(d),i=m(),a=h("button"),a.textContent="Ã—",g(n,"class","text-xs text-green-800"),g(a,"class","text-green-600 hover:text-green-800"),g(t,"class","flex items-center justify-between p-2 bg-green-50 rounded-md")},m(e,f){l(e,t,f),c(t,n),c(n,r),c(n,o),c(t,i),c(t,a),u||(s=v(a,"click",p),u=!0)},p(t,n){e=t,4&n[0]&&d!==(d=e[28]+"")&&b(o,d)},d(e){e&&f(t),u=!1,s()}}}function Ie(e){let t,n,r,o,i,a,u,s="week"===e[2].dateRange.period?"This Week":"month"===e[2].dateRange.period?"This Month":"This Year";return{c(){t=h("div"),n=h("div"),r=y(s),o=m(),i=h("button"),i.textContent="Ã—",g(n,"class","text-xs text-purple-800"),g(i,"class","text-purple-600 hover:text-purple-800"),g(t,"class","flex items-center justify-between p-2 bg-purple-50 rounded-md")},m(s,f){l(s,t,f),c(t,n),c(n,r),c(t,o),c(t,i),a||(u=v(i,"click",e[17]),a=!0)},p(e,t){4&t[0]&&s!==(s="week"===e[2].dateRange.period?"This Week":"month"===e[2].dateRange.period?"This Month":"This Year")&&b(r,s)},d(e){e&&f(t),a=!1,u()}}}function Re(e){let t,n,r,o=e[4].length+"";return{c(){t=y("Domains ("),n=y(o),r=y(")")},m(e,o){l(e,t,o),l(e,n,o),l(e,r,o)},p(e,t){16&t[0]&&o!==(o=e[4].length+"")&&b(n,o)},d(e){e&&(f(t),f(n),f(r))}}}function qe(e){let t,n,r,o,i=e[4].length+"";return{c(){t=h("span"),n=y("Matching Domains ("),r=y(i),o=y(")"),g(t,"class","text-blue-600")},m(e,i){l(e,t,i),c(t,n),c(t,r),c(t,o)},p(e,t){16&t[0]&&i!==(i=e[4].length+"")&&b(r,i)},d(e){e&&f(t)}}}function Me(e){let t,n,o,i,a,u;return{c(){t=h("div"),n=h("button"),n.textContent="Recent",o=m(),i=h("button"),i.textContent="Count",g(n,"class","text-xs px-2 py-1 rounded"),g(n,"title","Sort by most recent bookmark"),x(n,"bg-blue-100","recency"===e[1]),x(n,"text-blue-700","recency"===e[1]),x(n,"text-gray-500","recency"!==e[1]),g(i,"class","text-xs px-2 py-1 rounded"),g(i,"title","Sort by bookmark count"),x(i,"bg-blue-100","count"===e[1]),x(i,"text-blue-700","count"===e[1]),x(i,"text-gray-500","count"!==e[1]),g(t,"class","flex space-x-1")},m(r,s){l(r,t,s),c(t,n),c(t,o),c(t,i),a||(u=[v(n,"click",e[21]),v(i,"click",e[22])],a=!0)},p(e,t){2&t[0]&&x(n,"bg-blue-100","recency"===e[1]),2&t[0]&&x(n,"text-blue-700","recency"===e[1]),2&t[0]&&x(n,"text-gray-500","recency"!==e[1]),2&t[0]&&x(i,"bg-blue-100","count"===e[1]),2&t[0]&&x(i,"text-blue-700","count"===e[1]),2&t[0]&&x(i,"text-gray-500","count"!==e[1])},d(e){e&&f(t),a=!1,r(u)}}}function $e(e){let t,n,r=Qe(e[31].dateAdded||e[31].latestDate)+"";return{c(){t=h("span"),n=y(r)},m(e,r){l(e,t,r),c(t,n)},p(e,t){16&t[0]&&r!==(r=Qe(e[31].dateAdded||e[31].latestDate)+"")&&b(n,r)},d(e){e&&f(t)}}}function Fe(e){let t,n,r,o,i,a,u,s,d,p,w,k,_,E=e[31].domain+"",O=e[31].count+"",P=1!==e[31].count?"s":"",A=!e[0]&&"recency"===e[1]&&(e[31].dateAdded||e[31].latestDate)&&$e(e);function C(){return e[23](e[31])}return{c(){t=h("button"),n=h("div"),r=y(E),o=m(),i=h("div"),a=h("span"),u=y(O),s=y(" bookmark"),d=y(P),p=m(),A&&A.c(),g(n,"class","truncate font-medium"),g(i,"class","flex justify-between items-center text-xs text-gray-500 mt-1"),g(t,"class","w-full text-left px-2 py-2 text-sm hover:bg-gray-100 rounded border"),g(t,"title",w=e[31].domain),x(t,"bg-blue-50",e[2].domains.includes(e[31].domain)),x(t,"text-blue-700",e[2].domains.includes(e[31].domain)),x(t,"border-blue-200",e[2].domains.includes(e[31].domain)),x(t,"text-gray-600",!e[2].domains.includes(e[31].domain)),x(t,"border-transparent",!e[2].domains.includes(e[31].domain))},m(e,f){l(e,t,f),c(t,n),c(n,r),c(t,o),c(t,i),c(i,a),c(a,u),c(a,s),c(a,d),c(i,p),A&&A.m(i,null),k||(_=v(t,"click",C),k=!0)},p(n,o){e=n,16&o[0]&&E!==(E=e[31].domain+"")&&b(r,E),16&o[0]&&O!==(O=e[31].count+"")&&b(u,O),16&o[0]&&P!==(P=1!==e[31].count?"s":"")&&b(d,P),e[0]||"recency"!==e[1]||!e[31].dateAdded&&!e[31].latestDate?A&&(A.d(1),A=null):A?A.p(e,o):(A=$e(e),A.c(),A.m(i,null)),16&o[0]&&w!==(w=e[31].domain)&&g(t,"title",w),20&o[0]&&x(t,"bg-blue-50",e[2].domains.includes(e[31].domain)),20&o[0]&&x(t,"text-blue-700",e[2].domains.includes(e[31].domain)),20&o[0]&&x(t,"border-blue-200",e[2].domains.includes(e[31].domain)),20&o[0]&&x(t,"text-gray-600",!e[2].domains.includes(e[31].domain)),20&o[0]&&x(t,"border-transparent",!e[2].domains.includes(e[31].domain))},d(e){e&&f(t),A&&A.d(),k=!1,_()}}}function Ne(e){let t,n,r,o,i=e[4].length-30+"";return{c(){t=h("div"),n=y("... and "),r=y(i),o=y(" more"),g(t,"class","text-xs text-gray-400 px-2 py-1")},m(e,i){l(e,t,i),c(t,n),c(t,r),c(t,o)},p(e,t){16&t[0]&&i!==(i=e[4].length-30+"")&&b(r,i)},d(e){e&&f(t)}}}function Le(e){let t;return{c(){t=h("div"),t.textContent="No domains found",g(t,"class","text-xs text-gray-400 px-2 py-2 italic")},m(e,n){l(e,t,n)},d(e){e&&f(t)}}}function ze(e){let t,n,r,o=e[3].length+"";return{c(){t=y("Folders ("),n=y(o),r=y(")")},m(e,o){l(e,t,o),l(e,n,o),l(e,r,o)},p(e,t){8&t[0]&&o!==(o=e[3].length+"")&&b(n,o)},d(e){e&&(f(t),f(n),f(r))}}}function Ue(e){let t,n,r,o,i=e[3].length+"";return{c(){t=h("span"),n=y("Matching Folders ("),r=y(i),o=y(")"),g(t,"class","text-blue-600")},m(e,i){l(e,t,i),c(t,n),c(t,r),c(t,o)},p(e,t){8&t[0]&&i!==(i=e[3].length+"")&&b(r,i)},d(e){e&&f(t)}}}function Ve(e){let t,n,r,o,i,a,u,s=e[28]+"";function d(){return e[24](e[28])}return{c(){t=h("button"),n=h("span"),r=y("ðŸ“ "),o=y(s),g(n,"class","truncate block"),g(t,"class","w-full text-left px-2 py-1 text-sm hover:bg-gray-100 rounded border"),g(t,"title",i=e[28]),x(t,"bg-green-50",e[2].folders.includes(e[28])),x(t,"text-green-700",e[2].folders.includes(e[28])),x(t,"border-green-200",e[2].folders.includes(e[28])),x(t,"text-gray-600",!e[2].folders.includes(e[28])),x(t,"border-transparent",!e[2].folders.includes(e[28]))},m(e,i){l(e,t,i),c(t,n),c(n,r),c(n,o),a||(u=v(t,"click",d),a=!0)},p(n,r){e=n,8&r[0]&&s!==(s=e[28]+"")&&b(o,s),8&r[0]&&i!==(i=e[28])&&g(t,"title",i),12&r[0]&&x(t,"bg-green-50",e[2].folders.includes(e[28])),12&r[0]&&x(t,"text-green-700",e[2].folders.includes(e[28])),12&r[0]&&x(t,"border-green-200",e[2].folders.includes(e[28])),12&r[0]&&x(t,"text-gray-600",!e[2].folders.includes(e[28])),12&r[0]&&x(t,"border-transparent",!e[2].folders.includes(e[28]))},d(e){e&&f(t),a=!1,u()}}}function We(e){let t,n,r,o,i=e[3].length-15+"";return{c(){t=h("div"),n=y("... and "),r=y(i),o=y(" more"),g(t,"class","text-xs text-gray-400 px-2 py-1")},m(e,i){l(e,t,i),c(t,n),c(t,r),c(t,o)},p(e,t){8&t[0]&&i!==(i=e[3].length-15+"")&&b(r,i)},d(e){e&&f(t)}}}function Ye(e){let t;return{c(){t=h("div"),t.textContent="No folders found",g(t,"class","text-xs text-gray-400 px-2 py-2 italic")},m(e,n){l(e,t,n)},d(e){e&&f(t)}}}function He(t){let n,o,i,a,u,s,p,y,b,w,k,_,E,O,P,A,C,S,K,j,D,T,B,I,R,q,M,$,F,N,L,U,V,W,Y=t[9](),H=t[9](),Q=Y&&function(t){let n,r,o;return{c(){n=h("button"),n.textContent="Clear All",g(n,"class","text-xs text-blue-600 hover:text-blue-800")},m(e,i){l(e,n,i),r||(o=v(n,"click",t[7]),r=!0)},p:e,d(e){e&&f(n),r=!1,o()}}}(t),G=H&&function(e){let t,n,r,o=z(e[2].domains),i=[];for(let t=0;t<o.length;t+=1)i[t]=Te(De(e,o,t));let a=z(e[2].folders),u=[];for(let t=0;t<a.length;t+=1)u[t]=Be(je(e,a,t));let s=e[2].dateRange&&Ie(e);return{c(){t=h("div");for(let e=0;e<i.length;e+=1)i[e].c();n=m();for(let e=0;e<u.length;e+=1)u[e].c();r=m(),s&&s.c(),g(t,"class","mb-4 space-y-2")},m(e,o){l(e,t,o);for(let e=0;e<i.length;e+=1)i[e]&&i[e].m(t,null);c(t,n);for(let e=0;e<u.length;e+=1)u[e]&&u[e].m(t,null);c(t,r),s&&s.m(t,null)},p(e,c){if(36&c[0]){let r;for(o=z(e[2].domains),r=0;r<o.length;r+=1){const a=De(e,o,r);i[r]?i[r].p(a,c):(i[r]=Te(a),i[r].c(),i[r].m(t,n))}for(;r<i.length;r+=1)i[r].d(1);i.length=o.length}if(68&c[0]){let n;for(a=z(e[2].folders),n=0;n<a.length;n+=1){const o=je(e,a,n);u[n]?u[n].p(o,c):(u[n]=Be(o),u[n].c(),u[n].m(t,r))}for(;n<u.length;n+=1)u[n].d(1);u.length=a.length}e[2].dateRange?s?s.p(e,c):(s=Ie(e),s.c(),s.m(t,null)):s&&(s.d(1),s=null)},d(e){e&&f(t),d(i,e),d(u,e),s&&s.d()}}}(t);function X(e,t){return e[0]?qe:Re}let J=X(t),Z=J(t),ee=!t[0]&&Me(t),te=z(t[4].slice(0,30)),ne=[];for(let e=0;e<te.length;e+=1)ne[e]=Fe(Ke(t,te,e));let re=t[4].length>30&&Ne(t),oe=0===t[4].length&&Le();function ie(e,t){return e[0]?Ue:ze}let ae=ie(t),ue=ae(t),se=z(t[3].slice(0,15)),ce=[];for(let e=0;e<se.length;e+=1)ce[e]=Ve(Se(t,se,e));let le=t[3].length>15&&We(t),fe=0===t[3].length&&Ye();return{c(){n=h("div"),o=h("div"),i=h("div"),a=h("h3"),a.textContent="Filters",u=m(),Q&&Q.c(),s=m(),G&&G.c(),p=m(),y=h("div"),b=h("h4"),b.textContent="Date Added",w=m(),k=h("div"),_=h("button"),_.textContent="This Week",E=m(),O=h("button"),O.textContent="This Month",P=m(),A=h("button"),A.textContent="This Year",C=m(),S=h("div"),K=h("div"),j=h("h4"),Z.c(),D=m(),ee&&ee.c(),T=m(),B=h("div");for(let e=0;e<ne.length;e+=1)ne[e].c();I=m(),re&&re.c(),R=m(),oe&&oe.c(),q=m(),M=h("div"),$=h("h4"),ue.c(),F=m(),N=h("div");for(let e=0;e<ce.length;e+=1)ce[e].c();L=m(),le&&le.c(),U=m(),fe&&fe.c(),g(a,"class","text-sm font-medium text-gray-900"),g(i,"class","flex items-center justify-between mb-3"),g(o,"class","mb-6"),g(b,"class","text-xs font-medium text-gray-700 uppercase tracking-wide mb-2"),g(_,"class","w-full text-left px-2 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded"),x(_,"bg-blue-50","week"===t[2].dateRange?.period),x(_,"text-blue-700","week"===t[2].dateRange?.period),g(O,"class","w-full text-left px-2 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded"),x(O,"bg-blue-50","month"===t[2].dateRange?.period),x(O,"text-blue-700","month"===t[2].dateRange?.period),g(A,"class","w-full text-left px-2 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded"),x(A,"bg-blue-50","year"===t[2].dateRange?.period),x(A,"text-blue-700","year"===t[2].dateRange?.period),g(k,"class","space-y-1"),g(y,"class","mb-6"),g(j,"class","text-xs font-medium text-gray-700 uppercase tracking-wide"),g(K,"class","flex items-center justify-between mb-2"),g(B,"class","space-y-1 max-h-64 overflow-y-auto"),g(S,"class","mb-6"),g($,"class","text-xs font-medium text-gray-700 uppercase tracking-wide mb-2"),g(N,"class","space-y-1 max-h-48 overflow-y-auto"),g(M,"class","mb-6"),g(n,"class","w-64 bg-gray-50 border-r border-gray-200 p-4 overflow-y-auto flex-shrink-0")},m(e,r){l(e,n,r),c(n,o),c(o,i),c(i,a),c(i,u),Q&&Q.m(i,null),c(o,s),G&&G.m(o,null),c(n,p),c(n,y),c(y,b),c(y,w),c(y,k),c(k,_),c(k,E),c(k,O),c(k,P),c(k,A),c(n,C),c(n,S),c(S,K),c(K,j),Z.m(j,null),c(K,D),ee&&ee.m(K,null),c(S,T),c(S,B);for(let e=0;e<ne.length;e+=1)ne[e]&&ne[e].m(B,null);c(B,I),re&&re.m(B,null),c(B,R),oe&&oe.m(B,null),c(n,q),c(n,M),c(M,$),ue.m($,null),c(M,F),c(M,N);for(let e=0;e<ce.length;e+=1)ce[e]&&ce[e].m(N,null);c(N,L),le&&le.m(N,null),c(N,U),fe&&fe.m(N,null),V||(W=[v(_,"click",t[18]),v(O,"click",t[19]),v(A,"click",t[20])],V=!0)},p(e,t){if(Y&&Q.p(e,t),H&&G.p(e,t),4&t[0]&&x(_,"bg-blue-50","week"===e[2].dateRange?.period),4&t[0]&&x(_,"text-blue-700","week"===e[2].dateRange?.period),4&t[0]&&x(O,"bg-blue-50","month"===e[2].dateRange?.period),4&t[0]&&x(O,"text-blue-700","month"===e[2].dateRange?.period),4&t[0]&&x(A,"bg-blue-50","year"===e[2].dateRange?.period),4&t[0]&&x(A,"text-blue-700","year"===e[2].dateRange?.period),J===(J=X(e))&&Z?Z.p(e,t):(Z.d(1),Z=J(e),Z&&(Z.c(),Z.m(j,null))),e[0]?ee&&(ee.d(1),ee=null):ee?ee.p(e,t):(ee=Me(e),ee.c(),ee.m(K,null)),55&t[0]){let n;for(te=z(e[4].slice(0,30)),n=0;n<te.length;n+=1){const r=Ke(e,te,n);ne[n]?ne[n].p(r,t):(ne[n]=Fe(r),ne[n].c(),ne[n].m(B,I))}for(;n<ne.length;n+=1)ne[n].d(1);ne.length=te.length}if(e[4].length>30?re?re.p(e,t):(re=Ne(e),re.c(),re.m(B,R)):re&&(re.d(1),re=null),0===e[4].length?oe||(oe=Le(),oe.c(),oe.m(B,null)):oe&&(oe.d(1),oe=null),ae===(ae=ie(e))&&ue?ue.p(e,t):(ue.d(1),ue=ae(e),ue&&(ue.c(),ue.m($,null))),76&t[0]){let n;for(se=z(e[3].slice(0,15)),n=0;n<se.length;n+=1){const r=Se(e,se,n);ce[n]?ce[n].p(r,t):(ce[n]=Ve(r),ce[n].c(),ce[n].m(N,L))}for(;n<ce.length;n+=1)ce[n].d(1);ce.length=se.length}e[3].length>15?le?le.p(e,t):(le=We(e),le.c(),le.m(N,U)):le&&(le.d(1),le=null),0===e[3].length?fe||(fe=Ye(),fe.c(),fe.m(N,null)):fe&&(fe.d(1),fe=null)},i:e,o:e,d(e){e&&f(n),Q&&Q.d(),G&&G.d(),Z.d(),ee&&ee.d(),d(ne,e),re&&re.d(),oe&&oe.d(),ue.d(),d(ce,e),le&&le.d(),fe&&fe.d(),V=!1,r(W)}}}function Qe(e){const t=Date.now()-e,n=Math.floor(t/864e5);return 0===n?"Today":1===n?"1 day ago":n<7?`${n} days ago`:n<30?`${Math.floor(n/7)} weeks ago`:n<365?`${Math.floor(n/30)} months ago`:`${Math.floor(n/365)} years ago`}function Ge(e,t,n){let r,o;const i=O();let{searchResultStats:a=null}=t,{isSearchActive:u=!1}=t,s=[],c=[],l=[],f={domains:[],folders:[],dateRange:null},d="count";function h(e){f.domains.includes(e)?n(2,f.domains=f.domains.filter(t=>t!==e),f):n(2,f.domains=[...f.domains,e],f),y()}function p(e){f.folders.includes(e)?n(2,f.folders=f.folders.filter(t=>t!==e),f):n(2,f.folders=[...f.folders,e],f),y()}function y(){i("filter",f)}function m(e){const t=new Date;let r;switch(e){case"week":r=new Date(t.getTime()-6048e5);break;case"month":r=new Date(t.getFullYear(),t.getMonth(),1);break;case"year":r=new Date(t.getFullYear(),0,1)}!function(e,t,r){n(2,f.dateRange={startDate:e,endDate:t,period:r},f),y()}(r.getTime(),t.getTime(),e)}E(async()=>{try{await async function(){n(12,s=await async function(){return(await Ce()).byRecency}()),n(13,c=await async function(){return(await Ce()).byCount}())}(),n(14,l=await async function(){try{const e=await Pe();return[...new Set(e.map(e=>e.folderPath).filter(e=>e))].sort()}catch(e){return console.error("Error getting unique folders:",e),[]}}())}catch(e){console.error("Error loading filters:",e)}});return e.$$set=e=>{"searchResultStats"in e&&n(11,a=e.searchResultStats),"isSearchActive"in e&&n(0,u=e.isSearchActive)},e.$$.update=()=>{14339&e.$$.dirty[0]&&n(4,r=u&&a?.domains?a.domains:"recency"===d?s:c),18433&e.$$.dirty[0]&&n(3,o=u&&a?.folders?a.folders.map(e=>e.folder):l)},[u,d,f,o,r,h,p,function(){n(2,f={domains:[],folders:[],dateRange:null}),y()},y,function(){return f.domains.length>0||f.folders.length>0||null!==f.dateRange},m,a,s,c,l,e=>h(e),e=>p(e),()=>{n(2,f.dateRange=null,f),y()},()=>m("week"),()=>m("month"),()=>m("year"),()=>n(1,d="recency"),()=>n(1,d="count"),e=>h(e.domain),e=>p(e)]}class Xe extends G{constructor(e){super(),Q(this,e,Ge,He,i,{searchResultStats:11,isSearchActive:0},null,[-1,-1])}}function Je(e,t,n){const r=e.slice();return r[9]=t[n],r}function Ze(t){let n,r;return n=new Xe({}),n.$on("filter",t[7]),{c(){V(n.$$.fragment)},m(e,t){W(n,e,t),r=!0},p:e,i(e){r||(N(n.$$.fragment,e),r=!0)},o(e){L(n.$$.fragment,e),r=!1},d(e){Y(n,e)}}}function et(e){let t,n,o=[],i=new Map,a=z(e[0]);const u=e=>e[9].id;for(let t=0;t<a.length;t+=1){let n=Je(e,a,t),r=u(n);i.set(r,o[t]=ot(r,n))}return{c(){t=h("div");for(let e=0;e<o.length;e+=1)o[e].c();g(t,"class","space-y-3")},m(e,r){l(e,t,r);for(let e=0;e<o.length;e+=1)o[e]&&o[e].m(t,null);n=!0},p(e,n){1&n&&(a=z(e[0]),$(),o=function(e,t,n,o,i,a,u,s,c,l,f,d){let h=e.length,p=a.length,y=h;const m={};for(;y--;)m[e[y].key]=y;const v=[],g=new Map,b=new Map,w=[];for(y=p;y--;){const e=d(i,a,y),r=n(e);let s=u.get(r);s?o&&w.push(()=>s.p(e,t)):(s=l(r,e),s.c()),g.set(r,v[y]=s),r in m&&b.set(r,Math.abs(y-m[r]))}const x=new Set,k=new Set;function _(e){N(e,1),e.m(s,f),u.set(e.key,e),f=e.first,p--}for(;h&&p;){const t=v[p-1],n=e[h-1],r=t.key,o=n.key;t===n?(f=t.first,h--,p--):g.has(o)?!u.has(r)||x.has(r)?_(t):k.has(o)?h--:b.get(r)>b.get(o)?(k.add(r),_(t)):(x.add(o),h--):(c(n,u),h--)}for(;h--;){const t=e[h];g.has(t.key)||c(t,u)}for(;p;)_(v[p-1]);return r(w),v}(o,n,u,1,e,a,i,t,U,ot,null,Je),F())},i(e){if(!n){for(let e=0;e<a.length;e+=1)N(o[e]);n=!0}},o(e){for(let e=0;e<o.length;e+=1)L(o[e]);n=!1},d(e){e&&f(t);for(let e=0;e<o.length;e+=1)o[e].d()}}}function tt(t){let n;function r(e,t){return e[3]?at:it}let o=r(t),i=o(t);return{c(){n=h("div"),i.c(),g(n,"class","text-center text-gray-500 p-4")},m(e,t){l(e,n,t),i.m(n,null)},p(e,t){o===(o=r(e))&&i?i.p(e,t):(i.d(1),i=o(e),i&&(i.c(),i.m(n,null)))},i:e,o:e,d(e){e&&f(n),i.d()}}}function nt(t){let n,r,o,i,a,u,s,d;return{c(){n=h("div"),r=h("p"),o=y("Error: "),i=y(t[2]),a=m(),u=h("button"),u.textContent="Retry",g(u,"class","mt-2 px-3 py-1 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700"),g(n,"class","text-center text-red-600 p-4")},m(e,f){l(e,n,f),c(n,r),c(r,o),c(r,i),c(n,a),c(n,u),s||(d=v(u,"click",t[5]),s=!0)},p(e,t){4&t&&b(i,e[2])},i:e,o:e,d(e){e&&f(n),s=!1,d()}}}function rt(t){let n;return{c(){n=h("div"),n.innerHTML='<div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>',g(n,"class","flex items-center justify-center h-32")},m(e,t){l(e,n,t)},p:e,i:e,o:e,d(e){e&&f(n)}}}function ot(e,t){let n,r,o;return r=new ae({props:{bookmark:t[9]}}),{key:e,first:null,c(){n=y(""),V(r.$$.fragment),this.first=n},m(e,t){l(e,n,t),W(r,e,t),o=!0},p(e,n){t=e;const o={};1&n&&(o.bookmark=t[9]),r.$set(o)},i(e){o||(N(r.$$.fragment,e),o=!0)},o(e){L(r.$$.fragment,e),o=!1},d(e){e&&f(n),Y(r,e)}}}function it(t){let n;return{c(){n=h("p"),n.textContent="No bookmarks found"},m(e,t){l(e,n,t)},p:e,d(e){e&&f(n)}}}function at(e){let t,n,r,o;return{c(){t=h("p"),n=y('No bookmarks found for "'),r=y(e[3]),o=y('"')},m(e,i){l(e,t,i),c(t,n),c(t,r),c(t,o)},p(e,t){8&t&&b(r,e[3])},d(e){e&&f(t)}}}function ut(e){let t,n,o,i,a,u,s,d,p,w,x,k,_,E,O,P,A,C,S,K,j,D,T,B,I,R=e[0].length+"",q=1!==e[0].length?"s":"";x=new ge({}),x.$on("search",e[6]);let M=e[4]&&Ze(e);const z=[rt,nt,tt,et],U=[];function H(e,t){return e[1]?0:e[2]?1:0===e[0].length?2:3}return j=H(e),D=U[j]=z[j](e),{c(){t=h("div"),n=h("div"),o=h("div"),i=h("h1"),i.textContent="Bookmark Insight",a=m(),u=h("div"),s=h("button"),s.innerHTML='<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z"></path></svg>',d=m(),p=h("button"),p.textContent="Dashboard",w=m(),V(x.$$.fragment),k=m(),_=h("div"),E=y(R),O=y(" bookmark"),P=y(q),A=m(),C=h("div"),M&&M.c(),S=m(),K=h("div"),D.c(),g(i,"class","text-lg font-semibold text-gray-900"),g(s,"class","p-2 text-gray-400 hover:text-gray-600 rounded-md hover:bg-gray-100"),g(s,"title","Toggle Filters"),g(p,"class","px-3 py-1 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700"),g(u,"class","flex space-x-2"),g(o,"class","flex items-center justify-between mb-3"),g(_,"class","text-xs text-gray-500"),g(n,"class","p-4 border-b border-gray-200 bg-gray-50"),g(K,"class","flex-1 overflow-y-auto p-4"),g(C,"class","flex flex-1 overflow-hidden"),g(t,"class","w-96 h-96 bg-white flex flex-col")},m(r,f){l(r,t,f),c(t,n),c(n,o),c(o,i),c(o,a),c(o,u),c(u,s),c(u,d),c(u,p),c(n,w),W(x,n,null),c(n,k),c(n,_),c(_,E),c(_,O),c(_,P),c(t,A),c(t,C),M&&M.m(C,null),c(C,S),c(C,K),U[j].m(K,null),T=!0,B||(I=[v(s,"click",e[8]),v(p,"click",st)],B=!0)},p(e,[t]){(!T||1&t)&&R!==(R=e[0].length+"")&&b(E,R),(!T||1&t)&&q!==(q=1!==e[0].length?"s":"")&&b(P,q),e[4]?M?(M.p(e,t),16&t&&N(M,1)):(M=Ze(e),M.c(),N(M,1),M.m(C,S)):M&&($(),L(M,1,1,()=>{M=null}),F());let n=j;j=H(e),j===n?U[j].p(e,t):($(),L(U[n],1,1,()=>{U[n]=null}),F(),D=U[j],D?D.p(e,t):(D=U[j]=z[j](e),D.c()),N(D,1),D.m(K,null))},i(e){T||(N(x.$$.fragment,e),N(M),N(D),T=!0)},o(e){L(x.$$.fragment,e),L(M),L(D),T=!1},d(e){e&&f(t),Y(x),M&&M.d(),U[j].d(),B=!1,r(I)}}}function st(){chrome.tabs.create({url:chrome.runtime.getURL("dashboard.html")}),window.close()}function ct(e,t,n){let r=[],o=!0,i=null,a="",u=!1;async function s(){n(0,r=await Pe())}return E(async()=>{try{await s()}catch(e){n(2,i=e.message)}finally{n(1,o=!1)}}),[r,o,i,a,u,s,async function(e){const t=e.detail.query;n(3,a=t);try{n(1,o=!0),n(0,r=await async function(e){try{if(!e||!e.trim())return await Oe.bookmarks.orderBy("dateAdded").reverse().toArray();const t=e.toLowerCase();return(await Oe.bookmarks.toArray()).filter(e=>e.title.toLowerCase().includes(t)||e.url.toLowerCase().includes(t)||e.domain&&e.domain.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t)||e.keywords&&e.keywords.some(e=>e.toLowerCase().includes(t))).sort((e,t)=>t.dateAdded-e.dateAdded)}catch(e){return console.error("Search error:",e),[]}}(t))}catch(e){n(2,i=e.message)}finally{n(1,o=!1)}},async function(e){const{type:t,value:a}=e.detail;try{switch(n(1,o=!0),t){case"clear":n(0,r=await Pe());break;case"domain":n(0,r=await async function(e){try{return await Oe.bookmarks.where("domain").equals(e).toArray()}catch(e){return console.error("Error getting bookmarks by domain:",e),[]}}(a));break;case"folder":n(0,r=await async function(e){try{return(await Pe()).filter(t=>t.folderPath===e)}catch(e){return console.error("Error getting bookmarks by folder:",e),[]}}(a));break;case"date":n(0,r=await async function(e,t){try{return await Oe.bookmarks.where("dateAdded").between(e,t,!0,!0).toArray()}catch(e){return console.error("Error getting bookmarks by date range:",e),[]}}(a.startDate,a.endDate))}}catch(e){n(2,i=e.message)}finally{n(1,o=!1)}},function(){n(4,u=!u)}]}const lt=new class extends G{constructor(e){super(),Q(this,e,ct,ut,i,{})}}({target:document.body});export{lt as default};
//# sourceMappingURL=popup.js.map
