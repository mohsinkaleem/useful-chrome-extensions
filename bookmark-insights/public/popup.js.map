{"version":3,"file":"popup.js","sources":["../node_modules/svelte/src/runtime/internal/utils.js","../node_modules/svelte/src/runtime/internal/lifecycle.js","../node_modules/svelte/src/runtime/internal/dom.js","../node_modules/svelte/src/runtime/internal/scheduler.js","../node_modules/svelte/src/runtime/internal/transitions.js","../node_modules/svelte/src/runtime/internal/each.js","../node_modules/svelte/src/runtime/internal/Component.js","../src/utils.js","../src/BookmarkCard.svelte","../node_modules/svelte/src/runtime/internal/disclose-version/index.js","../node_modules/svelte/src/shared/version.js","../src/SearchBar.svelte","../node_modules/dexie/dist/dexie.js","../node_modules/dexie/import-wrapper.mjs","../src/db.js","../src/Sidebar.svelte","../src/App.svelte","../src/popup.js"],"sourcesContent":["/** @returns {void} */\nexport function noop() {}\n\nexport const identity = (x) => x;\n\n/**\n * @template T\n * @template S\n * @param {T} tar\n * @param {S} src\n * @returns {T & S}\n */\nexport function assign(tar, src) {\n\t// @ts-ignore\n\tfor (const k in src) tar[k] = src[k];\n\treturn /** @type {T & S} */ (tar);\n}\n\n// Adapted from https://github.com/then/is-promise/blob/master/index.js\n// Distributed under MIT License https://github.com/then/is-promise/blob/master/LICENSE\n/**\n * @param {any} value\n * @returns {value is PromiseLike<any>}\n */\nexport function is_promise(value) {\n\treturn (\n\t\t!!value &&\n\t\t(typeof value === 'object' || typeof value === 'function') &&\n\t\ttypeof (/** @type {any} */ (value).then) === 'function'\n\t);\n}\n\n/** @returns {void} */\nexport function add_location(element, file, line, column, char) {\n\telement.__svelte_meta = {\n\t\tloc: { file, line, column, char }\n\t};\n}\n\nexport function run(fn) {\n\treturn fn();\n}\n\nexport function blank_object() {\n\treturn Object.create(null);\n}\n\n/**\n * @param {Function[]} fns\n * @returns {void}\n */\nexport function run_all(fns) {\n\tfns.forEach(run);\n}\n\n/**\n * @param {any} thing\n * @returns {thing is Function}\n */\nexport function is_function(thing) {\n\treturn typeof thing === 'function';\n}\n\n/** @returns {boolean} */\nexport function safe_not_equal(a, b) {\n\treturn a != a ? b == b : a !== b || (a && typeof a === 'object') || typeof a === 'function';\n}\n\nlet src_url_equal_anchor;\n\n/**\n * @param {string} element_src\n * @param {string} url\n * @returns {boolean}\n */\nexport function src_url_equal(element_src, url) {\n\tif (element_src === url) return true;\n\tif (!src_url_equal_anchor) {\n\t\tsrc_url_equal_anchor = document.createElement('a');\n\t}\n\t// This is actually faster than doing URL(..).href\n\tsrc_url_equal_anchor.href = url;\n\treturn element_src === src_url_equal_anchor.href;\n}\n\n/** @param {string} srcset */\nfunction split_srcset(srcset) {\n\treturn srcset.split(',').map((src) => src.trim().split(' ').filter(Boolean));\n}\n\n/**\n * @param {HTMLSourceElement | HTMLImageElement} element_srcset\n * @param {string | undefined | null} srcset\n * @returns {boolean}\n */\nexport function srcset_url_equal(element_srcset, srcset) {\n\tconst element_urls = split_srcset(element_srcset.srcset);\n\tconst urls = split_srcset(srcset || '');\n\n\treturn (\n\t\turls.length === element_urls.length &&\n\t\turls.every(\n\t\t\t([url, width], i) =>\n\t\t\t\twidth === element_urls[i][1] &&\n\t\t\t\t// We need to test both ways because Vite will create an a full URL with\n\t\t\t\t// `new URL(asset, import.meta.url).href` for the client when `base: './'`, and the\n\t\t\t\t// relative URLs inside srcset are not automatically resolved to absolute URLs by\n\t\t\t\t// browsers (in contrast to img.src). This means both SSR and DOM code could\n\t\t\t\t// contain relative or absolute URLs.\n\t\t\t\t(src_url_equal(element_urls[i][0], url) || src_url_equal(url, element_urls[i][0]))\n\t\t)\n\t);\n}\n\n/** @returns {boolean} */\nexport function not_equal(a, b) {\n\treturn a != a ? b == b : a !== b;\n}\n\n/** @returns {boolean} */\nexport function is_empty(obj) {\n\treturn Object.keys(obj).length === 0;\n}\n\n/** @returns {void} */\nexport function validate_store(store, name) {\n\tif (store != null && typeof store.subscribe !== 'function') {\n\t\tthrow new Error(`'${name}' is not a store with a 'subscribe' method`);\n\t}\n}\n\nexport function subscribe(store, ...callbacks) {\n\tif (store == null) {\n\t\tfor (const callback of callbacks) {\n\t\t\tcallback(undefined);\n\t\t}\n\t\treturn noop;\n\t}\n\tconst unsub = store.subscribe(...callbacks);\n\treturn unsub.unsubscribe ? () => unsub.unsubscribe() : unsub;\n}\n\n/**\n * Get the current value from a store by subscribing and immediately unsubscribing.\n *\n * https://svelte.dev/docs/svelte-store#get\n * @template T\n * @param {import('../store/public.js').Readable<T>} store\n * @returns {T}\n */\nexport function get_store_value(store) {\n\tlet value;\n\tsubscribe(store, (_) => (value = _))();\n\treturn value;\n}\n\n/** @returns {void} */\nexport function component_subscribe(component, store, callback) {\n\tcomponent.$$.on_destroy.push(subscribe(store, callback));\n}\n\nexport function create_slot(definition, ctx, $$scope, fn) {\n\tif (definition) {\n\t\tconst slot_ctx = get_slot_context(definition, ctx, $$scope, fn);\n\t\treturn definition[0](slot_ctx);\n\t}\n}\n\nfunction get_slot_context(definition, ctx, $$scope, fn) {\n\treturn definition[1] && fn ? assign($$scope.ctx.slice(), definition[1](fn(ctx))) : $$scope.ctx;\n}\n\nexport function get_slot_changes(definition, $$scope, dirty, fn) {\n\tif (definition[2] && fn) {\n\t\tconst lets = definition[2](fn(dirty));\n\t\tif ($$scope.dirty === undefined) {\n\t\t\treturn lets;\n\t\t}\n\t\tif (typeof lets === 'object') {\n\t\t\tconst merged = [];\n\t\t\tconst len = Math.max($$scope.dirty.length, lets.length);\n\t\t\tfor (let i = 0; i < len; i += 1) {\n\t\t\t\tmerged[i] = $$scope.dirty[i] | lets[i];\n\t\t\t}\n\t\t\treturn merged;\n\t\t}\n\t\treturn $$scope.dirty | lets;\n\t}\n\treturn $$scope.dirty;\n}\n\n/** @returns {void} */\nexport function update_slot_base(\n\tslot,\n\tslot_definition,\n\tctx,\n\t$$scope,\n\tslot_changes,\n\tget_slot_context_fn\n) {\n\tif (slot_changes) {\n\t\tconst slot_context = get_slot_context(slot_definition, ctx, $$scope, get_slot_context_fn);\n\t\tslot.p(slot_context, slot_changes);\n\t}\n}\n\n/** @returns {void} */\nexport function update_slot(\n\tslot,\n\tslot_definition,\n\tctx,\n\t$$scope,\n\tdirty,\n\tget_slot_changes_fn,\n\tget_slot_context_fn\n) {\n\tconst slot_changes = get_slot_changes(slot_definition, $$scope, dirty, get_slot_changes_fn);\n\tupdate_slot_base(slot, slot_definition, ctx, $$scope, slot_changes, get_slot_context_fn);\n}\n\n/** @returns {any[] | -1} */\nexport function get_all_dirty_from_scope($$scope) {\n\tif ($$scope.ctx.length > 32) {\n\t\tconst dirty = [];\n\t\tconst length = $$scope.ctx.length / 32;\n\t\tfor (let i = 0; i < length; i++) {\n\t\t\tdirty[i] = -1;\n\t\t}\n\t\treturn dirty;\n\t}\n\treturn -1;\n}\n\n/** @returns {{}} */\nexport function exclude_internal_props(props) {\n\tconst result = {};\n\tfor (const k in props) if (k[0] !== '$') result[k] = props[k];\n\treturn result;\n}\n\n/** @returns {{}} */\nexport function compute_rest_props(props, keys) {\n\tconst rest = {};\n\tkeys = new Set(keys);\n\tfor (const k in props) if (!keys.has(k) && k[0] !== '$') rest[k] = props[k];\n\treturn rest;\n}\n\n/** @returns {{}} */\nexport function compute_slots(slots) {\n\tconst result = {};\n\tfor (const key in slots) {\n\t\tresult[key] = true;\n\t}\n\treturn result;\n}\n\n/** @returns {(this: any, ...args: any[]) => void} */\nexport function once(fn) {\n\tlet ran = false;\n\treturn function (...args) {\n\t\tif (ran) return;\n\t\tran = true;\n\t\tfn.call(this, ...args);\n\t};\n}\n\nexport function null_to_empty(value) {\n\treturn value == null ? '' : value;\n}\n\nexport function set_store_value(store, ret, value) {\n\tstore.set(value);\n\treturn ret;\n}\n\nexport const has_prop = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop);\n\nexport function action_destroyer(action_result) {\n\treturn action_result && is_function(action_result.destroy) ? action_result.destroy : noop;\n}\n\n/** @param {number | string} value\n * @returns {[number, string]}\n */\nexport function split_css_unit(value) {\n\tconst split = typeof value === 'string' && value.match(/^\\s*(-?[\\d.]+)([^\\s]*)\\s*$/);\n\treturn split ? [parseFloat(split[1]), split[2] || 'px'] : [/** @type {number} */ (value), 'px'];\n}\n\nexport const contenteditable_truthy_values = ['', true, 1, 'true', 'contenteditable'];\n","import { custom_event } from './dom.js';\n\nexport let current_component;\n\n/** @returns {void} */\nexport function set_current_component(component) {\n\tcurrent_component = component;\n}\n\nexport function get_current_component() {\n\tif (!current_component) throw new Error('Function called outside component initialization');\n\treturn current_component;\n}\n\n/**\n * Schedules a callback to run immediately before the component is updated after any state change.\n *\n * The first time the callback runs will be before the initial `onMount`\n *\n * https://svelte.dev/docs/svelte#beforeupdate\n * @param {() => any} fn\n * @returns {void}\n */\nexport function beforeUpdate(fn) {\n\tget_current_component().$$.before_update.push(fn);\n}\n\n/**\n * The `onMount` function schedules a callback to run as soon as the component has been mounted to the DOM.\n * It must be called during the component's initialisation (but doesn't need to live *inside* the component;\n * it can be called from an external module).\n *\n * If a function is returned _synchronously_ from `onMount`, it will be called when the component is unmounted.\n *\n * `onMount` does not run inside a [server-side component](https://svelte.dev/docs#run-time-server-side-component-api).\n *\n * https://svelte.dev/docs/svelte#onmount\n * @template T\n * @param {() => import('./private.js').NotFunction<T> | Promise<import('./private.js').NotFunction<T>> | (() => any)} fn\n * @returns {void}\n */\nexport function onMount(fn) {\n\tget_current_component().$$.on_mount.push(fn);\n}\n\n/**\n * Schedules a callback to run immediately after the component has been updated.\n *\n * The first time the callback runs will be after the initial `onMount`\n *\n * https://svelte.dev/docs/svelte#afterupdate\n * @param {() => any} fn\n * @returns {void}\n */\nexport function afterUpdate(fn) {\n\tget_current_component().$$.after_update.push(fn);\n}\n\n/**\n * Schedules a callback to run immediately before the component is unmounted.\n *\n * Out of `onMount`, `beforeUpdate`, `afterUpdate` and `onDestroy`, this is the\n * only one that runs inside a server-side component.\n *\n * https://svelte.dev/docs/svelte#ondestroy\n * @param {() => any} fn\n * @returns {void}\n */\nexport function onDestroy(fn) {\n\tget_current_component().$$.on_destroy.push(fn);\n}\n\n/**\n * Creates an event dispatcher that can be used to dispatch [component events](https://svelte.dev/docs#template-syntax-component-directives-on-eventname).\n * Event dispatchers are functions that can take two arguments: `name` and `detail`.\n *\n * Component events created with `createEventDispatcher` create a\n * [CustomEvent](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent).\n * These events do not [bubble](https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Building_blocks/Events#Event_bubbling_and_capture).\n * The `detail` argument corresponds to the [CustomEvent.detail](https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/detail)\n * property and can contain any type of data.\n *\n * The event dispatcher can be typed to narrow the allowed event names and the type of the `detail` argument:\n * ```ts\n * const dispatch = createEventDispatcher<{\n *  loaded: never; // does not take a detail argument\n *  change: string; // takes a detail argument of type string, which is required\n *  optional: number | null; // takes an optional detail argument of type number\n * }>();\n * ```\n *\n * https://svelte.dev/docs/svelte#createeventdispatcher\n * @template {Record<string, any>} [EventMap=any]\n * @returns {import('./public.js').EventDispatcher<EventMap>}\n */\nexport function createEventDispatcher() {\n\tconst component = get_current_component();\n\treturn (type, detail, { cancelable = false } = {}) => {\n\t\tconst callbacks = component.$$.callbacks[type];\n\t\tif (callbacks) {\n\t\t\t// TODO are there situations where events could be dispatched\n\t\t\t// in a server (non-DOM) environment?\n\t\t\tconst event = custom_event(/** @type {string} */ (type), detail, { cancelable });\n\t\t\tcallbacks.slice().forEach((fn) => {\n\t\t\t\tfn.call(component, event);\n\t\t\t});\n\t\t\treturn !event.defaultPrevented;\n\t\t}\n\t\treturn true;\n\t};\n}\n\n/**\n * Associates an arbitrary `context` object with the current component and the specified `key`\n * and returns that object. The context is then available to children of the component\n * (including slotted content) with `getContext`.\n *\n * Like lifecycle functions, this must be called during component initialisation.\n *\n * https://svelte.dev/docs/svelte#setcontext\n * @template T\n * @param {any} key\n * @param {T} context\n * @returns {T}\n */\nexport function setContext(key, context) {\n\tget_current_component().$$.context.set(key, context);\n\treturn context;\n}\n\n/**\n * Retrieves the context that belongs to the closest parent component with the specified `key`.\n * Must be called during component initialisation.\n *\n * https://svelte.dev/docs/svelte#getcontext\n * @template T\n * @param {any} key\n * @returns {T}\n */\nexport function getContext(key) {\n\treturn get_current_component().$$.context.get(key);\n}\n\n/**\n * Retrieves the whole context map that belongs to the closest parent component.\n * Must be called during component initialisation. Useful, for example, if you\n * programmatically create a component and want to pass the existing context to it.\n *\n * https://svelte.dev/docs/svelte#getallcontexts\n * @template {Map<any, any>} [T=Map<any, any>]\n * @returns {T}\n */\nexport function getAllContexts() {\n\treturn get_current_component().$$.context;\n}\n\n/**\n * Checks whether a given `key` has been set in the context of a parent component.\n * Must be called during component initialisation.\n *\n * https://svelte.dev/docs/svelte#hascontext\n * @param {any} key\n * @returns {boolean}\n */\nexport function hasContext(key) {\n\treturn get_current_component().$$.context.has(key);\n}\n\n// TODO figure out if we still want to support\n// shorthand events, or if we want to implement\n// a real bubbling mechanism\n/**\n * @param component\n * @param event\n * @returns {void}\n */\nexport function bubble(component, event) {\n\tconst callbacks = component.$$.callbacks[event.type];\n\tif (callbacks) {\n\t\t// @ts-ignore\n\t\tcallbacks.slice().forEach((fn) => fn.call(this, event));\n\t}\n}\n","import { contenteditable_truthy_values, has_prop } from './utils.js';\n\nimport { ResizeObserverSingleton } from './ResizeObserverSingleton.js';\n\n// Track which nodes are claimed during hydration. Unclaimed nodes can then be removed from the DOM\n// at the end of hydration without touching the remaining nodes.\nlet is_hydrating = false;\n\n/**\n * @returns {void}\n */\nexport function start_hydrating() {\n\tis_hydrating = true;\n}\n\n/**\n * @returns {void}\n */\nexport function end_hydrating() {\n\tis_hydrating = false;\n}\n\n/**\n * @param {number} low\n * @param {number} high\n * @param {(index: number) => number} key\n * @param {number} value\n * @returns {number}\n */\nfunction upper_bound(low, high, key, value) {\n\t// Return first index of value larger than input value in the range [low, high)\n\twhile (low < high) {\n\t\tconst mid = low + ((high - low) >> 1);\n\t\tif (key(mid) <= value) {\n\t\t\tlow = mid + 1;\n\t\t} else {\n\t\t\thigh = mid;\n\t\t}\n\t}\n\treturn low;\n}\n\n/**\n * @param {NodeEx} target\n * @returns {void}\n */\nfunction init_hydrate(target) {\n\tif (target.hydrate_init) return;\n\ttarget.hydrate_init = true;\n\t// We know that all children have claim_order values since the unclaimed have been detached if target is not <head>\n\n\tlet children = /** @type {ArrayLike<NodeEx2>} */ (target.childNodes);\n\t// If target is <head>, there may be children without claim_order\n\tif (target.nodeName === 'HEAD') {\n\t\tconst my_children = [];\n\t\tfor (let i = 0; i < children.length; i++) {\n\t\t\tconst node = children[i];\n\t\t\tif (node.claim_order !== undefined) {\n\t\t\t\tmy_children.push(node);\n\t\t\t}\n\t\t}\n\t\tchildren = my_children;\n\t}\n\t/*\n\t * Reorder claimed children optimally.\n\t * We can reorder claimed children optimally by finding the longest subsequence of\n\t * nodes that are already claimed in order and only moving the rest. The longest\n\t * subsequence of nodes that are claimed in order can be found by\n\t * computing the longest increasing subsequence of .claim_order values.\n\t *\n\t * This algorithm is optimal in generating the least amount of reorder operations\n\t * possible.\n\t *\n\t * Proof:\n\t * We know that, given a set of reordering operations, the nodes that do not move\n\t * always form an increasing subsequence, since they do not move among each other\n\t * meaning that they must be already ordered among each other. Thus, the maximal\n\t * set of nodes that do not move form a longest increasing subsequence.\n\t */\n\t// Compute longest increasing subsequence\n\t// m: subsequence length j => index k of smallest value that ends an increasing subsequence of length j\n\tconst m = new Int32Array(children.length + 1);\n\t// Predecessor indices + 1\n\tconst p = new Int32Array(children.length);\n\tm[0] = -1;\n\tlet longest = 0;\n\tfor (let i = 0; i < children.length; i++) {\n\t\tconst current = children[i].claim_order;\n\t\t// Find the largest subsequence length such that it ends in a value less than our current value\n\t\t// upper_bound returns first greater value, so we subtract one\n\t\t// with fast path for when we are on the current longest subsequence\n\t\tconst seq_len =\n\t\t\t(longest > 0 && children[m[longest]].claim_order <= current\n\t\t\t\t? longest + 1\n\t\t\t\t: upper_bound(1, longest, (idx) => children[m[idx]].claim_order, current)) - 1;\n\t\tp[i] = m[seq_len] + 1;\n\t\tconst new_len = seq_len + 1;\n\t\t// We can guarantee that current is the smallest value. Otherwise, we would have generated a longer sequence.\n\t\tm[new_len] = i;\n\t\tlongest = Math.max(new_len, longest);\n\t}\n\t// The longest increasing subsequence of nodes (initially reversed)\n\n\t/**\n\t * @type {NodeEx2[]}\n\t */\n\tconst lis = [];\n\t// The rest of the nodes, nodes that will be moved\n\n\t/**\n\t * @type {NodeEx2[]}\n\t */\n\tconst to_move = [];\n\tlet last = children.length - 1;\n\tfor (let cur = m[longest] + 1; cur != 0; cur = p[cur - 1]) {\n\t\tlis.push(children[cur - 1]);\n\t\tfor (; last >= cur; last--) {\n\t\t\tto_move.push(children[last]);\n\t\t}\n\t\tlast--;\n\t}\n\tfor (; last >= 0; last--) {\n\t\tto_move.push(children[last]);\n\t}\n\tlis.reverse();\n\t// We sort the nodes being moved to guarantee that their insertion order matches the claim order\n\tto_move.sort((a, b) => a.claim_order - b.claim_order);\n\t// Finally, we move the nodes\n\tfor (let i = 0, j = 0; i < to_move.length; i++) {\n\t\twhile (j < lis.length && to_move[i].claim_order >= lis[j].claim_order) {\n\t\t\tj++;\n\t\t}\n\t\tconst anchor = j < lis.length ? lis[j] : null;\n\t\ttarget.insertBefore(to_move[i], anchor);\n\t}\n}\n\n/**\n * @param {Node} target\n * @param {Node} node\n * @returns {void}\n */\nexport function append(target, node) {\n\ttarget.appendChild(node);\n}\n\n/**\n * @param {Node} target\n * @param {string} style_sheet_id\n * @param {string} styles\n * @returns {void}\n */\nexport function append_styles(target, style_sheet_id, styles) {\n\tconst append_styles_to = get_root_for_style(target);\n\tif (!append_styles_to.getElementById(style_sheet_id)) {\n\t\tconst style = element('style');\n\t\tstyle.id = style_sheet_id;\n\t\tstyle.textContent = styles;\n\t\tappend_stylesheet(append_styles_to, style);\n\t}\n}\n\n/**\n * @param {Node} node\n * @returns {ShadowRoot | Document}\n */\nexport function get_root_for_style(node) {\n\tif (!node) return document;\n\tconst root = node.getRootNode ? node.getRootNode() : node.ownerDocument;\n\tif (root && /** @type {ShadowRoot} */ (root).host) {\n\t\treturn /** @type {ShadowRoot} */ (root);\n\t}\n\treturn node.ownerDocument;\n}\n\n/**\n * @param {Node} node\n * @returns {CSSStyleSheet}\n */\nexport function append_empty_stylesheet(node) {\n\tconst style_element = element('style');\n\t// For transitions to work without 'style-src: unsafe-inline' Content Security Policy,\n\t// these empty tags need to be allowed with a hash as a workaround until we move to the Web Animations API.\n\t// Using the hash for the empty string (for an empty tag) works in all browsers except Safari.\n\t// So as a workaround for the workaround, when we append empty style tags we set their content to /* empty */.\n\t// The hash 'sha256-9OlNO0DNEeaVzHL4RZwCLsBHA8WBQ8toBp/4F5XV2nc=' will then work even in Safari.\n\tstyle_element.textContent = '/* empty */';\n\tappend_stylesheet(get_root_for_style(node), style_element);\n\treturn style_element.sheet;\n}\n\n/**\n * @param {ShadowRoot | Document} node\n * @param {HTMLStyleElement} style\n * @returns {CSSStyleSheet}\n */\nfunction append_stylesheet(node, style) {\n\tappend(/** @type {Document} */ (node).head || node, style);\n\treturn style.sheet;\n}\n\n/**\n * @param {NodeEx} target\n * @param {NodeEx} node\n * @returns {void}\n */\nexport function append_hydration(target, node) {\n\tif (is_hydrating) {\n\t\tinit_hydrate(target);\n\t\tif (\n\t\t\ttarget.actual_end_child === undefined ||\n\t\t\t(target.actual_end_child !== null && target.actual_end_child.parentNode !== target)\n\t\t) {\n\t\t\ttarget.actual_end_child = target.firstChild;\n\t\t}\n\t\t// Skip nodes of undefined ordering\n\t\twhile (target.actual_end_child !== null && target.actual_end_child.claim_order === undefined) {\n\t\t\ttarget.actual_end_child = target.actual_end_child.nextSibling;\n\t\t}\n\t\tif (node !== target.actual_end_child) {\n\t\t\t// We only insert if the ordering of this node should be modified or the parent node is not target\n\t\t\tif (node.claim_order !== undefined || node.parentNode !== target) {\n\t\t\t\ttarget.insertBefore(node, target.actual_end_child);\n\t\t\t}\n\t\t} else {\n\t\t\ttarget.actual_end_child = node.nextSibling;\n\t\t}\n\t} else if (node.parentNode !== target || node.nextSibling !== null) {\n\t\ttarget.appendChild(node);\n\t}\n}\n\n/**\n * @param {Node} target\n * @param {Node} node\n * @param {Node} [anchor]\n * @returns {void}\n */\nexport function insert(target, node, anchor) {\n\ttarget.insertBefore(node, anchor || null);\n}\n\n/**\n * @param {NodeEx} target\n * @param {NodeEx} node\n * @param {NodeEx} [anchor]\n * @returns {void}\n */\nexport function insert_hydration(target, node, anchor) {\n\tif (is_hydrating && !anchor) {\n\t\tappend_hydration(target, node);\n\t} else if (node.parentNode !== target || node.nextSibling != anchor) {\n\t\ttarget.insertBefore(node, anchor || null);\n\t}\n}\n\n/**\n * @param {Node} node\n * @returns {void}\n */\nexport function detach(node) {\n\tif (node.parentNode) {\n\t\tnode.parentNode.removeChild(node);\n\t}\n}\n\n/**\n * @returns {void} */\nexport function destroy_each(iterations, detaching) {\n\tfor (let i = 0; i < iterations.length; i += 1) {\n\t\tif (iterations[i]) iterations[i].d(detaching);\n\t}\n}\n\n/**\n * @template {keyof HTMLElementTagNameMap} K\n * @param {K} name\n * @returns {HTMLElementTagNameMap[K]}\n */\nexport function element(name) {\n\treturn document.createElement(name);\n}\n\n/**\n * @template {keyof HTMLElementTagNameMap} K\n * @param {K} name\n * @param {string} is\n * @returns {HTMLElementTagNameMap[K]}\n */\nexport function element_is(name, is) {\n\treturn document.createElement(name, { is });\n}\n\n/**\n * @template T\n * @template {keyof T} K\n * @param {T} obj\n * @param {K[]} exclude\n * @returns {Pick<T, Exclude<keyof T, K>>}\n */\nexport function object_without_properties(obj, exclude) {\n\tconst target = /** @type {Pick<T, Exclude<keyof T, K>>} */ ({});\n\tfor (const k in obj) {\n\t\tif (\n\t\t\thas_prop(obj, k) &&\n\t\t\t// @ts-ignore\n\t\t\texclude.indexOf(k) === -1\n\t\t) {\n\t\t\t// @ts-ignore\n\t\t\ttarget[k] = obj[k];\n\t\t}\n\t}\n\treturn target;\n}\n\n/**\n * @template {keyof SVGElementTagNameMap} K\n * @param {K} name\n * @returns {SVGElement}\n */\nexport function svg_element(name) {\n\treturn document.createElementNS('http://www.w3.org/2000/svg', name);\n}\n\n/**\n * @param {string} data\n * @returns {Text}\n */\nexport function text(data) {\n\treturn document.createTextNode(data);\n}\n\n/**\n * @returns {Text} */\nexport function space() {\n\treturn text(' ');\n}\n\n/**\n * @returns {Text} */\nexport function empty() {\n\treturn text('');\n}\n\n/**\n * @param {string} content\n * @returns {Comment}\n */\nexport function comment(content) {\n\treturn document.createComment(content);\n}\n\n/**\n * @param {EventTarget} node\n * @param {string} event\n * @param {EventListenerOrEventListenerObject} handler\n * @param {boolean | AddEventListenerOptions | EventListenerOptions} [options]\n * @returns {() => void}\n */\nexport function listen(node, event, handler, options) {\n\tnode.addEventListener(event, handler, options);\n\treturn () => node.removeEventListener(event, handler, options);\n}\n\n/**\n * @returns {(event: any) => any} */\nexport function prevent_default(fn) {\n\treturn function (event) {\n\t\tevent.preventDefault();\n\t\t// @ts-ignore\n\t\treturn fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => any} */\nexport function stop_propagation(fn) {\n\treturn function (event) {\n\t\tevent.stopPropagation();\n\t\t// @ts-ignore\n\t\treturn fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => any} */\nexport function stop_immediate_propagation(fn) {\n\treturn function (event) {\n\t\tevent.stopImmediatePropagation();\n\t\t// @ts-ignore\n\t\treturn fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => void} */\nexport function self(fn) {\n\treturn function (event) {\n\t\t// @ts-ignore\n\t\tif (event.target === this) fn.call(this, event);\n\t};\n}\n\n/**\n * @returns {(event: any) => void} */\nexport function trusted(fn) {\n\treturn function (event) {\n\t\t// @ts-ignore\n\t\tif (event.isTrusted) fn.call(this, event);\n\t};\n}\n\n/**\n * @param {Element} node\n * @param {string} attribute\n * @param {string} [value]\n * @returns {void}\n */\nexport function attr(node, attribute, value) {\n\tif (value == null) node.removeAttribute(attribute);\n\telse if (node.getAttribute(attribute) !== value) node.setAttribute(attribute, value);\n}\n/**\n * List of attributes that should always be set through the attr method,\n * because updating them through the property setter doesn't work reliably.\n * In the example of `width`/`height`, the problem is that the setter only\n * accepts numeric values, but the attribute can also be set to a string like `50%`.\n * If this list becomes too big, rethink this approach.\n */\nconst always_set_through_set_attribute = ['width', 'height'];\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {{ [x: string]: string }} attributes\n * @returns {void}\n */\nexport function set_attributes(node, attributes) {\n\t// @ts-ignore\n\tconst descriptors = Object.getOwnPropertyDescriptors(node.__proto__);\n\tfor (const key in attributes) {\n\t\tif (attributes[key] == null) {\n\t\t\tnode.removeAttribute(key);\n\t\t} else if (key === 'style') {\n\t\t\tnode.style.cssText = attributes[key];\n\t\t} else if (key === '__value') {\n\t\t\t/** @type {any} */ (node).value = node[key] = attributes[key];\n\t\t} else if (\n\t\t\tdescriptors[key] &&\n\t\t\tdescriptors[key].set &&\n\t\t\talways_set_through_set_attribute.indexOf(key) === -1\n\t\t) {\n\t\t\tnode[key] = attributes[key];\n\t\t} else {\n\t\t\tattr(node, key, attributes[key]);\n\t\t}\n\t}\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {{ [x: string]: string }} attributes\n * @returns {void}\n */\nexport function set_svg_attributes(node, attributes) {\n\tfor (const key in attributes) {\n\t\tattr(node, key, attributes[key]);\n\t}\n}\n\n/**\n * @param {Record<string, unknown>} data_map\n * @returns {void}\n */\nexport function set_custom_element_data_map(node, data_map) {\n\tObject.keys(data_map).forEach((key) => {\n\t\tset_custom_element_data(node, key, data_map[key]);\n\t});\n}\n\n/**\n * @returns {void} */\nexport function set_custom_element_data(node, prop, value) {\n\tconst lower = prop.toLowerCase(); // for backwards compatibility with existing behavior we do lowercase first\n\tif (lower in node) {\n\t\tnode[lower] = typeof node[lower] === 'boolean' && value === '' ? true : value;\n\t} else if (prop in node) {\n\t\tnode[prop] = typeof node[prop] === 'boolean' && value === '' ? true : value;\n\t} else {\n\t\tattr(node, prop, value);\n\t}\n}\n\n/**\n * @param {string} tag\n */\nexport function set_dynamic_element_data(tag) {\n\treturn /-/.test(tag) ? set_custom_element_data_map : set_attributes;\n}\n\n/**\n * @returns {void}\n */\nexport function xlink_attr(node, attribute, value) {\n\tnode.setAttributeNS('http://www.w3.org/1999/xlink', attribute, value);\n}\n\n/**\n * @param {HTMLElement} node\n * @returns {string}\n */\nexport function get_svelte_dataset(node) {\n\treturn node.dataset.svelteH;\n}\n\n/**\n * @returns {unknown[]} */\nexport function get_binding_group_value(group, __value, checked) {\n\tconst value = new Set();\n\tfor (let i = 0; i < group.length; i += 1) {\n\t\tif (group[i].checked) value.add(group[i].__value);\n\t}\n\tif (!checked) {\n\t\tvalue.delete(__value);\n\t}\n\treturn Array.from(value);\n}\n\n/**\n * @param {HTMLInputElement[]} group\n * @returns {{ p(...inputs: HTMLInputElement[]): void; r(): void; }}\n */\nexport function init_binding_group(group) {\n\t/**\n\t * @type {HTMLInputElement[]} */\n\tlet _inputs;\n\treturn {\n\t\t/* push */ p(...inputs) {\n\t\t\t_inputs = inputs;\n\t\t\t_inputs.forEach((input) => group.push(input));\n\t\t},\n\t\t/* remove */ r() {\n\t\t\t_inputs.forEach((input) => group.splice(group.indexOf(input), 1));\n\t\t}\n\t};\n}\n\n/**\n * @param {number[]} indexes\n * @returns {{ u(new_indexes: number[]): void; p(...inputs: HTMLInputElement[]): void; r: () => void; }}\n */\nexport function init_binding_group_dynamic(group, indexes) {\n\t/**\n\t * @type {HTMLInputElement[]} */\n\tlet _group = get_binding_group(group);\n\n\t/**\n\t * @type {HTMLInputElement[]} */\n\tlet _inputs;\n\n\tfunction get_binding_group(group) {\n\t\tfor (let i = 0; i < indexes.length; i++) {\n\t\t\tgroup = group[indexes[i]] = group[indexes[i]] || [];\n\t\t}\n\t\treturn group;\n\t}\n\n\t/**\n\t * @returns {void} */\n\tfunction push() {\n\t\t_inputs.forEach((input) => _group.push(input));\n\t}\n\n\t/**\n\t * @returns {void} */\n\tfunction remove() {\n\t\t_inputs.forEach((input) => _group.splice(_group.indexOf(input), 1));\n\t}\n\treturn {\n\t\t/* update */ u(new_indexes) {\n\t\t\tindexes = new_indexes;\n\t\t\tconst new_group = get_binding_group(group);\n\t\t\tif (new_group !== _group) {\n\t\t\t\tremove();\n\t\t\t\t_group = new_group;\n\t\t\t\tpush();\n\t\t\t}\n\t\t},\n\t\t/* push */ p(...inputs) {\n\t\t\t_inputs = inputs;\n\t\t\tpush();\n\t\t},\n\t\t/* remove */ r: remove\n\t};\n}\n\n/** @returns {number} */\nexport function to_number(value) {\n\treturn value === '' ? null : +value;\n}\n\n/** @returns {any[]} */\nexport function time_ranges_to_array(ranges) {\n\tconst array = [];\n\tfor (let i = 0; i < ranges.length; i += 1) {\n\t\tarray.push({ start: ranges.start(i), end: ranges.end(i) });\n\t}\n\treturn array;\n}\n\n/**\n * @param {Element} element\n * @returns {ChildNode[]}\n */\nexport function children(element) {\n\treturn Array.from(element.childNodes);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @returns {void}\n */\nfunction init_claim_info(nodes) {\n\tif (nodes.claim_info === undefined) {\n\t\tnodes.claim_info = { last_index: 0, total_claimed: 0 };\n\t}\n}\n\n/**\n * @template {ChildNodeEx} R\n * @param {ChildNodeArray} nodes\n * @param {(node: ChildNodeEx) => node is R} predicate\n * @param {(node: ChildNodeEx) => ChildNodeEx | undefined} process_node\n * @param {() => R} create_node\n * @param {boolean} dont_update_last_index\n * @returns {R}\n */\nfunction claim_node(nodes, predicate, process_node, create_node, dont_update_last_index = false) {\n\t// Try to find nodes in an order such that we lengthen the longest increasing subsequence\n\tinit_claim_info(nodes);\n\tconst result_node = (() => {\n\t\t// We first try to find an element after the previous one\n\t\tfor (let i = nodes.claim_info.last_index; i < nodes.length; i++) {\n\t\t\tconst node = nodes[i];\n\t\t\tif (predicate(node)) {\n\t\t\t\tconst replacement = process_node(node);\n\t\t\t\tif (replacement === undefined) {\n\t\t\t\t\tnodes.splice(i, 1);\n\t\t\t\t} else {\n\t\t\t\t\tnodes[i] = replacement;\n\t\t\t\t}\n\t\t\t\tif (!dont_update_last_index) {\n\t\t\t\t\tnodes.claim_info.last_index = i;\n\t\t\t\t}\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t\t// Otherwise, we try to find one before\n\t\t// We iterate in reverse so that we don't go too far back\n\t\tfor (let i = nodes.claim_info.last_index - 1; i >= 0; i--) {\n\t\t\tconst node = nodes[i];\n\t\t\tif (predicate(node)) {\n\t\t\t\tconst replacement = process_node(node);\n\t\t\t\tif (replacement === undefined) {\n\t\t\t\t\tnodes.splice(i, 1);\n\t\t\t\t} else {\n\t\t\t\t\tnodes[i] = replacement;\n\t\t\t\t}\n\t\t\t\tif (!dont_update_last_index) {\n\t\t\t\t\tnodes.claim_info.last_index = i;\n\t\t\t\t} else if (replacement === undefined) {\n\t\t\t\t\t// Since we spliced before the last_index, we decrease it\n\t\t\t\t\tnodes.claim_info.last_index--;\n\t\t\t\t}\n\t\t\t\treturn node;\n\t\t\t}\n\t\t}\n\t\t// If we can't find any matching node, we create a new one\n\t\treturn create_node();\n\t})();\n\tresult_node.claim_order = nodes.claim_info.total_claimed;\n\tnodes.claim_info.total_claimed += 1;\n\treturn result_node;\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @param {string} name\n * @param {{ [key: string]: boolean }} attributes\n * @param {(name: string) => Element | SVGElement} create_element\n * @returns {Element | SVGElement}\n */\nfunction claim_element_base(nodes, name, attributes, create_element) {\n\treturn claim_node(\n\t\tnodes,\n\t\t/** @returns {node is Element | SVGElement} */\n\t\t(node) => node.nodeName === name,\n\t\t/** @param {Element} node */\n\t\t(node) => {\n\t\t\tconst remove = [];\n\t\t\tfor (let j = 0; j < node.attributes.length; j++) {\n\t\t\t\tconst attribute = node.attributes[j];\n\t\t\t\tif (!attributes[attribute.name]) {\n\t\t\t\t\tremove.push(attribute.name);\n\t\t\t\t}\n\t\t\t}\n\t\t\tremove.forEach((v) => node.removeAttribute(v));\n\t\t\treturn undefined;\n\t\t},\n\t\t() => create_element(name)\n\t);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @param {string} name\n * @param {{ [key: string]: boolean }} attributes\n * @returns {Element | SVGElement}\n */\nexport function claim_element(nodes, name, attributes) {\n\treturn claim_element_base(nodes, name, attributes, element);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @param {string} name\n * @param {{ [key: string]: boolean }} attributes\n * @returns {Element | SVGElement}\n */\nexport function claim_svg_element(nodes, name, attributes) {\n\treturn claim_element_base(nodes, name, attributes, svg_element);\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @returns {Text}\n */\nexport function claim_text(nodes, data) {\n\treturn claim_node(\n\t\tnodes,\n\t\t/** @returns {node is Text} */\n\t\t(node) => node.nodeType === 3,\n\t\t/** @param {Text} node */\n\t\t(node) => {\n\t\t\tconst data_str = '' + data;\n\t\t\tif (node.data.startsWith(data_str)) {\n\t\t\t\tif (node.data.length !== data_str.length) {\n\t\t\t\t\treturn node.splitText(data_str.length);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnode.data = data_str;\n\t\t\t}\n\t\t},\n\t\t() => text(data),\n\t\ttrue // Text nodes should not update last index since it is likely not worth it to eliminate an increasing subsequence of actual elements\n\t);\n}\n\n/**\n * @returns {Text} */\nexport function claim_space(nodes) {\n\treturn claim_text(nodes, ' ');\n}\n\n/**\n * @param {ChildNodeArray} nodes\n * @returns {Comment}\n */\nexport function claim_comment(nodes, data) {\n\treturn claim_node(\n\t\tnodes,\n\t\t/** @returns {node is Comment} */\n\t\t(node) => node.nodeType === 8,\n\t\t/** @param {Comment} node */\n\t\t(node) => {\n\t\t\tnode.data = '' + data;\n\t\t\treturn undefined;\n\t\t},\n\t\t() => comment(data),\n\t\ttrue\n\t);\n}\n\nfunction get_comment_idx(nodes, text, start) {\n\tfor (let i = start; i < nodes.length; i += 1) {\n\t\tconst node = nodes[i];\n\t\tif (node.nodeType === 8 /* comment node */ && node.textContent.trim() === text) {\n\t\t\treturn i;\n\t\t}\n\t}\n\treturn -1;\n}\n\n/**\n * @param {boolean} is_svg\n * @returns {HtmlTagHydration}\n */\nexport function claim_html_tag(nodes, is_svg) {\n\t// find html opening tag\n\tconst start_index = get_comment_idx(nodes, 'HTML_TAG_START', 0);\n\tconst end_index = get_comment_idx(nodes, 'HTML_TAG_END', start_index + 1);\n\tif (start_index === -1 || end_index === -1) {\n\t\treturn new HtmlTagHydration(is_svg);\n\t}\n\n\tinit_claim_info(nodes);\n\tconst html_tag_nodes = nodes.splice(start_index, end_index - start_index + 1);\n\tdetach(html_tag_nodes[0]);\n\tdetach(html_tag_nodes[html_tag_nodes.length - 1]);\n\tconst claimed_nodes = html_tag_nodes.slice(1, html_tag_nodes.length - 1);\n\tif (claimed_nodes.length === 0) {\n\t\treturn new HtmlTagHydration(is_svg);\n\t}\n\tfor (const n of claimed_nodes) {\n\t\tn.claim_order = nodes.claim_info.total_claimed;\n\t\tnodes.claim_info.total_claimed += 1;\n\t}\n\treturn new HtmlTagHydration(is_svg, claimed_nodes);\n}\n\n/**\n * @param {Text} text\n * @param {unknown} data\n * @returns {void}\n */\nexport function set_data(text, data) {\n\tdata = '' + data;\n\tif (text.data === data) return;\n\ttext.data = /** @type {string} */ (data);\n}\n\n/**\n * @param {Text} text\n * @param {unknown} data\n * @returns {void}\n */\nexport function set_data_contenteditable(text, data) {\n\tdata = '' + data;\n\tif (text.wholeText === data) return;\n\ttext.data = /** @type {string} */ (data);\n}\n\n/**\n * @param {Text} text\n * @param {unknown} data\n * @param {string} attr_value\n * @returns {void}\n */\nexport function set_data_maybe_contenteditable(text, data, attr_value) {\n\tif (~contenteditable_truthy_values.indexOf(attr_value)) {\n\t\tset_data_contenteditable(text, data);\n\t} else {\n\t\tset_data(text, data);\n\t}\n}\n\n/**\n * @returns {void} */\nexport function set_input_value(input, value) {\n\tinput.value = value == null ? '' : value;\n}\n\n/**\n * @returns {void} */\nexport function set_input_type(input, type) {\n\ttry {\n\t\tinput.type = type;\n\t} catch (e) {\n\t\t// do nothing\n\t}\n}\n\n/**\n * @returns {void} */\nexport function set_style(node, key, value, important) {\n\tif (value == null) {\n\t\tnode.style.removeProperty(key);\n\t} else {\n\t\tnode.style.setProperty(key, value, important ? 'important' : '');\n\t}\n}\n\n/**\n * @returns {void} */\nexport function select_option(select, value, mounting) {\n\tfor (let i = 0; i < select.options.length; i += 1) {\n\t\tconst option = select.options[i];\n\t\tif (option.__value === value) {\n\t\t\toption.selected = true;\n\t\t\treturn;\n\t\t}\n\t}\n\tif (!mounting || value !== undefined) {\n\t\tselect.selectedIndex = -1; // no option should be selected\n\t}\n}\n\n/**\n * @returns {void} */\nexport function select_options(select, value) {\n\tfor (let i = 0; i < select.options.length; i += 1) {\n\t\tconst option = select.options[i];\n\t\toption.selected = ~value.indexOf(option.__value);\n\t}\n}\n\nexport function select_value(select) {\n\tconst selected_option = select.querySelector(':checked');\n\treturn selected_option && selected_option.__value;\n}\n\nexport function select_multiple_value(select) {\n\treturn [].map.call(select.querySelectorAll(':checked'), (option) => option.__value);\n}\n// unfortunately this can't be a constant as that wouldn't be tree-shakeable\n// so we cache the result instead\n\n/**\n * @type {boolean} */\nlet crossorigin;\n\n/**\n * @returns {boolean} */\nexport function is_crossorigin() {\n\tif (crossorigin === undefined) {\n\t\tcrossorigin = false;\n\t\ttry {\n\t\t\tif (typeof window !== 'undefined' && window.parent) {\n\t\t\t\tvoid window.parent.document;\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tcrossorigin = true;\n\t\t}\n\t}\n\treturn crossorigin;\n}\n\n/**\n * @param {HTMLElement} node\n * @param {() => void} fn\n * @returns {() => void}\n */\nexport function add_iframe_resize_listener(node, fn) {\n\tconst computed_style = getComputedStyle(node);\n\tif (computed_style.position === 'static') {\n\t\tnode.style.position = 'relative';\n\t}\n\tconst iframe = element('iframe');\n\tiframe.setAttribute(\n\t\t'style',\n\t\t'display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; ' +\n\t\t\t'overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;'\n\t);\n\tiframe.setAttribute('aria-hidden', 'true');\n\tiframe.tabIndex = -1;\n\tconst crossorigin = is_crossorigin();\n\n\t/**\n\t * @type {() => void}\n\t */\n\tlet unsubscribe;\n\tif (crossorigin) {\n\t\tiframe.src = \"data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}</script>\";\n\t\tunsubscribe = listen(\n\t\t\twindow,\n\t\t\t'message',\n\t\t\t/** @param {MessageEvent} event */ (event) => {\n\t\t\t\tif (event.source === iframe.contentWindow) fn();\n\t\t\t}\n\t\t);\n\t} else {\n\t\tiframe.src = 'about:blank';\n\t\tiframe.onload = () => {\n\t\t\tunsubscribe = listen(iframe.contentWindow, 'resize', fn);\n\t\t\t// make sure an initial resize event is fired _after_ the iframe is loaded (which is asynchronous)\n\t\t\t// see https://github.com/sveltejs/svelte/issues/4233\n\t\t\tfn();\n\t\t};\n\t}\n\tappend(node, iframe);\n\treturn () => {\n\t\tif (crossorigin) {\n\t\t\tunsubscribe();\n\t\t} else if (unsubscribe && iframe.contentWindow) {\n\t\t\tunsubscribe();\n\t\t}\n\t\tdetach(iframe);\n\t};\n}\nexport const resize_observer_content_box = /* @__PURE__ */ new ResizeObserverSingleton({\n\tbox: 'content-box'\n});\nexport const resize_observer_border_box = /* @__PURE__ */ new ResizeObserverSingleton({\n\tbox: 'border-box'\n});\nexport const resize_observer_device_pixel_content_box = /* @__PURE__ */ new ResizeObserverSingleton(\n\t{ box: 'device-pixel-content-box' }\n);\nexport { ResizeObserverSingleton };\n\n/**\n * @returns {void} */\nexport function toggle_class(element, name, toggle) {\n\t// The `!!` is required because an `undefined` flag means flipping the current state.\n\telement.classList.toggle(name, !!toggle);\n}\n\n/**\n * @template T\n * @param {string} type\n * @param {T} [detail]\n * @param {{ bubbles?: boolean, cancelable?: boolean }} [options]\n * @returns {CustomEvent<T>}\n */\nexport function custom_event(type, detail, { bubbles = false, cancelable = false } = {}) {\n\treturn new CustomEvent(type, { detail, bubbles, cancelable });\n}\n\n/**\n * @param {string} selector\n * @param {HTMLElement} parent\n * @returns {ChildNodeArray}\n */\nexport function query_selector_all(selector, parent = document.body) {\n\treturn Array.from(parent.querySelectorAll(selector));\n}\n\n/**\n * @param {string} nodeId\n * @param {HTMLElement} head\n * @returns {any[]}\n */\nexport function head_selector(nodeId, head) {\n\tconst result = [];\n\tlet started = 0;\n\tfor (const node of head.childNodes) {\n\t\tif (node.nodeType === 8 /* comment node */) {\n\t\t\tconst comment = node.textContent.trim();\n\t\t\tif (comment === `HEAD_${nodeId}_END`) {\n\t\t\t\tstarted -= 1;\n\t\t\t\tresult.push(node);\n\t\t\t} else if (comment === `HEAD_${nodeId}_START`) {\n\t\t\t\tstarted += 1;\n\t\t\t\tresult.push(node);\n\t\t\t}\n\t\t} else if (started > 0) {\n\t\t\tresult.push(node);\n\t\t}\n\t}\n\treturn result;\n}\n/** */\nexport class HtmlTag {\n\t/**\n\t * @private\n\t * @default false\n\t */\n\tis_svg = false;\n\t/** parent for creating node */\n\te = undefined;\n\t/** html tag nodes */\n\tn = undefined;\n\t/** target */\n\tt = undefined;\n\t/** anchor */\n\ta = undefined;\n\tconstructor(is_svg = false) {\n\t\tthis.is_svg = is_svg;\n\t\tthis.e = this.n = null;\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\tc(html) {\n\t\tthis.h(html);\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @param {HTMLElement | SVGElement} target\n\t * @param {HTMLElement | SVGElement} anchor\n\t * @returns {void}\n\t */\n\tm(html, target, anchor = null) {\n\t\tif (!this.e) {\n\t\t\tif (this.is_svg)\n\t\t\t\tthis.e = svg_element(/** @type {keyof SVGElementTagNameMap} */ (target.nodeName));\n\t\t\t/** #7364  target for <template> may be provided as #document-fragment(11) */ else\n\t\t\t\tthis.e = element(\n\t\t\t\t\t/** @type {keyof HTMLElementTagNameMap} */ (\n\t\t\t\t\t\ttarget.nodeType === 11 ? 'TEMPLATE' : target.nodeName\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\tthis.t =\n\t\t\t\ttarget.tagName !== 'TEMPLATE'\n\t\t\t\t\t? target\n\t\t\t\t\t: /** @type {HTMLTemplateElement} */ (target).content;\n\t\t\tthis.c(html);\n\t\t}\n\t\tthis.i(anchor);\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\th(html) {\n\t\tthis.e.innerHTML = html;\n\t\tthis.n = Array.from(\n\t\t\tthis.e.nodeName === 'TEMPLATE' ? this.e.content.childNodes : this.e.childNodes\n\t\t);\n\t}\n\n\t/**\n\t * @returns {void} */\n\ti(anchor) {\n\t\tfor (let i = 0; i < this.n.length; i += 1) {\n\t\t\tinsert(this.t, this.n[i], anchor);\n\t\t}\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\tp(html) {\n\t\tthis.d();\n\t\tthis.h(html);\n\t\tthis.i(this.a);\n\t}\n\n\t/**\n\t * @returns {void} */\n\td() {\n\t\tthis.n.forEach(detach);\n\t}\n}\n\nexport class HtmlTagHydration extends HtmlTag {\n\t/** @type {Element[]} hydration claimed nodes */\n\tl = undefined;\n\n\tconstructor(is_svg = false, claimed_nodes) {\n\t\tsuper(is_svg);\n\t\tthis.e = this.n = null;\n\t\tthis.l = claimed_nodes;\n\t}\n\n\t/**\n\t * @param {string} html\n\t * @returns {void}\n\t */\n\tc(html) {\n\t\tif (this.l) {\n\t\t\tthis.n = this.l;\n\t\t} else {\n\t\t\tsuper.c(html);\n\t\t}\n\t}\n\n\t/**\n\t * @returns {void} */\n\ti(anchor) {\n\t\tfor (let i = 0; i < this.n.length; i += 1) {\n\t\t\tinsert_hydration(this.t, this.n[i], anchor);\n\t\t}\n\t}\n}\n\n/**\n * @param {NamedNodeMap} attributes\n * @returns {{}}\n */\nexport function attribute_to_object(attributes) {\n\tconst result = {};\n\tfor (const attribute of attributes) {\n\t\tresult[attribute.name] = attribute.value;\n\t}\n\treturn result;\n}\n\nconst escaped = {\n\t'\"': '&quot;',\n\t'&': '&amp;',\n\t'<': '&lt;'\n};\n\nconst regex_attribute_characters_to_escape = /[\"&<]/g;\n\n/**\n * Note that the attribute itself should be surrounded in double quotes\n * @param {any} attribute\n */\nfunction escape_attribute(attribute) {\n\treturn String(attribute).replace(regex_attribute_characters_to_escape, (match) => escaped[match]);\n}\n\n/**\n * @param {Record<string, string>} attributes\n */\nexport function stringify_spread(attributes) {\n\tlet str = ' ';\n\tfor (const key in attributes) {\n\t\tif (attributes[key] != null) {\n\t\t\tstr += `${key}=\"${escape_attribute(attributes[key])}\" `;\n\t\t}\n\t}\n\n\treturn str;\n}\n\n/**\n * @param {HTMLElement} element\n * @returns {{}}\n */\nexport function get_custom_elements_slots(element) {\n\tconst result = {};\n\telement.childNodes.forEach(\n\t\t/** @param {Element} node */ (node) => {\n\t\t\tresult[node.slot || 'default'] = true;\n\t\t}\n\t);\n\treturn result;\n}\n\nexport function construct_svelte_component(component, props) {\n\treturn new component(props);\n}\n\n/**\n * @typedef {Node & {\n * \tclaim_order?: number;\n * \thydrate_init?: true;\n * \tactual_end_child?: NodeEx;\n * \tchildNodes: NodeListOf<NodeEx>;\n * }} NodeEx\n */\n\n/** @typedef {ChildNode & NodeEx} ChildNodeEx */\n\n/** @typedef {NodeEx & { claim_order: number }} NodeEx2 */\n\n/**\n * @typedef {ChildNodeEx[] & {\n * \tclaim_info?: {\n * \t\tlast_index: number;\n * \t\ttotal_claimed: number;\n * \t};\n * }} ChildNodeArray\n */\n","import { run_all } from './utils.js';\nimport { current_component, set_current_component } from './lifecycle.js';\n\nexport const dirty_components = [];\nexport const intros = { enabled: false };\nexport const binding_callbacks = [];\n\nlet render_callbacks = [];\n\nconst flush_callbacks = [];\n\nconst resolved_promise = /* @__PURE__ */ Promise.resolve();\n\nlet update_scheduled = false;\n\n/** @returns {void} */\nexport function schedule_update() {\n\tif (!update_scheduled) {\n\t\tupdate_scheduled = true;\n\t\tresolved_promise.then(flush);\n\t}\n}\n\n/** @returns {Promise<void>} */\nexport function tick() {\n\tschedule_update();\n\treturn resolved_promise;\n}\n\n/** @returns {void} */\nexport function add_render_callback(fn) {\n\trender_callbacks.push(fn);\n}\n\n/** @returns {void} */\nexport function add_flush_callback(fn) {\n\tflush_callbacks.push(fn);\n}\n\n// flush() calls callbacks in this order:\n// 1. All beforeUpdate callbacks, in order: parents before children\n// 2. All bind:this callbacks, in reverse order: children before parents.\n// 3. All afterUpdate callbacks, in order: parents before children. EXCEPT\n//    for afterUpdates called during the initial onMount, which are called in\n//    reverse order: children before parents.\n// Since callbacks might update component values, which could trigger another\n// call to flush(), the following steps guard against this:\n// 1. During beforeUpdate, any updated components will be added to the\n//    dirty_components array and will cause a reentrant call to flush(). Because\n//    the flush index is kept outside the function, the reentrant call will pick\n//    up where the earlier call left off and go through all dirty components. The\n//    current_component value is saved and restored so that the reentrant call will\n//    not interfere with the \"parent\" flush() call.\n// 2. bind:this callbacks cannot trigger new flush() calls.\n// 3. During afterUpdate, any updated components will NOT have their afterUpdate\n//    callback called a second time; the seen_callbacks set, outside the flush()\n//    function, guarantees this behavior.\nconst seen_callbacks = new Set();\n\nlet flushidx = 0; // Do *not* move this inside the flush() function\n\n/** @returns {void} */\nexport function flush() {\n\t// Do not reenter flush while dirty components are updated, as this can\n\t// result in an infinite loop. Instead, let the inner flush handle it.\n\t// Reentrancy is ok afterwards for bindings etc.\n\tif (flushidx !== 0) {\n\t\treturn;\n\t}\n\tconst saved_component = current_component;\n\tdo {\n\t\t// first, call beforeUpdate functions\n\t\t// and update components\n\t\ttry {\n\t\t\twhile (flushidx < dirty_components.length) {\n\t\t\t\tconst component = dirty_components[flushidx];\n\t\t\t\tflushidx++;\n\t\t\t\tset_current_component(component);\n\t\t\t\tupdate(component.$$);\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t// reset dirty state to not end up in a deadlocked state and then rethrow\n\t\t\tdirty_components.length = 0;\n\t\t\tflushidx = 0;\n\t\t\tthrow e;\n\t\t}\n\t\tset_current_component(null);\n\t\tdirty_components.length = 0;\n\t\tflushidx = 0;\n\t\twhile (binding_callbacks.length) binding_callbacks.pop()();\n\t\t// then, once components are updated, call\n\t\t// afterUpdate functions. This may cause\n\t\t// subsequent updates...\n\t\tfor (let i = 0; i < render_callbacks.length; i += 1) {\n\t\t\tconst callback = render_callbacks[i];\n\t\t\tif (!seen_callbacks.has(callback)) {\n\t\t\t\t// ...so guard against infinite loops\n\t\t\t\tseen_callbacks.add(callback);\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t\trender_callbacks.length = 0;\n\t} while (dirty_components.length);\n\twhile (flush_callbacks.length) {\n\t\tflush_callbacks.pop()();\n\t}\n\tupdate_scheduled = false;\n\tseen_callbacks.clear();\n\tset_current_component(saved_component);\n}\n\n/** @returns {void} */\nfunction update($$) {\n\tif ($$.fragment !== null) {\n\t\t$$.update();\n\t\trun_all($$.before_update);\n\t\tconst dirty = $$.dirty;\n\t\t$$.dirty = [-1];\n\t\t$$.fragment && $$.fragment.p($$.ctx, dirty);\n\t\t$$.after_update.forEach(add_render_callback);\n\t}\n}\n\n/**\n * Useful for example to execute remaining `afterUpdate` callbacks before executing `destroy`.\n * @param {Function[]} fns\n * @returns {void}\n */\nexport function flush_render_callbacks(fns) {\n\tconst filtered = [];\n\tconst targets = [];\n\trender_callbacks.forEach((c) => (fns.indexOf(c) === -1 ? filtered.push(c) : targets.push(c)));\n\ttargets.forEach((c) => c());\n\trender_callbacks = filtered;\n}\n","import { identity as linear, is_function, noop, run_all } from './utils.js';\nimport { now } from './environment.js';\nimport { loop } from './loop.js';\nimport { create_rule, delete_rule } from './style_manager.js';\nimport { custom_event } from './dom.js';\nimport { add_render_callback } from './scheduler.js';\n\n/**\n * @type {Promise<void> | null}\n */\nlet promise;\n\n/**\n * @returns {Promise<void>}\n */\nfunction wait() {\n\tif (!promise) {\n\t\tpromise = Promise.resolve();\n\t\tpromise.then(() => {\n\t\t\tpromise = null;\n\t\t});\n\t}\n\treturn promise;\n}\n\n/**\n * @param {Element} node\n * @param {INTRO | OUTRO | boolean} direction\n * @param {'start' | 'end'} kind\n * @returns {void}\n */\nfunction dispatch(node, direction, kind) {\n\tnode.dispatchEvent(custom_event(`${direction ? 'intro' : 'outro'}${kind}`));\n}\n\nconst outroing = new Set();\n\n/**\n * @type {Outro}\n */\nlet outros;\n\n/**\n * @returns {void} */\nexport function group_outros() {\n\toutros = {\n\t\tr: 0,\n\t\tc: [],\n\t\tp: outros // parent group\n\t};\n}\n\n/**\n * @returns {void} */\nexport function check_outros() {\n\tif (!outros.r) {\n\t\trun_all(outros.c);\n\t}\n\toutros = outros.p;\n}\n\n/**\n * @param {import('./private.js').Fragment} block\n * @param {0 | 1} [local]\n * @returns {void}\n */\nexport function transition_in(block, local) {\n\tif (block && block.i) {\n\t\toutroing.delete(block);\n\t\tblock.i(local);\n\t}\n}\n\n/**\n * @param {import('./private.js').Fragment} block\n * @param {0 | 1} local\n * @param {0 | 1} [detach]\n * @param {() => void} [callback]\n * @returns {void}\n */\nexport function transition_out(block, local, detach, callback) {\n\tif (block && block.o) {\n\t\tif (outroing.has(block)) return;\n\t\toutroing.add(block);\n\t\toutros.c.push(() => {\n\t\t\toutroing.delete(block);\n\t\t\tif (callback) {\n\t\t\t\tif (detach) block.d(1);\n\t\t\t\tcallback();\n\t\t\t}\n\t\t});\n\t\tblock.o(local);\n\t} else if (callback) {\n\t\tcallback();\n\t}\n}\n\n/**\n * @type {import('../transition/public.js').TransitionConfig}\n */\nconst null_transition = { duration: 0 };\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {TransitionFn} fn\n * @param {any} params\n * @returns {{ start(): void; invalidate(): void; end(): void; }}\n */\nexport function create_in_transition(node, fn, params) {\n\t/**\n\t * @type {TransitionOptions} */\n\tconst options = { direction: 'in' };\n\tlet config = fn(node, params, options);\n\tlet running = false;\n\tlet animation_name;\n\tlet task;\n\tlet uid = 0;\n\n\t/**\n\t * @returns {void} */\n\tfunction cleanup() {\n\t\tif (animation_name) delete_rule(node, animation_name);\n\t}\n\n\t/**\n\t * @returns {void} */\n\tfunction go() {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = 300,\n\t\t\teasing = linear,\n\t\t\ttick = noop,\n\t\t\tcss\n\t\t} = config || null_transition;\n\t\tif (css) animation_name = create_rule(node, 0, 1, duration, delay, easing, css, uid++);\n\t\ttick(0, 1);\n\t\tconst start_time = now() + delay;\n\t\tconst end_time = start_time + duration;\n\t\tif (task) task.abort();\n\t\trunning = true;\n\t\tadd_render_callback(() => dispatch(node, true, 'start'));\n\t\ttask = loop((now) => {\n\t\t\tif (running) {\n\t\t\t\tif (now >= end_time) {\n\t\t\t\t\ttick(1, 0);\n\t\t\t\t\tdispatch(node, true, 'end');\n\t\t\t\t\tcleanup();\n\t\t\t\t\treturn (running = false);\n\t\t\t\t}\n\t\t\t\tif (now >= start_time) {\n\t\t\t\t\tconst t = easing((now - start_time) / duration);\n\t\t\t\t\ttick(t, 1 - t);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn running;\n\t\t});\n\t}\n\tlet started = false;\n\treturn {\n\t\tstart() {\n\t\t\tif (started) return;\n\t\t\tstarted = true;\n\t\t\tdelete_rule(node);\n\t\t\tif (is_function(config)) {\n\t\t\t\tconfig = config(options);\n\t\t\t\twait().then(go);\n\t\t\t} else {\n\t\t\t\tgo();\n\t\t\t}\n\t\t},\n\t\tinvalidate() {\n\t\t\tstarted = false;\n\t\t},\n\t\tend() {\n\t\t\tif (running) {\n\t\t\t\tcleanup();\n\t\t\t\trunning = false;\n\t\t\t}\n\t\t}\n\t};\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {TransitionFn} fn\n * @param {any} params\n * @returns {{ end(reset: any): void; }}\n */\nexport function create_out_transition(node, fn, params) {\n\t/** @type {TransitionOptions} */\n\tconst options = { direction: 'out' };\n\tlet config = fn(node, params, options);\n\tlet running = true;\n\tlet animation_name;\n\tconst group = outros;\n\tgroup.r += 1;\n\t/** @type {boolean} */\n\tlet original_inert_value;\n\n\t/**\n\t * @returns {void} */\n\tfunction go() {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = 300,\n\t\t\teasing = linear,\n\t\t\ttick = noop,\n\t\t\tcss\n\t\t} = config || null_transition;\n\n\t\tif (css) animation_name = create_rule(node, 1, 0, duration, delay, easing, css);\n\n\t\tconst start_time = now() + delay;\n\t\tconst end_time = start_time + duration;\n\t\tadd_render_callback(() => dispatch(node, false, 'start'));\n\n\t\tif ('inert' in node) {\n\t\t\toriginal_inert_value = /** @type {HTMLElement} */ (node).inert;\n\t\t\tnode.inert = true;\n\t\t}\n\n\t\tloop((now) => {\n\t\t\tif (running) {\n\t\t\t\tif (now >= end_time) {\n\t\t\t\t\ttick(0, 1);\n\t\t\t\t\tdispatch(node, false, 'end');\n\t\t\t\t\tif (!--group.r) {\n\t\t\t\t\t\t// this will result in `end()` being called,\n\t\t\t\t\t\t// so we don't need to clean up here\n\t\t\t\t\t\trun_all(group.c);\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (now >= start_time) {\n\t\t\t\t\tconst t = easing((now - start_time) / duration);\n\t\t\t\t\ttick(1 - t, t);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn running;\n\t\t});\n\t}\n\n\tif (is_function(config)) {\n\t\twait().then(() => {\n\t\t\t// @ts-ignore\n\t\t\tconfig = config(options);\n\t\t\tgo();\n\t\t});\n\t} else {\n\t\tgo();\n\t}\n\n\treturn {\n\t\tend(reset) {\n\t\t\tif (reset && 'inert' in node) {\n\t\t\t\tnode.inert = original_inert_value;\n\t\t\t}\n\t\t\tif (reset && config.tick) {\n\t\t\t\tconfig.tick(1, 0);\n\t\t\t}\n\t\t\tif (running) {\n\t\t\t\tif (animation_name) delete_rule(node, animation_name);\n\t\t\t\trunning = false;\n\t\t\t}\n\t\t}\n\t};\n}\n\n/**\n * @param {Element & ElementCSSInlineStyle} node\n * @param {TransitionFn} fn\n * @param {any} params\n * @param {boolean} intro\n * @returns {{ run(b: 0 | 1): void; end(): void; }}\n */\nexport function create_bidirectional_transition(node, fn, params, intro) {\n\t/**\n\t * @type {TransitionOptions} */\n\tconst options = { direction: 'both' };\n\tlet config = fn(node, params, options);\n\tlet t = intro ? 0 : 1;\n\n\t/**\n\t * @type {Program | null} */\n\tlet running_program = null;\n\n\t/**\n\t * @type {PendingProgram | null} */\n\tlet pending_program = null;\n\tlet animation_name = null;\n\n\t/** @type {boolean} */\n\tlet original_inert_value;\n\n\t/**\n\t * @returns {void} */\n\tfunction clear_animation() {\n\t\tif (animation_name) delete_rule(node, animation_name);\n\t}\n\n\t/**\n\t * @param {PendingProgram} program\n\t * @param {number} duration\n\t * @returns {Program}\n\t */\n\tfunction init(program, duration) {\n\t\tconst d = /** @type {Program['d']} */ (program.b - t);\n\t\tduration *= Math.abs(d);\n\t\treturn {\n\t\t\ta: t,\n\t\t\tb: program.b,\n\t\t\td,\n\t\t\tduration,\n\t\t\tstart: program.start,\n\t\t\tend: program.start + duration,\n\t\t\tgroup: program.group\n\t\t};\n\t}\n\n\t/**\n\t * @param {INTRO | OUTRO} b\n\t * @returns {void}\n\t */\n\tfunction go(b) {\n\t\tconst {\n\t\t\tdelay = 0,\n\t\t\tduration = 300,\n\t\t\teasing = linear,\n\t\t\ttick = noop,\n\t\t\tcss\n\t\t} = config || null_transition;\n\n\t\t/**\n\t\t * @type {PendingProgram} */\n\t\tconst program = {\n\t\t\tstart: now() + delay,\n\t\t\tb\n\t\t};\n\n\t\tif (!b) {\n\t\t\t// @ts-ignore todo: improve typings\n\t\t\tprogram.group = outros;\n\t\t\toutros.r += 1;\n\t\t}\n\n\t\tif ('inert' in node) {\n\t\t\tif (b) {\n\t\t\t\tif (original_inert_value !== undefined) {\n\t\t\t\t\t// aborted/reversed outro  restore previous inert value\n\t\t\t\t\tnode.inert = original_inert_value;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toriginal_inert_value = /** @type {HTMLElement} */ (node).inert;\n\t\t\t\tnode.inert = true;\n\t\t\t}\n\t\t}\n\n\t\tif (running_program || pending_program) {\n\t\t\tpending_program = program;\n\t\t} else {\n\t\t\t// if this is an intro, and there's a delay, we need to do\n\t\t\t// an initial tick and/or apply CSS animation immediately\n\t\t\tif (css) {\n\t\t\t\tclear_animation();\n\t\t\t\tanimation_name = create_rule(node, t, b, duration, delay, easing, css);\n\t\t\t}\n\t\t\tif (b) tick(0, 1);\n\t\t\trunning_program = init(program, duration);\n\t\t\tadd_render_callback(() => dispatch(node, b, 'start'));\n\t\t\tloop((now) => {\n\t\t\t\tif (pending_program && now > pending_program.start) {\n\t\t\t\t\trunning_program = init(pending_program, duration);\n\t\t\t\t\tpending_program = null;\n\t\t\t\t\tdispatch(node, running_program.b, 'start');\n\t\t\t\t\tif (css) {\n\t\t\t\t\t\tclear_animation();\n\t\t\t\t\t\tanimation_name = create_rule(\n\t\t\t\t\t\t\tnode,\n\t\t\t\t\t\t\tt,\n\t\t\t\t\t\t\trunning_program.b,\n\t\t\t\t\t\t\trunning_program.duration,\n\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\teasing,\n\t\t\t\t\t\t\tconfig.css\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (running_program) {\n\t\t\t\t\tif (now >= running_program.end) {\n\t\t\t\t\t\ttick((t = running_program.b), 1 - t);\n\t\t\t\t\t\tdispatch(node, running_program.b, 'end');\n\t\t\t\t\t\tif (!pending_program) {\n\t\t\t\t\t\t\t// we're done\n\t\t\t\t\t\t\tif (running_program.b) {\n\t\t\t\t\t\t\t\t// intro  we can tidy up immediately\n\t\t\t\t\t\t\t\tclear_animation();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// outro  needs to be coordinated\n\t\t\t\t\t\t\t\tif (!--running_program.group.r) run_all(running_program.group.c);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\trunning_program = null;\n\t\t\t\t\t} else if (now >= running_program.start) {\n\t\t\t\t\t\tconst p = now - running_program.start;\n\t\t\t\t\t\tt = running_program.a + running_program.d * easing(p / running_program.duration);\n\t\t\t\t\t\ttick(t, 1 - t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn !!(running_program || pending_program);\n\t\t\t});\n\t\t}\n\t}\n\treturn {\n\t\trun(b) {\n\t\t\tif (is_function(config)) {\n\t\t\t\twait().then(() => {\n\t\t\t\t\tconst opts = { direction: b ? 'in' : 'out' };\n\t\t\t\t\t// @ts-ignore\n\t\t\t\t\tconfig = config(opts);\n\t\t\t\t\tgo(b);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tgo(b);\n\t\t\t}\n\t\t},\n\t\tend() {\n\t\t\tclear_animation();\n\t\t\trunning_program = pending_program = null;\n\t\t}\n\t};\n}\n\n/** @typedef {1} INTRO */\n/** @typedef {0} OUTRO */\n/** @typedef {{ direction: 'in' | 'out' | 'both' }} TransitionOptions */\n/** @typedef {(node: Element, params: any, options: TransitionOptions) => import('../transition/public.js').TransitionConfig} TransitionFn */\n\n/**\n * @typedef {Object} Outro\n * @property {number} r\n * @property {Function[]} c\n * @property {Object} p\n */\n\n/**\n * @typedef {Object} PendingProgram\n * @property {number} start\n * @property {INTRO|OUTRO} b\n * @property {Outro} [group]\n */\n\n/**\n * @typedef {Object} Program\n * @property {number} a\n * @property {INTRO|OUTRO} b\n * @property {1|-1} d\n * @property {number} duration\n * @property {number} start\n * @property {number} end\n * @property {Outro} [group]\n */\n","import { transition_in, transition_out } from './transitions.js';\nimport { run_all } from './utils.js';\n\n// general each functions:\n\nexport function ensure_array_like(array_like_or_iterator) {\n\treturn array_like_or_iterator?.length !== undefined\n\t\t? array_like_or_iterator\n\t\t: Array.from(array_like_or_iterator);\n}\n\n// keyed each functions:\n\n/** @returns {void} */\nexport function destroy_block(block, lookup) {\n\tblock.d(1);\n\tlookup.delete(block.key);\n}\n\n/** @returns {void} */\nexport function outro_and_destroy_block(block, lookup) {\n\ttransition_out(block, 1, 1, () => {\n\t\tlookup.delete(block.key);\n\t});\n}\n\n/** @returns {void} */\nexport function fix_and_destroy_block(block, lookup) {\n\tblock.f();\n\tdestroy_block(block, lookup);\n}\n\n/** @returns {void} */\nexport function fix_and_outro_and_destroy_block(block, lookup) {\n\tblock.f();\n\toutro_and_destroy_block(block, lookup);\n}\n\n/** @returns {any[]} */\nexport function update_keyed_each(\n\told_blocks,\n\tdirty,\n\tget_key,\n\tdynamic,\n\tctx,\n\tlist,\n\tlookup,\n\tnode,\n\tdestroy,\n\tcreate_each_block,\n\tnext,\n\tget_context\n) {\n\tlet o = old_blocks.length;\n\tlet n = list.length;\n\tlet i = o;\n\tconst old_indexes = {};\n\twhile (i--) old_indexes[old_blocks[i].key] = i;\n\tconst new_blocks = [];\n\tconst new_lookup = new Map();\n\tconst deltas = new Map();\n\tconst updates = [];\n\ti = n;\n\twhile (i--) {\n\t\tconst child_ctx = get_context(ctx, list, i);\n\t\tconst key = get_key(child_ctx);\n\t\tlet block = lookup.get(key);\n\t\tif (!block) {\n\t\t\tblock = create_each_block(key, child_ctx);\n\t\t\tblock.c();\n\t\t} else if (dynamic) {\n\t\t\t// defer updates until all the DOM shuffling is done\n\t\t\tupdates.push(() => block.p(child_ctx, dirty));\n\t\t}\n\t\tnew_lookup.set(key, (new_blocks[i] = block));\n\t\tif (key in old_indexes) deltas.set(key, Math.abs(i - old_indexes[key]));\n\t}\n\tconst will_move = new Set();\n\tconst did_move = new Set();\n\t/** @returns {void} */\n\tfunction insert(block) {\n\t\ttransition_in(block, 1);\n\t\tblock.m(node, next);\n\t\tlookup.set(block.key, block);\n\t\tnext = block.first;\n\t\tn--;\n\t}\n\twhile (o && n) {\n\t\tconst new_block = new_blocks[n - 1];\n\t\tconst old_block = old_blocks[o - 1];\n\t\tconst new_key = new_block.key;\n\t\tconst old_key = old_block.key;\n\t\tif (new_block === old_block) {\n\t\t\t// do nothing\n\t\t\tnext = new_block.first;\n\t\t\to--;\n\t\t\tn--;\n\t\t} else if (!new_lookup.has(old_key)) {\n\t\t\t// remove old block\n\t\t\tdestroy(old_block, lookup);\n\t\t\to--;\n\t\t} else if (!lookup.has(new_key) || will_move.has(new_key)) {\n\t\t\tinsert(new_block);\n\t\t} else if (did_move.has(old_key)) {\n\t\t\to--;\n\t\t} else if (deltas.get(new_key) > deltas.get(old_key)) {\n\t\t\tdid_move.add(new_key);\n\t\t\tinsert(new_block);\n\t\t} else {\n\t\t\twill_move.add(old_key);\n\t\t\to--;\n\t\t}\n\t}\n\twhile (o--) {\n\t\tconst old_block = old_blocks[o];\n\t\tif (!new_lookup.has(old_block.key)) destroy(old_block, lookup);\n\t}\n\twhile (n) insert(new_blocks[n - 1]);\n\trun_all(updates);\n\treturn new_blocks;\n}\n\n/** @returns {void} */\nexport function validate_each_keys(ctx, list, get_context, get_key) {\n\tconst keys = new Map();\n\tfor (let i = 0; i < list.length; i++) {\n\t\tconst key = get_key(get_context(ctx, list, i));\n\t\tif (keys.has(key)) {\n\t\t\tlet value = '';\n\t\t\ttry {\n\t\t\t\tvalue = `with value '${String(key)}' `;\n\t\t\t} catch (e) {\n\t\t\t\t// can't stringify\n\t\t\t}\n\t\t\tthrow new Error(\n\t\t\t\t`Cannot have duplicate keys in a keyed each: Keys at index ${keys.get(\n\t\t\t\t\tkey\n\t\t\t\t)} and ${i} ${value}are duplicates`\n\t\t\t);\n\t\t}\n\t\tkeys.set(key, i);\n\t}\n}\n","import {\n\tadd_render_callback,\n\tflush,\n\tflush_render_callbacks,\n\tschedule_update,\n\tdirty_components\n} from './scheduler.js';\nimport { current_component, set_current_component } from './lifecycle.js';\nimport { blank_object, is_empty, is_function, run, run_all, noop } from './utils.js';\nimport {\n\tchildren,\n\tdetach,\n\tstart_hydrating,\n\tend_hydrating,\n\tget_custom_elements_slots,\n\tinsert,\n\telement,\n\tattr\n} from './dom.js';\nimport { transition_in } from './transitions.js';\n\n/** @returns {void} */\nexport function bind(component, name, callback) {\n\tconst index = component.$$.props[name];\n\tif (index !== undefined) {\n\t\tcomponent.$$.bound[index] = callback;\n\t\tcallback(component.$$.ctx[index]);\n\t}\n}\n\n/** @returns {void} */\nexport function create_component(block) {\n\tblock && block.c();\n}\n\n/** @returns {void} */\nexport function claim_component(block, parent_nodes) {\n\tblock && block.l(parent_nodes);\n}\n\n/** @returns {void} */\nexport function mount_component(component, target, anchor) {\n\tconst { fragment, after_update } = component.$$;\n\tfragment && fragment.m(target, anchor);\n\t// onMount happens before the initial afterUpdate\n\tadd_render_callback(() => {\n\t\tconst new_on_destroy = component.$$.on_mount.map(run).filter(is_function);\n\t\t// if the component was destroyed immediately\n\t\t// it will update the `$$.on_destroy` reference to `null`.\n\t\t// the destructured on_destroy may still reference to the old array\n\t\tif (component.$$.on_destroy) {\n\t\t\tcomponent.$$.on_destroy.push(...new_on_destroy);\n\t\t} else {\n\t\t\t// Edge case - component was destroyed immediately,\n\t\t\t// most likely as a result of a binding initialising\n\t\t\trun_all(new_on_destroy);\n\t\t}\n\t\tcomponent.$$.on_mount = [];\n\t});\n\tafter_update.forEach(add_render_callback);\n}\n\n/** @returns {void} */\nexport function destroy_component(component, detaching) {\n\tconst $$ = component.$$;\n\tif ($$.fragment !== null) {\n\t\tflush_render_callbacks($$.after_update);\n\t\trun_all($$.on_destroy);\n\t\t$$.fragment && $$.fragment.d(detaching);\n\t\t// TODO null out other refs, including component.$$ (but need to\n\t\t// preserve final state?)\n\t\t$$.on_destroy = $$.fragment = null;\n\t\t$$.ctx = [];\n\t}\n}\n\n/** @returns {void} */\nfunction make_dirty(component, i) {\n\tif (component.$$.dirty[0] === -1) {\n\t\tdirty_components.push(component);\n\t\tschedule_update();\n\t\tcomponent.$$.dirty.fill(0);\n\t}\n\tcomponent.$$.dirty[(i / 31) | 0] |= 1 << i % 31;\n}\n\n// TODO: Document the other params\n/**\n * @param {SvelteComponent} component\n * @param {import('./public.js').ComponentConstructorOptions} options\n *\n * @param {import('./utils.js')['not_equal']} not_equal Used to compare props and state values.\n * @param {(target: Element | ShadowRoot) => void} [append_styles] Function that appends styles to the DOM when the component is first initialised.\n * This will be the `add_css` function from the compiled component.\n *\n * @returns {void}\n */\nexport function init(\n\tcomponent,\n\toptions,\n\tinstance,\n\tcreate_fragment,\n\tnot_equal,\n\tprops,\n\tappend_styles = null,\n\tdirty = [-1]\n) {\n\tconst parent_component = current_component;\n\tset_current_component(component);\n\t/** @type {import('./private.js').T$$} */\n\tconst $$ = (component.$$ = {\n\t\tfragment: null,\n\t\tctx: [],\n\t\t// state\n\t\tprops,\n\t\tupdate: noop,\n\t\tnot_equal,\n\t\tbound: blank_object(),\n\t\t// lifecycle\n\t\ton_mount: [],\n\t\ton_destroy: [],\n\t\ton_disconnect: [],\n\t\tbefore_update: [],\n\t\tafter_update: [],\n\t\tcontext: new Map(options.context || (parent_component ? parent_component.$$.context : [])),\n\t\t// everything else\n\t\tcallbacks: blank_object(),\n\t\tdirty,\n\t\tskip_bound: false,\n\t\troot: options.target || parent_component.$$.root\n\t});\n\tappend_styles && append_styles($$.root);\n\tlet ready = false;\n\t$$.ctx = instance\n\t\t? instance(component, options.props || {}, (i, ret, ...rest) => {\n\t\t\t\tconst value = rest.length ? rest[0] : ret;\n\t\t\t\tif ($$.ctx && not_equal($$.ctx[i], ($$.ctx[i] = value))) {\n\t\t\t\t\tif (!$$.skip_bound && $$.bound[i]) $$.bound[i](value);\n\t\t\t\t\tif (ready) make_dirty(component, i);\n\t\t\t\t}\n\t\t\t\treturn ret;\n\t\t  })\n\t\t: [];\n\t$$.update();\n\tready = true;\n\trun_all($$.before_update);\n\t// `false` as a special case of no DOM component\n\t$$.fragment = create_fragment ? create_fragment($$.ctx) : false;\n\tif (options.target) {\n\t\tif (options.hydrate) {\n\t\t\tstart_hydrating();\n\t\t\t// TODO: what is the correct type here?\n\t\t\t// @ts-expect-error\n\t\t\tconst nodes = children(options.target);\n\t\t\t$$.fragment && $$.fragment.l(nodes);\n\t\t\tnodes.forEach(detach);\n\t\t} else {\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n\t\t\t$$.fragment && $$.fragment.c();\n\t\t}\n\t\tif (options.intro) transition_in(component.$$.fragment);\n\t\tmount_component(component, options.target, options.anchor);\n\t\tend_hydrating();\n\t\tflush();\n\t}\n\tset_current_component(parent_component);\n}\n\nexport let SvelteElement;\n\nif (typeof HTMLElement === 'function') {\n\tSvelteElement = class extends HTMLElement {\n\t\t/** The Svelte component constructor */\n\t\t$$ctor;\n\t\t/** Slots */\n\t\t$$s;\n\t\t/** The Svelte component instance */\n\t\t$$c;\n\t\t/** Whether or not the custom element is connected */\n\t\t$$cn = false;\n\t\t/** Component props data */\n\t\t$$d = {};\n\t\t/** `true` if currently in the process of reflecting component props back to attributes */\n\t\t$$r = false;\n\t\t/** @type {Record<string, CustomElementPropDefinition>} Props definition (name, reflected, type etc) */\n\t\t$$p_d = {};\n\t\t/** @type {Record<string, Function[]>} Event listeners */\n\t\t$$l = {};\n\t\t/** @type {Map<Function, Function>} Event listener unsubscribe functions */\n\t\t$$l_u = new Map();\n\n\t\tconstructor($$componentCtor, $$slots, use_shadow_dom) {\n\t\t\tsuper();\n\t\t\tthis.$$ctor = $$componentCtor;\n\t\t\tthis.$$s = $$slots;\n\t\t\tif (use_shadow_dom) {\n\t\t\t\tthis.attachShadow({ mode: 'open' });\n\t\t\t}\n\t\t}\n\n\t\taddEventListener(type, listener, options) {\n\t\t\t// We can't determine upfront if the event is a custom event or not, so we have to\n\t\t\t// listen to both. If someone uses a custom event with the same name as a regular\n\t\t\t// browser event, this fires twice - we can't avoid that.\n\t\t\tthis.$$l[type] = this.$$l[type] || [];\n\t\t\tthis.$$l[type].push(listener);\n\t\t\tif (this.$$c) {\n\t\t\t\tconst unsub = this.$$c.$on(type, listener);\n\t\t\t\tthis.$$l_u.set(listener, unsub);\n\t\t\t}\n\t\t\tsuper.addEventListener(type, listener, options);\n\t\t}\n\n\t\tremoveEventListener(type, listener, options) {\n\t\t\tsuper.removeEventListener(type, listener, options);\n\t\t\tif (this.$$c) {\n\t\t\t\tconst unsub = this.$$l_u.get(listener);\n\t\t\t\tif (unsub) {\n\t\t\t\t\tunsub();\n\t\t\t\t\tthis.$$l_u.delete(listener);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (this.$$l[type]) {\n\t\t\t\tconst idx = this.$$l[type].indexOf(listener);\n\t\t\t\tif (idx >= 0) {\n\t\t\t\t\tthis.$$l[type].splice(idx, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tasync connectedCallback() {\n\t\t\tthis.$$cn = true;\n\t\t\tif (!this.$$c) {\n\t\t\t\t// We wait one tick to let possible child slot elements be created/mounted\n\t\t\t\tawait Promise.resolve();\n\t\t\t\tif (!this.$$cn || this.$$c) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tfunction create_slot(name) {\n\t\t\t\t\treturn () => {\n\t\t\t\t\t\tlet node;\n\t\t\t\t\t\tconst obj = {\n\t\t\t\t\t\t\tc: function create() {\n\t\t\t\t\t\t\t\tnode = element('slot');\n\t\t\t\t\t\t\t\tif (name !== 'default') {\n\t\t\t\t\t\t\t\t\tattr(node, 'name', name);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t/**\n\t\t\t\t\t\t\t * @param {HTMLElement} target\n\t\t\t\t\t\t\t * @param {HTMLElement} [anchor]\n\t\t\t\t\t\t\t */\n\t\t\t\t\t\t\tm: function mount(target, anchor) {\n\t\t\t\t\t\t\t\tinsert(target, node, anchor);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\td: function destroy(detaching) {\n\t\t\t\t\t\t\t\tif (detaching) {\n\t\t\t\t\t\t\t\t\tdetach(node);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\treturn obj;\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\tconst $$slots = {};\n\t\t\t\tconst existing_slots = get_custom_elements_slots(this);\n\t\t\t\tfor (const name of this.$$s) {\n\t\t\t\t\tif (name in existing_slots) {\n\t\t\t\t\t\t$$slots[name] = [create_slot(name)];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (const attribute of this.attributes) {\n\t\t\t\t\t// this.$$data takes precedence over this.attributes\n\t\t\t\t\tconst name = this.$$g_p(attribute.name);\n\t\t\t\t\tif (!(name in this.$$d)) {\n\t\t\t\t\t\tthis.$$d[name] = get_custom_element_value(name, attribute.value, this.$$p_d, 'toProp');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Port over props that were set programmatically before ce was initialized\n\t\t\t\tfor (const key in this.$$p_d) {\n\t\t\t\t\tif (!(key in this.$$d) && this[key] !== undefined) {\n\t\t\t\t\t\tthis.$$d[key] = this[key]; // don't transform, these were set through JavaScript\n\t\t\t\t\t\tdelete this[key]; // remove the property that shadows the getter/setter\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.$$c = new this.$$ctor({\n\t\t\t\t\ttarget: this.shadowRoot || this,\n\t\t\t\t\tprops: {\n\t\t\t\t\t\t...this.$$d,\n\t\t\t\t\t\t$$slots,\n\t\t\t\t\t\t$$scope: {\n\t\t\t\t\t\t\tctx: []\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Reflect component props as attributes\n\t\t\t\tconst reflect_attributes = () => {\n\t\t\t\t\tthis.$$r = true;\n\t\t\t\t\tfor (const key in this.$$p_d) {\n\t\t\t\t\t\tthis.$$d[key] = this.$$c.$$.ctx[this.$$c.$$.props[key]];\n\t\t\t\t\t\tif (this.$$p_d[key].reflect) {\n\t\t\t\t\t\t\tconst attribute_value = get_custom_element_value(\n\t\t\t\t\t\t\t\tkey,\n\t\t\t\t\t\t\t\tthis.$$d[key],\n\t\t\t\t\t\t\t\tthis.$$p_d,\n\t\t\t\t\t\t\t\t'toAttribute'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tif (attribute_value == null) {\n\t\t\t\t\t\t\t\tthis.removeAttribute(this.$$p_d[key].attribute || key);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.setAttribute(this.$$p_d[key].attribute || key, attribute_value);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.$$r = false;\n\t\t\t\t};\n\t\t\t\tthis.$$c.$$.after_update.push(reflect_attributes);\n\t\t\t\treflect_attributes(); // once initially because after_update is added too late for first render\n\n\t\t\t\tfor (const type in this.$$l) {\n\t\t\t\t\tfor (const listener of this.$$l[type]) {\n\t\t\t\t\t\tconst unsub = this.$$c.$on(type, listener);\n\t\t\t\t\t\tthis.$$l_u.set(listener, unsub);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.$$l = {};\n\t\t\t}\n\t\t}\n\n\t\t// We don't need this when working within Svelte code, but for compatibility of people using this outside of Svelte\n\t\t// and setting attributes through setAttribute etc, this is helpful\n\t\tattributeChangedCallback(attr, _oldValue, newValue) {\n\t\t\tif (this.$$r) return;\n\t\t\tattr = this.$$g_p(attr);\n\t\t\tthis.$$d[attr] = get_custom_element_value(attr, newValue, this.$$p_d, 'toProp');\n\t\t\tthis.$$c?.$set({ [attr]: this.$$d[attr] });\n\t\t}\n\n\t\tdisconnectedCallback() {\n\t\t\tthis.$$cn = false;\n\t\t\t// In a microtask, because this could be a move within the DOM\n\t\t\tPromise.resolve().then(() => {\n\t\t\t\tif (!this.$$cn && this.$$c) {\n\t\t\t\t\tthis.$$c.$destroy();\n\t\t\t\t\tthis.$$c = undefined;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t$$g_p(attribute_name) {\n\t\t\treturn (\n\t\t\t\tObject.keys(this.$$p_d).find(\n\t\t\t\t\t(key) =>\n\t\t\t\t\t\tthis.$$p_d[key].attribute === attribute_name ||\n\t\t\t\t\t\t(!this.$$p_d[key].attribute && key.toLowerCase() === attribute_name)\n\t\t\t\t) || attribute_name\n\t\t\t);\n\t\t}\n\t};\n}\n\n/**\n * @param {string} prop\n * @param {any} value\n * @param {Record<string, CustomElementPropDefinition>} props_definition\n * @param {'toAttribute' | 'toProp'} [transform]\n */\nfunction get_custom_element_value(prop, value, props_definition, transform) {\n\tconst type = props_definition[prop]?.type;\n\tvalue = type === 'Boolean' && typeof value !== 'boolean' ? value != null : value;\n\tif (!transform || !props_definition[prop]) {\n\t\treturn value;\n\t} else if (transform === 'toAttribute') {\n\t\tswitch (type) {\n\t\t\tcase 'Object':\n\t\t\tcase 'Array':\n\t\t\t\treturn value == null ? null : JSON.stringify(value);\n\t\t\tcase 'Boolean':\n\t\t\t\treturn value ? '' : null;\n\t\t\tcase 'Number':\n\t\t\t\treturn value == null ? null : value;\n\t\t\tdefault:\n\t\t\t\treturn value;\n\t\t}\n\t} else {\n\t\tswitch (type) {\n\t\t\tcase 'Object':\n\t\t\tcase 'Array':\n\t\t\t\treturn value && JSON.parse(value);\n\t\t\tcase 'Boolean':\n\t\t\t\treturn value; // conversion already handled above\n\t\t\tcase 'Number':\n\t\t\t\treturn value != null ? +value : value;\n\t\t\tdefault:\n\t\t\t\treturn value;\n\t\t}\n\t}\n}\n\n/**\n * @internal\n *\n * Turn a Svelte component into a custom element.\n * @param {import('./public.js').ComponentType} Component  A Svelte component constructor\n * @param {Record<string, CustomElementPropDefinition>} props_definition  The props to observe\n * @param {string[]} slots  The slots to create\n * @param {string[]} accessors  Other accessors besides the ones for props the component has\n * @param {boolean} use_shadow_dom  Whether to use shadow DOM\n * @param {(ce: new () => HTMLElement) => new () => HTMLElement} [extend]\n */\nexport function create_custom_element(\n\tComponent,\n\tprops_definition,\n\tslots,\n\taccessors,\n\tuse_shadow_dom,\n\textend\n) {\n\tlet Class = class extends SvelteElement {\n\t\tconstructor() {\n\t\t\tsuper(Component, slots, use_shadow_dom);\n\t\t\tthis.$$p_d = props_definition;\n\t\t}\n\t\tstatic get observedAttributes() {\n\t\t\treturn Object.keys(props_definition).map((key) =>\n\t\t\t\t(props_definition[key].attribute || key).toLowerCase()\n\t\t\t);\n\t\t}\n\t};\n\tObject.keys(props_definition).forEach((prop) => {\n\t\tObject.defineProperty(Class.prototype, prop, {\n\t\t\tget() {\n\t\t\t\treturn this.$$c && prop in this.$$c ? this.$$c[prop] : this.$$d[prop];\n\t\t\t},\n\t\t\tset(value) {\n\t\t\t\tvalue = get_custom_element_value(prop, value, props_definition);\n\t\t\t\tthis.$$d[prop] = value;\n\t\t\t\tthis.$$c?.$set({ [prop]: value });\n\t\t\t}\n\t\t});\n\t});\n\taccessors.forEach((accessor) => {\n\t\tObject.defineProperty(Class.prototype, accessor, {\n\t\t\tget() {\n\t\t\t\treturn this.$$c?.[accessor];\n\t\t\t}\n\t\t});\n\t});\n\tif (extend) {\n\t\t// @ts-expect-error - assigning here is fine\n\t\tClass = extend(Class);\n\t}\n\tComponent.element = /** @type {any} */ (Class);\n\treturn Class;\n}\n\n/**\n * Base class for Svelte components. Used when dev=false.\n *\n * @template {Record<string, any>} [Props=any]\n * @template {Record<string, any>} [Events=any]\n */\nexport class SvelteComponent {\n\t/**\n\t * ### PRIVATE API\n\t *\n\t * Do not use, may change at any time\n\t *\n\t * @type {any}\n\t */\n\t$$ = undefined;\n\t/**\n\t * ### PRIVATE API\n\t *\n\t * Do not use, may change at any time\n\t *\n\t * @type {any}\n\t */\n\t$$set = undefined;\n\n\t/** @returns {void} */\n\t$destroy() {\n\t\tdestroy_component(this, 1);\n\t\tthis.$destroy = noop;\n\t}\n\n\t/**\n\t * @template {Extract<keyof Events, string>} K\n\t * @param {K} type\n\t * @param {((e: Events[K]) => void) | null | undefined} callback\n\t * @returns {() => void}\n\t */\n\t$on(type, callback) {\n\t\tif (!is_function(callback)) {\n\t\t\treturn noop;\n\t\t}\n\t\tconst callbacks = this.$$.callbacks[type] || (this.$$.callbacks[type] = []);\n\t\tcallbacks.push(callback);\n\t\treturn () => {\n\t\t\tconst index = callbacks.indexOf(callback);\n\t\t\tif (index !== -1) callbacks.splice(index, 1);\n\t\t};\n\t}\n\n\t/**\n\t * @param {Partial<Props>} props\n\t * @returns {void}\n\t */\n\t$set(props) {\n\t\tif (this.$$set && !is_empty(props)) {\n\t\t\tthis.$$.skip_bound = true;\n\t\t\tthis.$$set(props);\n\t\t\tthis.$$.skip_bound = false;\n\t\t}\n\t}\n}\n\n/**\n * @typedef {Object} CustomElementPropDefinition\n * @property {string} [attribute]\n * @property {boolean} [reflect]\n * @property {'String'|'Boolean'|'Number'|'Array'|'Object'} [type]\n */\n","// Shared utility functions for Bookmark Insight\n\n/**\n * Format a timestamp to a localized date string\n * @param {number} timestamp - Unix timestamp in milliseconds\n * @returns {string} Formatted date string\n */\nexport function formatDate(timestamp) {\n  return new Date(timestamp).toLocaleDateString();\n}\n\n/**\n * Format a timestamp to a relative time string (e.g., \"2 days ago\")\n * @param {number} timestamp - Unix timestamp in milliseconds\n * @returns {string} Relative time string\n */\nexport function formatTimeAgo(timestamp) {\n  const now = Date.now();\n  const diff = now - timestamp;\n  const seconds = Math.floor(diff / 1000);\n  const minutes = Math.floor(seconds / 60);\n  const hours = Math.floor(minutes / 60);\n  const days = Math.floor(hours / 24);\n  const weeks = Math.floor(days / 7);\n  const months = Math.floor(days / 30);\n  const years = Math.floor(days / 365);\n\n  if (seconds < 60) return 'Just now';\n  if (minutes < 60) return `${minutes} minute${minutes !== 1 ? 's' : ''} ago`;\n  if (hours < 24) return `${hours} hour${hours !== 1 ? 's' : ''} ago`;\n  if (days === 0) return 'Today';\n  if (days === 1) return '1 day ago';\n  if (days < 7) return `${days} days ago`;\n  if (weeks < 4) return `${weeks} week${weeks !== 1 ? 's' : ''} ago`;\n  if (months < 12) return `${months} month${months !== 1 ? 's' : ''} ago`;\n  return `${years} year${years !== 1 ? 's' : ''} ago`;\n}\n\n/**\n * Generate a favicon URL for a bookmark\n * Uses letter-based SVG icons for reliability\n * @param {Object} bookmark - Bookmark object with url and domain properties\n * @returns {string} Data URL for the favicon SVG\n */\nexport function getFaviconUrl(bookmark) {\n  // For HTTP/HTTPS URLs, create a simple domain-based icon\n  if (bookmark.url.startsWith('http://') || bookmark.url.startsWith('https://')) {\n    const firstLetter = bookmark.domain.charAt(0).toUpperCase();\n    const colors = ['#3B82F6', '#EF4444', '#10B981', '#F59E0B', '#8B5CF6', '#EC4899'];\n    const colorIndex = bookmark.domain.length % colors.length;\n    const color = colors[colorIndex];\n\n    return `data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\"><rect width=\"16\" height=\"16\" fill=\"${color}\"/><text x=\"8\" y=\"12\" font-family=\"Arial\" font-size=\"10\" text-anchor=\"middle\" fill=\"white\" font-weight=\"bold\">${firstLetter}</text></svg>`;\n  }\n\n  // Return specific icons for different URL types\n  switch (bookmark.domain) {\n    case 'chrome-internal':\n      return 'data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\"><rect width=\"16\" height=\"16\" fill=\"%23EA4335\"/><circle cx=\"8\" cy=\"8\" r=\"3\" fill=\"white\"/></svg>';\n    case 'local-file':\n      return 'data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\"><rect width=\"16\" height=\"16\" fill=\"%23F59E0B\"/><text x=\"8\" y=\"12\" font-family=\"Arial\" font-size=\"10\" text-anchor=\"middle\" fill=\"white\"></text></svg>';\n    case 'javascript-bookmarklet':\n      return 'data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\"><rect width=\"16\" height=\"16\" fill=\"%23F7DF1E\"/><text x=\"8\" y=\"12\" font-family=\"Arial\" font-size=\"8\" text-anchor=\"middle\" fill=\"black\" font-weight=\"bold\">JS</text></svg>';\n    case 'data-uri':\n      return 'data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\"><rect width=\"16\" height=\"16\" fill=\"%2310B981\"/><text x=\"8\" y=\"12\" font-family=\"Arial\" font-size=\"8\" text-anchor=\"middle\" fill=\"white\" font-weight=\"bold\">D</text></svg>';\n    case 'contact-link':\n      return 'data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\"><rect width=\"16\" height=\"16\" fill=\"%238B5CF6\"/><text x=\"8\" y=\"12\" font-family=\"Arial\" font-size=\"10\" text-anchor=\"middle\" fill=\"white\">@</text></svg>';\n    case 'other-protocol':\n      return 'data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\"><rect width=\"16\" height=\"16\" fill=\"%236B7280\"/><text x=\"8\" y=\"12\" font-family=\"Arial\" font-size=\"10\" text-anchor=\"middle\" fill=\"white\"></text></svg>';\n    default:\n      return 'data:image/svg+xml,<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 16 16\"><rect width=\"16\" height=\"16\" fill=\"%23E5E7EB\"/><text x=\"8\" y=\"12\" font-family=\"Arial\" font-size=\"10\" text-anchor=\"middle\" fill=\"%236B7280\">?</text></svg>';\n  }\n}\n\n/**\n * Get a human-readable label for a bookmark's domain type\n * @param {Object} bookmark - Bookmark object with domain property\n * @returns {string} Human-readable domain label\n */\nexport function getDomainLabel(bookmark) {\n  switch (bookmark.domain) {\n    case 'chrome-internal':\n      return 'Chrome';\n    case 'local-file':\n      return 'Local File';\n    case 'javascript-bookmarklet':\n      return 'Bookmarklet';\n    case 'data-uri':\n      return 'Data URI';\n    case 'contact-link':\n      return 'Contact';\n    case 'other-protocol':\n      return 'Other';\n    case 'invalid-url':\n      return 'Invalid URL';\n    default:\n      return bookmark.domain;\n  }\n}\n\n/**\n * Truncate a string to a maximum length with ellipsis\n * @param {string} str - String to truncate\n * @param {number} maxLength - Maximum length\n * @returns {string} Truncated string\n */\nexport function truncateString(str, maxLength = 50) {\n  if (!str || str.length <= maxLength) return str;\n  return str.substring(0, maxLength - 3) + '...';\n}\n\n/**\n * Copy text to clipboard\n * @param {string} text - Text to copy\n * @returns {Promise<boolean>} Success status\n */\nexport async function copyToClipboard(text) {\n  try {\n    await navigator.clipboard.writeText(text);\n    return true;\n  } catch (err) {\n    console.error('Failed to copy to clipboard:', err);\n    return false;\n  }\n}\n\n/**\n * Debounce a function\n * @param {Function} func - Function to debounce\n * @param {number} wait - Wait time in milliseconds\n * @returns {Function} Debounced function\n */\nexport function debounce(func, wait = 300) {\n  let timeout;\n  return function executedFunction(...args) {\n    const later = () => {\n      clearTimeout(timeout);\n      func(...args);\n    };\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n  };\n}\n\n/**\n * Sort options for bookmarks\n */\nexport const SORT_OPTIONS = {\n  DATE_DESC: { key: 'date_desc', label: 'Newest First', sort: (a, b) => b.dateAdded - a.dateAdded },\n  DATE_ASC: { key: 'date_asc', label: 'Oldest First', sort: (a, b) => a.dateAdded - b.dateAdded },\n  TITLE_ASC: { key: 'title_asc', label: 'Title A-Z', sort: (a, b) => a.title.localeCompare(b.title) },\n  TITLE_DESC: { key: 'title_desc', label: 'Title Z-A', sort: (a, b) => b.title.localeCompare(a.title) },\n  DOMAIN_ASC: { key: 'domain_asc', label: 'Domain A-Z', sort: (a, b) => a.domain.localeCompare(b.domain) },\n};\n\n/**\n * Get sort function by key\n * @param {string} key - Sort option key\n * @returns {Function} Sort function\n */\nexport function getSortFunction(key) {\n  const option = Object.values(SORT_OPTIONS).find(opt => opt.key === key);\n  return option ? option.sort : SORT_OPTIONS.DATE_DESC.sort;\n}\n","<script>\n  import { createEventDispatcher } from 'svelte';\n  import { formatDate, getFaviconUrl, getDomainLabel, copyToClipboard } from './utils.js';\n  \n  export let bookmark;\n  \n  const dispatch = createEventDispatcher();\n  \n  let showCopied = false;\n  \n  function openBookmark(url) {\n    chrome.tabs.create({ url });\n  }\n  \n  async function handleCopyUrl(event) {\n    event.stopPropagation();\n    const success = await copyToClipboard(bookmark.url);\n    if (success) {\n      showCopied = true;\n      setTimeout(() => showCopied = false, 2000);\n    }\n  }\n</script>\n\n<div class=\"bookmark-card bg-white rounded-lg shadow-md p-4 hover:shadow-lg transition-shadow cursor-pointer border border-gray-200\"\n     role=\"button\"\n     tabindex=\"0\"\n     on:click={() => openBookmark(bookmark.url)}\n     on:keydown={(e) => e.key === 'Enter' && openBookmark(bookmark.url)}>\n  <div class=\"flex items-start space-x-3\">\n    <img \n      src=\"{getFaviconUrl(bookmark)}\"\n      alt=\"Favicon\"\n      class=\"w-4 h-4 mt-1 flex-shrink-0\"\n    />\n    <div class=\"flex-1 min-w-0\">\n      <h3 class=\"text-sm font-medium text-gray-900 truncate\" title={bookmark.title}>\n        {bookmark.title}\n      </h3>\n      <p class=\"text-xs text-gray-500 truncate mt-1\" title={bookmark.url}>\n        {bookmark.url}\n      </p>\n      <div class=\"flex items-center justify-between mt-2\">\n        <span class=\"text-xs text-blue-600 bg-blue-50 px-2 py-1 rounded\">\n          {getDomainLabel(bookmark)}\n        </span>\n        <div class=\"flex items-center space-x-2\">\n          <button\n            on:click={handleCopyUrl}\n            class=\"p-1 text-gray-400 hover:text-blue-600 transition-colors\"\n            title=\"Copy URL\"\n          >\n            {#if showCopied}\n              <svg class=\"w-4 h-4 text-green-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M5 13l4 4L19 7\"></path>\n              </svg>\n            {:else}\n              <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3\"></path>\n              </svg>\n            {/if}\n          </button>\n          <span class=\"text-xs text-gray-400\">\n            {formatDate(bookmark.dateAdded)}\n          </span>\n        </div>\n      </div>\n      {#if bookmark.folderPath}\n        <p class=\"text-xs text-gray-400 mt-1 truncate\" title={bookmark.folderPath}>\n           {bookmark.folderPath}\n        </p>\n      {/if}\n    </div>\n  </div>\n</div>\n\n<style>\n  .bookmark-card:hover {\n    transform: translateY(-1px);\n  }\n</style>\n","import { PUBLIC_VERSION } from '../../../shared/version.js';\n\nif (typeof window !== 'undefined')\n\t// @ts-ignore\n\t(window.__svelte || (window.__svelte = { v: new Set() })).v.add(PUBLIC_VERSION);\n","// generated during release, do not modify\n\n/**\n * The current version, as set in package.json.\n *\n * https://svelte.dev/docs/svelte-compiler#svelte-version\n * @type {string}\n */\nexport const VERSION = '4.2.20';\nexport const PUBLIC_VERSION = '4';\n","<script>\n  import { createEventDispatcher } from 'svelte';\n  \n  const dispatch = createEventDispatcher();\n  \n  export let value = '';\n  export let placeholder = 'Search: use +term (must include), -term (exclude), \"exact phrase\"';\n  \n  let debounceTimer;\n  let inputElement;\n  let showHelp = false;\n  \n  // Parse query to show visual feedback\n  $: parsedQuery = parseQueryForDisplay(value);\n  \n  function parseQueryForDisplay(query) {\n    if (!query) return { positive: [], negative: [], phrases: [], regular: [] };\n    \n    const positive = [];\n    const negative = [];\n    const phrases = [];\n    const regular = [];\n    \n    // Extract quoted phrases first\n    const phraseMatches = query.match(/\"([^\"]+)\"/g) || [];\n    phraseMatches.forEach(p => phrases.push(p.slice(1, -1)));\n    \n    // Remove quoted phrases for further parsing\n    let remaining = query.replace(/\"[^\"]+\"/g, '').trim();\n    \n    // Split into terms\n    const terms = remaining.split(/\\s+/).filter(t => t.length > 0);\n    \n    terms.forEach(term => {\n      if (term.startsWith('+') && term.length > 1) {\n        positive.push(term.slice(1));\n      } else if (term.startsWith('-') && term.length > 1) {\n        negative.push(term.slice(1));\n      } else {\n        regular.push(term);\n      }\n    });\n    \n    return { positive, negative, phrases, regular };\n  }\n  \n  function handleInput(event) {\n    value = event.target.value;\n    \n    // Debounce search to avoid too many queries\n    clearTimeout(debounceTimer);\n    debounceTimer = setTimeout(() => {\n      dispatch('search', { query: value });\n    }, 200);\n  }\n  \n  function handleKeyDown(event) {\n    if (event.key === 'Escape') {\n      clearSearch();\n    } else if (event.key === 'Enter') {\n      // Immediate search on Enter\n      clearTimeout(debounceTimer);\n      dispatch('search', { query: value });\n    }\n  }\n  \n  function clearSearch() {\n    value = '';\n    dispatch('search', { query: '' });\n    inputElement?.focus();\n  }\n  \n  function toggleHelp() {\n    showHelp = !showHelp;\n  }\n</script>\n\n<div class=\"relative mb-4\">\n  <div class=\"flex items-center gap-2\">\n    <div class=\"relative flex-1\">\n      <div class=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n        <svg class=\"h-5 w-5 text-gray-400\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n          <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z\"></path>\n        </svg>\n      </div>\n      <input\n        bind:this={inputElement}\n        type=\"text\"\n        bind:value\n        on:input={handleInput}\n        on:keydown={handleKeyDown}\n        placeholder={placeholder}\n        class=\"block w-full pl-10 pr-10 py-2.5 border border-gray-300 rounded-lg leading-5 bg-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm\"\n        autocomplete=\"off\"\n        spellcheck=\"false\"\n      />\n      {#if value}\n        <button\n          on:click={clearSearch}\n          class=\"absolute inset-y-0 right-0 pr-3 flex items-center\"\n          type=\"button\"\n          title=\"Clear search (Esc)\"\n        >\n          <svg class=\"h-5 w-5 text-gray-400 hover:text-gray-600\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M6 18L18 6M6 6l12 12\"></path>\n          </svg>\n        </button>\n      {/if}\n    </div>\n    <button\n      on:click={toggleHelp}\n      class=\"p-2.5 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg border border-gray-300 transition-colors\"\n      type=\"button\"\n      title=\"Search help\"\n    >\n      <svg class=\"h-5 w-5\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"></path>\n      </svg>\n    </button>\n  </div>\n  \n  <!-- Active search terms display -->\n  {#if value && (parsedQuery.positive.length > 0 || parsedQuery.negative.length > 0 || parsedQuery.phrases.length > 0)}\n    <div class=\"flex flex-wrap gap-1.5 mt-2\">\n      {#each parsedQuery.positive as term}\n        <span class=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800\">\n          <svg class=\"w-3 h-3 mr-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clip-rule=\"evenodd\"/></svg>\n          {term}\n        </span>\n      {/each}\n      {#each parsedQuery.negative as term}\n        <span class=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800\">\n          <svg class=\"w-3 h-3 mr-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clip-rule=\"evenodd\"/></svg>\n          {term}\n        </span>\n      {/each}\n      {#each parsedQuery.phrases as phrase}\n        <span class=\"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800\">\n          <svg class=\"w-3 h-3 mr-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M18 13V5a2 2 0 00-2-2H4a2 2 0 00-2 2v8a2 2 0 002 2h3l3 3 3-3h3a2 2 0 002-2zM5 7a1 1 0 011-1h8a1 1 0 110 2H6a1 1 0 01-1-1zm1 3a1 1 0 100 2h3a1 1 0 100-2H6z\" clip-rule=\"evenodd\"/></svg>\n          \"{phrase}\"\n        </span>\n      {/each}\n    </div>\n  {/if}\n  \n  <!-- Search help dropdown -->\n  {#if showHelp}\n    <div class=\"absolute z-20 w-full mt-2 p-4 bg-white border border-gray-200 rounded-lg shadow-lg\">\n      <h4 class=\"font-medium text-gray-900 mb-3\">Search Syntax</h4>\n      <div class=\"space-y-2 text-sm\">\n        <div class=\"flex items-start gap-3\">\n          <code class=\"px-1.5 py-0.5 bg-green-100 text-green-800 rounded text-xs whitespace-nowrap\">+term</code>\n          <span class=\"text-gray-600\">Must include this term</span>\n        </div>\n        <div class=\"flex items-start gap-3\">\n          <code class=\"px-1.5 py-0.5 bg-red-100 text-red-800 rounded text-xs whitespace-nowrap\">-term</code>\n          <span class=\"text-gray-600\">Must NOT include this term</span>\n        </div>\n        <div class=\"flex items-start gap-3\">\n          <code class=\"px-1.5 py-0.5 bg-blue-100 text-blue-800 rounded text-xs whitespace-nowrap\">\"exact phrase\"</code>\n          <span class=\"text-gray-600\">Match exact phrase</span>\n        </div>\n        <div class=\"flex items-start gap-3\">\n          <code class=\"px-1.5 py-0.5 bg-gray-100 text-gray-700 rounded text-xs whitespace-nowrap\">word</code>\n          <span class=\"text-gray-600\">Regular search term</span>\n        </div>\n      </div>\n      <div class=\"mt-3 pt-3 border-t border-gray-100\">\n        <p class=\"text-xs text-gray-500\">\n          <strong>Example:</strong> <code class=\"bg-gray-100 px-1 rounded\">javascript +tutorial -video \"best practices\"</code>\n        </p>\n      </div>\n    </div>\n  {/if}\n</div>\n","/*\n * Dexie.js - a minimalistic wrapper for IndexedDB\n * ===============================================\n *\n * By David Fahlander, david.fahlander@gmail.com\n *\n * Version 4.2.1, Sat Oct 04 2025\n *\n * https://dexie.org\n *\n * Apache License Version 2.0, January 2004, http://www.apache.org/licenses/\n */\n \n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define(factory) :\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.Dexie = factory());\n})(this, (function () { 'use strict';\n\n    /*! *****************************************************************************\n    Copyright (c) Microsoft Corporation.\n    Permission to use, copy, modify, and/or distribute this software for any\n    purpose with or without fee is hereby granted.\n    THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\n    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n    PERFORMANCE OF THIS SOFTWARE.\n    ***************************************************************************** */\n    var extendStatics = function(d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    function __extends(d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    }\n    var __assign = function() {\n        __assign = Object.assign || function __assign(t) {\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\n                s = arguments[i];\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n            }\n            return t;\n        };\n        return __assign.apply(this, arguments);\n    };\n    function __spreadArray(to, from, pack) {\n        if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n            if (ar || !(i in from)) {\n                if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n                ar[i] = from[i];\n            }\n        }\n        return to.concat(ar || Array.prototype.slice.call(from));\n    }\n\n    var _global = typeof globalThis !== 'undefined' ? globalThis :\n        typeof self !== 'undefined' ? self :\n            typeof window !== 'undefined' ? window :\n                global;\n\n    var keys = Object.keys;\n    var isArray = Array.isArray;\n    if (typeof Promise !== 'undefined' && !_global.Promise) {\n        _global.Promise = Promise;\n    }\n    function extend(obj, extension) {\n        if (typeof extension !== 'object')\n            return obj;\n        keys(extension).forEach(function (key) {\n            obj[key] = extension[key];\n        });\n        return obj;\n    }\n    var getProto = Object.getPrototypeOf;\n    var _hasOwn = {}.hasOwnProperty;\n    function hasOwn(obj, prop) {\n        return _hasOwn.call(obj, prop);\n    }\n    function props(proto, extension) {\n        if (typeof extension === 'function')\n            extension = extension(getProto(proto));\n        (typeof Reflect === \"undefined\" ? keys : Reflect.ownKeys)(extension).forEach(function (key) {\n            setProp(proto, key, extension[key]);\n        });\n    }\n    var defineProperty = Object.defineProperty;\n    function setProp(obj, prop, functionOrGetSet, options) {\n        defineProperty(obj, prop, extend(functionOrGetSet && hasOwn(functionOrGetSet, \"get\") && typeof functionOrGetSet.get === 'function' ?\n            { get: functionOrGetSet.get, set: functionOrGetSet.set, configurable: true } :\n            { value: functionOrGetSet, configurable: true, writable: true }, options));\n    }\n    function derive(Child) {\n        return {\n            from: function (Parent) {\n                Child.prototype = Object.create(Parent.prototype);\n                setProp(Child.prototype, \"constructor\", Child);\n                return {\n                    extend: props.bind(null, Child.prototype)\n                };\n            }\n        };\n    }\n    var getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n    function getPropertyDescriptor(obj, prop) {\n        var pd = getOwnPropertyDescriptor(obj, prop);\n        var proto;\n        return pd || (proto = getProto(obj)) && getPropertyDescriptor(proto, prop);\n    }\n    var _slice = [].slice;\n    function slice(args, start, end) {\n        return _slice.call(args, start, end);\n    }\n    function override(origFunc, overridedFactory) {\n        return overridedFactory(origFunc);\n    }\n    function assert(b) {\n        if (!b)\n            throw new Error(\"Assertion Failed\");\n    }\n    function asap$1(fn) {\n        if (_global.setImmediate)\n            setImmediate(fn);\n        else\n            setTimeout(fn, 0);\n    }\n    function arrayToObject(array, extractor) {\n        return array.reduce(function (result, item, i) {\n            var nameAndValue = extractor(item, i);\n            if (nameAndValue)\n                result[nameAndValue[0]] = nameAndValue[1];\n            return result;\n        }, {});\n    }\n    function getByKeyPath(obj, keyPath) {\n        if (typeof keyPath === 'string' && hasOwn(obj, keyPath))\n            return obj[keyPath];\n        if (!keyPath)\n            return obj;\n        if (typeof keyPath !== 'string') {\n            var rv = [];\n            for (var i = 0, l = keyPath.length; i < l; ++i) {\n                var val = getByKeyPath(obj, keyPath[i]);\n                rv.push(val);\n            }\n            return rv;\n        }\n        var period = keyPath.indexOf('.');\n        if (period !== -1) {\n            var innerObj = obj[keyPath.substr(0, period)];\n            return innerObj == null ? undefined : getByKeyPath(innerObj, keyPath.substr(period + 1));\n        }\n        return undefined;\n    }\n    function setByKeyPath(obj, keyPath, value) {\n        if (!obj || keyPath === undefined)\n            return;\n        if ('isFrozen' in Object && Object.isFrozen(obj))\n            return;\n        if (typeof keyPath !== 'string' && 'length' in keyPath) {\n            assert(typeof value !== 'string' && 'length' in value);\n            for (var i = 0, l = keyPath.length; i < l; ++i) {\n                setByKeyPath(obj, keyPath[i], value[i]);\n            }\n        }\n        else {\n            var period = keyPath.indexOf('.');\n            if (period !== -1) {\n                var currentKeyPath = keyPath.substr(0, period);\n                var remainingKeyPath = keyPath.substr(period + 1);\n                if (remainingKeyPath === \"\")\n                    if (value === undefined) {\n                        if (isArray(obj) && !isNaN(parseInt(currentKeyPath)))\n                            obj.splice(currentKeyPath, 1);\n                        else\n                            delete obj[currentKeyPath];\n                    }\n                    else\n                        obj[currentKeyPath] = value;\n                else {\n                    var innerObj = obj[currentKeyPath];\n                    if (!innerObj || !hasOwn(obj, currentKeyPath))\n                        innerObj = (obj[currentKeyPath] = {});\n                    setByKeyPath(innerObj, remainingKeyPath, value);\n                }\n            }\n            else {\n                if (value === undefined) {\n                    if (isArray(obj) && !isNaN(parseInt(keyPath)))\n                        obj.splice(keyPath, 1);\n                    else\n                        delete obj[keyPath];\n                }\n                else\n                    obj[keyPath] = value;\n            }\n        }\n    }\n    function delByKeyPath(obj, keyPath) {\n        if (typeof keyPath === 'string')\n            setByKeyPath(obj, keyPath, undefined);\n        else if ('length' in keyPath)\n            [].map.call(keyPath, function (kp) {\n                setByKeyPath(obj, kp, undefined);\n            });\n    }\n    function shallowClone(obj) {\n        var rv = {};\n        for (var m in obj) {\n            if (hasOwn(obj, m))\n                rv[m] = obj[m];\n        }\n        return rv;\n    }\n    var concat = [].concat;\n    function flatten(a) {\n        return concat.apply([], a);\n    }\n    var intrinsicTypeNames = \"BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey\"\n        .split(',').concat(flatten([8, 16, 32, 64].map(function (num) { return [\"Int\", \"Uint\", \"Float\"].map(function (t) { return t + num + \"Array\"; }); }))).filter(function (t) { return _global[t]; });\n    var intrinsicTypes = new Set(intrinsicTypeNames.map(function (t) { return _global[t]; }));\n    function cloneSimpleObjectTree(o) {\n        var rv = {};\n        for (var k in o)\n            if (hasOwn(o, k)) {\n                var v = o[k];\n                rv[k] = !v || typeof v !== 'object' || intrinsicTypes.has(v.constructor) ? v : cloneSimpleObjectTree(v);\n            }\n        return rv;\n    }\n    function objectIsEmpty(o) {\n        for (var k in o)\n            if (hasOwn(o, k))\n                return false;\n        return true;\n    }\n    var circularRefs = null;\n    function deepClone(any) {\n        circularRefs = new WeakMap();\n        var rv = innerDeepClone(any);\n        circularRefs = null;\n        return rv;\n    }\n    function innerDeepClone(x) {\n        if (!x || typeof x !== 'object')\n            return x;\n        var rv = circularRefs.get(x);\n        if (rv)\n            return rv;\n        if (isArray(x)) {\n            rv = [];\n            circularRefs.set(x, rv);\n            for (var i = 0, l = x.length; i < l; ++i) {\n                rv.push(innerDeepClone(x[i]));\n            }\n        }\n        else if (intrinsicTypes.has(x.constructor)) {\n            rv = x;\n        }\n        else {\n            var proto = getProto(x);\n            rv = proto === Object.prototype ? {} : Object.create(proto);\n            circularRefs.set(x, rv);\n            for (var prop in x) {\n                if (hasOwn(x, prop)) {\n                    rv[prop] = innerDeepClone(x[prop]);\n                }\n            }\n        }\n        return rv;\n    }\n    var toString = {}.toString;\n    function toStringTag(o) {\n        return toString.call(o).slice(8, -1);\n    }\n    var iteratorSymbol = typeof Symbol !== 'undefined' ?\n        Symbol.iterator :\n        '@@iterator';\n    var getIteratorOf = typeof iteratorSymbol === \"symbol\" ? function (x) {\n        var i;\n        return x != null && (i = x[iteratorSymbol]) && i.apply(x);\n    } : function () { return null; };\n    function delArrayItem(a, x) {\n        var i = a.indexOf(x);\n        if (i >= 0)\n            a.splice(i, 1);\n        return i >= 0;\n    }\n    var NO_CHAR_ARRAY = {};\n    function getArrayOf(arrayLike) {\n        var i, a, x, it;\n        if (arguments.length === 1) {\n            if (isArray(arrayLike))\n                return arrayLike.slice();\n            if (this === NO_CHAR_ARRAY && typeof arrayLike === 'string')\n                return [arrayLike];\n            if ((it = getIteratorOf(arrayLike))) {\n                a = [];\n                while ((x = it.next()), !x.done)\n                    a.push(x.value);\n                return a;\n            }\n            if (arrayLike == null)\n                return [arrayLike];\n            i = arrayLike.length;\n            if (typeof i === 'number') {\n                a = new Array(i);\n                while (i--)\n                    a[i] = arrayLike[i];\n                return a;\n            }\n            return [arrayLike];\n        }\n        i = arguments.length;\n        a = new Array(i);\n        while (i--)\n            a[i] = arguments[i];\n        return a;\n    }\n    var isAsyncFunction = typeof Symbol !== 'undefined'\n        ? function (fn) { return fn[Symbol.toStringTag] === 'AsyncFunction'; }\n        : function () { return false; };\n\n    var dexieErrorNames = [\n        'Modify',\n        'Bulk',\n        'OpenFailed',\n        'VersionChange',\n        'Schema',\n        'Upgrade',\n        'InvalidTable',\n        'MissingAPI',\n        'NoSuchDatabase',\n        'InvalidArgument',\n        'SubTransaction',\n        'Unsupported',\n        'Internal',\n        'DatabaseClosed',\n        'PrematureCommit',\n        'ForeignAwait'\n    ];\n    var idbDomErrorNames = [\n        'Unknown',\n        'Constraint',\n        'Data',\n        'TransactionInactive',\n        'ReadOnly',\n        'Version',\n        'NotFound',\n        'InvalidState',\n        'InvalidAccess',\n        'Abort',\n        'Timeout',\n        'QuotaExceeded',\n        'Syntax',\n        'DataClone'\n    ];\n    var errorList = dexieErrorNames.concat(idbDomErrorNames);\n    var defaultTexts = {\n        VersionChanged: \"Database version changed by other database connection\",\n        DatabaseClosed: \"Database has been closed\",\n        Abort: \"Transaction aborted\",\n        TransactionInactive: \"Transaction has already completed or failed\",\n        MissingAPI: \"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb\"\n    };\n    function DexieError(name, msg) {\n        this.name = name;\n        this.message = msg;\n    }\n    derive(DexieError).from(Error).extend({\n        toString: function () { return this.name + \": \" + this.message; }\n    });\n    function getMultiErrorMessage(msg, failures) {\n        return msg + \". Errors: \" + Object.keys(failures)\n            .map(function (key) { return failures[key].toString(); })\n            .filter(function (v, i, s) { return s.indexOf(v) === i; })\n            .join('\\n');\n    }\n    function ModifyError(msg, failures, successCount, failedKeys) {\n        this.failures = failures;\n        this.failedKeys = failedKeys;\n        this.successCount = successCount;\n        this.message = getMultiErrorMessage(msg, failures);\n    }\n    derive(ModifyError).from(DexieError);\n    function BulkError(msg, failures) {\n        this.name = \"BulkError\";\n        this.failures = Object.keys(failures).map(function (pos) { return failures[pos]; });\n        this.failuresByPos = failures;\n        this.message = getMultiErrorMessage(msg, this.failures);\n    }\n    derive(BulkError).from(DexieError);\n    var errnames = errorList.reduce(function (obj, name) { return (obj[name] = name + \"Error\", obj); }, {});\n    var BaseException = DexieError;\n    var exceptions = errorList.reduce(function (obj, name) {\n        var fullName = name + \"Error\";\n        function DexieError(msgOrInner, inner) {\n            this.name = fullName;\n            if (!msgOrInner) {\n                this.message = defaultTexts[name] || fullName;\n                this.inner = null;\n            }\n            else if (typeof msgOrInner === 'string') {\n                this.message = \"\".concat(msgOrInner).concat(!inner ? '' : '\\n ' + inner);\n                this.inner = inner || null;\n            }\n            else if (typeof msgOrInner === 'object') {\n                this.message = \"\".concat(msgOrInner.name, \" \").concat(msgOrInner.message);\n                this.inner = msgOrInner;\n            }\n        }\n        derive(DexieError).from(BaseException);\n        obj[name] = DexieError;\n        return obj;\n    }, {});\n    exceptions.Syntax = SyntaxError;\n    exceptions.Type = TypeError;\n    exceptions.Range = RangeError;\n    var exceptionMap = idbDomErrorNames.reduce(function (obj, name) {\n        obj[name + \"Error\"] = exceptions[name];\n        return obj;\n    }, {});\n    function mapError(domError, message) {\n        if (!domError || domError instanceof DexieError || domError instanceof TypeError || domError instanceof SyntaxError || !domError.name || !exceptionMap[domError.name])\n            return domError;\n        var rv = new exceptionMap[domError.name](message || domError.message, domError);\n        if (\"stack\" in domError) {\n            setProp(rv, \"stack\", { get: function () {\n                    return this.inner.stack;\n                } });\n        }\n        return rv;\n    }\n    var fullNameExceptions = errorList.reduce(function (obj, name) {\n        if ([\"Syntax\", \"Type\", \"Range\"].indexOf(name) === -1)\n            obj[name + \"Error\"] = exceptions[name];\n        return obj;\n    }, {});\n    fullNameExceptions.ModifyError = ModifyError;\n    fullNameExceptions.DexieError = DexieError;\n    fullNameExceptions.BulkError = BulkError;\n\n    function nop() { }\n    function mirror(val) { return val; }\n    function pureFunctionChain(f1, f2) {\n        if (f1 == null || f1 === mirror)\n            return f2;\n        return function (val) {\n            return f2(f1(val));\n        };\n    }\n    function callBoth(on1, on2) {\n        return function () {\n            on1.apply(this, arguments);\n            on2.apply(this, arguments);\n        };\n    }\n    function hookCreatingChain(f1, f2) {\n        if (f1 === nop)\n            return f2;\n        return function () {\n            var res = f1.apply(this, arguments);\n            if (res !== undefined)\n                arguments[0] = res;\n            var onsuccess = this.onsuccess,\n            onerror = this.onerror;\n            this.onsuccess = null;\n            this.onerror = null;\n            var res2 = f2.apply(this, arguments);\n            if (onsuccess)\n                this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n            if (onerror)\n                this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n            return res2 !== undefined ? res2 : res;\n        };\n    }\n    function hookDeletingChain(f1, f2) {\n        if (f1 === nop)\n            return f2;\n        return function () {\n            f1.apply(this, arguments);\n            var onsuccess = this.onsuccess,\n            onerror = this.onerror;\n            this.onsuccess = this.onerror = null;\n            f2.apply(this, arguments);\n            if (onsuccess)\n                this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n            if (onerror)\n                this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n        };\n    }\n    function hookUpdatingChain(f1, f2) {\n        if (f1 === nop)\n            return f2;\n        return function (modifications) {\n            var res = f1.apply(this, arguments);\n            extend(modifications, res);\n            var onsuccess = this.onsuccess,\n            onerror = this.onerror;\n            this.onsuccess = null;\n            this.onerror = null;\n            var res2 = f2.apply(this, arguments);\n            if (onsuccess)\n                this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n            if (onerror)\n                this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n            return res === undefined ?\n                (res2 === undefined ? undefined : res2) :\n                (extend(res, res2));\n        };\n    }\n    function reverseStoppableEventChain(f1, f2) {\n        if (f1 === nop)\n            return f2;\n        return function () {\n            if (f2.apply(this, arguments) === false)\n                return false;\n            return f1.apply(this, arguments);\n        };\n    }\n    function promisableChain(f1, f2) {\n        if (f1 === nop)\n            return f2;\n        return function () {\n            var res = f1.apply(this, arguments);\n            if (res && typeof res.then === 'function') {\n                var thiz = this, i = arguments.length, args = new Array(i);\n                while (i--)\n                    args[i] = arguments[i];\n                return res.then(function () {\n                    return f2.apply(thiz, args);\n                });\n            }\n            return f2.apply(this, arguments);\n        };\n    }\n\n    var debug = typeof location !== 'undefined' &&\n        /^(http|https):\\/\\/(localhost|127\\.0\\.0\\.1)/.test(location.href);\n    function setDebug(value, filter) {\n        debug = value;\n    }\n\n    var INTERNAL = {};\n    var ZONE_ECHO_LIMIT = 100, _a$1 = typeof Promise === 'undefined' ?\n        [] :\n        (function () {\n            var globalP = Promise.resolve();\n            if (typeof crypto === 'undefined' || !crypto.subtle)\n                return [globalP, getProto(globalP), globalP];\n            var nativeP = crypto.subtle.digest(\"SHA-512\", new Uint8Array([0]));\n            return [\n                nativeP,\n                getProto(nativeP),\n                globalP\n            ];\n        })(), resolvedNativePromise = _a$1[0], nativePromiseProto = _a$1[1], resolvedGlobalPromise = _a$1[2], nativePromiseThen = nativePromiseProto && nativePromiseProto.then;\n    var NativePromise = resolvedNativePromise && resolvedNativePromise.constructor;\n    var patchGlobalPromise = !!resolvedGlobalPromise;\n    function schedulePhysicalTick() {\n        queueMicrotask(physicalTick);\n    }\n    var asap = function (callback, args) {\n        microtickQueue.push([callback, args]);\n        if (needsNewPhysicalTick) {\n            schedulePhysicalTick();\n            needsNewPhysicalTick = false;\n        }\n    };\n    var isOutsideMicroTick = true,\n    needsNewPhysicalTick = true,\n    unhandledErrors = [],\n    rejectingErrors = [],\n    rejectionMapper = mirror;\n    var globalPSD = {\n        id: 'global',\n        global: true,\n        ref: 0,\n        unhandleds: [],\n        onunhandled: nop,\n        pgp: false,\n        env: {},\n        finalize: nop\n    };\n    var PSD = globalPSD;\n    var microtickQueue = [];\n    var numScheduledCalls = 0;\n    var tickFinalizers = [];\n    function DexiePromise(fn) {\n        if (typeof this !== 'object')\n            throw new TypeError('Promises must be constructed via new');\n        this._listeners = [];\n        this._lib = false;\n        var psd = (this._PSD = PSD);\n        if (typeof fn !== 'function') {\n            if (fn !== INTERNAL)\n                throw new TypeError('Not a function');\n            this._state = arguments[1];\n            this._value = arguments[2];\n            if (this._state === false)\n                handleRejection(this, this._value);\n            return;\n        }\n        this._state = null;\n        this._value = null;\n        ++psd.ref;\n        executePromiseTask(this, fn);\n    }\n    var thenProp = {\n        get: function () {\n            var psd = PSD, microTaskId = totalEchoes;\n            function then(onFulfilled, onRejected) {\n                var _this = this;\n                var possibleAwait = !psd.global && (psd !== PSD || microTaskId !== totalEchoes);\n                var cleanup = possibleAwait && !decrementExpectedAwaits();\n                var rv = new DexiePromise(function (resolve, reject) {\n                    propagateToListener(_this, new Listener(nativeAwaitCompatibleWrap(onFulfilled, psd, possibleAwait, cleanup), nativeAwaitCompatibleWrap(onRejected, psd, possibleAwait, cleanup), resolve, reject, psd));\n                });\n                if (this._consoleTask)\n                    rv._consoleTask = this._consoleTask;\n                return rv;\n            }\n            then.prototype = INTERNAL;\n            return then;\n        },\n        set: function (value) {\n            setProp(this, 'then', value && value.prototype === INTERNAL ?\n                thenProp :\n                {\n                    get: function () {\n                        return value;\n                    },\n                    set: thenProp.set\n                });\n        }\n    };\n    props(DexiePromise.prototype, {\n        then: thenProp,\n        _then: function (onFulfilled, onRejected) {\n            propagateToListener(this, new Listener(null, null, onFulfilled, onRejected, PSD));\n        },\n        catch: function (onRejected) {\n            if (arguments.length === 1)\n                return this.then(null, onRejected);\n            var type = arguments[0], handler = arguments[1];\n            return typeof type === 'function' ? this.then(null, function (err) {\n                return err instanceof type ? handler(err) : PromiseReject(err);\n            })\n                : this.then(null, function (err) {\n                    return err && err.name === type ? handler(err) : PromiseReject(err);\n                });\n        },\n        finally: function (onFinally) {\n            return this.then(function (value) {\n                return DexiePromise.resolve(onFinally()).then(function () { return value; });\n            }, function (err) {\n                return DexiePromise.resolve(onFinally()).then(function () { return PromiseReject(err); });\n            });\n        },\n        timeout: function (ms, msg) {\n            var _this = this;\n            return ms < Infinity ?\n                new DexiePromise(function (resolve, reject) {\n                    var handle = setTimeout(function () { return reject(new exceptions.Timeout(msg)); }, ms);\n                    _this.then(resolve, reject).finally(clearTimeout.bind(null, handle));\n                }) : this;\n        }\n    });\n    if (typeof Symbol !== 'undefined' && Symbol.toStringTag)\n        setProp(DexiePromise.prototype, Symbol.toStringTag, 'Dexie.Promise');\n    globalPSD.env = snapShot();\n    function Listener(onFulfilled, onRejected, resolve, reject, zone) {\n        this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n        this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n        this.resolve = resolve;\n        this.reject = reject;\n        this.psd = zone;\n    }\n    props(DexiePromise, {\n        all: function () {\n            var values = getArrayOf.apply(null, arguments)\n                .map(onPossibleParallellAsync);\n            return new DexiePromise(function (resolve, reject) {\n                if (values.length === 0)\n                    resolve([]);\n                var remaining = values.length;\n                values.forEach(function (a, i) { return DexiePromise.resolve(a).then(function (x) {\n                    values[i] = x;\n                    if (!--remaining)\n                        resolve(values);\n                }, reject); });\n            });\n        },\n        resolve: function (value) {\n            if (value instanceof DexiePromise)\n                return value;\n            if (value && typeof value.then === 'function')\n                return new DexiePromise(function (resolve, reject) {\n                    value.then(resolve, reject);\n                });\n            var rv = new DexiePromise(INTERNAL, true, value);\n            return rv;\n        },\n        reject: PromiseReject,\n        race: function () {\n            var values = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n            return new DexiePromise(function (resolve, reject) {\n                values.map(function (value) { return DexiePromise.resolve(value).then(resolve, reject); });\n            });\n        },\n        PSD: {\n            get: function () { return PSD; },\n            set: function (value) { return PSD = value; }\n        },\n        totalEchoes: { get: function () { return totalEchoes; } },\n        newPSD: newScope,\n        usePSD: usePSD,\n        scheduler: {\n            get: function () { return asap; },\n            set: function (value) { asap = value; }\n        },\n        rejectionMapper: {\n            get: function () { return rejectionMapper; },\n            set: function (value) { rejectionMapper = value; }\n        },\n        follow: function (fn, zoneProps) {\n            return new DexiePromise(function (resolve, reject) {\n                return newScope(function (resolve, reject) {\n                    var psd = PSD;\n                    psd.unhandleds = [];\n                    psd.onunhandled = reject;\n                    psd.finalize = callBoth(function () {\n                        var _this = this;\n                        run_at_end_of_this_or_next_physical_tick(function () {\n                            _this.unhandleds.length === 0 ? resolve() : reject(_this.unhandleds[0]);\n                        });\n                    }, psd.finalize);\n                    fn();\n                }, zoneProps, resolve, reject);\n            });\n        }\n    });\n    if (NativePromise) {\n        if (NativePromise.allSettled)\n            setProp(DexiePromise, \"allSettled\", function () {\n                var possiblePromises = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n                return new DexiePromise(function (resolve) {\n                    if (possiblePromises.length === 0)\n                        resolve([]);\n                    var remaining = possiblePromises.length;\n                    var results = new Array(remaining);\n                    possiblePromises.forEach(function (p, i) { return DexiePromise.resolve(p).then(function (value) { return results[i] = { status: \"fulfilled\", value: value }; }, function (reason) { return results[i] = { status: \"rejected\", reason: reason }; })\n                        .then(function () { return --remaining || resolve(results); }); });\n                });\n            });\n        if (NativePromise.any && typeof AggregateError !== 'undefined')\n            setProp(DexiePromise, \"any\", function () {\n                var possiblePromises = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n                return new DexiePromise(function (resolve, reject) {\n                    if (possiblePromises.length === 0)\n                        reject(new AggregateError([]));\n                    var remaining = possiblePromises.length;\n                    var failures = new Array(remaining);\n                    possiblePromises.forEach(function (p, i) { return DexiePromise.resolve(p).then(function (value) { return resolve(value); }, function (failure) {\n                        failures[i] = failure;\n                        if (!--remaining)\n                            reject(new AggregateError(failures));\n                    }); });\n                });\n            });\n        if (NativePromise.withResolvers)\n            DexiePromise.withResolvers = NativePromise.withResolvers;\n    }\n    function executePromiseTask(promise, fn) {\n        try {\n            fn(function (value) {\n                if (promise._state !== null)\n                    return;\n                if (value === promise)\n                    throw new TypeError('A promise cannot be resolved with itself.');\n                var shouldExecuteTick = promise._lib && beginMicroTickScope();\n                if (value && typeof value.then === 'function') {\n                    executePromiseTask(promise, function (resolve, reject) {\n                        value instanceof DexiePromise ?\n                            value._then(resolve, reject) :\n                            value.then(resolve, reject);\n                    });\n                }\n                else {\n                    promise._state = true;\n                    promise._value = value;\n                    propagateAllListeners(promise);\n                }\n                if (shouldExecuteTick)\n                    endMicroTickScope();\n            }, handleRejection.bind(null, promise));\n        }\n        catch (ex) {\n            handleRejection(promise, ex);\n        }\n    }\n    function handleRejection(promise, reason) {\n        rejectingErrors.push(reason);\n        if (promise._state !== null)\n            return;\n        var shouldExecuteTick = promise._lib && beginMicroTickScope();\n        reason = rejectionMapper(reason);\n        promise._state = false;\n        promise._value = reason;\n        addPossiblyUnhandledError(promise);\n        propagateAllListeners(promise);\n        if (shouldExecuteTick)\n            endMicroTickScope();\n    }\n    function propagateAllListeners(promise) {\n        var listeners = promise._listeners;\n        promise._listeners = [];\n        for (var i = 0, len = listeners.length; i < len; ++i) {\n            propagateToListener(promise, listeners[i]);\n        }\n        var psd = promise._PSD;\n        --psd.ref || psd.finalize();\n        if (numScheduledCalls === 0) {\n            ++numScheduledCalls;\n            asap(function () {\n                if (--numScheduledCalls === 0)\n                    finalizePhysicalTick();\n            }, []);\n        }\n    }\n    function propagateToListener(promise, listener) {\n        if (promise._state === null) {\n            promise._listeners.push(listener);\n            return;\n        }\n        var cb = promise._state ? listener.onFulfilled : listener.onRejected;\n        if (cb === null) {\n            return (promise._state ? listener.resolve : listener.reject)(promise._value);\n        }\n        ++listener.psd.ref;\n        ++numScheduledCalls;\n        asap(callListener, [cb, promise, listener]);\n    }\n    function callListener(cb, promise, listener) {\n        try {\n            var ret, value = promise._value;\n            if (!promise._state && rejectingErrors.length)\n                rejectingErrors = [];\n            ret = debug && promise._consoleTask ? promise._consoleTask.run(function () { return cb(value); }) : cb(value);\n            if (!promise._state && rejectingErrors.indexOf(value) === -1) {\n                markErrorAsHandled(promise);\n            }\n            listener.resolve(ret);\n        }\n        catch (e) {\n            listener.reject(e);\n        }\n        finally {\n            if (--numScheduledCalls === 0)\n                finalizePhysicalTick();\n            --listener.psd.ref || listener.psd.finalize();\n        }\n    }\n    function physicalTick() {\n        usePSD(globalPSD, function () {\n            beginMicroTickScope() && endMicroTickScope();\n        });\n    }\n    function beginMicroTickScope() {\n        var wasRootExec = isOutsideMicroTick;\n        isOutsideMicroTick = false;\n        needsNewPhysicalTick = false;\n        return wasRootExec;\n    }\n    function endMicroTickScope() {\n        var callbacks, i, l;\n        do {\n            while (microtickQueue.length > 0) {\n                callbacks = microtickQueue;\n                microtickQueue = [];\n                l = callbacks.length;\n                for (i = 0; i < l; ++i) {\n                    var item = callbacks[i];\n                    item[0].apply(null, item[1]);\n                }\n            }\n        } while (microtickQueue.length > 0);\n        isOutsideMicroTick = true;\n        needsNewPhysicalTick = true;\n    }\n    function finalizePhysicalTick() {\n        var unhandledErrs = unhandledErrors;\n        unhandledErrors = [];\n        unhandledErrs.forEach(function (p) {\n            p._PSD.onunhandled.call(null, p._value, p);\n        });\n        var finalizers = tickFinalizers.slice(0);\n        var i = finalizers.length;\n        while (i)\n            finalizers[--i]();\n    }\n    function run_at_end_of_this_or_next_physical_tick(fn) {\n        function finalizer() {\n            fn();\n            tickFinalizers.splice(tickFinalizers.indexOf(finalizer), 1);\n        }\n        tickFinalizers.push(finalizer);\n        ++numScheduledCalls;\n        asap(function () {\n            if (--numScheduledCalls === 0)\n                finalizePhysicalTick();\n        }, []);\n    }\n    function addPossiblyUnhandledError(promise) {\n        if (!unhandledErrors.some(function (p) { return p._value === promise._value; }))\n            unhandledErrors.push(promise);\n    }\n    function markErrorAsHandled(promise) {\n        var i = unhandledErrors.length;\n        while (i)\n            if (unhandledErrors[--i]._value === promise._value) {\n                unhandledErrors.splice(i, 1);\n                return;\n            }\n    }\n    function PromiseReject(reason) {\n        return new DexiePromise(INTERNAL, false, reason);\n    }\n    function wrap(fn, errorCatcher) {\n        var psd = PSD;\n        return function () {\n            var wasRootExec = beginMicroTickScope(), outerScope = PSD;\n            try {\n                switchToZone(psd, true);\n                return fn.apply(this, arguments);\n            }\n            catch (e) {\n                errorCatcher && errorCatcher(e);\n            }\n            finally {\n                switchToZone(outerScope, false);\n                if (wasRootExec)\n                    endMicroTickScope();\n            }\n        };\n    }\n    var task = { awaits: 0, echoes: 0, id: 0 };\n    var taskCounter = 0;\n    var zoneStack = [];\n    var zoneEchoes = 0;\n    var totalEchoes = 0;\n    var zone_id_counter = 0;\n    function newScope(fn, props, a1, a2) {\n        var parent = PSD, psd = Object.create(parent);\n        psd.parent = parent;\n        psd.ref = 0;\n        psd.global = false;\n        psd.id = ++zone_id_counter;\n        globalPSD.env;\n        psd.env = patchGlobalPromise ? {\n            Promise: DexiePromise,\n            PromiseProp: { value: DexiePromise, configurable: true, writable: true },\n            all: DexiePromise.all,\n            race: DexiePromise.race,\n            allSettled: DexiePromise.allSettled,\n            any: DexiePromise.any,\n            resolve: DexiePromise.resolve,\n            reject: DexiePromise.reject,\n        } : {};\n        if (props)\n            extend(psd, props);\n        ++parent.ref;\n        psd.finalize = function () {\n            --this.parent.ref || this.parent.finalize();\n        };\n        var rv = usePSD(psd, fn, a1, a2);\n        if (psd.ref === 0)\n            psd.finalize();\n        return rv;\n    }\n    function incrementExpectedAwaits() {\n        if (!task.id)\n            task.id = ++taskCounter;\n        ++task.awaits;\n        task.echoes += ZONE_ECHO_LIMIT;\n        return task.id;\n    }\n    function decrementExpectedAwaits() {\n        if (!task.awaits)\n            return false;\n        if (--task.awaits === 0)\n            task.id = 0;\n        task.echoes = task.awaits * ZONE_ECHO_LIMIT;\n        return true;\n    }\n    if (('' + nativePromiseThen).indexOf('[native code]') === -1) {\n        incrementExpectedAwaits = decrementExpectedAwaits = nop;\n    }\n    function onPossibleParallellAsync(possiblePromise) {\n        if (task.echoes && possiblePromise && possiblePromise.constructor === NativePromise) {\n            incrementExpectedAwaits();\n            return possiblePromise.then(function (x) {\n                decrementExpectedAwaits();\n                return x;\n            }, function (e) {\n                decrementExpectedAwaits();\n                return rejection(e);\n            });\n        }\n        return possiblePromise;\n    }\n    function zoneEnterEcho(targetZone) {\n        ++totalEchoes;\n        if (!task.echoes || --task.echoes === 0) {\n            task.echoes = task.awaits = task.id = 0;\n        }\n        zoneStack.push(PSD);\n        switchToZone(targetZone, true);\n    }\n    function zoneLeaveEcho() {\n        var zone = zoneStack[zoneStack.length - 1];\n        zoneStack.pop();\n        switchToZone(zone, false);\n    }\n    function switchToZone(targetZone, bEnteringZone) {\n        var currentZone = PSD;\n        if (bEnteringZone ? task.echoes && (!zoneEchoes++ || targetZone !== PSD) : zoneEchoes && (!--zoneEchoes || targetZone !== PSD)) {\n            queueMicrotask(bEnteringZone ? zoneEnterEcho.bind(null, targetZone) : zoneLeaveEcho);\n        }\n        if (targetZone === PSD)\n            return;\n        PSD = targetZone;\n        if (currentZone === globalPSD)\n            globalPSD.env = snapShot();\n        if (patchGlobalPromise) {\n            var GlobalPromise = globalPSD.env.Promise;\n            var targetEnv = targetZone.env;\n            if (currentZone.global || targetZone.global) {\n                Object.defineProperty(_global, 'Promise', targetEnv.PromiseProp);\n                GlobalPromise.all = targetEnv.all;\n                GlobalPromise.race = targetEnv.race;\n                GlobalPromise.resolve = targetEnv.resolve;\n                GlobalPromise.reject = targetEnv.reject;\n                if (targetEnv.allSettled)\n                    GlobalPromise.allSettled = targetEnv.allSettled;\n                if (targetEnv.any)\n                    GlobalPromise.any = targetEnv.any;\n            }\n        }\n    }\n    function snapShot() {\n        var GlobalPromise = _global.Promise;\n        return patchGlobalPromise ? {\n            Promise: GlobalPromise,\n            PromiseProp: Object.getOwnPropertyDescriptor(_global, \"Promise\"),\n            all: GlobalPromise.all,\n            race: GlobalPromise.race,\n            allSettled: GlobalPromise.allSettled,\n            any: GlobalPromise.any,\n            resolve: GlobalPromise.resolve,\n            reject: GlobalPromise.reject,\n        } : {};\n    }\n    function usePSD(psd, fn, a1, a2, a3) {\n        var outerScope = PSD;\n        try {\n            switchToZone(psd, true);\n            return fn(a1, a2, a3);\n        }\n        finally {\n            switchToZone(outerScope, false);\n        }\n    }\n    function nativeAwaitCompatibleWrap(fn, zone, possibleAwait, cleanup) {\n        return typeof fn !== 'function' ? fn : function () {\n            var outerZone = PSD;\n            if (possibleAwait)\n                incrementExpectedAwaits();\n            switchToZone(zone, true);\n            try {\n                return fn.apply(this, arguments);\n            }\n            finally {\n                switchToZone(outerZone, false);\n                if (cleanup)\n                    queueMicrotask(decrementExpectedAwaits);\n            }\n        };\n    }\n    function execInGlobalContext(cb) {\n        if (Promise === NativePromise && task.echoes === 0) {\n            if (zoneEchoes === 0) {\n                cb();\n            }\n            else {\n                enqueueNativeMicroTask(cb);\n            }\n        }\n        else {\n            setTimeout(cb, 0);\n        }\n    }\n    var rejection = DexiePromise.reject;\n\n    function tempTransaction(db, mode, storeNames, fn) {\n        if (!db.idbdb || (!db._state.openComplete && (!PSD.letThrough && !db._vip))) {\n            if (db._state.openComplete) {\n                return rejection(new exceptions.DatabaseClosed(db._state.dbOpenError));\n            }\n            if (!db._state.isBeingOpened) {\n                if (!db._state.autoOpen)\n                    return rejection(new exceptions.DatabaseClosed());\n                db.open().catch(nop);\n            }\n            return db._state.dbReadyPromise.then(function () { return tempTransaction(db, mode, storeNames, fn); });\n        }\n        else {\n            var trans = db._createTransaction(mode, storeNames, db._dbSchema);\n            try {\n                trans.create();\n                db._state.PR1398_maxLoop = 3;\n            }\n            catch (ex) {\n                if (ex.name === errnames.InvalidState && db.isOpen() && --db._state.PR1398_maxLoop > 0) {\n                    console.warn('Dexie: Need to reopen db');\n                    db.close({ disableAutoOpen: false });\n                    return db.open().then(function () { return tempTransaction(db, mode, storeNames, fn); });\n                }\n                return rejection(ex);\n            }\n            return trans._promise(mode, function (resolve, reject) {\n                return newScope(function () {\n                    PSD.trans = trans;\n                    return fn(resolve, reject, trans);\n                });\n            }).then(function (result) {\n                if (mode === 'readwrite')\n                    try {\n                        trans.idbtrans.commit();\n                    }\n                    catch (_a) { }\n                return mode === 'readonly' ? result : trans._completion.then(function () { return result; });\n            });\n        }\n    }\n\n    var DEXIE_VERSION = '4.2.1';\n    var maxString = String.fromCharCode(65535);\n    var minKey = -Infinity;\n    var INVALID_KEY_ARGUMENT = \"Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.\";\n    var STRING_EXPECTED = \"String expected.\";\n    var connections = [];\n    var DBNAMES_DB = '__dbnames';\n    var READONLY = 'readonly';\n    var READWRITE = 'readwrite';\n\n    function combine(filter1, filter2) {\n        return filter1 ?\n            filter2 ?\n                function () { return filter1.apply(this, arguments) && filter2.apply(this, arguments); } :\n                filter1 :\n            filter2;\n    }\n\n    var AnyRange = {\n        type: 3 ,\n        lower: -Infinity,\n        lowerOpen: false,\n        upper: [[]],\n        upperOpen: false\n    };\n\n    function workaroundForUndefinedPrimKey(keyPath) {\n        return typeof keyPath === \"string\" && !/\\./.test(keyPath)\n            ? function (obj) {\n                if (obj[keyPath] === undefined && (keyPath in obj)) {\n                    obj = deepClone(obj);\n                    delete obj[keyPath];\n                }\n                return obj;\n            }\n            : function (obj) { return obj; };\n    }\n\n    function Entity() {\n        throw exceptions.Type(\"Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.\");\n    }\n\n    function cmp(a, b) {\n        try {\n            var ta = type(a);\n            var tb = type(b);\n            if (ta !== tb) {\n                if (ta === 'Array')\n                    return 1;\n                if (tb === 'Array')\n                    return -1;\n                if (ta === 'binary')\n                    return 1;\n                if (tb === 'binary')\n                    return -1;\n                if (ta === 'string')\n                    return 1;\n                if (tb === 'string')\n                    return -1;\n                if (ta === 'Date')\n                    return 1;\n                if (tb !== 'Date')\n                    return NaN;\n                return -1;\n            }\n            switch (ta) {\n                case 'number':\n                case 'Date':\n                case 'string':\n                    return a > b ? 1 : a < b ? -1 : 0;\n                case 'binary': {\n                    return compareUint8Arrays(getUint8Array(a), getUint8Array(b));\n                }\n                case 'Array':\n                    return compareArrays(a, b);\n            }\n        }\n        catch (_a) { }\n        return NaN;\n    }\n    function compareArrays(a, b) {\n        var al = a.length;\n        var bl = b.length;\n        var l = al < bl ? al : bl;\n        for (var i = 0; i < l; ++i) {\n            var res = cmp(a[i], b[i]);\n            if (res !== 0)\n                return res;\n        }\n        return al === bl ? 0 : al < bl ? -1 : 1;\n    }\n    function compareUint8Arrays(a, b) {\n        var al = a.length;\n        var bl = b.length;\n        var l = al < bl ? al : bl;\n        for (var i = 0; i < l; ++i) {\n            if (a[i] !== b[i])\n                return a[i] < b[i] ? -1 : 1;\n        }\n        return al === bl ? 0 : al < bl ? -1 : 1;\n    }\n    function type(x) {\n        var t = typeof x;\n        if (t !== 'object')\n            return t;\n        if (ArrayBuffer.isView(x))\n            return 'binary';\n        var tsTag = toStringTag(x);\n        return tsTag === 'ArrayBuffer' ? 'binary' : tsTag;\n    }\n    function getUint8Array(a) {\n        if (a instanceof Uint8Array)\n            return a;\n        if (ArrayBuffer.isView(a))\n            return new Uint8Array(a.buffer, a.byteOffset, a.byteLength);\n        return new Uint8Array(a);\n    }\n\n    function builtInDeletionTrigger(table, keys, res) {\n        var yProps = table.schema.yProps;\n        if (!yProps)\n            return res;\n        if (keys && res.numFailures > 0)\n            keys = keys.filter(function (_, i) { return !res.failures[i]; });\n        return Promise.all(yProps.map(function (_a) {\n            var updatesTable = _a.updatesTable;\n            return keys\n                ? table.db.table(updatesTable).where('k').anyOf(keys).delete()\n                : table.db.table(updatesTable).clear();\n        })).then(function () { return res; });\n    }\n\n    var PropModification =  (function () {\n        function PropModification(spec) {\n            this[\"@@propmod\"] = spec;\n        }\n        PropModification.prototype.execute = function (value) {\n            var _a;\n            var spec = this[\"@@propmod\"];\n            if (spec.add !== undefined) {\n                var term = spec.add;\n                if (isArray(term)) {\n                    return __spreadArray(__spreadArray([], (isArray(value) ? value : []), true), term, true).sort();\n                }\n                if (typeof term === 'number')\n                    return (Number(value) || 0) + term;\n                if (typeof term === 'bigint') {\n                    try {\n                        return BigInt(value) + term;\n                    }\n                    catch (_b) {\n                        return BigInt(0) + term;\n                    }\n                }\n                throw new TypeError(\"Invalid term \".concat(term));\n            }\n            if (spec.remove !== undefined) {\n                var subtrahend_1 = spec.remove;\n                if (isArray(subtrahend_1)) {\n                    return isArray(value) ? value.filter(function (item) { return !subtrahend_1.includes(item); }).sort() : [];\n                }\n                if (typeof subtrahend_1 === 'number')\n                    return Number(value) - subtrahend_1;\n                if (typeof subtrahend_1 === 'bigint') {\n                    try {\n                        return BigInt(value) - subtrahend_1;\n                    }\n                    catch (_c) {\n                        return BigInt(0) - subtrahend_1;\n                    }\n                }\n                throw new TypeError(\"Invalid subtrahend \".concat(subtrahend_1));\n            }\n            var prefixToReplace = (_a = spec.replacePrefix) === null || _a === void 0 ? void 0 : _a[0];\n            if (prefixToReplace && typeof value === 'string' && value.startsWith(prefixToReplace)) {\n                return spec.replacePrefix[1] + value.substring(prefixToReplace.length);\n            }\n            return value;\n        };\n        return PropModification;\n    }());\n\n    function applyUpdateSpec(obj, changes) {\n        var keyPaths = keys(changes);\n        var numKeys = keyPaths.length;\n        var anythingModified = false;\n        for (var i = 0; i < numKeys; ++i) {\n            var keyPath = keyPaths[i];\n            var value = changes[keyPath];\n            var origValue = getByKeyPath(obj, keyPath);\n            if (value instanceof PropModification) {\n                setByKeyPath(obj, keyPath, value.execute(origValue));\n                anythingModified = true;\n            }\n            else if (origValue !== value) {\n                setByKeyPath(obj, keyPath, value);\n                anythingModified = true;\n            }\n        }\n        return anythingModified;\n    }\n\n    var Table =  (function () {\n        function Table() {\n        }\n        Table.prototype._trans = function (mode, fn, writeLocked) {\n            var trans = this._tx || PSD.trans;\n            var tableName = this.name;\n            var task = debug && typeof console !== 'undefined' && console.createTask && console.createTask(\"Dexie: \".concat(mode === 'readonly' ? 'read' : 'write', \" \").concat(this.name));\n            function checkTableInTransaction(resolve, reject, trans) {\n                if (!trans.schema[tableName])\n                    throw new exceptions.NotFound(\"Table \" + tableName + \" not part of transaction\");\n                return fn(trans.idbtrans, trans);\n            }\n            var wasRootExec = beginMicroTickScope();\n            try {\n                var p = trans && trans.db._novip === this.db._novip ?\n                    trans === PSD.trans ?\n                        trans._promise(mode, checkTableInTransaction, writeLocked) :\n                        newScope(function () { return trans._promise(mode, checkTableInTransaction, writeLocked); }, { trans: trans, transless: PSD.transless || PSD }) :\n                    tempTransaction(this.db, mode, [this.name], checkTableInTransaction);\n                if (task) {\n                    p._consoleTask = task;\n                    p = p.catch(function (err) {\n                        console.trace(err);\n                        return rejection(err);\n                    });\n                }\n                return p;\n            }\n            finally {\n                if (wasRootExec)\n                    endMicroTickScope();\n            }\n        };\n        Table.prototype.get = function (keyOrCrit, cb) {\n            var _this = this;\n            if (keyOrCrit && keyOrCrit.constructor === Object)\n                return this.where(keyOrCrit).first(cb);\n            if (keyOrCrit == null)\n                return rejection(new exceptions.Type(\"Invalid argument to Table.get()\"));\n            return this._trans('readonly', function (trans) {\n                return _this.core.get({ trans: trans, key: keyOrCrit })\n                    .then(function (res) { return _this.hook.reading.fire(res); });\n            }).then(cb);\n        };\n        Table.prototype.where = function (indexOrCrit) {\n            if (typeof indexOrCrit === 'string')\n                return new this.db.WhereClause(this, indexOrCrit);\n            if (isArray(indexOrCrit))\n                return new this.db.WhereClause(this, \"[\".concat(indexOrCrit.join('+'), \"]\"));\n            var keyPaths = keys(indexOrCrit);\n            if (keyPaths.length === 1)\n                return this\n                    .where(keyPaths[0])\n                    .equals(indexOrCrit[keyPaths[0]]);\n            var compoundIndex = this.schema.indexes.concat(this.schema.primKey).filter(function (ix) {\n                if (ix.compound &&\n                    keyPaths.every(function (keyPath) { return ix.keyPath.indexOf(keyPath) >= 0; })) {\n                    for (var i = 0; i < keyPaths.length; ++i) {\n                        if (keyPaths.indexOf(ix.keyPath[i]) === -1)\n                            return false;\n                    }\n                    return true;\n                }\n                return false;\n            }).sort(function (a, b) { return a.keyPath.length - b.keyPath.length; })[0];\n            if (compoundIndex && this.db._maxKey !== maxString) {\n                var keyPathsInValidOrder = compoundIndex.keyPath.slice(0, keyPaths.length);\n                return this\n                    .where(keyPathsInValidOrder)\n                    .equals(keyPathsInValidOrder.map(function (kp) { return indexOrCrit[kp]; }));\n            }\n            if (!compoundIndex && debug)\n                console.warn(\"The query \".concat(JSON.stringify(indexOrCrit), \" on \").concat(this.name, \" would benefit from a \") +\n                    \"compound index [\".concat(keyPaths.join('+'), \"]\"));\n            var idxByName = this.schema.idxByName;\n            function equals(a, b) {\n                return cmp(a, b) === 0;\n            }\n            var _a = keyPaths.reduce(function (_a, keyPath) {\n                var prevIndex = _a[0], prevFilterFn = _a[1];\n                var index = idxByName[keyPath];\n                var value = indexOrCrit[keyPath];\n                return [\n                    prevIndex || index,\n                    prevIndex || !index ?\n                        combine(prevFilterFn, index && index.multi ?\n                            function (x) {\n                                var prop = getByKeyPath(x, keyPath);\n                                return isArray(prop) && prop.some(function (item) { return equals(value, item); });\n                            } : function (x) { return equals(value, getByKeyPath(x, keyPath)); })\n                        : prevFilterFn\n                ];\n            }, [null, null]), idx = _a[0], filterFunction = _a[1];\n            return idx ?\n                this.where(idx.name).equals(indexOrCrit[idx.keyPath])\n                    .filter(filterFunction) :\n                compoundIndex ?\n                    this.filter(filterFunction) :\n                    this.where(keyPaths).equals('');\n        };\n        Table.prototype.filter = function (filterFunction) {\n            return this.toCollection().and(filterFunction);\n        };\n        Table.prototype.count = function (thenShortcut) {\n            return this.toCollection().count(thenShortcut);\n        };\n        Table.prototype.offset = function (offset) {\n            return this.toCollection().offset(offset);\n        };\n        Table.prototype.limit = function (numRows) {\n            return this.toCollection().limit(numRows);\n        };\n        Table.prototype.each = function (callback) {\n            return this.toCollection().each(callback);\n        };\n        Table.prototype.toArray = function (thenShortcut) {\n            return this.toCollection().toArray(thenShortcut);\n        };\n        Table.prototype.toCollection = function () {\n            return new this.db.Collection(new this.db.WhereClause(this));\n        };\n        Table.prototype.orderBy = function (index) {\n            return new this.db.Collection(new this.db.WhereClause(this, isArray(index) ?\n                \"[\".concat(index.join('+'), \"]\") :\n                index));\n        };\n        Table.prototype.reverse = function () {\n            return this.toCollection().reverse();\n        };\n        Table.prototype.mapToClass = function (constructor) {\n            var _a = this, db = _a.db, tableName = _a.name;\n            this.schema.mappedClass = constructor;\n            if (constructor.prototype instanceof Entity) {\n                constructor =  (function (_super) {\n                    __extends(class_1, _super);\n                    function class_1() {\n                        return _super !== null && _super.apply(this, arguments) || this;\n                    }\n                    Object.defineProperty(class_1.prototype, \"db\", {\n                        get: function () { return db; },\n                        enumerable: false,\n                        configurable: true\n                    });\n                    class_1.prototype.table = function () { return tableName; };\n                    return class_1;\n                }(constructor));\n            }\n            var inheritedProps = new Set();\n            for (var proto = constructor.prototype; proto; proto = getProto(proto)) {\n                Object.getOwnPropertyNames(proto).forEach(function (propName) { return inheritedProps.add(propName); });\n            }\n            var readHook = function (obj) {\n                if (!obj)\n                    return obj;\n                var res = Object.create(constructor.prototype);\n                for (var m in obj)\n                    if (!inheritedProps.has(m))\n                        try {\n                            res[m] = obj[m];\n                        }\n                        catch (_) { }\n                return res;\n            };\n            if (this.schema.readHook) {\n                this.hook.reading.unsubscribe(this.schema.readHook);\n            }\n            this.schema.readHook = readHook;\n            this.hook(\"reading\", readHook);\n            return constructor;\n        };\n        Table.prototype.defineClass = function () {\n            function Class(content) {\n                extend(this, content);\n            }\n            return this.mapToClass(Class);\n        };\n        Table.prototype.add = function (obj, key) {\n            var _this = this;\n            var _a = this.schema.primKey, auto = _a.auto, keyPath = _a.keyPath;\n            var objToAdd = obj;\n            if (keyPath && auto) {\n                objToAdd = workaroundForUndefinedPrimKey(keyPath)(obj);\n            }\n            return this._trans('readwrite', function (trans) {\n                return _this.core.mutate({ trans: trans, type: 'add', keys: key != null ? [key] : null, values: [objToAdd] });\n            }).then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : res.lastResult; })\n                .then(function (lastResult) {\n                if (keyPath) {\n                    try {\n                        setByKeyPath(obj, keyPath, lastResult);\n                    }\n                    catch (_) { }\n                }\n                return lastResult;\n            });\n        };\n        Table.prototype.upsert = function (key, modifications) {\n            var _this = this;\n            var keyPath = this.schema.primKey.keyPath;\n            return this._trans('readwrite', function (trans) {\n                return _this.core.get({ trans: trans, key: key }).then(function (existing) {\n                    var obj = existing !== null && existing !== void 0 ? existing : {};\n                    applyUpdateSpec(obj, modifications);\n                    if (keyPath)\n                        setByKeyPath(obj, keyPath, key);\n                    return _this.core.mutate({\n                        trans: trans,\n                        type: 'put',\n                        values: [obj],\n                        keys: [key],\n                        upsert: true,\n                        updates: { keys: [key], changeSpecs: [modifications] }\n                    }).then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : !!existing; });\n                });\n            });\n        };\n        Table.prototype.update = function (keyOrObject, modifications) {\n            if (typeof keyOrObject === 'object' && !isArray(keyOrObject)) {\n                var key = getByKeyPath(keyOrObject, this.schema.primKey.keyPath);\n                if (key === undefined)\n                    return rejection(new exceptions.InvalidArgument(\"Given object does not contain its primary key\"));\n                return this.where(\":id\").equals(key).modify(modifications);\n            }\n            else {\n                return this.where(\":id\").equals(keyOrObject).modify(modifications);\n            }\n        };\n        Table.prototype.put = function (obj, key) {\n            var _this = this;\n            var _a = this.schema.primKey, auto = _a.auto, keyPath = _a.keyPath;\n            var objToAdd = obj;\n            if (keyPath && auto) {\n                objToAdd = workaroundForUndefinedPrimKey(keyPath)(obj);\n            }\n            return this._trans('readwrite', function (trans) { return _this.core.mutate({ trans: trans, type: 'put', values: [objToAdd], keys: key != null ? [key] : null }); })\n                .then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : res.lastResult; })\n                .then(function (lastResult) {\n                if (keyPath) {\n                    try {\n                        setByKeyPath(obj, keyPath, lastResult);\n                    }\n                    catch (_) { }\n                }\n                return lastResult;\n            });\n        };\n        Table.prototype.delete = function (key) {\n            var _this = this;\n            return this._trans('readwrite', function (trans) { return _this.core.mutate({ trans: trans, type: 'delete', keys: [key] })\n                .then(function (res) { return builtInDeletionTrigger(_this, [key], res); })\n                .then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : undefined; }); });\n        };\n        Table.prototype.clear = function () {\n            var _this = this;\n            return this._trans('readwrite', function (trans) { return _this.core.mutate({ trans: trans, type: 'deleteRange', range: AnyRange })\n                .then(function (res) { return builtInDeletionTrigger(_this, null, res); }); })\n                .then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : undefined; });\n        };\n        Table.prototype.bulkGet = function (keys) {\n            var _this = this;\n            return this._trans('readonly', function (trans) {\n                return _this.core.getMany({\n                    keys: keys,\n                    trans: trans\n                }).then(function (result) { return result.map(function (res) { return _this.hook.reading.fire(res); }); });\n            });\n        };\n        Table.prototype.bulkAdd = function (objects, keysOrOptions, options) {\n            var _this = this;\n            var keys = Array.isArray(keysOrOptions) ? keysOrOptions : undefined;\n            options = options || (keys ? undefined : keysOrOptions);\n            var wantResults = options ? options.allKeys : undefined;\n            return this._trans('readwrite', function (trans) {\n                var _a = _this.schema.primKey, auto = _a.auto, keyPath = _a.keyPath;\n                if (keyPath && keys)\n                    throw new exceptions.InvalidArgument(\"bulkAdd(): keys argument invalid on tables with inbound keys\");\n                if (keys && keys.length !== objects.length)\n                    throw new exceptions.InvalidArgument(\"Arguments objects and keys must have the same length\");\n                var numObjects = objects.length;\n                var objectsToAdd = keyPath && auto ?\n                    objects.map(workaroundForUndefinedPrimKey(keyPath)) :\n                    objects;\n                return _this.core.mutate({ trans: trans, type: 'add', keys: keys, values: objectsToAdd, wantResults: wantResults })\n                    .then(function (_a) {\n                    var numFailures = _a.numFailures, results = _a.results, lastResult = _a.lastResult, failures = _a.failures;\n                    var result = wantResults ? results : lastResult;\n                    if (numFailures === 0)\n                        return result;\n                    throw new BulkError(\"\".concat(_this.name, \".bulkAdd(): \").concat(numFailures, \" of \").concat(numObjects, \" operations failed\"), failures);\n                });\n            });\n        };\n        Table.prototype.bulkPut = function (objects, keysOrOptions, options) {\n            var _this = this;\n            var keys = Array.isArray(keysOrOptions) ? keysOrOptions : undefined;\n            options = options || (keys ? undefined : keysOrOptions);\n            var wantResults = options ? options.allKeys : undefined;\n            return this._trans('readwrite', function (trans) {\n                var _a = _this.schema.primKey, auto = _a.auto, keyPath = _a.keyPath;\n                if (keyPath && keys)\n                    throw new exceptions.InvalidArgument(\"bulkPut(): keys argument invalid on tables with inbound keys\");\n                if (keys && keys.length !== objects.length)\n                    throw new exceptions.InvalidArgument(\"Arguments objects and keys must have the same length\");\n                var numObjects = objects.length;\n                var objectsToPut = keyPath && auto ?\n                    objects.map(workaroundForUndefinedPrimKey(keyPath)) :\n                    objects;\n                return _this.core.mutate({ trans: trans, type: 'put', keys: keys, values: objectsToPut, wantResults: wantResults })\n                    .then(function (_a) {\n                    var numFailures = _a.numFailures, results = _a.results, lastResult = _a.lastResult, failures = _a.failures;\n                    var result = wantResults ? results : lastResult;\n                    if (numFailures === 0)\n                        return result;\n                    throw new BulkError(\"\".concat(_this.name, \".bulkPut(): \").concat(numFailures, \" of \").concat(numObjects, \" operations failed\"), failures);\n                });\n            });\n        };\n        Table.prototype.bulkUpdate = function (keysAndChanges) {\n            var _this = this;\n            var coreTable = this.core;\n            var keys = keysAndChanges.map(function (entry) { return entry.key; });\n            var changeSpecs = keysAndChanges.map(function (entry) { return entry.changes; });\n            var offsetMap = [];\n            return this._trans('readwrite', function (trans) {\n                return coreTable.getMany({ trans: trans, keys: keys, cache: 'clone' }).then(function (objs) {\n                    var resultKeys = [];\n                    var resultObjs = [];\n                    keysAndChanges.forEach(function (_a, idx) {\n                        var key = _a.key, changes = _a.changes;\n                        var obj = objs[idx];\n                        if (obj) {\n                            for (var _i = 0, _b = Object.keys(changes); _i < _b.length; _i++) {\n                                var keyPath = _b[_i];\n                                var value = changes[keyPath];\n                                if (keyPath === _this.schema.primKey.keyPath) {\n                                    if (cmp(value, key) !== 0) {\n                                        throw new exceptions.Constraint(\"Cannot update primary key in bulkUpdate()\");\n                                    }\n                                }\n                                else {\n                                    setByKeyPath(obj, keyPath, value);\n                                }\n                            }\n                            offsetMap.push(idx);\n                            resultKeys.push(key);\n                            resultObjs.push(obj);\n                        }\n                    });\n                    var numEntries = resultKeys.length;\n                    return coreTable\n                        .mutate({\n                        trans: trans,\n                        type: 'put',\n                        keys: resultKeys,\n                        values: resultObjs,\n                        updates: {\n                            keys: keys,\n                            changeSpecs: changeSpecs\n                        }\n                    })\n                        .then(function (_a) {\n                        var numFailures = _a.numFailures, failures = _a.failures;\n                        if (numFailures === 0)\n                            return numEntries;\n                        for (var _i = 0, _b = Object.keys(failures); _i < _b.length; _i++) {\n                            var offset = _b[_i];\n                            var mappedOffset = offsetMap[Number(offset)];\n                            if (mappedOffset != null) {\n                                var failure = failures[offset];\n                                delete failures[offset];\n                                failures[mappedOffset] = failure;\n                            }\n                        }\n                        throw new BulkError(\"\".concat(_this.name, \".bulkUpdate(): \").concat(numFailures, \" of \").concat(numEntries, \" operations failed\"), failures);\n                    });\n                });\n            });\n        };\n        Table.prototype.bulkDelete = function (keys) {\n            var _this = this;\n            var numKeys = keys.length;\n            return this._trans('readwrite', function (trans) {\n                return _this.core.mutate({ trans: trans, type: 'delete', keys: keys })\n                    .then(function (res) { return builtInDeletionTrigger(_this, keys, res); });\n            }).then(function (_a) {\n                var numFailures = _a.numFailures, lastResult = _a.lastResult, failures = _a.failures;\n                if (numFailures === 0)\n                    return lastResult;\n                throw new BulkError(\"\".concat(_this.name, \".bulkDelete(): \").concat(numFailures, \" of \").concat(numKeys, \" operations failed\"), failures);\n            });\n        };\n        return Table;\n    }());\n\n    function Events(ctx) {\n        var evs = {};\n        var rv = function (eventName, subscriber) {\n            if (subscriber) {\n                var i = arguments.length, args = new Array(i - 1);\n                while (--i)\n                    args[i - 1] = arguments[i];\n                evs[eventName].subscribe.apply(null, args);\n                return ctx;\n            }\n            else if (typeof (eventName) === 'string') {\n                return evs[eventName];\n            }\n        };\n        rv.addEventType = add;\n        for (var i = 1, l = arguments.length; i < l; ++i) {\n            add(arguments[i]);\n        }\n        return rv;\n        function add(eventName, chainFunction, defaultFunction) {\n            if (typeof eventName === 'object')\n                return addConfiguredEvents(eventName);\n            if (!chainFunction)\n                chainFunction = reverseStoppableEventChain;\n            if (!defaultFunction)\n                defaultFunction = nop;\n            var context = {\n                subscribers: [],\n                fire: defaultFunction,\n                subscribe: function (cb) {\n                    if (context.subscribers.indexOf(cb) === -1) {\n                        context.subscribers.push(cb);\n                        context.fire = chainFunction(context.fire, cb);\n                    }\n                },\n                unsubscribe: function (cb) {\n                    context.subscribers = context.subscribers.filter(function (fn) { return fn !== cb; });\n                    context.fire = context.subscribers.reduce(chainFunction, defaultFunction);\n                }\n            };\n            evs[eventName] = rv[eventName] = context;\n            return context;\n        }\n        function addConfiguredEvents(cfg) {\n            keys(cfg).forEach(function (eventName) {\n                var args = cfg[eventName];\n                if (isArray(args)) {\n                    add(eventName, cfg[eventName][0], cfg[eventName][1]);\n                }\n                else if (args === 'asap') {\n                    var context = add(eventName, mirror, function fire() {\n                        var i = arguments.length, args = new Array(i);\n                        while (i--)\n                            args[i] = arguments[i];\n                        context.subscribers.forEach(function (fn) {\n                            asap$1(function fireEvent() {\n                                fn.apply(null, args);\n                            });\n                        });\n                    });\n                }\n                else\n                    throw new exceptions.InvalidArgument(\"Invalid event config\");\n            });\n        }\n    }\n\n    function makeClassConstructor(prototype, constructor) {\n        derive(constructor).from({ prototype: prototype });\n        return constructor;\n    }\n\n    function createTableConstructor(db) {\n        return makeClassConstructor(Table.prototype, function Table(name, tableSchema, trans) {\n            this.db = db;\n            this._tx = trans;\n            this.name = name;\n            this.schema = tableSchema;\n            this.hook = db._allTables[name] ? db._allTables[name].hook : Events(null, {\n                \"creating\": [hookCreatingChain, nop],\n                \"reading\": [pureFunctionChain, mirror],\n                \"updating\": [hookUpdatingChain, nop],\n                \"deleting\": [hookDeletingChain, nop]\n            });\n        });\n    }\n\n    function isPlainKeyRange(ctx, ignoreLimitFilter) {\n        return !(ctx.filter || ctx.algorithm || ctx.or) &&\n            (ignoreLimitFilter ? ctx.justLimit : !ctx.replayFilter);\n    }\n    function addFilter(ctx, fn) {\n        ctx.filter = combine(ctx.filter, fn);\n    }\n    function addReplayFilter(ctx, factory, isLimitFilter) {\n        var curr = ctx.replayFilter;\n        ctx.replayFilter = curr ? function () { return combine(curr(), factory()); } : factory;\n        ctx.justLimit = isLimitFilter && !curr;\n    }\n    function addMatchFilter(ctx, fn) {\n        ctx.isMatch = combine(ctx.isMatch, fn);\n    }\n    function getIndexOrStore(ctx, coreSchema) {\n        if (ctx.isPrimKey)\n            return coreSchema.primaryKey;\n        var index = coreSchema.getIndexByKeyPath(ctx.index);\n        if (!index)\n            throw new exceptions.Schema(\"KeyPath \" + ctx.index + \" on object store \" + coreSchema.name + \" is not indexed\");\n        return index;\n    }\n    function openCursor(ctx, coreTable, trans) {\n        var index = getIndexOrStore(ctx, coreTable.schema);\n        return coreTable.openCursor({\n            trans: trans,\n            values: !ctx.keysOnly,\n            reverse: ctx.dir === 'prev',\n            unique: !!ctx.unique,\n            query: {\n                index: index,\n                range: ctx.range\n            }\n        });\n    }\n    function iter(ctx, fn, coreTrans, coreTable) {\n        var filter = ctx.replayFilter ? combine(ctx.filter, ctx.replayFilter()) : ctx.filter;\n        if (!ctx.or) {\n            return iterate(openCursor(ctx, coreTable, coreTrans), combine(ctx.algorithm, filter), fn, !ctx.keysOnly && ctx.valueMapper);\n        }\n        else {\n            var set_1 = {};\n            var union = function (item, cursor, advance) {\n                if (!filter || filter(cursor, advance, function (result) { return cursor.stop(result); }, function (err) { return cursor.fail(err); })) {\n                    var primaryKey = cursor.primaryKey;\n                    var key = '' + primaryKey;\n                    if (key === '[object ArrayBuffer]')\n                        key = '' + new Uint8Array(primaryKey);\n                    if (!hasOwn(set_1, key)) {\n                        set_1[key] = true;\n                        fn(item, cursor, advance);\n                    }\n                }\n            };\n            return Promise.all([\n                ctx.or._iterate(union, coreTrans),\n                iterate(openCursor(ctx, coreTable, coreTrans), ctx.algorithm, union, !ctx.keysOnly && ctx.valueMapper)\n            ]);\n        }\n    }\n    function iterate(cursorPromise, filter, fn, valueMapper) {\n        var mappedFn = valueMapper ? function (x, c, a) { return fn(valueMapper(x), c, a); } : fn;\n        var wrappedFn = wrap(mappedFn);\n        return cursorPromise.then(function (cursor) {\n            if (cursor) {\n                return cursor.start(function () {\n                    var c = function () { return cursor.continue(); };\n                    if (!filter || filter(cursor, function (advancer) { return c = advancer; }, function (val) { cursor.stop(val); c = nop; }, function (e) { cursor.fail(e); c = nop; }))\n                        wrappedFn(cursor.value, cursor, function (advancer) { return c = advancer; });\n                    c();\n                });\n            }\n        });\n    }\n\n    var Collection =  (function () {\n        function Collection() {\n        }\n        Collection.prototype._read = function (fn, cb) {\n            var ctx = this._ctx;\n            return ctx.error ?\n                ctx.table._trans(null, rejection.bind(null, ctx.error)) :\n                ctx.table._trans('readonly', fn).then(cb);\n        };\n        Collection.prototype._write = function (fn) {\n            var ctx = this._ctx;\n            return ctx.error ?\n                ctx.table._trans(null, rejection.bind(null, ctx.error)) :\n                ctx.table._trans('readwrite', fn, \"locked\");\n        };\n        Collection.prototype._addAlgorithm = function (fn) {\n            var ctx = this._ctx;\n            ctx.algorithm = combine(ctx.algorithm, fn);\n        };\n        Collection.prototype._iterate = function (fn, coreTrans) {\n            return iter(this._ctx, fn, coreTrans, this._ctx.table.core);\n        };\n        Collection.prototype.clone = function (props) {\n            var rv = Object.create(this.constructor.prototype), ctx = Object.create(this._ctx);\n            if (props)\n                extend(ctx, props);\n            rv._ctx = ctx;\n            return rv;\n        };\n        Collection.prototype.raw = function () {\n            this._ctx.valueMapper = null;\n            return this;\n        };\n        Collection.prototype.each = function (fn) {\n            var ctx = this._ctx;\n            return this._read(function (trans) { return iter(ctx, fn, trans, ctx.table.core); });\n        };\n        Collection.prototype.count = function (cb) {\n            var _this = this;\n            return this._read(function (trans) {\n                var ctx = _this._ctx;\n                var coreTable = ctx.table.core;\n                if (isPlainKeyRange(ctx, true)) {\n                    return coreTable.count({\n                        trans: trans,\n                        query: {\n                            index: getIndexOrStore(ctx, coreTable.schema),\n                            range: ctx.range\n                        }\n                    }).then(function (count) { return Math.min(count, ctx.limit); });\n                }\n                else {\n                    var count = 0;\n                    return iter(ctx, function () { ++count; return false; }, trans, coreTable)\n                        .then(function () { return count; });\n                }\n            }).then(cb);\n        };\n        Collection.prototype.sortBy = function (keyPath, cb) {\n            var parts = keyPath.split('.').reverse(), lastPart = parts[0], lastIndex = parts.length - 1;\n            function getval(obj, i) {\n                if (i)\n                    return getval(obj[parts[i]], i - 1);\n                return obj[lastPart];\n            }\n            var order = this._ctx.dir === \"next\" ? 1 : -1;\n            function sorter(a, b) {\n                var aVal = getval(a, lastIndex), bVal = getval(b, lastIndex);\n                return cmp(aVal, bVal) * order;\n            }\n            return this.toArray(function (a) {\n                return a.sort(sorter);\n            }).then(cb);\n        };\n        Collection.prototype.toArray = function (cb) {\n            var _this = this;\n            return this._read(function (trans) {\n                var ctx = _this._ctx;\n                if (ctx.dir === 'next' && isPlainKeyRange(ctx, true) && ctx.limit > 0) {\n                    var valueMapper_1 = ctx.valueMapper;\n                    var index = getIndexOrStore(ctx, ctx.table.core.schema);\n                    return ctx.table.core.query({\n                        trans: trans,\n                        limit: ctx.limit,\n                        values: true,\n                        query: {\n                            index: index,\n                            range: ctx.range\n                        }\n                    }).then(function (_a) {\n                        var result = _a.result;\n                        return valueMapper_1 ? result.map(valueMapper_1) : result;\n                    });\n                }\n                else {\n                    var a_1 = [];\n                    return iter(ctx, function (item) { return a_1.push(item); }, trans, ctx.table.core).then(function () { return a_1; });\n                }\n            }, cb);\n        };\n        Collection.prototype.offset = function (offset) {\n            var ctx = this._ctx;\n            if (offset <= 0)\n                return this;\n            ctx.offset += offset;\n            if (isPlainKeyRange(ctx)) {\n                addReplayFilter(ctx, function () {\n                    var offsetLeft = offset;\n                    return function (cursor, advance) {\n                        if (offsetLeft === 0)\n                            return true;\n                        if (offsetLeft === 1) {\n                            --offsetLeft;\n                            return false;\n                        }\n                        advance(function () {\n                            cursor.advance(offsetLeft);\n                            offsetLeft = 0;\n                        });\n                        return false;\n                    };\n                });\n            }\n            else {\n                addReplayFilter(ctx, function () {\n                    var offsetLeft = offset;\n                    return function () { return (--offsetLeft < 0); };\n                });\n            }\n            return this;\n        };\n        Collection.prototype.limit = function (numRows) {\n            this._ctx.limit = Math.min(this._ctx.limit, numRows);\n            addReplayFilter(this._ctx, function () {\n                var rowsLeft = numRows;\n                return function (cursor, advance, resolve) {\n                    if (--rowsLeft <= 0)\n                        advance(resolve);\n                    return rowsLeft >= 0;\n                };\n            }, true);\n            return this;\n        };\n        Collection.prototype.until = function (filterFunction, bIncludeStopEntry) {\n            addFilter(this._ctx, function (cursor, advance, resolve) {\n                if (filterFunction(cursor.value)) {\n                    advance(resolve);\n                    return bIncludeStopEntry;\n                }\n                else {\n                    return true;\n                }\n            });\n            return this;\n        };\n        Collection.prototype.first = function (cb) {\n            return this.limit(1).toArray(function (a) { return a[0]; }).then(cb);\n        };\n        Collection.prototype.last = function (cb) {\n            return this.reverse().first(cb);\n        };\n        Collection.prototype.filter = function (filterFunction) {\n            addFilter(this._ctx, function (cursor) {\n                return filterFunction(cursor.value);\n            });\n            addMatchFilter(this._ctx, filterFunction);\n            return this;\n        };\n        Collection.prototype.and = function (filter) {\n            return this.filter(filter);\n        };\n        Collection.prototype.or = function (indexName) {\n            return new this.db.WhereClause(this._ctx.table, indexName, this);\n        };\n        Collection.prototype.reverse = function () {\n            this._ctx.dir = (this._ctx.dir === \"prev\" ? \"next\" : \"prev\");\n            if (this._ondirectionchange)\n                this._ondirectionchange(this._ctx.dir);\n            return this;\n        };\n        Collection.prototype.desc = function () {\n            return this.reverse();\n        };\n        Collection.prototype.eachKey = function (cb) {\n            var ctx = this._ctx;\n            ctx.keysOnly = !ctx.isMatch;\n            return this.each(function (val, cursor) { cb(cursor.key, cursor); });\n        };\n        Collection.prototype.eachUniqueKey = function (cb) {\n            this._ctx.unique = \"unique\";\n            return this.eachKey(cb);\n        };\n        Collection.prototype.eachPrimaryKey = function (cb) {\n            var ctx = this._ctx;\n            ctx.keysOnly = !ctx.isMatch;\n            return this.each(function (val, cursor) { cb(cursor.primaryKey, cursor); });\n        };\n        Collection.prototype.keys = function (cb) {\n            var ctx = this._ctx;\n            ctx.keysOnly = !ctx.isMatch;\n            var a = [];\n            return this.each(function (item, cursor) {\n                a.push(cursor.key);\n            }).then(function () {\n                return a;\n            }).then(cb);\n        };\n        Collection.prototype.primaryKeys = function (cb) {\n            var ctx = this._ctx;\n            if (ctx.dir === 'next' && isPlainKeyRange(ctx, true) && ctx.limit > 0) {\n                return this._read(function (trans) {\n                    var index = getIndexOrStore(ctx, ctx.table.core.schema);\n                    return ctx.table.core.query({\n                        trans: trans,\n                        values: false,\n                        limit: ctx.limit,\n                        query: {\n                            index: index,\n                            range: ctx.range\n                        }\n                    });\n                }).then(function (_a) {\n                    var result = _a.result;\n                    return result;\n                }).then(cb);\n            }\n            ctx.keysOnly = !ctx.isMatch;\n            var a = [];\n            return this.each(function (item, cursor) {\n                a.push(cursor.primaryKey);\n            }).then(function () {\n                return a;\n            }).then(cb);\n        };\n        Collection.prototype.uniqueKeys = function (cb) {\n            this._ctx.unique = \"unique\";\n            return this.keys(cb);\n        };\n        Collection.prototype.firstKey = function (cb) {\n            return this.limit(1).keys(function (a) { return a[0]; }).then(cb);\n        };\n        Collection.prototype.lastKey = function (cb) {\n            return this.reverse().firstKey(cb);\n        };\n        Collection.prototype.distinct = function () {\n            var ctx = this._ctx, idx = ctx.index && ctx.table.schema.idxByName[ctx.index];\n            if (!idx || !idx.multi)\n                return this;\n            var set = {};\n            addFilter(this._ctx, function (cursor) {\n                var strKey = cursor.primaryKey.toString();\n                var found = hasOwn(set, strKey);\n                set[strKey] = true;\n                return !found;\n            });\n            return this;\n        };\n        Collection.prototype.modify = function (changes) {\n            var _this = this;\n            var ctx = this._ctx;\n            return this._write(function (trans) {\n                var modifyer;\n                if (typeof changes === 'function') {\n                    modifyer = changes;\n                }\n                else {\n                    modifyer = function (item) { return applyUpdateSpec(item, changes); };\n                }\n                var coreTable = ctx.table.core;\n                var _a = coreTable.schema.primaryKey, outbound = _a.outbound, extractKey = _a.extractKey;\n                var limit = 200;\n                var modifyChunkSize = _this.db._options.modifyChunkSize;\n                if (modifyChunkSize) {\n                    if (typeof modifyChunkSize == 'object') {\n                        limit = modifyChunkSize[coreTable.name] || modifyChunkSize['*'] || 200;\n                    }\n                    else {\n                        limit = modifyChunkSize;\n                    }\n                }\n                var totalFailures = [];\n                var successCount = 0;\n                var failedKeys = [];\n                var applyMutateResult = function (expectedCount, res) {\n                    var failures = res.failures, numFailures = res.numFailures;\n                    successCount += expectedCount - numFailures;\n                    for (var _i = 0, _a = keys(failures); _i < _a.length; _i++) {\n                        var pos = _a[_i];\n                        totalFailures.push(failures[pos]);\n                    }\n                };\n                var isUnconditionalDelete = changes === deleteCallback;\n                return _this.clone().primaryKeys().then(function (keys) {\n                    var criteria = isPlainKeyRange(ctx) &&\n                        ctx.limit === Infinity &&\n                        (typeof changes !== 'function' || isUnconditionalDelete) && {\n                        index: ctx.index,\n                        range: ctx.range\n                    };\n                    var nextChunk = function (offset) {\n                        var count = Math.min(limit, keys.length - offset);\n                        var keysInChunk = keys.slice(offset, offset + count);\n                        return (isUnconditionalDelete ? Promise.resolve([]) : coreTable.getMany({\n                            trans: trans,\n                            keys: keysInChunk,\n                            cache: \"immutable\"\n                        })).then(function (values) {\n                            var addValues = [];\n                            var putValues = [];\n                            var putKeys = outbound ? [] : null;\n                            var deleteKeys = isUnconditionalDelete ? keysInChunk : [];\n                            if (!isUnconditionalDelete)\n                                for (var i = 0; i < count; ++i) {\n                                    var origValue = values[i];\n                                    var ctx_1 = {\n                                        value: deepClone(origValue),\n                                        primKey: keys[offset + i]\n                                    };\n                                    if (modifyer.call(ctx_1, ctx_1.value, ctx_1) !== false) {\n                                        if (ctx_1.value == null) {\n                                            deleteKeys.push(keys[offset + i]);\n                                        }\n                                        else if (!outbound && cmp(extractKey(origValue), extractKey(ctx_1.value)) !== 0) {\n                                            deleteKeys.push(keys[offset + i]);\n                                            addValues.push(ctx_1.value);\n                                        }\n                                        else {\n                                            putValues.push(ctx_1.value);\n                                            if (outbound)\n                                                putKeys.push(keys[offset + i]);\n                                        }\n                                    }\n                                }\n                            return Promise.resolve(addValues.length > 0 &&\n                                coreTable.mutate({ trans: trans, type: 'add', values: addValues })\n                                    .then(function (res) {\n                                    for (var pos in res.failures) {\n                                        deleteKeys.splice(parseInt(pos), 1);\n                                    }\n                                    applyMutateResult(addValues.length, res);\n                                })).then(function () { return (putValues.length > 0 || (criteria && typeof changes === 'object')) &&\n                                coreTable.mutate({\n                                    trans: trans,\n                                    type: 'put',\n                                    keys: putKeys,\n                                    values: putValues,\n                                    criteria: criteria,\n                                    changeSpec: typeof changes !== 'function'\n                                        && changes,\n                                    isAdditionalChunk: offset > 0\n                                }).then(function (res) { return applyMutateResult(putValues.length, res); }); }).then(function () { return (deleteKeys.length > 0 || (criteria && isUnconditionalDelete)) &&\n                                coreTable.mutate({\n                                    trans: trans,\n                                    type: 'delete',\n                                    keys: deleteKeys,\n                                    criteria: criteria,\n                                    isAdditionalChunk: offset > 0\n                                }).then(function (res) { return builtInDeletionTrigger(ctx.table, deleteKeys, res); })\n                                    .then(function (res) { return applyMutateResult(deleteKeys.length, res); }); }).then(function () {\n                                return keys.length > offset + count && nextChunk(offset + limit);\n                            });\n                        });\n                    };\n                    return nextChunk(0).then(function () {\n                        if (totalFailures.length > 0)\n                            throw new ModifyError(\"Error modifying one or more objects\", totalFailures, successCount, failedKeys);\n                        return keys.length;\n                    });\n                });\n            });\n        };\n        Collection.prototype.delete = function () {\n            var ctx = this._ctx, range = ctx.range;\n            if (isPlainKeyRange(ctx) &&\n                !ctx.table.schema.yProps &&\n                (ctx.isPrimKey || range.type === 3 ))\n             {\n                return this._write(function (trans) {\n                    var primaryKey = ctx.table.core.schema.primaryKey;\n                    var coreRange = range;\n                    return ctx.table.core.count({ trans: trans, query: { index: primaryKey, range: coreRange } }).then(function (count) {\n                        return ctx.table.core.mutate({ trans: trans, type: 'deleteRange', range: coreRange })\n                            .then(function (_a) {\n                            var failures = _a.failures, numFailures = _a.numFailures;\n                            if (numFailures)\n                                throw new ModifyError(\"Could not delete some values\", Object.keys(failures).map(function (pos) { return failures[pos]; }), count - numFailures);\n                            return count - numFailures;\n                        });\n                    });\n                });\n            }\n            return this.modify(deleteCallback);\n        };\n        return Collection;\n    }());\n    var deleteCallback = function (value, ctx) { return ctx.value = null; };\n\n    function createCollectionConstructor(db) {\n        return makeClassConstructor(Collection.prototype, function Collection(whereClause, keyRangeGenerator) {\n            this.db = db;\n            var keyRange = AnyRange, error = null;\n            if (keyRangeGenerator)\n                try {\n                    keyRange = keyRangeGenerator();\n                }\n                catch (ex) {\n                    error = ex;\n                }\n            var whereCtx = whereClause._ctx;\n            var table = whereCtx.table;\n            var readingHook = table.hook.reading.fire;\n            this._ctx = {\n                table: table,\n                index: whereCtx.index,\n                isPrimKey: (!whereCtx.index || (table.schema.primKey.keyPath && whereCtx.index === table.schema.primKey.name)),\n                range: keyRange,\n                keysOnly: false,\n                dir: \"next\",\n                unique: \"\",\n                algorithm: null,\n                filter: null,\n                replayFilter: null,\n                justLimit: true,\n                isMatch: null,\n                offset: 0,\n                limit: Infinity,\n                error: error,\n                or: whereCtx.or,\n                valueMapper: readingHook !== mirror ? readingHook : null\n            };\n        });\n    }\n\n    function simpleCompare(a, b) {\n        return a < b ? -1 : a === b ? 0 : 1;\n    }\n    function simpleCompareReverse(a, b) {\n        return a > b ? -1 : a === b ? 0 : 1;\n    }\n\n    function fail(collectionOrWhereClause, err, T) {\n        var collection = collectionOrWhereClause instanceof WhereClause ?\n            new collectionOrWhereClause.Collection(collectionOrWhereClause) :\n            collectionOrWhereClause;\n        collection._ctx.error = T ? new T(err) : new TypeError(err);\n        return collection;\n    }\n    function emptyCollection(whereClause) {\n        return new whereClause.Collection(whereClause, function () { return rangeEqual(\"\"); }).limit(0);\n    }\n    function upperFactory(dir) {\n        return dir === \"next\" ?\n            function (s) { return s.toUpperCase(); } :\n            function (s) { return s.toLowerCase(); };\n    }\n    function lowerFactory(dir) {\n        return dir === \"next\" ?\n            function (s) { return s.toLowerCase(); } :\n            function (s) { return s.toUpperCase(); };\n    }\n    function nextCasing(key, lowerKey, upperNeedle, lowerNeedle, cmp, dir) {\n        var length = Math.min(key.length, lowerNeedle.length);\n        var llp = -1;\n        for (var i = 0; i < length; ++i) {\n            var lwrKeyChar = lowerKey[i];\n            if (lwrKeyChar !== lowerNeedle[i]) {\n                if (cmp(key[i], upperNeedle[i]) < 0)\n                    return key.substr(0, i) + upperNeedle[i] + upperNeedle.substr(i + 1);\n                if (cmp(key[i], lowerNeedle[i]) < 0)\n                    return key.substr(0, i) + lowerNeedle[i] + upperNeedle.substr(i + 1);\n                if (llp >= 0)\n                    return key.substr(0, llp) + lowerKey[llp] + upperNeedle.substr(llp + 1);\n                return null;\n            }\n            if (cmp(key[i], lwrKeyChar) < 0)\n                llp = i;\n        }\n        if (length < lowerNeedle.length && dir === \"next\")\n            return key + upperNeedle.substr(key.length);\n        if (length < key.length && dir === \"prev\")\n            return key.substr(0, upperNeedle.length);\n        return (llp < 0 ? null : key.substr(0, llp) + lowerNeedle[llp] + upperNeedle.substr(llp + 1));\n    }\n    function addIgnoreCaseAlgorithm(whereClause, match, needles, suffix) {\n        var upper, lower, compare, upperNeedles, lowerNeedles, direction, nextKeySuffix, needlesLen = needles.length;\n        if (!needles.every(function (s) { return typeof s === 'string'; })) {\n            return fail(whereClause, STRING_EXPECTED);\n        }\n        function initDirection(dir) {\n            upper = upperFactory(dir);\n            lower = lowerFactory(dir);\n            compare = (dir === \"next\" ? simpleCompare : simpleCompareReverse);\n            var needleBounds = needles.map(function (needle) {\n                return { lower: lower(needle), upper: upper(needle) };\n            }).sort(function (a, b) {\n                return compare(a.lower, b.lower);\n            });\n            upperNeedles = needleBounds.map(function (nb) { return nb.upper; });\n            lowerNeedles = needleBounds.map(function (nb) { return nb.lower; });\n            direction = dir;\n            nextKeySuffix = (dir === \"next\" ? \"\" : suffix);\n        }\n        initDirection(\"next\");\n        var c = new whereClause.Collection(whereClause, function () { return createRange(upperNeedles[0], lowerNeedles[needlesLen - 1] + suffix); });\n        c._ondirectionchange = function (direction) {\n            initDirection(direction);\n        };\n        var firstPossibleNeedle = 0;\n        c._addAlgorithm(function (cursor, advance, resolve) {\n            var key = cursor.key;\n            if (typeof key !== 'string')\n                return false;\n            var lowerKey = lower(key);\n            if (match(lowerKey, lowerNeedles, firstPossibleNeedle)) {\n                return true;\n            }\n            else {\n                var lowestPossibleCasing = null;\n                for (var i = firstPossibleNeedle; i < needlesLen; ++i) {\n                    var casing = nextCasing(key, lowerKey, upperNeedles[i], lowerNeedles[i], compare, direction);\n                    if (casing === null && lowestPossibleCasing === null)\n                        firstPossibleNeedle = i + 1;\n                    else if (lowestPossibleCasing === null || compare(lowestPossibleCasing, casing) > 0) {\n                        lowestPossibleCasing = casing;\n                    }\n                }\n                if (lowestPossibleCasing !== null) {\n                    advance(function () { cursor.continue(lowestPossibleCasing + nextKeySuffix); });\n                }\n                else {\n                    advance(resolve);\n                }\n                return false;\n            }\n        });\n        return c;\n    }\n    function createRange(lower, upper, lowerOpen, upperOpen) {\n        return {\n            type: 2 ,\n            lower: lower,\n            upper: upper,\n            lowerOpen: lowerOpen,\n            upperOpen: upperOpen\n        };\n    }\n    function rangeEqual(value) {\n        return {\n            type: 1 ,\n            lower: value,\n            upper: value\n        };\n    }\n\n    var WhereClause =  (function () {\n        function WhereClause() {\n        }\n        Object.defineProperty(WhereClause.prototype, \"Collection\", {\n            get: function () {\n                return this._ctx.table.db.Collection;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        WhereClause.prototype.between = function (lower, upper, includeLower, includeUpper) {\n            includeLower = includeLower !== false;\n            includeUpper = includeUpper === true;\n            try {\n                if ((this._cmp(lower, upper) > 0) ||\n                    (this._cmp(lower, upper) === 0 && (includeLower || includeUpper) && !(includeLower && includeUpper)))\n                    return emptyCollection(this);\n                return new this.Collection(this, function () { return createRange(lower, upper, !includeLower, !includeUpper); });\n            }\n            catch (e) {\n                return fail(this, INVALID_KEY_ARGUMENT);\n            }\n        };\n        WhereClause.prototype.equals = function (value) {\n            if (value == null)\n                return fail(this, INVALID_KEY_ARGUMENT);\n            return new this.Collection(this, function () { return rangeEqual(value); });\n        };\n        WhereClause.prototype.above = function (value) {\n            if (value == null)\n                return fail(this, INVALID_KEY_ARGUMENT);\n            return new this.Collection(this, function () { return createRange(value, undefined, true); });\n        };\n        WhereClause.prototype.aboveOrEqual = function (value) {\n            if (value == null)\n                return fail(this, INVALID_KEY_ARGUMENT);\n            return new this.Collection(this, function () { return createRange(value, undefined, false); });\n        };\n        WhereClause.prototype.below = function (value) {\n            if (value == null)\n                return fail(this, INVALID_KEY_ARGUMENT);\n            return new this.Collection(this, function () { return createRange(undefined, value, false, true); });\n        };\n        WhereClause.prototype.belowOrEqual = function (value) {\n            if (value == null)\n                return fail(this, INVALID_KEY_ARGUMENT);\n            return new this.Collection(this, function () { return createRange(undefined, value); });\n        };\n        WhereClause.prototype.startsWith = function (str) {\n            if (typeof str !== 'string')\n                return fail(this, STRING_EXPECTED);\n            return this.between(str, str + maxString, true, true);\n        };\n        WhereClause.prototype.startsWithIgnoreCase = function (str) {\n            if (str === \"\")\n                return this.startsWith(str);\n            return addIgnoreCaseAlgorithm(this, function (x, a) { return x.indexOf(a[0]) === 0; }, [str], maxString);\n        };\n        WhereClause.prototype.equalsIgnoreCase = function (str) {\n            return addIgnoreCaseAlgorithm(this, function (x, a) { return x === a[0]; }, [str], \"\");\n        };\n        WhereClause.prototype.anyOfIgnoreCase = function () {\n            var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n            if (set.length === 0)\n                return emptyCollection(this);\n            return addIgnoreCaseAlgorithm(this, function (x, a) { return a.indexOf(x) !== -1; }, set, \"\");\n        };\n        WhereClause.prototype.startsWithAnyOfIgnoreCase = function () {\n            var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n            if (set.length === 0)\n                return emptyCollection(this);\n            return addIgnoreCaseAlgorithm(this, function (x, a) { return a.some(function (n) { return x.indexOf(n) === 0; }); }, set, maxString);\n        };\n        WhereClause.prototype.anyOf = function () {\n            var _this = this;\n            var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n            var compare = this._cmp;\n            try {\n                set.sort(compare);\n            }\n            catch (e) {\n                return fail(this, INVALID_KEY_ARGUMENT);\n            }\n            if (set.length === 0)\n                return emptyCollection(this);\n            var c = new this.Collection(this, function () { return createRange(set[0], set[set.length - 1]); });\n            c._ondirectionchange = function (direction) {\n                compare = (direction === \"next\" ?\n                    _this._ascending :\n                    _this._descending);\n                set.sort(compare);\n            };\n            var i = 0;\n            c._addAlgorithm(function (cursor, advance, resolve) {\n                var key = cursor.key;\n                while (compare(key, set[i]) > 0) {\n                    ++i;\n                    if (i === set.length) {\n                        advance(resolve);\n                        return false;\n                    }\n                }\n                if (compare(key, set[i]) === 0) {\n                    return true;\n                }\n                else {\n                    advance(function () { cursor.continue(set[i]); });\n                    return false;\n                }\n            });\n            return c;\n        };\n        WhereClause.prototype.notEqual = function (value) {\n            return this.inAnyRange([[minKey, value], [value, this.db._maxKey]], { includeLowers: false, includeUppers: false });\n        };\n        WhereClause.prototype.noneOf = function () {\n            var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n            if (set.length === 0)\n                return new this.Collection(this);\n            try {\n                set.sort(this._ascending);\n            }\n            catch (e) {\n                return fail(this, INVALID_KEY_ARGUMENT);\n            }\n            var ranges = set.reduce(function (res, val) { return res ?\n                res.concat([[res[res.length - 1][1], val]]) :\n                [[minKey, val]]; }, null);\n            ranges.push([set[set.length - 1], this.db._maxKey]);\n            return this.inAnyRange(ranges, { includeLowers: false, includeUppers: false });\n        };\n        WhereClause.prototype.inAnyRange = function (ranges, options) {\n            var _this = this;\n            var cmp = this._cmp, ascending = this._ascending, descending = this._descending, min = this._min, max = this._max;\n            if (ranges.length === 0)\n                return emptyCollection(this);\n            if (!ranges.every(function (range) {\n                return range[0] !== undefined &&\n                    range[1] !== undefined &&\n                    ascending(range[0], range[1]) <= 0;\n            })) {\n                return fail(this, \"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower\", exceptions.InvalidArgument);\n            }\n            var includeLowers = !options || options.includeLowers !== false;\n            var includeUppers = options && options.includeUppers === true;\n            function addRange(ranges, newRange) {\n                var i = 0, l = ranges.length;\n                for (; i < l; ++i) {\n                    var range = ranges[i];\n                    if (cmp(newRange[0], range[1]) < 0 && cmp(newRange[1], range[0]) > 0) {\n                        range[0] = min(range[0], newRange[0]);\n                        range[1] = max(range[1], newRange[1]);\n                        break;\n                    }\n                }\n                if (i === l)\n                    ranges.push(newRange);\n                return ranges;\n            }\n            var sortDirection = ascending;\n            function rangeSorter(a, b) { return sortDirection(a[0], b[0]); }\n            var set;\n            try {\n                set = ranges.reduce(addRange, []);\n                set.sort(rangeSorter);\n            }\n            catch (ex) {\n                return fail(this, INVALID_KEY_ARGUMENT);\n            }\n            var rangePos = 0;\n            var keyIsBeyondCurrentEntry = includeUppers ?\n                function (key) { return ascending(key, set[rangePos][1]) > 0; } :\n                function (key) { return ascending(key, set[rangePos][1]) >= 0; };\n            var keyIsBeforeCurrentEntry = includeLowers ?\n                function (key) { return descending(key, set[rangePos][0]) > 0; } :\n                function (key) { return descending(key, set[rangePos][0]) >= 0; };\n            function keyWithinCurrentRange(key) {\n                return !keyIsBeyondCurrentEntry(key) && !keyIsBeforeCurrentEntry(key);\n            }\n            var checkKey = keyIsBeyondCurrentEntry;\n            var c = new this.Collection(this, function () { return createRange(set[0][0], set[set.length - 1][1], !includeLowers, !includeUppers); });\n            c._ondirectionchange = function (direction) {\n                if (direction === \"next\") {\n                    checkKey = keyIsBeyondCurrentEntry;\n                    sortDirection = ascending;\n                }\n                else {\n                    checkKey = keyIsBeforeCurrentEntry;\n                    sortDirection = descending;\n                }\n                set.sort(rangeSorter);\n            };\n            c._addAlgorithm(function (cursor, advance, resolve) {\n                var key = cursor.key;\n                while (checkKey(key)) {\n                    ++rangePos;\n                    if (rangePos === set.length) {\n                        advance(resolve);\n                        return false;\n                    }\n                }\n                if (keyWithinCurrentRange(key)) {\n                    return true;\n                }\n                else if (_this._cmp(key, set[rangePos][1]) === 0 || _this._cmp(key, set[rangePos][0]) === 0) {\n                    return false;\n                }\n                else {\n                    advance(function () {\n                        if (sortDirection === ascending)\n                            cursor.continue(set[rangePos][0]);\n                        else\n                            cursor.continue(set[rangePos][1]);\n                    });\n                    return false;\n                }\n            });\n            return c;\n        };\n        WhereClause.prototype.startsWithAnyOf = function () {\n            var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n            if (!set.every(function (s) { return typeof s === 'string'; })) {\n                return fail(this, \"startsWithAnyOf() only works with strings\");\n            }\n            if (set.length === 0)\n                return emptyCollection(this);\n            return this.inAnyRange(set.map(function (str) { return [str, str + maxString]; }));\n        };\n        return WhereClause;\n    }());\n\n    function createWhereClauseConstructor(db) {\n        return makeClassConstructor(WhereClause.prototype, function WhereClause(table, index, orCollection) {\n            this.db = db;\n            this._ctx = {\n                table: table,\n                index: index === \":id\" ? null : index,\n                or: orCollection\n            };\n            this._cmp = this._ascending = cmp;\n            this._descending = function (a, b) { return cmp(b, a); };\n            this._max = function (a, b) { return cmp(a, b) > 0 ? a : b; };\n            this._min = function (a, b) { return cmp(a, b) < 0 ? a : b; };\n            this._IDBKeyRange = db._deps.IDBKeyRange;\n            if (!this._IDBKeyRange)\n                throw new exceptions.MissingAPI();\n        });\n    }\n\n    function eventRejectHandler(reject) {\n        return wrap(function (event) {\n            preventDefault(event);\n            reject(event.target.error);\n            return false;\n        });\n    }\n    function preventDefault(event) {\n        if (event.stopPropagation)\n            event.stopPropagation();\n        if (event.preventDefault)\n            event.preventDefault();\n    }\n\n    var DEXIE_STORAGE_MUTATED_EVENT_NAME = 'storagemutated';\n    var STORAGE_MUTATED_DOM_EVENT_NAME = 'x-storagemutated-1';\n    var globalEvents = Events(null, DEXIE_STORAGE_MUTATED_EVENT_NAME);\n\n    var Transaction =  (function () {\n        function Transaction() {\n        }\n        Transaction.prototype._lock = function () {\n            assert(!PSD.global);\n            ++this._reculock;\n            if (this._reculock === 1 && !PSD.global)\n                PSD.lockOwnerFor = this;\n            return this;\n        };\n        Transaction.prototype._unlock = function () {\n            assert(!PSD.global);\n            if (--this._reculock === 0) {\n                if (!PSD.global)\n                    PSD.lockOwnerFor = null;\n                while (this._blockedFuncs.length > 0 && !this._locked()) {\n                    var fnAndPSD = this._blockedFuncs.shift();\n                    try {\n                        usePSD(fnAndPSD[1], fnAndPSD[0]);\n                    }\n                    catch (e) { }\n                }\n            }\n            return this;\n        };\n        Transaction.prototype._locked = function () {\n            return this._reculock && PSD.lockOwnerFor !== this;\n        };\n        Transaction.prototype.create = function (idbtrans) {\n            var _this = this;\n            if (!this.mode)\n                return this;\n            var idbdb = this.db.idbdb;\n            var dbOpenError = this.db._state.dbOpenError;\n            assert(!this.idbtrans);\n            if (!idbtrans && !idbdb) {\n                switch (dbOpenError && dbOpenError.name) {\n                    case \"DatabaseClosedError\":\n                        throw new exceptions.DatabaseClosed(dbOpenError);\n                    case \"MissingAPIError\":\n                        throw new exceptions.MissingAPI(dbOpenError.message, dbOpenError);\n                    default:\n                        throw new exceptions.OpenFailed(dbOpenError);\n                }\n            }\n            if (!this.active)\n                throw new exceptions.TransactionInactive();\n            assert(this._completion._state === null);\n            idbtrans = this.idbtrans = idbtrans ||\n                (this.db.core\n                    ? this.db.core.transaction(this.storeNames, this.mode, { durability: this.chromeTransactionDurability })\n                    : idbdb.transaction(this.storeNames, this.mode, { durability: this.chromeTransactionDurability }));\n            idbtrans.onerror = wrap(function (ev) {\n                preventDefault(ev);\n                _this._reject(idbtrans.error);\n            });\n            idbtrans.onabort = wrap(function (ev) {\n                preventDefault(ev);\n                _this.active && _this._reject(new exceptions.Abort(idbtrans.error));\n                _this.active = false;\n                _this.on(\"abort\").fire(ev);\n            });\n            idbtrans.oncomplete = wrap(function () {\n                _this.active = false;\n                _this._resolve();\n                if ('mutatedParts' in idbtrans) {\n                    globalEvents.storagemutated.fire(idbtrans[\"mutatedParts\"]);\n                }\n            });\n            return this;\n        };\n        Transaction.prototype._promise = function (mode, fn, bWriteLock) {\n            var _this = this;\n            if (mode === 'readwrite' && this.mode !== 'readwrite')\n                return rejection(new exceptions.ReadOnly(\"Transaction is readonly\"));\n            if (!this.active)\n                return rejection(new exceptions.TransactionInactive());\n            if (this._locked()) {\n                return new DexiePromise(function (resolve, reject) {\n                    _this._blockedFuncs.push([function () {\n                            _this._promise(mode, fn, bWriteLock).then(resolve, reject);\n                        }, PSD]);\n                });\n            }\n            else if (bWriteLock) {\n                return newScope(function () {\n                    var p = new DexiePromise(function (resolve, reject) {\n                        _this._lock();\n                        var rv = fn(resolve, reject, _this);\n                        if (rv && rv.then)\n                            rv.then(resolve, reject);\n                    });\n                    p.finally(function () { return _this._unlock(); });\n                    p._lib = true;\n                    return p;\n                });\n            }\n            else {\n                var p = new DexiePromise(function (resolve, reject) {\n                    var rv = fn(resolve, reject, _this);\n                    if (rv && rv.then)\n                        rv.then(resolve, reject);\n                });\n                p._lib = true;\n                return p;\n            }\n        };\n        Transaction.prototype._root = function () {\n            return this.parent ? this.parent._root() : this;\n        };\n        Transaction.prototype.waitFor = function (promiseLike) {\n            var root = this._root();\n            var promise = DexiePromise.resolve(promiseLike);\n            if (root._waitingFor) {\n                root._waitingFor = root._waitingFor.then(function () { return promise; });\n            }\n            else {\n                root._waitingFor = promise;\n                root._waitingQueue = [];\n                var store = root.idbtrans.objectStore(root.storeNames[0]);\n                (function spin() {\n                    ++root._spinCount;\n                    while (root._waitingQueue.length)\n                        (root._waitingQueue.shift())();\n                    if (root._waitingFor)\n                        store.get(-Infinity).onsuccess = spin;\n                }());\n            }\n            var currentWaitPromise = root._waitingFor;\n            return new DexiePromise(function (resolve, reject) {\n                promise.then(function (res) { return root._waitingQueue.push(wrap(resolve.bind(null, res))); }, function (err) { return root._waitingQueue.push(wrap(reject.bind(null, err))); }).finally(function () {\n                    if (root._waitingFor === currentWaitPromise) {\n                        root._waitingFor = null;\n                    }\n                });\n            });\n        };\n        Transaction.prototype.abort = function () {\n            if (this.active) {\n                this.active = false;\n                if (this.idbtrans)\n                    this.idbtrans.abort();\n                this._reject(new exceptions.Abort());\n            }\n        };\n        Transaction.prototype.table = function (tableName) {\n            var memoizedTables = (this._memoizedTables || (this._memoizedTables = {}));\n            if (hasOwn(memoizedTables, tableName))\n                return memoizedTables[tableName];\n            var tableSchema = this.schema[tableName];\n            if (!tableSchema) {\n                throw new exceptions.NotFound(\"Table \" + tableName + \" not part of transaction\");\n            }\n            var transactionBoundTable = new this.db.Table(tableName, tableSchema, this);\n            transactionBoundTable.core = this.db.core.table(tableName);\n            memoizedTables[tableName] = transactionBoundTable;\n            return transactionBoundTable;\n        };\n        return Transaction;\n    }());\n\n    function createTransactionConstructor(db) {\n        return makeClassConstructor(Transaction.prototype, function Transaction(mode, storeNames, dbschema, chromeTransactionDurability, parent) {\n            var _this = this;\n            if (mode !== 'readonly')\n                storeNames.forEach(function (storeName) {\n                    var _a;\n                    var yProps = (_a = dbschema[storeName]) === null || _a === void 0 ? void 0 : _a.yProps;\n                    if (yProps)\n                        storeNames = storeNames.concat(yProps.map(function (p) { return p.updatesTable; }));\n                });\n            this.db = db;\n            this.mode = mode;\n            this.storeNames = storeNames;\n            this.schema = dbschema;\n            this.chromeTransactionDurability = chromeTransactionDurability;\n            this.idbtrans = null;\n            this.on = Events(this, \"complete\", \"error\", \"abort\");\n            this.parent = parent || null;\n            this.active = true;\n            this._reculock = 0;\n            this._blockedFuncs = [];\n            this._resolve = null;\n            this._reject = null;\n            this._waitingFor = null;\n            this._waitingQueue = null;\n            this._spinCount = 0;\n            this._completion = new DexiePromise(function (resolve, reject) {\n                _this._resolve = resolve;\n                _this._reject = reject;\n            });\n            this._completion.then(function () {\n                _this.active = false;\n                _this.on.complete.fire();\n            }, function (e) {\n                var wasActive = _this.active;\n                _this.active = false;\n                _this.on.error.fire(e);\n                _this.parent ?\n                    _this.parent._reject(e) :\n                    wasActive && _this.idbtrans && _this.idbtrans.abort();\n                return rejection(e);\n            });\n        });\n    }\n\n    function createIndexSpec(name, keyPath, unique, multi, auto, compound, isPrimKey, type) {\n        return {\n            name: name,\n            keyPath: keyPath,\n            unique: unique,\n            multi: multi,\n            auto: auto,\n            compound: compound,\n            src: (unique && !isPrimKey ? '&' : '') + (multi ? '*' : '') + (auto ? \"++\" : \"\") + nameFromKeyPath(keyPath),\n            type: type\n        };\n    }\n    function nameFromKeyPath(keyPath) {\n        return typeof keyPath === 'string' ?\n            keyPath :\n            keyPath ? ('[' + [].join.call(keyPath, '+') + ']') : \"\";\n    }\n\n    function createTableSchema(name, primKey, indexes) {\n        return {\n            name: name,\n            primKey: primKey,\n            indexes: indexes,\n            mappedClass: null,\n            idxByName: arrayToObject(indexes, function (index) { return [index.name, index]; }),\n        };\n    }\n\n    function safariMultiStoreFix(storeNames) {\n        return storeNames.length === 1 ? storeNames[0] : storeNames;\n    }\n    var getMaxKey = function (IdbKeyRange) {\n        try {\n            IdbKeyRange.only([[]]);\n            getMaxKey = function () { return [[]]; };\n            return [[]];\n        }\n        catch (e) {\n            getMaxKey = function () { return maxString; };\n            return maxString;\n        }\n    };\n\n    function getKeyExtractor(keyPath) {\n        if (keyPath == null) {\n            return function () { return undefined; };\n        }\n        else if (typeof keyPath === 'string') {\n            return getSinglePathKeyExtractor(keyPath);\n        }\n        else {\n            return function (obj) { return getByKeyPath(obj, keyPath); };\n        }\n    }\n    function getSinglePathKeyExtractor(keyPath) {\n        var split = keyPath.split('.');\n        if (split.length === 1) {\n            return function (obj) { return obj[keyPath]; };\n        }\n        else {\n            return function (obj) { return getByKeyPath(obj, keyPath); };\n        }\n    }\n\n    function arrayify(arrayLike) {\n        return [].slice.call(arrayLike);\n    }\n    var _id_counter = 0;\n    function getKeyPathAlias(keyPath) {\n        return keyPath == null ?\n            \":id\" :\n            typeof keyPath === 'string' ?\n                keyPath :\n                \"[\".concat(keyPath.join('+'), \"]\");\n    }\n    function createDBCore(db, IdbKeyRange, tmpTrans) {\n        function extractSchema(db, trans) {\n            var tables = arrayify(db.objectStoreNames);\n            return {\n                schema: {\n                    name: db.name,\n                    tables: tables.map(function (table) { return trans.objectStore(table); }).map(function (store) {\n                        var keyPath = store.keyPath, autoIncrement = store.autoIncrement;\n                        var compound = isArray(keyPath);\n                        var outbound = keyPath == null;\n                        var indexByKeyPath = {};\n                        var result = {\n                            name: store.name,\n                            primaryKey: {\n                                name: null,\n                                isPrimaryKey: true,\n                                outbound: outbound,\n                                compound: compound,\n                                keyPath: keyPath,\n                                autoIncrement: autoIncrement,\n                                unique: true,\n                                extractKey: getKeyExtractor(keyPath)\n                            },\n                            indexes: arrayify(store.indexNames).map(function (indexName) { return store.index(indexName); })\n                                .map(function (index) {\n                                var name = index.name, unique = index.unique, multiEntry = index.multiEntry, keyPath = index.keyPath;\n                                var compound = isArray(keyPath);\n                                var result = {\n                                    name: name,\n                                    compound: compound,\n                                    keyPath: keyPath,\n                                    unique: unique,\n                                    multiEntry: multiEntry,\n                                    extractKey: getKeyExtractor(keyPath)\n                                };\n                                indexByKeyPath[getKeyPathAlias(keyPath)] = result;\n                                return result;\n                            }),\n                            getIndexByKeyPath: function (keyPath) { return indexByKeyPath[getKeyPathAlias(keyPath)]; }\n                        };\n                        indexByKeyPath[\":id\"] = result.primaryKey;\n                        if (keyPath != null) {\n                            indexByKeyPath[getKeyPathAlias(keyPath)] = result.primaryKey;\n                        }\n                        return result;\n                    })\n                },\n                hasGetAll: tables.length > 0 && ('getAll' in trans.objectStore(tables[0])) &&\n                    !(typeof navigator !== 'undefined' && /Safari/.test(navigator.userAgent) &&\n                        !/(Chrome\\/|Edge\\/)/.test(navigator.userAgent) &&\n                        [].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1] < 604)\n            };\n        }\n        function makeIDBKeyRange(range) {\n            if (range.type === 3 )\n                return null;\n            if (range.type === 4 )\n                throw new Error(\"Cannot convert never type to IDBKeyRange\");\n            var lower = range.lower, upper = range.upper, lowerOpen = range.lowerOpen, upperOpen = range.upperOpen;\n            var idbRange = lower === undefined ?\n                upper === undefined ?\n                    null :\n                    IdbKeyRange.upperBound(upper, !!upperOpen) :\n                upper === undefined ?\n                    IdbKeyRange.lowerBound(lower, !!lowerOpen) :\n                    IdbKeyRange.bound(lower, upper, !!lowerOpen, !!upperOpen);\n            return idbRange;\n        }\n        function createDbCoreTable(tableSchema) {\n            var tableName = tableSchema.name;\n            function mutate(_a) {\n                var trans = _a.trans, type = _a.type, keys = _a.keys, values = _a.values, range = _a.range;\n                return new Promise(function (resolve, reject) {\n                    resolve = wrap(resolve);\n                    var store = trans.objectStore(tableName);\n                    var outbound = store.keyPath == null;\n                    var isAddOrPut = type === \"put\" || type === \"add\";\n                    if (!isAddOrPut && type !== 'delete' && type !== 'deleteRange')\n                        throw new Error(\"Invalid operation type: \" + type);\n                    var length = (keys || values || { length: 1 }).length;\n                    if (keys && values && keys.length !== values.length) {\n                        throw new Error(\"Given keys array must have same length as given values array.\");\n                    }\n                    if (length === 0)\n                        return resolve({ numFailures: 0, failures: {}, results: [], lastResult: undefined });\n                    var req;\n                    var reqs = [];\n                    var failures = [];\n                    var numFailures = 0;\n                    var errorHandler = function (event) {\n                        ++numFailures;\n                        preventDefault(event);\n                    };\n                    if (type === 'deleteRange') {\n                        if (range.type === 4 )\n                            return resolve({ numFailures: numFailures, failures: failures, results: [], lastResult: undefined });\n                        if (range.type === 3 )\n                            reqs.push(req = store.clear());\n                        else\n                            reqs.push(req = store.delete(makeIDBKeyRange(range)));\n                    }\n                    else {\n                        var _a = isAddOrPut ?\n                            outbound ?\n                                [values, keys] :\n                                [values, null] :\n                            [keys, null], args1 = _a[0], args2 = _a[1];\n                        if (isAddOrPut) {\n                            for (var i = 0; i < length; ++i) {\n                                reqs.push(req = (args2 && args2[i] !== undefined ?\n                                    store[type](args1[i], args2[i]) :\n                                    store[type](args1[i])));\n                                req.onerror = errorHandler;\n                            }\n                        }\n                        else {\n                            for (var i = 0; i < length; ++i) {\n                                reqs.push(req = store[type](args1[i]));\n                                req.onerror = errorHandler;\n                            }\n                        }\n                    }\n                    var done = function (event) {\n                        var lastResult = event.target.result;\n                        reqs.forEach(function (req, i) { return req.error != null && (failures[i] = req.error); });\n                        resolve({\n                            numFailures: numFailures,\n                            failures: failures,\n                            results: type === \"delete\" ? keys : reqs.map(function (req) { return req.result; }),\n                            lastResult: lastResult\n                        });\n                    };\n                    req.onerror = function (event) {\n                        errorHandler(event);\n                        done(event);\n                    };\n                    req.onsuccess = done;\n                });\n            }\n            function openCursor(_a) {\n                var trans = _a.trans, values = _a.values, query = _a.query, reverse = _a.reverse, unique = _a.unique;\n                return new Promise(function (resolve, reject) {\n                    resolve = wrap(resolve);\n                    var index = query.index, range = query.range;\n                    var store = trans.objectStore(tableName);\n                    var source = index.isPrimaryKey ?\n                        store :\n                        store.index(index.name);\n                    var direction = reverse ?\n                        unique ?\n                            \"prevunique\" :\n                            \"prev\" :\n                        unique ?\n                            \"nextunique\" :\n                            \"next\";\n                    var req = values || !('openKeyCursor' in source) ?\n                        source.openCursor(makeIDBKeyRange(range), direction) :\n                        source.openKeyCursor(makeIDBKeyRange(range), direction);\n                    req.onerror = eventRejectHandler(reject);\n                    req.onsuccess = wrap(function (ev) {\n                        var cursor = req.result;\n                        if (!cursor) {\n                            resolve(null);\n                            return;\n                        }\n                        cursor.___id = ++_id_counter;\n                        cursor.done = false;\n                        var _cursorContinue = cursor.continue.bind(cursor);\n                        var _cursorContinuePrimaryKey = cursor.continuePrimaryKey;\n                        if (_cursorContinuePrimaryKey)\n                            _cursorContinuePrimaryKey = _cursorContinuePrimaryKey.bind(cursor);\n                        var _cursorAdvance = cursor.advance.bind(cursor);\n                        var doThrowCursorIsNotStarted = function () { throw new Error(\"Cursor not started\"); };\n                        var doThrowCursorIsStopped = function () { throw new Error(\"Cursor not stopped\"); };\n                        cursor.trans = trans;\n                        cursor.stop = cursor.continue = cursor.continuePrimaryKey = cursor.advance = doThrowCursorIsNotStarted;\n                        cursor.fail = wrap(reject);\n                        cursor.next = function () {\n                            var _this = this;\n                            var gotOne = 1;\n                            return this.start(function () { return gotOne-- ? _this.continue() : _this.stop(); }).then(function () { return _this; });\n                        };\n                        cursor.start = function (callback) {\n                            var iterationPromise = new Promise(function (resolveIteration, rejectIteration) {\n                                resolveIteration = wrap(resolveIteration);\n                                req.onerror = eventRejectHandler(rejectIteration);\n                                cursor.fail = rejectIteration;\n                                cursor.stop = function (value) {\n                                    cursor.stop = cursor.continue = cursor.continuePrimaryKey = cursor.advance = doThrowCursorIsStopped;\n                                    resolveIteration(value);\n                                };\n                            });\n                            var guardedCallback = function () {\n                                if (req.result) {\n                                    try {\n                                        callback();\n                                    }\n                                    catch (err) {\n                                        cursor.fail(err);\n                                    }\n                                }\n                                else {\n                                    cursor.done = true;\n                                    cursor.start = function () { throw new Error(\"Cursor behind last entry\"); };\n                                    cursor.stop();\n                                }\n                            };\n                            req.onsuccess = wrap(function (ev) {\n                                req.onsuccess = guardedCallback;\n                                guardedCallback();\n                            });\n                            cursor.continue = _cursorContinue;\n                            cursor.continuePrimaryKey = _cursorContinuePrimaryKey;\n                            cursor.advance = _cursorAdvance;\n                            guardedCallback();\n                            return iterationPromise;\n                        };\n                        resolve(cursor);\n                    }, reject);\n                });\n            }\n            function query(hasGetAll) {\n                return function (request) {\n                    return new Promise(function (resolve, reject) {\n                        resolve = wrap(resolve);\n                        var trans = request.trans, values = request.values, limit = request.limit, query = request.query;\n                        var nonInfinitLimit = limit === Infinity ? undefined : limit;\n                        var index = query.index, range = query.range;\n                        var store = trans.objectStore(tableName);\n                        var source = index.isPrimaryKey ? store : store.index(index.name);\n                        var idbKeyRange = makeIDBKeyRange(range);\n                        if (limit === 0)\n                            return resolve({ result: [] });\n                        if (hasGetAll) {\n                            var req = values ?\n                                source.getAll(idbKeyRange, nonInfinitLimit) :\n                                source.getAllKeys(idbKeyRange, nonInfinitLimit);\n                            req.onsuccess = function (event) { return resolve({ result: event.target.result }); };\n                            req.onerror = eventRejectHandler(reject);\n                        }\n                        else {\n                            var count_1 = 0;\n                            var req_1 = values || !('openKeyCursor' in source) ?\n                                source.openCursor(idbKeyRange) :\n                                source.openKeyCursor(idbKeyRange);\n                            var result_1 = [];\n                            req_1.onsuccess = function (event) {\n                                var cursor = req_1.result;\n                                if (!cursor)\n                                    return resolve({ result: result_1 });\n                                result_1.push(values ? cursor.value : cursor.primaryKey);\n                                if (++count_1 === limit)\n                                    return resolve({ result: result_1 });\n                                cursor.continue();\n                            };\n                            req_1.onerror = eventRejectHandler(reject);\n                        }\n                    });\n                };\n            }\n            return {\n                name: tableName,\n                schema: tableSchema,\n                mutate: mutate,\n                getMany: function (_a) {\n                    var trans = _a.trans, keys = _a.keys;\n                    return new Promise(function (resolve, reject) {\n                        resolve = wrap(resolve);\n                        var store = trans.objectStore(tableName);\n                        var length = keys.length;\n                        var result = new Array(length);\n                        var keyCount = 0;\n                        var callbackCount = 0;\n                        var req;\n                        var successHandler = function (event) {\n                            var req = event.target;\n                            if ((result[req._pos] = req.result) != null)\n                                ;\n                            if (++callbackCount === keyCount)\n                                resolve(result);\n                        };\n                        var errorHandler = eventRejectHandler(reject);\n                        for (var i = 0; i < length; ++i) {\n                            var key = keys[i];\n                            if (key != null) {\n                                req = store.get(keys[i]);\n                                req._pos = i;\n                                req.onsuccess = successHandler;\n                                req.onerror = errorHandler;\n                                ++keyCount;\n                            }\n                        }\n                        if (keyCount === 0)\n                            resolve(result);\n                    });\n                },\n                get: function (_a) {\n                    var trans = _a.trans, key = _a.key;\n                    return new Promise(function (resolve, reject) {\n                        resolve = wrap(resolve);\n                        var store = trans.objectStore(tableName);\n                        var req = store.get(key);\n                        req.onsuccess = function (event) { return resolve(event.target.result); };\n                        req.onerror = eventRejectHandler(reject);\n                    });\n                },\n                query: query(hasGetAll),\n                openCursor: openCursor,\n                count: function (_a) {\n                    var query = _a.query, trans = _a.trans;\n                    var index = query.index, range = query.range;\n                    return new Promise(function (resolve, reject) {\n                        var store = trans.objectStore(tableName);\n                        var source = index.isPrimaryKey ? store : store.index(index.name);\n                        var idbKeyRange = makeIDBKeyRange(range);\n                        var req = idbKeyRange ? source.count(idbKeyRange) : source.count();\n                        req.onsuccess = wrap(function (ev) { return resolve(ev.target.result); });\n                        req.onerror = eventRejectHandler(reject);\n                    });\n                }\n            };\n        }\n        var _a = extractSchema(db, tmpTrans), schema = _a.schema, hasGetAll = _a.hasGetAll;\n        var tables = schema.tables.map(function (tableSchema) { return createDbCoreTable(tableSchema); });\n        var tableMap = {};\n        tables.forEach(function (table) { return tableMap[table.name] = table; });\n        return {\n            stack: \"dbcore\",\n            transaction: db.transaction.bind(db),\n            table: function (name) {\n                var result = tableMap[name];\n                if (!result)\n                    throw new Error(\"Table '\".concat(name, \"' not found\"));\n                return tableMap[name];\n            },\n            MIN_KEY: -Infinity,\n            MAX_KEY: getMaxKey(IdbKeyRange),\n            schema: schema\n        };\n    }\n\n    function createMiddlewareStack(stackImpl, middlewares) {\n        return middlewares.reduce(function (down, _a) {\n            var create = _a.create;\n            return (__assign(__assign({}, down), create(down)));\n        }, stackImpl);\n    }\n    function createMiddlewareStacks(middlewares, idbdb, _a, tmpTrans) {\n        var IDBKeyRange = _a.IDBKeyRange; _a.indexedDB;\n        var dbcore = createMiddlewareStack(createDBCore(idbdb, IDBKeyRange, tmpTrans), middlewares.dbcore);\n        return {\n            dbcore: dbcore\n        };\n    }\n    function generateMiddlewareStacks(db, tmpTrans) {\n        var idbdb = tmpTrans.db;\n        var stacks = createMiddlewareStacks(db._middlewares, idbdb, db._deps, tmpTrans);\n        db.core = stacks.dbcore;\n        db.tables.forEach(function (table) {\n            var tableName = table.name;\n            if (db.core.schema.tables.some(function (tbl) { return tbl.name === tableName; })) {\n                table.core = db.core.table(tableName);\n                if (db[tableName] instanceof db.Table) {\n                    db[tableName].core = table.core;\n                }\n            }\n        });\n    }\n\n    function setApiOnPlace(db, objs, tableNames, dbschema) {\n        tableNames.forEach(function (tableName) {\n            var schema = dbschema[tableName];\n            objs.forEach(function (obj) {\n                var propDesc = getPropertyDescriptor(obj, tableName);\n                if (!propDesc || (\"value\" in propDesc && propDesc.value === undefined)) {\n                    if (obj === db.Transaction.prototype || obj instanceof db.Transaction) {\n                        setProp(obj, tableName, {\n                            get: function () { return this.table(tableName); },\n                            set: function (value) {\n                                defineProperty(this, tableName, { value: value, writable: true, configurable: true, enumerable: true });\n                            }\n                        });\n                    }\n                    else {\n                        obj[tableName] = new db.Table(tableName, schema);\n                    }\n                }\n            });\n        });\n    }\n    function removeTablesApi(db, objs) {\n        objs.forEach(function (obj) {\n            for (var key in obj) {\n                if (obj[key] instanceof db.Table)\n                    delete obj[key];\n            }\n        });\n    }\n    function lowerVersionFirst(a, b) {\n        return a._cfg.version - b._cfg.version;\n    }\n    function runUpgraders(db, oldVersion, idbUpgradeTrans, reject) {\n        var globalSchema = db._dbSchema;\n        if (idbUpgradeTrans.objectStoreNames.contains('$meta') && !globalSchema.$meta) {\n            globalSchema.$meta = createTableSchema(\"$meta\", parseIndexSyntax(\"\")[0], []);\n            db._storeNames.push('$meta');\n        }\n        var trans = db._createTransaction('readwrite', db._storeNames, globalSchema);\n        trans.create(idbUpgradeTrans);\n        trans._completion.catch(reject);\n        var rejectTransaction = trans._reject.bind(trans);\n        var transless = PSD.transless || PSD;\n        newScope(function () {\n            PSD.trans = trans;\n            PSD.transless = transless;\n            if (oldVersion === 0) {\n                keys(globalSchema).forEach(function (tableName) {\n                    createTable(idbUpgradeTrans, tableName, globalSchema[tableName].primKey, globalSchema[tableName].indexes);\n                });\n                generateMiddlewareStacks(db, idbUpgradeTrans);\n                DexiePromise.follow(function () { return db.on.populate.fire(trans); }).catch(rejectTransaction);\n            }\n            else {\n                generateMiddlewareStacks(db, idbUpgradeTrans);\n                return getExistingVersion(db, trans, oldVersion)\n                    .then(function (oldVersion) { return updateTablesAndIndexes(db, oldVersion, trans, idbUpgradeTrans); })\n                    .catch(rejectTransaction);\n            }\n        });\n    }\n    function patchCurrentVersion(db, idbUpgradeTrans) {\n        createMissingTables(db._dbSchema, idbUpgradeTrans);\n        if (idbUpgradeTrans.db.version % 10 === 0 && !idbUpgradeTrans.objectStoreNames.contains('$meta')) {\n            idbUpgradeTrans.db.createObjectStore('$meta').add(Math.ceil((idbUpgradeTrans.db.version / 10) - 1), 'version');\n        }\n        var globalSchema = buildGlobalSchema(db, db.idbdb, idbUpgradeTrans);\n        adjustToExistingIndexNames(db, db._dbSchema, idbUpgradeTrans);\n        var diff = getSchemaDiff(globalSchema, db._dbSchema);\n        var _loop_1 = function (tableChange) {\n            if (tableChange.change.length || tableChange.recreate) {\n                console.warn(\"Unable to patch indexes of table \".concat(tableChange.name, \" because it has changes on the type of index or primary key.\"));\n                return { value: void 0 };\n            }\n            var store = idbUpgradeTrans.objectStore(tableChange.name);\n            tableChange.add.forEach(function (idx) {\n                if (debug)\n                    console.debug(\"Dexie upgrade patch: Creating missing index \".concat(tableChange.name, \".\").concat(idx.src));\n                addIndex(store, idx);\n            });\n        };\n        for (var _i = 0, _a = diff.change; _i < _a.length; _i++) {\n            var tableChange = _a[_i];\n            var state_1 = _loop_1(tableChange);\n            if (typeof state_1 === \"object\")\n                return state_1.value;\n        }\n    }\n    function getExistingVersion(db, trans, oldVersion) {\n        if (trans.storeNames.includes('$meta')) {\n            return trans.table('$meta').get('version').then(function (metaVersion) {\n                return metaVersion != null ? metaVersion : oldVersion;\n            });\n        }\n        else {\n            return DexiePromise.resolve(oldVersion);\n        }\n    }\n    function updateTablesAndIndexes(db, oldVersion, trans, idbUpgradeTrans) {\n        var queue = [];\n        var versions = db._versions;\n        var globalSchema = db._dbSchema = buildGlobalSchema(db, db.idbdb, idbUpgradeTrans);\n        var versToRun = versions.filter(function (v) { return v._cfg.version >= oldVersion; });\n        if (versToRun.length === 0) {\n            return DexiePromise.resolve();\n        }\n        versToRun.forEach(function (version) {\n            queue.push(function () {\n                var oldSchema = globalSchema;\n                var newSchema = version._cfg.dbschema;\n                adjustToExistingIndexNames(db, oldSchema, idbUpgradeTrans);\n                adjustToExistingIndexNames(db, newSchema, idbUpgradeTrans);\n                globalSchema = db._dbSchema = newSchema;\n                var diff = getSchemaDiff(oldSchema, newSchema);\n                diff.add.forEach(function (tuple) {\n                    createTable(idbUpgradeTrans, tuple[0], tuple[1].primKey, tuple[1].indexes);\n                });\n                diff.change.forEach(function (change) {\n                    if (change.recreate) {\n                        throw new exceptions.Upgrade(\"Not yet support for changing primary key\");\n                    }\n                    else {\n                        var store_1 = idbUpgradeTrans.objectStore(change.name);\n                        change.add.forEach(function (idx) { return addIndex(store_1, idx); });\n                        change.change.forEach(function (idx) {\n                            store_1.deleteIndex(idx.name);\n                            addIndex(store_1, idx);\n                        });\n                        change.del.forEach(function (idxName) { return store_1.deleteIndex(idxName); });\n                    }\n                });\n                var contentUpgrade = version._cfg.contentUpgrade;\n                if (contentUpgrade && version._cfg.version > oldVersion) {\n                    generateMiddlewareStacks(db, idbUpgradeTrans);\n                    trans._memoizedTables = {};\n                    var upgradeSchema_1 = shallowClone(newSchema);\n                    diff.del.forEach(function (table) {\n                        upgradeSchema_1[table] = oldSchema[table];\n                    });\n                    removeTablesApi(db, [db.Transaction.prototype]);\n                    setApiOnPlace(db, [db.Transaction.prototype], keys(upgradeSchema_1), upgradeSchema_1);\n                    trans.schema = upgradeSchema_1;\n                    var contentUpgradeIsAsync_1 = isAsyncFunction(contentUpgrade);\n                    if (contentUpgradeIsAsync_1) {\n                        incrementExpectedAwaits();\n                    }\n                    var returnValue_1;\n                    var promiseFollowed = DexiePromise.follow(function () {\n                        returnValue_1 = contentUpgrade(trans);\n                        if (returnValue_1) {\n                            if (contentUpgradeIsAsync_1) {\n                                var decrementor = decrementExpectedAwaits.bind(null, null);\n                                returnValue_1.then(decrementor, decrementor);\n                            }\n                        }\n                    });\n                    return (returnValue_1 && typeof returnValue_1.then === 'function' ?\n                        DexiePromise.resolve(returnValue_1) : promiseFollowed.then(function () { return returnValue_1; }));\n                }\n            });\n            queue.push(function (idbtrans) {\n                var newSchema = version._cfg.dbschema;\n                deleteRemovedTables(newSchema, idbtrans);\n                removeTablesApi(db, [db.Transaction.prototype]);\n                setApiOnPlace(db, [db.Transaction.prototype], db._storeNames, db._dbSchema);\n                trans.schema = db._dbSchema;\n            });\n            queue.push(function (idbtrans) {\n                if (db.idbdb.objectStoreNames.contains('$meta')) {\n                    if (Math.ceil(db.idbdb.version / 10) === version._cfg.version) {\n                        db.idbdb.deleteObjectStore('$meta');\n                        delete db._dbSchema.$meta;\n                        db._storeNames = db._storeNames.filter(function (name) { return name !== '$meta'; });\n                    }\n                    else {\n                        idbtrans.objectStore('$meta').put(version._cfg.version, 'version');\n                    }\n                }\n            });\n        });\n        function runQueue() {\n            return queue.length ? DexiePromise.resolve(queue.shift()(trans.idbtrans)).then(runQueue) :\n                DexiePromise.resolve();\n        }\n        return runQueue().then(function () {\n            createMissingTables(globalSchema, idbUpgradeTrans);\n        });\n    }\n    function getSchemaDiff(oldSchema, newSchema) {\n        var diff = {\n            del: [],\n            add: [],\n            change: []\n        };\n        var table;\n        for (table in oldSchema) {\n            if (!newSchema[table])\n                diff.del.push(table);\n        }\n        for (table in newSchema) {\n            var oldDef = oldSchema[table], newDef = newSchema[table];\n            if (!oldDef) {\n                diff.add.push([table, newDef]);\n            }\n            else {\n                var change = {\n                    name: table,\n                    def: newDef,\n                    recreate: false,\n                    del: [],\n                    add: [],\n                    change: []\n                };\n                if ((\n                '' + (oldDef.primKey.keyPath || '')) !== ('' + (newDef.primKey.keyPath || '')) ||\n                    (oldDef.primKey.auto !== newDef.primKey.auto)) {\n                    change.recreate = true;\n                    diff.change.push(change);\n                }\n                else {\n                    var oldIndexes = oldDef.idxByName;\n                    var newIndexes = newDef.idxByName;\n                    var idxName = void 0;\n                    for (idxName in oldIndexes) {\n                        if (!newIndexes[idxName])\n                            change.del.push(idxName);\n                    }\n                    for (idxName in newIndexes) {\n                        var oldIdx = oldIndexes[idxName], newIdx = newIndexes[idxName];\n                        if (!oldIdx)\n                            change.add.push(newIdx);\n                        else if (oldIdx.src !== newIdx.src)\n                            change.change.push(newIdx);\n                    }\n                    if (change.del.length > 0 || change.add.length > 0 || change.change.length > 0) {\n                        diff.change.push(change);\n                    }\n                }\n            }\n        }\n        return diff;\n    }\n    function createTable(idbtrans, tableName, primKey, indexes) {\n        var store = idbtrans.db.createObjectStore(tableName, primKey.keyPath ?\n            { keyPath: primKey.keyPath, autoIncrement: primKey.auto } :\n            { autoIncrement: primKey.auto });\n        indexes.forEach(function (idx) { return addIndex(store, idx); });\n        return store;\n    }\n    function createMissingTables(newSchema, idbtrans) {\n        keys(newSchema).forEach(function (tableName) {\n            if (!idbtrans.db.objectStoreNames.contains(tableName)) {\n                if (debug)\n                    console.debug('Dexie: Creating missing table', tableName);\n                createTable(idbtrans, tableName, newSchema[tableName].primKey, newSchema[tableName].indexes);\n            }\n        });\n    }\n    function deleteRemovedTables(newSchema, idbtrans) {\n        [].slice.call(idbtrans.db.objectStoreNames).forEach(function (storeName) {\n            return newSchema[storeName] == null && idbtrans.db.deleteObjectStore(storeName);\n        });\n    }\n    function addIndex(store, idx) {\n        store.createIndex(idx.name, idx.keyPath, { unique: idx.unique, multiEntry: idx.multi });\n    }\n    function buildGlobalSchema(db, idbdb, tmpTrans) {\n        var globalSchema = {};\n        var dbStoreNames = slice(idbdb.objectStoreNames, 0);\n        dbStoreNames.forEach(function (storeName) {\n            var store = tmpTrans.objectStore(storeName);\n            var keyPath = store.keyPath;\n            var primKey = createIndexSpec(nameFromKeyPath(keyPath), keyPath || \"\", true, false, !!store.autoIncrement, keyPath && typeof keyPath !== \"string\", true);\n            var indexes = [];\n            for (var j = 0; j < store.indexNames.length; ++j) {\n                var idbindex = store.index(store.indexNames[j]);\n                keyPath = idbindex.keyPath;\n                var index = createIndexSpec(idbindex.name, keyPath, !!idbindex.unique, !!idbindex.multiEntry, false, keyPath && typeof keyPath !== \"string\", false);\n                indexes.push(index);\n            }\n            globalSchema[storeName] = createTableSchema(storeName, primKey, indexes);\n        });\n        return globalSchema;\n    }\n    function readGlobalSchema(db, idbdb, tmpTrans) {\n        db.verno = idbdb.version / 10;\n        var globalSchema = db._dbSchema = buildGlobalSchema(db, idbdb, tmpTrans);\n        db._storeNames = slice(idbdb.objectStoreNames, 0);\n        setApiOnPlace(db, [db._allTables], keys(globalSchema), globalSchema);\n    }\n    function verifyInstalledSchema(db, tmpTrans) {\n        var installedSchema = buildGlobalSchema(db, db.idbdb, tmpTrans);\n        var diff = getSchemaDiff(installedSchema, db._dbSchema);\n        return !(diff.add.length || diff.change.some(function (ch) { return ch.add.length || ch.change.length; }));\n    }\n    function adjustToExistingIndexNames(db, schema, idbtrans) {\n        var storeNames = idbtrans.db.objectStoreNames;\n        for (var i = 0; i < storeNames.length; ++i) {\n            var storeName = storeNames[i];\n            var store = idbtrans.objectStore(storeName);\n            db._hasGetAll = 'getAll' in store;\n            for (var j = 0; j < store.indexNames.length; ++j) {\n                var indexName = store.indexNames[j];\n                var keyPath = store.index(indexName).keyPath;\n                var dexieName = typeof keyPath === 'string' ? keyPath : \"[\" + slice(keyPath).join('+') + \"]\";\n                if (schema[storeName]) {\n                    var indexSpec = schema[storeName].idxByName[dexieName];\n                    if (indexSpec) {\n                        indexSpec.name = indexName;\n                        delete schema[storeName].idxByName[dexieName];\n                        schema[storeName].idxByName[indexName] = indexSpec;\n                    }\n                }\n            }\n        }\n        if (typeof navigator !== 'undefined' && /Safari/.test(navigator.userAgent) &&\n            !/(Chrome\\/|Edge\\/)/.test(navigator.userAgent) &&\n            _global.WorkerGlobalScope && _global instanceof _global.WorkerGlobalScope &&\n            [].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1] < 604) {\n            db._hasGetAll = false;\n        }\n    }\n    function parseIndexSyntax(primKeyAndIndexes) {\n        return primKeyAndIndexes.split(',').map(function (index, indexNum) {\n            var _a;\n            var typeSplit = index.split(':');\n            var type = (_a = typeSplit[1]) === null || _a === void 0 ? void 0 : _a.trim();\n            index = typeSplit[0].trim();\n            var name = index.replace(/([&*]|\\+\\+)/g, \"\");\n            var keyPath = /^\\[/.test(name) ? name.match(/^\\[(.*)\\]$/)[1].split('+') : name;\n            return createIndexSpec(name, keyPath || null, /\\&/.test(index), /\\*/.test(index), /\\+\\+/.test(index), isArray(keyPath), indexNum === 0, type);\n        });\n    }\n\n    var Version =  (function () {\n        function Version() {\n        }\n        Version.prototype._createTableSchema = function (name, primKey, indexes) {\n            return createTableSchema(name, primKey, indexes);\n        };\n        Version.prototype._parseIndexSyntax = function (primKeyAndIndexes) {\n            return parseIndexSyntax(primKeyAndIndexes);\n        };\n        Version.prototype._parseStoresSpec = function (stores, outSchema) {\n            var _this = this;\n            keys(stores).forEach(function (tableName) {\n                if (stores[tableName] !== null) {\n                    var indexes = _this._parseIndexSyntax(stores[tableName]);\n                    var primKey = indexes.shift();\n                    if (!primKey) {\n                        throw new exceptions.Schema('Invalid schema for table ' + tableName + ': ' + stores[tableName]);\n                    }\n                    primKey.unique = true;\n                    if (primKey.multi)\n                        throw new exceptions.Schema('Primary key cannot be multiEntry*');\n                    indexes.forEach(function (idx) {\n                        if (idx.auto)\n                            throw new exceptions.Schema('Only primary key can be marked as autoIncrement (++)');\n                        if (!idx.keyPath)\n                            throw new exceptions.Schema('Index must have a name and cannot be an empty string');\n                    });\n                    var tblSchema = _this._createTableSchema(tableName, primKey, indexes);\n                    outSchema[tableName] = tblSchema;\n                }\n            });\n        };\n        Version.prototype.stores = function (stores) {\n            var db = this.db;\n            this._cfg.storesSource = this._cfg.storesSource\n                ? extend(this._cfg.storesSource, stores)\n                : stores;\n            var versions = db._versions;\n            var storesSpec = {};\n            var dbschema = {};\n            versions.forEach(function (version) {\n                extend(storesSpec, version._cfg.storesSource);\n                dbschema = version._cfg.dbschema = {};\n                version._parseStoresSpec(storesSpec, dbschema);\n            });\n            db._dbSchema = dbschema;\n            removeTablesApi(db, [db._allTables, db, db.Transaction.prototype]);\n            setApiOnPlace(db, [db._allTables, db, db.Transaction.prototype, this._cfg.tables], keys(dbschema), dbschema);\n            db._storeNames = keys(dbschema);\n            return this;\n        };\n        Version.prototype.upgrade = function (upgradeFunction) {\n            this._cfg.contentUpgrade = promisableChain(this._cfg.contentUpgrade || nop, upgradeFunction);\n            return this;\n        };\n        return Version;\n    }());\n\n    function createVersionConstructor(db) {\n        return makeClassConstructor(Version.prototype, function Version(versionNumber) {\n            this.db = db;\n            this._cfg = {\n                version: versionNumber,\n                storesSource: null,\n                dbschema: {},\n                tables: {},\n                contentUpgrade: null\n            };\n        });\n    }\n\n    function getDbNamesTable(indexedDB, IDBKeyRange) {\n        var dbNamesDB = indexedDB[\"_dbNamesDB\"];\n        if (!dbNamesDB) {\n            dbNamesDB = indexedDB[\"_dbNamesDB\"] = new Dexie$1(DBNAMES_DB, {\n                addons: [],\n                indexedDB: indexedDB,\n                IDBKeyRange: IDBKeyRange,\n            });\n            dbNamesDB.version(1).stores({ dbnames: \"name\" });\n        }\n        return dbNamesDB.table(\"dbnames\");\n    }\n    function hasDatabasesNative(indexedDB) {\n        return indexedDB && typeof indexedDB.databases === \"function\";\n    }\n    function getDatabaseNames(_a) {\n        var indexedDB = _a.indexedDB, IDBKeyRange = _a.IDBKeyRange;\n        return hasDatabasesNative(indexedDB)\n            ? Promise.resolve(indexedDB.databases()).then(function (infos) {\n                return infos\n                    .map(function (info) { return info.name; })\n                    .filter(function (name) { return name !== DBNAMES_DB; });\n            })\n            : getDbNamesTable(indexedDB, IDBKeyRange).toCollection().primaryKeys();\n    }\n    function _onDatabaseCreated(_a, name) {\n        var indexedDB = _a.indexedDB, IDBKeyRange = _a.IDBKeyRange;\n        !hasDatabasesNative(indexedDB) &&\n            name !== DBNAMES_DB &&\n            getDbNamesTable(indexedDB, IDBKeyRange).put({ name: name }).catch(nop);\n    }\n    function _onDatabaseDeleted(_a, name) {\n        var indexedDB = _a.indexedDB, IDBKeyRange = _a.IDBKeyRange;\n        !hasDatabasesNative(indexedDB) &&\n            name !== DBNAMES_DB &&\n            getDbNamesTable(indexedDB, IDBKeyRange).delete(name).catch(nop);\n    }\n\n    function vip(fn) {\n        return newScope(function () {\n            PSD.letThrough = true;\n            return fn();\n        });\n    }\n\n    function idbReady() {\n        var isSafari = !navigator.userAgentData &&\n            /Safari\\//.test(navigator.userAgent) &&\n            !/Chrom(e|ium)\\//.test(navigator.userAgent);\n        if (!isSafari || !indexedDB.databases)\n            return Promise.resolve();\n        var intervalId;\n        return new Promise(function (resolve) {\n            var tryIdb = function () { return indexedDB.databases().finally(resolve); };\n            intervalId = setInterval(tryIdb, 100);\n            tryIdb();\n        }).finally(function () { return clearInterval(intervalId); });\n    }\n\n    var _a;\n    function isEmptyRange(node) {\n        return !(\"from\" in node);\n    }\n    var RangeSet = function (fromOrTree, to) {\n        if (this) {\n            extend(this, arguments.length ? { d: 1, from: fromOrTree, to: arguments.length > 1 ? to : fromOrTree } : { d: 0 });\n        }\n        else {\n            var rv = new RangeSet();\n            if (fromOrTree && (\"d\" in fromOrTree)) {\n                extend(rv, fromOrTree);\n            }\n            return rv;\n        }\n    };\n    props(RangeSet.prototype, (_a = {\n            add: function (rangeSet) {\n                mergeRanges(this, rangeSet);\n                return this;\n            },\n            addKey: function (key) {\n                addRange(this, key, key);\n                return this;\n            },\n            addKeys: function (keys) {\n                var _this = this;\n                keys.forEach(function (key) { return addRange(_this, key, key); });\n                return this;\n            },\n            hasKey: function (key) {\n                var node = getRangeSetIterator(this).next(key).value;\n                return node && cmp(node.from, key) <= 0 && cmp(node.to, key) >= 0;\n            }\n        },\n        _a[iteratorSymbol] = function () {\n            return getRangeSetIterator(this);\n        },\n        _a));\n    function addRange(target, from, to) {\n        var diff = cmp(from, to);\n        if (isNaN(diff))\n            return;\n        if (diff > 0)\n            throw RangeError();\n        if (isEmptyRange(target))\n            return extend(target, { from: from, to: to, d: 1 });\n        var left = target.l;\n        var right = target.r;\n        if (cmp(to, target.from) < 0) {\n            left\n                ? addRange(left, from, to)\n                : (target.l = { from: from, to: to, d: 1, l: null, r: null });\n            return rebalance(target);\n        }\n        if (cmp(from, target.to) > 0) {\n            right\n                ? addRange(right, from, to)\n                : (target.r = { from: from, to: to, d: 1, l: null, r: null });\n            return rebalance(target);\n        }\n        if (cmp(from, target.from) < 0) {\n            target.from = from;\n            target.l = null;\n            target.d = right ? right.d + 1 : 1;\n        }\n        if (cmp(to, target.to) > 0) {\n            target.to = to;\n            target.r = null;\n            target.d = target.l ? target.l.d + 1 : 1;\n        }\n        var rightWasCutOff = !target.r;\n        if (left && !target.l) {\n            mergeRanges(target, left);\n        }\n        if (right && rightWasCutOff) {\n            mergeRanges(target, right);\n        }\n    }\n    function mergeRanges(target, newSet) {\n        function _addRangeSet(target, _a) {\n            var from = _a.from, to = _a.to, l = _a.l, r = _a.r;\n            addRange(target, from, to);\n            if (l)\n                _addRangeSet(target, l);\n            if (r)\n                _addRangeSet(target, r);\n        }\n        if (!isEmptyRange(newSet))\n            _addRangeSet(target, newSet);\n    }\n    function rangesOverlap(rangeSet1, rangeSet2) {\n        var i1 = getRangeSetIterator(rangeSet2);\n        var nextResult1 = i1.next();\n        if (nextResult1.done)\n            return false;\n        var a = nextResult1.value;\n        var i2 = getRangeSetIterator(rangeSet1);\n        var nextResult2 = i2.next(a.from);\n        var b = nextResult2.value;\n        while (!nextResult1.done && !nextResult2.done) {\n            if (cmp(b.from, a.to) <= 0 && cmp(b.to, a.from) >= 0)\n                return true;\n            cmp(a.from, b.from) < 0\n                ? (a = (nextResult1 = i1.next(b.from)).value)\n                : (b = (nextResult2 = i2.next(a.from)).value);\n        }\n        return false;\n    }\n    function getRangeSetIterator(node) {\n        var state = isEmptyRange(node) ? null : { s: 0, n: node };\n        return {\n            next: function (key) {\n                var keyProvided = arguments.length > 0;\n                while (state) {\n                    switch (state.s) {\n                        case 0:\n                            state.s = 1;\n                            if (keyProvided) {\n                                while (state.n.l && cmp(key, state.n.from) < 0)\n                                    state = { up: state, n: state.n.l, s: 1 };\n                            }\n                            else {\n                                while (state.n.l)\n                                    state = { up: state, n: state.n.l, s: 1 };\n                            }\n                        case 1:\n                            state.s = 2;\n                            if (!keyProvided || cmp(key, state.n.to) <= 0)\n                                return { value: state.n, done: false };\n                        case 2:\n                            if (state.n.r) {\n                                state.s = 3;\n                                state = { up: state, n: state.n.r, s: 0 };\n                                continue;\n                            }\n                        case 3:\n                            state = state.up;\n                    }\n                }\n                return { done: true };\n            },\n        };\n    }\n    function rebalance(target) {\n        var _a, _b;\n        var diff = (((_a = target.r) === null || _a === void 0 ? void 0 : _a.d) || 0) - (((_b = target.l) === null || _b === void 0 ? void 0 : _b.d) || 0);\n        var r = diff > 1 ? \"r\" : diff < -1 ? \"l\" : \"\";\n        if (r) {\n            var l = r === \"r\" ? \"l\" : \"r\";\n            var rootClone = __assign({}, target);\n            var oldRootRight = target[r];\n            target.from = oldRootRight.from;\n            target.to = oldRootRight.to;\n            target[r] = oldRootRight[r];\n            rootClone[r] = oldRootRight[l];\n            target[l] = rootClone;\n            rootClone.d = computeDepth(rootClone);\n        }\n        target.d = computeDepth(target);\n    }\n    function computeDepth(_a) {\n        var r = _a.r, l = _a.l;\n        return (r ? (l ? Math.max(r.d, l.d) : r.d) : l ? l.d : 0) + 1;\n    }\n\n    function extendObservabilitySet(target, newSet) {\n        keys(newSet).forEach(function (part) {\n            if (target[part])\n                mergeRanges(target[part], newSet[part]);\n            else\n                target[part] = cloneSimpleObjectTree(newSet[part]);\n        });\n        return target;\n    }\n\n    function obsSetsOverlap(os1, os2) {\n        return os1.all || os2.all || Object.keys(os1).some(function (key) { return os2[key] && rangesOverlap(os2[key], os1[key]); });\n    }\n\n    var cache = {};\n\n    var unsignaledParts = {};\n    var isTaskEnqueued = false;\n    function signalSubscribersLazily(part, optimistic) {\n        extendObservabilitySet(unsignaledParts, part);\n        if (!isTaskEnqueued) {\n            isTaskEnqueued = true;\n            setTimeout(function () {\n                isTaskEnqueued = false;\n                var parts = unsignaledParts;\n                unsignaledParts = {};\n                signalSubscribersNow(parts, false);\n            }, 0);\n        }\n    }\n    function signalSubscribersNow(updatedParts, deleteAffectedCacheEntries) {\n        if (deleteAffectedCacheEntries === void 0) { deleteAffectedCacheEntries = false; }\n        var queriesToSignal = new Set();\n        if (updatedParts.all) {\n            for (var _i = 0, _a = Object.values(cache); _i < _a.length; _i++) {\n                var tblCache = _a[_i];\n                collectTableSubscribers(tblCache, updatedParts, queriesToSignal, deleteAffectedCacheEntries);\n            }\n        }\n        else {\n            for (var key in updatedParts) {\n                var parts = /^idb\\:\\/\\/(.*)\\/(.*)\\//.exec(key);\n                if (parts) {\n                    var dbName = parts[1], tableName = parts[2];\n                    var tblCache = cache[\"idb://\".concat(dbName, \"/\").concat(tableName)];\n                    if (tblCache)\n                        collectTableSubscribers(tblCache, updatedParts, queriesToSignal, deleteAffectedCacheEntries);\n                }\n            }\n        }\n        queriesToSignal.forEach(function (requery) { return requery(); });\n    }\n    function collectTableSubscribers(tblCache, updatedParts, outQueriesToSignal, deleteAffectedCacheEntries) {\n        var updatedEntryLists = [];\n        for (var _i = 0, _a = Object.entries(tblCache.queries.query); _i < _a.length; _i++) {\n            var _b = _a[_i], indexName = _b[0], entries = _b[1];\n            var filteredEntries = [];\n            for (var _c = 0, entries_1 = entries; _c < entries_1.length; _c++) {\n                var entry = entries_1[_c];\n                if (obsSetsOverlap(updatedParts, entry.obsSet)) {\n                    entry.subscribers.forEach(function (requery) { return outQueriesToSignal.add(requery); });\n                }\n                else if (deleteAffectedCacheEntries) {\n                    filteredEntries.push(entry);\n                }\n            }\n            if (deleteAffectedCacheEntries)\n                updatedEntryLists.push([indexName, filteredEntries]);\n        }\n        if (deleteAffectedCacheEntries) {\n            for (var _d = 0, updatedEntryLists_1 = updatedEntryLists; _d < updatedEntryLists_1.length; _d++) {\n                var _e = updatedEntryLists_1[_d], indexName = _e[0], filteredEntries = _e[1];\n                tblCache.queries.query[indexName] = filteredEntries;\n            }\n        }\n    }\n\n    function dexieOpen(db) {\n        var state = db._state;\n        var indexedDB = db._deps.indexedDB;\n        if (state.isBeingOpened || db.idbdb)\n            return state.dbReadyPromise.then(function () { return state.dbOpenError ?\n                rejection(state.dbOpenError) :\n                db; });\n        state.isBeingOpened = true;\n        state.dbOpenError = null;\n        state.openComplete = false;\n        var openCanceller = state.openCanceller;\n        var nativeVerToOpen = Math.round(db.verno * 10);\n        var schemaPatchMode = false;\n        function throwIfCancelled() {\n            if (state.openCanceller !== openCanceller)\n                throw new exceptions.DatabaseClosed('db.open() was cancelled');\n        }\n        var resolveDbReady = state.dbReadyResolve,\n        upgradeTransaction = null, wasCreated = false;\n        var tryOpenDB = function () { return new DexiePromise(function (resolve, reject) {\n            throwIfCancelled();\n            if (!indexedDB)\n                throw new exceptions.MissingAPI();\n            var dbName = db.name;\n            var req = state.autoSchema || !nativeVerToOpen ?\n                indexedDB.open(dbName) :\n                indexedDB.open(dbName, nativeVerToOpen);\n            if (!req)\n                throw new exceptions.MissingAPI();\n            req.onerror = eventRejectHandler(reject);\n            req.onblocked = wrap(db._fireOnBlocked);\n            req.onupgradeneeded = wrap(function (e) {\n                upgradeTransaction = req.transaction;\n                if (state.autoSchema && !db._options.allowEmptyDB) {\n                    req.onerror = preventDefault;\n                    upgradeTransaction.abort();\n                    req.result.close();\n                    var delreq = indexedDB.deleteDatabase(dbName);\n                    delreq.onsuccess = delreq.onerror = wrap(function () {\n                        reject(new exceptions.NoSuchDatabase(\"Database \".concat(dbName, \" doesnt exist\")));\n                    });\n                }\n                else {\n                    upgradeTransaction.onerror = eventRejectHandler(reject);\n                    var oldVer = e.oldVersion > Math.pow(2, 62) ? 0 : e.oldVersion;\n                    wasCreated = oldVer < 1;\n                    db.idbdb = req.result;\n                    if (schemaPatchMode) {\n                        patchCurrentVersion(db, upgradeTransaction);\n                    }\n                    runUpgraders(db, oldVer / 10, upgradeTransaction, reject);\n                }\n            }, reject);\n            req.onsuccess = wrap(function () {\n                upgradeTransaction = null;\n                var idbdb = db.idbdb = req.result;\n                var objectStoreNames = slice(idbdb.objectStoreNames);\n                if (objectStoreNames.length > 0)\n                    try {\n                        var tmpTrans = idbdb.transaction(safariMultiStoreFix(objectStoreNames), 'readonly');\n                        if (state.autoSchema)\n                            readGlobalSchema(db, idbdb, tmpTrans);\n                        else {\n                            adjustToExistingIndexNames(db, db._dbSchema, tmpTrans);\n                            if (!verifyInstalledSchema(db, tmpTrans) && !schemaPatchMode) {\n                                console.warn(\"Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this.\");\n                                idbdb.close();\n                                nativeVerToOpen = idbdb.version + 1;\n                                schemaPatchMode = true;\n                                return resolve(tryOpenDB());\n                            }\n                        }\n                        generateMiddlewareStacks(db, tmpTrans);\n                    }\n                    catch (e) {\n                    }\n                connections.push(db);\n                idbdb.onversionchange = wrap(function (ev) {\n                    state.vcFired = true;\n                    db.on(\"versionchange\").fire(ev);\n                });\n                idbdb.onclose = wrap(function () {\n                    db.close({ disableAutoOpen: false });\n                });\n                if (wasCreated)\n                    _onDatabaseCreated(db._deps, dbName);\n                resolve();\n            }, reject);\n        }).catch(function (err) {\n            switch (err === null || err === void 0 ? void 0 : err.name) {\n                case \"UnknownError\":\n                    if (state.PR1398_maxLoop > 0) {\n                        state.PR1398_maxLoop--;\n                        console.warn('Dexie: Workaround for Chrome UnknownError on open()');\n                        return tryOpenDB();\n                    }\n                    break;\n                case \"VersionError\":\n                    if (nativeVerToOpen > 0) {\n                        nativeVerToOpen = 0;\n                        return tryOpenDB();\n                    }\n                    break;\n            }\n            return DexiePromise.reject(err);\n        }); };\n        return DexiePromise.race([\n            openCanceller,\n            (typeof navigator === 'undefined' ? DexiePromise.resolve() : idbReady()).then(tryOpenDB)\n        ]).then(function () {\n            throwIfCancelled();\n            state.onReadyBeingFired = [];\n            return DexiePromise.resolve(vip(function () { return db.on.ready.fire(db.vip); })).then(function fireRemainders() {\n                if (state.onReadyBeingFired.length > 0) {\n                    var remainders_1 = state.onReadyBeingFired.reduce(promisableChain, nop);\n                    state.onReadyBeingFired = [];\n                    return DexiePromise.resolve(vip(function () { return remainders_1(db.vip); })).then(fireRemainders);\n                }\n            });\n        }).finally(function () {\n            if (state.openCanceller === openCanceller) {\n                state.onReadyBeingFired = null;\n                state.isBeingOpened = false;\n            }\n        }).catch(function (err) {\n            state.dbOpenError = err;\n            try {\n                upgradeTransaction && upgradeTransaction.abort();\n            }\n            catch (_a) { }\n            if (openCanceller === state.openCanceller) {\n                db._close();\n            }\n            return rejection(err);\n        }).finally(function () {\n            state.openComplete = true;\n            resolveDbReady();\n        }).then(function () {\n            if (wasCreated) {\n                var everything_1 = {};\n                db.tables.forEach(function (table) {\n                    table.schema.indexes.forEach(function (idx) {\n                        if (idx.name)\n                            everything_1[\"idb://\".concat(db.name, \"/\").concat(table.name, \"/\").concat(idx.name)] = new RangeSet(-Infinity, [[[]]]);\n                    });\n                    everything_1[\"idb://\".concat(db.name, \"/\").concat(table.name, \"/\")] = everything_1[\"idb://\".concat(db.name, \"/\").concat(table.name, \"/:dels\")] = new RangeSet(-Infinity, [[[]]]);\n                });\n                globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME).fire(everything_1);\n                signalSubscribersNow(everything_1, true);\n            }\n            return db;\n        });\n    }\n\n    function awaitIterator(iterator) {\n        var callNext = function (result) { return iterator.next(result); }, doThrow = function (error) { return iterator.throw(error); }, onSuccess = step(callNext), onError = step(doThrow);\n        function step(getNext) {\n            return function (val) {\n                var next = getNext(val), value = next.value;\n                return next.done ? value :\n                    (!value || typeof value.then !== 'function' ?\n                        isArray(value) ? Promise.all(value).then(onSuccess, onError) : onSuccess(value) :\n                        value.then(onSuccess, onError));\n            };\n        }\n        return step(callNext)();\n    }\n\n    function extractTransactionArgs(mode, _tableArgs_, scopeFunc) {\n        var i = arguments.length;\n        if (i < 2)\n            throw new exceptions.InvalidArgument(\"Too few arguments\");\n        var args = new Array(i - 1);\n        while (--i)\n            args[i - 1] = arguments[i];\n        scopeFunc = args.pop();\n        var tables = flatten(args);\n        return [mode, tables, scopeFunc];\n    }\n    function enterTransactionScope(db, mode, storeNames, parentTransaction, scopeFunc) {\n        return DexiePromise.resolve().then(function () {\n            var transless = PSD.transless || PSD;\n            var trans = db._createTransaction(mode, storeNames, db._dbSchema, parentTransaction);\n            trans.explicit = true;\n            var zoneProps = {\n                trans: trans,\n                transless: transless\n            };\n            if (parentTransaction) {\n                trans.idbtrans = parentTransaction.idbtrans;\n            }\n            else {\n                try {\n                    trans.create();\n                    trans.idbtrans._explicit = true;\n                    db._state.PR1398_maxLoop = 3;\n                }\n                catch (ex) {\n                    if (ex.name === errnames.InvalidState && db.isOpen() && --db._state.PR1398_maxLoop > 0) {\n                        console.warn('Dexie: Need to reopen db');\n                        db.close({ disableAutoOpen: false });\n                        return db.open().then(function () { return enterTransactionScope(db, mode, storeNames, null, scopeFunc); });\n                    }\n                    return rejection(ex);\n                }\n            }\n            var scopeFuncIsAsync = isAsyncFunction(scopeFunc);\n            if (scopeFuncIsAsync) {\n                incrementExpectedAwaits();\n            }\n            var returnValue;\n            var promiseFollowed = DexiePromise.follow(function () {\n                returnValue = scopeFunc.call(trans, trans);\n                if (returnValue) {\n                    if (scopeFuncIsAsync) {\n                        var decrementor = decrementExpectedAwaits.bind(null, null);\n                        returnValue.then(decrementor, decrementor);\n                    }\n                    else if (typeof returnValue.next === 'function' && typeof returnValue.throw === 'function') {\n                        returnValue = awaitIterator(returnValue);\n                    }\n                }\n            }, zoneProps);\n            return (returnValue && typeof returnValue.then === 'function' ?\n                DexiePromise.resolve(returnValue).then(function (x) { return trans.active ?\n                    x\n                    : rejection(new exceptions.PrematureCommit(\"Transaction committed too early. See http://bit.ly/2kdckMn\")); })\n                : promiseFollowed.then(function () { return returnValue; })).then(function (x) {\n                if (parentTransaction)\n                    trans._resolve();\n                return trans._completion.then(function () { return x; });\n            }).catch(function (e) {\n                trans._reject(e);\n                return rejection(e);\n            });\n        });\n    }\n\n    function pad(a, value, count) {\n        var result = isArray(a) ? a.slice() : [a];\n        for (var i = 0; i < count; ++i)\n            result.push(value);\n        return result;\n    }\n    function createVirtualIndexMiddleware(down) {\n        return __assign(__assign({}, down), { table: function (tableName) {\n                var table = down.table(tableName);\n                var schema = table.schema;\n                var indexLookup = {};\n                var allVirtualIndexes = [];\n                function addVirtualIndexes(keyPath, keyTail, lowLevelIndex) {\n                    var keyPathAlias = getKeyPathAlias(keyPath);\n                    var indexList = (indexLookup[keyPathAlias] = indexLookup[keyPathAlias] || []);\n                    var keyLength = keyPath == null ? 0 : typeof keyPath === 'string' ? 1 : keyPath.length;\n                    var isVirtual = keyTail > 0;\n                    var virtualIndex = __assign(__assign({}, lowLevelIndex), { name: isVirtual\n                            ? \"\".concat(keyPathAlias, \"(virtual-from:\").concat(lowLevelIndex.name, \")\")\n                            : lowLevelIndex.name, lowLevelIndex: lowLevelIndex, isVirtual: isVirtual, keyTail: keyTail, keyLength: keyLength, extractKey: getKeyExtractor(keyPath), unique: !isVirtual && lowLevelIndex.unique });\n                    indexList.push(virtualIndex);\n                    if (!virtualIndex.isPrimaryKey) {\n                        allVirtualIndexes.push(virtualIndex);\n                    }\n                    if (keyLength > 1) {\n                        var virtualKeyPath = keyLength === 2 ?\n                            keyPath[0] :\n                            keyPath.slice(0, keyLength - 1);\n                        addVirtualIndexes(virtualKeyPath, keyTail + 1, lowLevelIndex);\n                    }\n                    indexList.sort(function (a, b) { return a.keyTail - b.keyTail; });\n                    return virtualIndex;\n                }\n                var primaryKey = addVirtualIndexes(schema.primaryKey.keyPath, 0, schema.primaryKey);\n                indexLookup[\":id\"] = [primaryKey];\n                for (var _i = 0, _a = schema.indexes; _i < _a.length; _i++) {\n                    var index = _a[_i];\n                    addVirtualIndexes(index.keyPath, 0, index);\n                }\n                function findBestIndex(keyPath) {\n                    var result = indexLookup[getKeyPathAlias(keyPath)];\n                    return result && result[0];\n                }\n                function translateRange(range, keyTail) {\n                    return {\n                        type: range.type === 1  ?\n                            2  :\n                            range.type,\n                        lower: pad(range.lower, range.lowerOpen ? down.MAX_KEY : down.MIN_KEY, keyTail),\n                        lowerOpen: true,\n                        upper: pad(range.upper, range.upperOpen ? down.MIN_KEY : down.MAX_KEY, keyTail),\n                        upperOpen: true\n                    };\n                }\n                function translateRequest(req) {\n                    var index = req.query.index;\n                    return index.isVirtual ? __assign(__assign({}, req), { query: {\n                            index: index.lowLevelIndex,\n                            range: translateRange(req.query.range, index.keyTail)\n                        } }) : req;\n                }\n                var result = __assign(__assign({}, table), { schema: __assign(__assign({}, schema), { primaryKey: primaryKey, indexes: allVirtualIndexes, getIndexByKeyPath: findBestIndex }), count: function (req) {\n                        return table.count(translateRequest(req));\n                    }, query: function (req) {\n                        return table.query(translateRequest(req));\n                    }, openCursor: function (req) {\n                        var _a = req.query.index, keyTail = _a.keyTail, isVirtual = _a.isVirtual, keyLength = _a.keyLength;\n                        if (!isVirtual)\n                            return table.openCursor(req);\n                        function createVirtualCursor(cursor) {\n                            function _continue(key) {\n                                key != null ?\n                                    cursor.continue(pad(key, req.reverse ? down.MAX_KEY : down.MIN_KEY, keyTail)) :\n                                    req.unique ?\n                                        cursor.continue(cursor.key.slice(0, keyLength)\n                                            .concat(req.reverse\n                                            ? down.MIN_KEY\n                                            : down.MAX_KEY, keyTail)) :\n                                        cursor.continue();\n                            }\n                            var virtualCursor = Object.create(cursor, {\n                                continue: { value: _continue },\n                                continuePrimaryKey: {\n                                    value: function (key, primaryKey) {\n                                        cursor.continuePrimaryKey(pad(key, down.MAX_KEY, keyTail), primaryKey);\n                                    }\n                                },\n                                primaryKey: {\n                                    get: function () {\n                                        return cursor.primaryKey;\n                                    }\n                                },\n                                key: {\n                                    get: function () {\n                                        var key = cursor.key;\n                                        return keyLength === 1 ?\n                                            key[0] :\n                                            key.slice(0, keyLength);\n                                    }\n                                },\n                                value: {\n                                    get: function () {\n                                        return cursor.value;\n                                    }\n                                }\n                            });\n                            return virtualCursor;\n                        }\n                        return table.openCursor(translateRequest(req))\n                            .then(function (cursor) { return cursor && createVirtualCursor(cursor); });\n                    } });\n                return result;\n            } });\n    }\n    var virtualIndexMiddleware = {\n        stack: \"dbcore\",\n        name: \"VirtualIndexMiddleware\",\n        level: 1,\n        create: createVirtualIndexMiddleware\n    };\n\n    function getObjectDiff(a, b, rv, prfx) {\n        rv = rv || {};\n        prfx = prfx || '';\n        keys(a).forEach(function (prop) {\n            if (!hasOwn(b, prop)) {\n                rv[prfx + prop] = undefined;\n            }\n            else {\n                var ap = a[prop], bp = b[prop];\n                if (typeof ap === 'object' && typeof bp === 'object' && ap && bp) {\n                    var apTypeName = toStringTag(ap);\n                    var bpTypeName = toStringTag(bp);\n                    if (apTypeName !== bpTypeName) {\n                        rv[prfx + prop] = b[prop];\n                    }\n                    else if (apTypeName === 'Object') {\n                        getObjectDiff(ap, bp, rv, prfx + prop + '.');\n                    }\n                    else if (ap !== bp) {\n                        rv[prfx + prop] = b[prop];\n                    }\n                }\n                else if (ap !== bp)\n                    rv[prfx + prop] = b[prop];\n            }\n        });\n        keys(b).forEach(function (prop) {\n            if (!hasOwn(a, prop)) {\n                rv[prfx + prop] = b[prop];\n            }\n        });\n        return rv;\n    }\n\n    function getEffectiveKeys(primaryKey, req) {\n        if (req.type === 'delete')\n            return req.keys;\n        return req.keys || req.values.map(primaryKey.extractKey);\n    }\n\n    var hooksMiddleware = {\n        stack: \"dbcore\",\n        name: \"HooksMiddleware\",\n        level: 2,\n        create: function (downCore) { return (__assign(__assign({}, downCore), { table: function (tableName) {\n                var downTable = downCore.table(tableName);\n                var primaryKey = downTable.schema.primaryKey;\n                var tableMiddleware = __assign(__assign({}, downTable), { mutate: function (req) {\n                        var dxTrans = PSD.trans;\n                        var _a = dxTrans.table(tableName).hook, deleting = _a.deleting, creating = _a.creating, updating = _a.updating;\n                        switch (req.type) {\n                            case 'add':\n                                if (creating.fire === nop)\n                                    break;\n                                return dxTrans._promise('readwrite', function () { return addPutOrDelete(req); }, true);\n                            case 'put':\n                                if (creating.fire === nop && updating.fire === nop)\n                                    break;\n                                return dxTrans._promise('readwrite', function () { return addPutOrDelete(req); }, true);\n                            case 'delete':\n                                if (deleting.fire === nop)\n                                    break;\n                                return dxTrans._promise('readwrite', function () { return addPutOrDelete(req); }, true);\n                            case 'deleteRange':\n                                if (deleting.fire === nop)\n                                    break;\n                                return dxTrans._promise('readwrite', function () { return deleteRange(req); }, true);\n                        }\n                        return downTable.mutate(req);\n                        function addPutOrDelete(req) {\n                            var dxTrans = PSD.trans;\n                            var keys = req.keys || getEffectiveKeys(primaryKey, req);\n                            if (!keys)\n                                throw new Error(\"Keys missing\");\n                            req = req.type === 'add' || req.type === 'put' ? __assign(__assign({}, req), { keys: keys }) : __assign({}, req);\n                            if (req.type !== 'delete')\n                                req.values = __spreadArray([], req.values, true);\n                            if (req.keys)\n                                req.keys = __spreadArray([], req.keys, true);\n                            return getExistingValues(downTable, req, keys).then(function (existingValues) {\n                                var contexts = keys.map(function (key, i) {\n                                    var existingValue = existingValues[i];\n                                    var ctx = { onerror: null, onsuccess: null };\n                                    if (req.type === 'delete') {\n                                        deleting.fire.call(ctx, key, existingValue, dxTrans);\n                                    }\n                                    else if (req.type === 'add' || existingValue === undefined) {\n                                        var generatedPrimaryKey = creating.fire.call(ctx, key, req.values[i], dxTrans);\n                                        if (key == null && generatedPrimaryKey != null) {\n                                            key = generatedPrimaryKey;\n                                            req.keys[i] = key;\n                                            if (!primaryKey.outbound) {\n                                                setByKeyPath(req.values[i], primaryKey.keyPath, key);\n                                            }\n                                        }\n                                    }\n                                    else {\n                                        var objectDiff = getObjectDiff(existingValue, req.values[i]);\n                                        var additionalChanges_1 = updating.fire.call(ctx, objectDiff, key, existingValue, dxTrans);\n                                        if (additionalChanges_1) {\n                                            var requestedValue_1 = req.values[i];\n                                            Object.keys(additionalChanges_1).forEach(function (keyPath) {\n                                                if (hasOwn(requestedValue_1, keyPath)) {\n                                                    requestedValue_1[keyPath] = additionalChanges_1[keyPath];\n                                                }\n                                                else {\n                                                    setByKeyPath(requestedValue_1, keyPath, additionalChanges_1[keyPath]);\n                                                }\n                                            });\n                                        }\n                                    }\n                                    return ctx;\n                                });\n                                return downTable.mutate(req).then(function (_a) {\n                                    var failures = _a.failures, results = _a.results, numFailures = _a.numFailures, lastResult = _a.lastResult;\n                                    for (var i = 0; i < keys.length; ++i) {\n                                        var primKey = results ? results[i] : keys[i];\n                                        var ctx = contexts[i];\n                                        if (primKey == null) {\n                                            ctx.onerror && ctx.onerror(failures[i]);\n                                        }\n                                        else {\n                                            ctx.onsuccess && ctx.onsuccess(req.type === 'put' && existingValues[i] ?\n                                                req.values[i] :\n                                                primKey\n                                            );\n                                        }\n                                    }\n                                    return { failures: failures, results: results, numFailures: numFailures, lastResult: lastResult };\n                                }).catch(function (error) {\n                                    contexts.forEach(function (ctx) { return ctx.onerror && ctx.onerror(error); });\n                                    return Promise.reject(error);\n                                });\n                            });\n                        }\n                        function deleteRange(req) {\n                            return deleteNextChunk(req.trans, req.range, 10000);\n                        }\n                        function deleteNextChunk(trans, range, limit) {\n                            return downTable.query({ trans: trans, values: false, query: { index: primaryKey, range: range }, limit: limit })\n                                .then(function (_a) {\n                                var result = _a.result;\n                                return addPutOrDelete({ type: 'delete', keys: result, trans: trans }).then(function (res) {\n                                    if (res.numFailures > 0)\n                                        return Promise.reject(res.failures[0]);\n                                    if (result.length < limit) {\n                                        return { failures: [], numFailures: 0, lastResult: undefined };\n                                    }\n                                    else {\n                                        return deleteNextChunk(trans, __assign(__assign({}, range), { lower: result[result.length - 1], lowerOpen: true }), limit);\n                                    }\n                                });\n                            });\n                        }\n                    } });\n                return tableMiddleware;\n            } })); }\n    };\n    function getExistingValues(table, req, effectiveKeys) {\n        return req.type === \"add\"\n            ? Promise.resolve([])\n            : table.getMany({ trans: req.trans, keys: effectiveKeys, cache: \"immutable\" });\n    }\n\n    function getFromTransactionCache(keys, cache, clone) {\n        try {\n            if (!cache)\n                return null;\n            if (cache.keys.length < keys.length)\n                return null;\n            var result = [];\n            for (var i = 0, j = 0; i < cache.keys.length && j < keys.length; ++i) {\n                if (cmp(cache.keys[i], keys[j]) !== 0)\n                    continue;\n                result.push(clone ? deepClone(cache.values[i]) : cache.values[i]);\n                ++j;\n            }\n            return result.length === keys.length ? result : null;\n        }\n        catch (_a) {\n            return null;\n        }\n    }\n    var cacheExistingValuesMiddleware = {\n        stack: \"dbcore\",\n        level: -1,\n        create: function (core) {\n            return {\n                table: function (tableName) {\n                    var table = core.table(tableName);\n                    return __assign(__assign({}, table), { getMany: function (req) {\n                            if (!req.cache) {\n                                return table.getMany(req);\n                            }\n                            var cachedResult = getFromTransactionCache(req.keys, req.trans[\"_cache\"], req.cache === \"clone\");\n                            if (cachedResult) {\n                                return DexiePromise.resolve(cachedResult);\n                            }\n                            return table.getMany(req).then(function (res) {\n                                req.trans[\"_cache\"] = {\n                                    keys: req.keys,\n                                    values: req.cache === \"clone\" ? deepClone(res) : res,\n                                };\n                                return res;\n                            });\n                        }, mutate: function (req) {\n                            if (req.type !== \"add\")\n                                req.trans[\"_cache\"] = null;\n                            return table.mutate(req);\n                        } });\n                },\n            };\n        },\n    };\n\n    function isCachableContext(ctx, table) {\n        return (ctx.trans.mode === 'readonly' &&\n            !!ctx.subscr &&\n            !ctx.trans.explicit &&\n            ctx.trans.db._options.cache !== 'disabled' &&\n            !table.schema.primaryKey.outbound);\n    }\n\n    function isCachableRequest(type, req) {\n        switch (type) {\n            case 'query':\n                return req.values && !req.unique;\n            case 'get':\n                return false;\n            case 'getMany':\n                return false;\n            case 'count':\n                return false;\n            case 'openCursor':\n                return false;\n        }\n    }\n\n    var observabilityMiddleware = {\n        stack: \"dbcore\",\n        level: 0,\n        name: \"Observability\",\n        create: function (core) {\n            var dbName = core.schema.name;\n            var FULL_RANGE = new RangeSet(core.MIN_KEY, core.MAX_KEY);\n            return __assign(__assign({}, core), { transaction: function (stores, mode, options) {\n                    if (PSD.subscr && mode !== 'readonly') {\n                        throw new exceptions.ReadOnly(\"Readwrite transaction in liveQuery context. Querier source: \".concat(PSD.querier));\n                    }\n                    return core.transaction(stores, mode, options);\n                }, table: function (tableName) {\n                    var table = core.table(tableName);\n                    var schema = table.schema;\n                    var primaryKey = schema.primaryKey, indexes = schema.indexes;\n                    var extractKey = primaryKey.extractKey, outbound = primaryKey.outbound;\n                    var indexesWithAutoIncPK = primaryKey.autoIncrement && indexes.filter(function (index) { return index.compound && index.keyPath.includes(primaryKey.keyPath); });\n                    var tableClone = __assign(__assign({}, table), { mutate: function (req) {\n                            var _a, _b;\n                            var trans = req.trans;\n                            var mutatedParts = req.mutatedParts || (req.mutatedParts = {});\n                            var getRangeSet = function (indexName) {\n                                var part = \"idb://\".concat(dbName, \"/\").concat(tableName, \"/\").concat(indexName);\n                                return (mutatedParts[part] ||\n                                    (mutatedParts[part] = new RangeSet()));\n                            };\n                            var pkRangeSet = getRangeSet(\"\");\n                            var delsRangeSet = getRangeSet(\":dels\");\n                            var type = req.type;\n                            var _c = req.type === \"deleteRange\"\n                                ? [req.range]\n                                : req.type === \"delete\"\n                                    ? [req.keys]\n                                    : req.values.length < 50\n                                        ? [getEffectiveKeys(primaryKey, req).filter(function (id) { return id; }), req.values]\n                                        : [], keys = _c[0], newObjs = _c[1];\n                            var oldCache = req.trans[\"_cache\"];\n                            if (isArray(keys)) {\n                                pkRangeSet.addKeys(keys);\n                                var oldObjs = type === 'delete' || keys.length === newObjs.length ? getFromTransactionCache(keys, oldCache) : null;\n                                if (!oldObjs) {\n                                    delsRangeSet.addKeys(keys);\n                                }\n                                if (oldObjs || newObjs) {\n                                    trackAffectedIndexes(getRangeSet, schema, oldObjs, newObjs);\n                                }\n                            }\n                            else if (keys) {\n                                var range = {\n                                    from: (_a = keys.lower) !== null && _a !== void 0 ? _a : core.MIN_KEY,\n                                    to: (_b = keys.upper) !== null && _b !== void 0 ? _b : core.MAX_KEY\n                                };\n                                delsRangeSet.add(range);\n                                pkRangeSet.add(range);\n                            }\n                            else {\n                                pkRangeSet.add(FULL_RANGE);\n                                delsRangeSet.add(FULL_RANGE);\n                                schema.indexes.forEach(function (idx) { return getRangeSet(idx.name).add(FULL_RANGE); });\n                            }\n                            return table.mutate(req).then(function (res) {\n                                if (keys && (req.type === 'add' || req.type === 'put')) {\n                                    pkRangeSet.addKeys(res.results);\n                                    if (indexesWithAutoIncPK) {\n                                        indexesWithAutoIncPK.forEach(function (idx) {\n                                            var idxVals = req.values.map(function (v) { return idx.extractKey(v); });\n                                            var pkPos = idx.keyPath.findIndex(function (prop) { return prop === primaryKey.keyPath; });\n                                            for (var i = 0, len = res.results.length; i < len; ++i) {\n                                                idxVals[i][pkPos] = res.results[i];\n                                            }\n                                            getRangeSet(idx.name).addKeys(idxVals);\n                                        });\n                                    }\n                                }\n                                trans.mutatedParts = extendObservabilitySet(trans.mutatedParts || {}, mutatedParts);\n                                return res;\n                            });\n                        } });\n                    var getRange = function (_a) {\n                        var _b, _c;\n                        var _d = _a.query, index = _d.index, range = _d.range;\n                        return [\n                            index,\n                            new RangeSet((_b = range.lower) !== null && _b !== void 0 ? _b : core.MIN_KEY, (_c = range.upper) !== null && _c !== void 0 ? _c : core.MAX_KEY),\n                        ];\n                    };\n                    var readSubscribers = {\n                        get: function (req) { return [primaryKey, new RangeSet(req.key)]; },\n                        getMany: function (req) { return [primaryKey, new RangeSet().addKeys(req.keys)]; },\n                        count: getRange,\n                        query: getRange,\n                        openCursor: getRange,\n                    };\n                    keys(readSubscribers).forEach(function (method) {\n                        tableClone[method] = function (req) {\n                            var subscr = PSD.subscr;\n                            var isLiveQuery = !!subscr;\n                            var cachable = isCachableContext(PSD, table) && isCachableRequest(method, req);\n                            var obsSet = cachable\n                                ? req.obsSet = {}\n                                : subscr;\n                            if (isLiveQuery) {\n                                var getRangeSet = function (indexName) {\n                                    var part = \"idb://\".concat(dbName, \"/\").concat(tableName, \"/\").concat(indexName);\n                                    return (obsSet[part] ||\n                                        (obsSet[part] = new RangeSet()));\n                                };\n                                var pkRangeSet_1 = getRangeSet(\"\");\n                                var delsRangeSet_1 = getRangeSet(\":dels\");\n                                var _a = readSubscribers[method](req), queriedIndex = _a[0], queriedRanges = _a[1];\n                                if (method === 'query' && queriedIndex.isPrimaryKey && !req.values) {\n                                    delsRangeSet_1.add(queriedRanges);\n                                }\n                                else {\n                                    getRangeSet(queriedIndex.name || \"\").add(queriedRanges);\n                                }\n                                if (!queriedIndex.isPrimaryKey) {\n                                    if (method === \"count\") {\n                                        delsRangeSet_1.add(FULL_RANGE);\n                                    }\n                                    else {\n                                        var keysPromise_1 = method === \"query\" &&\n                                            outbound &&\n                                            req.values &&\n                                            table.query(__assign(__assign({}, req), { values: false }));\n                                        return table[method].apply(this, arguments).then(function (res) {\n                                            if (method === \"query\") {\n                                                if (outbound && req.values) {\n                                                    return keysPromise_1.then(function (_a) {\n                                                        var resultingKeys = _a.result;\n                                                        pkRangeSet_1.addKeys(resultingKeys);\n                                                        return res;\n                                                    });\n                                                }\n                                                var pKeys = req.values\n                                                    ? res.result.map(extractKey)\n                                                    : res.result;\n                                                if (req.values) {\n                                                    pkRangeSet_1.addKeys(pKeys);\n                                                }\n                                                else {\n                                                    delsRangeSet_1.addKeys(pKeys);\n                                                }\n                                            }\n                                            else if (method === \"openCursor\") {\n                                                var cursor_1 = res;\n                                                var wantValues_1 = req.values;\n                                                return (cursor_1 &&\n                                                    Object.create(cursor_1, {\n                                                        key: {\n                                                            get: function () {\n                                                                delsRangeSet_1.addKey(cursor_1.primaryKey);\n                                                                return cursor_1.key;\n                                                            },\n                                                        },\n                                                        primaryKey: {\n                                                            get: function () {\n                                                                var pkey = cursor_1.primaryKey;\n                                                                delsRangeSet_1.addKey(pkey);\n                                                                return pkey;\n                                                            },\n                                                        },\n                                                        value: {\n                                                            get: function () {\n                                                                wantValues_1 && pkRangeSet_1.addKey(cursor_1.primaryKey);\n                                                                return cursor_1.value;\n                                                            },\n                                                        },\n                                                    }));\n                                            }\n                                            return res;\n                                        });\n                                    }\n                                }\n                            }\n                            return table[method].apply(this, arguments);\n                        };\n                    });\n                    return tableClone;\n                } });\n        },\n    };\n    function trackAffectedIndexes(getRangeSet, schema, oldObjs, newObjs) {\n        function addAffectedIndex(ix) {\n            var rangeSet = getRangeSet(ix.name || \"\");\n            function extractKey(obj) {\n                return obj != null ? ix.extractKey(obj) : null;\n            }\n            var addKeyOrKeys = function (key) { return ix.multiEntry && isArray(key)\n                ? key.forEach(function (key) { return rangeSet.addKey(key); })\n                : rangeSet.addKey(key); };\n            (oldObjs || newObjs).forEach(function (_, i) {\n                var oldKey = oldObjs && extractKey(oldObjs[i]);\n                var newKey = newObjs && extractKey(newObjs[i]);\n                if (cmp(oldKey, newKey) !== 0) {\n                    if (oldKey != null)\n                        addKeyOrKeys(oldKey);\n                    if (newKey != null)\n                        addKeyOrKeys(newKey);\n                }\n            });\n        }\n        schema.indexes.forEach(addAffectedIndex);\n    }\n\n    function adjustOptimisticFromFailures(tblCache, req, res) {\n        if (res.numFailures === 0)\n            return req;\n        if (req.type === 'deleteRange') {\n            return null;\n        }\n        var numBulkOps = req.keys\n            ? req.keys.length\n            : 'values' in req && req.values\n                ? req.values.length\n                : 1;\n        if (res.numFailures === numBulkOps) {\n            return null;\n        }\n        var clone = __assign({}, req);\n        if (isArray(clone.keys)) {\n            clone.keys = clone.keys.filter(function (_, i) { return !(i in res.failures); });\n        }\n        if ('values' in clone && isArray(clone.values)) {\n            clone.values = clone.values.filter(function (_, i) { return !(i in res.failures); });\n        }\n        return clone;\n    }\n\n    function isAboveLower(key, range) {\n        return range.lower === undefined\n            ? true\n            : range.lowerOpen\n                ? cmp(key, range.lower) > 0\n                : cmp(key, range.lower) >= 0;\n    }\n    function isBelowUpper(key, range) {\n        return range.upper === undefined\n            ? true\n            : range.upperOpen\n                ? cmp(key, range.upper) < 0\n                : cmp(key, range.upper) <= 0;\n    }\n    function isWithinRange(key, range) {\n        return isAboveLower(key, range) && isBelowUpper(key, range);\n    }\n\n    function applyOptimisticOps(result, req, ops, table, cacheEntry, immutable) {\n        if (!ops || ops.length === 0)\n            return result;\n        var index = req.query.index;\n        var multiEntry = index.multiEntry;\n        var queryRange = req.query.range;\n        var primaryKey = table.schema.primaryKey;\n        var extractPrimKey = primaryKey.extractKey;\n        var extractIndex = index.extractKey;\n        var extractLowLevelIndex = (index.lowLevelIndex || index).extractKey;\n        var finalResult = ops.reduce(function (result, op) {\n            var modifedResult = result;\n            var includedValues = [];\n            if (op.type === 'add' || op.type === 'put') {\n                var includedPKs = new RangeSet();\n                for (var i = op.values.length - 1; i >= 0; --i) {\n                    var value = op.values[i];\n                    var pk = extractPrimKey(value);\n                    if (includedPKs.hasKey(pk))\n                        continue;\n                    var key = extractIndex(value);\n                    if (multiEntry && isArray(key)\n                        ? key.some(function (k) { return isWithinRange(k, queryRange); })\n                        : isWithinRange(key, queryRange)) {\n                        includedPKs.addKey(pk);\n                        includedValues.push(value);\n                    }\n                }\n            }\n            switch (op.type) {\n                case 'add': {\n                    var existingKeys_1 = new RangeSet().addKeys(req.values ? result.map(function (v) { return extractPrimKey(v); }) : result);\n                    modifedResult = result.concat(req.values\n                        ? includedValues.filter(function (v) {\n                            var key = extractPrimKey(v);\n                            if (existingKeys_1.hasKey(key))\n                                return false;\n                            existingKeys_1.addKey(key);\n                            return true;\n                        })\n                        : includedValues\n                            .map(function (v) { return extractPrimKey(v); })\n                            .filter(function (k) {\n                            if (existingKeys_1.hasKey(k))\n                                return false;\n                            existingKeys_1.addKey(k);\n                            return true;\n                        }));\n                    break;\n                }\n                case 'put': {\n                    var keySet_1 = new RangeSet().addKeys(op.values.map(function (v) { return extractPrimKey(v); }));\n                    modifedResult = result\n                        .filter(\n                    function (item) { return !keySet_1.hasKey(req.values ? extractPrimKey(item) : item); })\n                        .concat(\n                    req.values\n                        ? includedValues\n                        : includedValues.map(function (v) { return extractPrimKey(v); }));\n                    break;\n                }\n                case 'delete':\n                    var keysToDelete_1 = new RangeSet().addKeys(op.keys);\n                    modifedResult = result.filter(function (item) {\n                        return !keysToDelete_1.hasKey(req.values ? extractPrimKey(item) : item);\n                    });\n                    break;\n                case 'deleteRange':\n                    var range_1 = op.range;\n                    modifedResult = result.filter(function (item) { return !isWithinRange(extractPrimKey(item), range_1); });\n                    break;\n            }\n            return modifedResult;\n        }, result);\n        if (finalResult === result)\n            return result;\n        finalResult.sort(function (a, b) {\n            return cmp(extractLowLevelIndex(a), extractLowLevelIndex(b)) ||\n                cmp(extractPrimKey(a), extractPrimKey(b));\n        });\n        if (req.limit && req.limit < Infinity) {\n            if (finalResult.length > req.limit) {\n                finalResult.length = req.limit;\n            }\n            else if (result.length === req.limit && finalResult.length < req.limit) {\n                cacheEntry.dirty = true;\n            }\n        }\n        return immutable ? Object.freeze(finalResult) : finalResult;\n    }\n\n    function areRangesEqual(r1, r2) {\n        return (cmp(r1.lower, r2.lower) === 0 &&\n            cmp(r1.upper, r2.upper) === 0 &&\n            !!r1.lowerOpen === !!r2.lowerOpen &&\n            !!r1.upperOpen === !!r2.upperOpen);\n    }\n\n    function compareLowers(lower1, lower2, lowerOpen1, lowerOpen2) {\n        if (lower1 === undefined)\n            return lower2 !== undefined ? -1 : 0;\n        if (lower2 === undefined)\n            return 1;\n        var c = cmp(lower1, lower2);\n        if (c === 0) {\n            if (lowerOpen1 && lowerOpen2)\n                return 0;\n            if (lowerOpen1)\n                return 1;\n            if (lowerOpen2)\n                return -1;\n        }\n        return c;\n    }\n    function compareUppers(upper1, upper2, upperOpen1, upperOpen2) {\n        if (upper1 === undefined)\n            return upper2 !== undefined ? 1 : 0;\n        if (upper2 === undefined)\n            return -1;\n        var c = cmp(upper1, upper2);\n        if (c === 0) {\n            if (upperOpen1 && upperOpen2)\n                return 0;\n            if (upperOpen1)\n                return -1;\n            if (upperOpen2)\n                return 1;\n        }\n        return c;\n    }\n    function isSuperRange(r1, r2) {\n        return (compareLowers(r1.lower, r2.lower, r1.lowerOpen, r2.lowerOpen) <= 0 &&\n            compareUppers(r1.upper, r2.upper, r1.upperOpen, r2.upperOpen) >= 0);\n    }\n\n    function findCompatibleQuery(dbName, tableName, type, req) {\n        var tblCache = cache[\"idb://\".concat(dbName, \"/\").concat(tableName)];\n        if (!tblCache)\n            return [];\n        var queries = tblCache.queries[type];\n        if (!queries)\n            return [null, false, tblCache, null];\n        var indexName = req.query ? req.query.index.name : null;\n        var entries = queries[indexName || ''];\n        if (!entries)\n            return [null, false, tblCache, null];\n        switch (type) {\n            case 'query':\n                var equalEntry = entries.find(function (entry) {\n                    return entry.req.limit === req.limit &&\n                        entry.req.values === req.values &&\n                        areRangesEqual(entry.req.query.range, req.query.range);\n                });\n                if (equalEntry)\n                    return [\n                        equalEntry,\n                        true,\n                        tblCache,\n                        entries,\n                    ];\n                var superEntry = entries.find(function (entry) {\n                    var limit = 'limit' in entry.req ? entry.req.limit : Infinity;\n                    return (limit >= req.limit &&\n                        (req.values ? entry.req.values : true) &&\n                        isSuperRange(entry.req.query.range, req.query.range));\n                });\n                return [superEntry, false, tblCache, entries];\n            case 'count':\n                var countQuery = entries.find(function (entry) {\n                    return areRangesEqual(entry.req.query.range, req.query.range);\n                });\n                return [countQuery, !!countQuery, tblCache, entries];\n        }\n    }\n\n    function subscribeToCacheEntry(cacheEntry, container, requery, signal) {\n        cacheEntry.subscribers.add(requery);\n        signal.addEventListener(\"abort\", function () {\n            cacheEntry.subscribers.delete(requery);\n            if (cacheEntry.subscribers.size === 0) {\n                enqueForDeletion(cacheEntry, container);\n            }\n        });\n    }\n    function enqueForDeletion(cacheEntry, container) {\n        setTimeout(function () {\n            if (cacheEntry.subscribers.size === 0) {\n                delArrayItem(container, cacheEntry);\n            }\n        }, 3000);\n    }\n\n    var cacheMiddleware = {\n        stack: 'dbcore',\n        level: 0,\n        name: 'Cache',\n        create: function (core) {\n            var dbName = core.schema.name;\n            var coreMW = __assign(__assign({}, core), { transaction: function (stores, mode, options) {\n                    var idbtrans = core.transaction(stores, mode, options);\n                    if (mode === 'readwrite') {\n                        var ac_1 = new AbortController();\n                        var signal = ac_1.signal;\n                        var endTransaction = function (wasCommitted) { return function () {\n                            ac_1.abort();\n                            if (mode === 'readwrite') {\n                                var affectedSubscribers_1 = new Set();\n                                for (var _i = 0, stores_1 = stores; _i < stores_1.length; _i++) {\n                                    var storeName = stores_1[_i];\n                                    var tblCache = cache[\"idb://\".concat(dbName, \"/\").concat(storeName)];\n                                    if (tblCache) {\n                                        var table = core.table(storeName);\n                                        var ops = tblCache.optimisticOps.filter(function (op) { return op.trans === idbtrans; });\n                                        if (idbtrans._explicit && wasCommitted && idbtrans.mutatedParts) {\n                                            for (var _a = 0, _b = Object.values(tblCache.queries.query); _a < _b.length; _a++) {\n                                                var entries = _b[_a];\n                                                for (var _c = 0, _d = entries.slice(); _c < _d.length; _c++) {\n                                                    var entry = _d[_c];\n                                                    if (obsSetsOverlap(entry.obsSet, idbtrans.mutatedParts)) {\n                                                        delArrayItem(entries, entry);\n                                                        entry.subscribers.forEach(function (requery) { return affectedSubscribers_1.add(requery); });\n                                                    }\n                                                }\n                                            }\n                                        }\n                                        else if (ops.length > 0) {\n                                            tblCache.optimisticOps = tblCache.optimisticOps.filter(function (op) { return op.trans !== idbtrans; });\n                                            for (var _e = 0, _f = Object.values(tblCache.queries.query); _e < _f.length; _e++) {\n                                                var entries = _f[_e];\n                                                for (var _g = 0, _h = entries.slice(); _g < _h.length; _g++) {\n                                                    var entry = _h[_g];\n                                                    if (entry.res != null &&\n                                                        idbtrans.mutatedParts\n    ) {\n                                                        if (wasCommitted && !entry.dirty) {\n                                                            var freezeResults = Object.isFrozen(entry.res);\n                                                            var modRes = applyOptimisticOps(entry.res, entry.req, ops, table, entry, freezeResults);\n                                                            if (entry.dirty) {\n                                                                delArrayItem(entries, entry);\n                                                                entry.subscribers.forEach(function (requery) { return affectedSubscribers_1.add(requery); });\n                                                            }\n                                                            else if (modRes !== entry.res) {\n                                                                entry.res = modRes;\n                                                                entry.promise = DexiePromise.resolve({ result: modRes });\n                                                            }\n                                                        }\n                                                        else {\n                                                            if (entry.dirty) {\n                                                                delArrayItem(entries, entry);\n                                                            }\n                                                            entry.subscribers.forEach(function (requery) { return affectedSubscribers_1.add(requery); });\n                                                        }\n                                                    }\n                                                }\n                                            }\n                                        }\n                                    }\n                                }\n                                affectedSubscribers_1.forEach(function (requery) { return requery(); });\n                            }\n                        }; };\n                        idbtrans.addEventListener('abort', endTransaction(false), {\n                            signal: signal,\n                        });\n                        idbtrans.addEventListener('error', endTransaction(false), {\n                            signal: signal,\n                        });\n                        idbtrans.addEventListener('complete', endTransaction(true), {\n                            signal: signal,\n                        });\n                    }\n                    return idbtrans;\n                }, table: function (tableName) {\n                    var downTable = core.table(tableName);\n                    var primKey = downTable.schema.primaryKey;\n                    var tableMW = __assign(__assign({}, downTable), { mutate: function (req) {\n                            var trans = PSD.trans;\n                            if (primKey.outbound ||\n                                trans.db._options.cache === 'disabled' ||\n                                trans.explicit ||\n                                trans.idbtrans.mode !== 'readwrite'\n                            ) {\n                                return downTable.mutate(req);\n                            }\n                            var tblCache = cache[\"idb://\".concat(dbName, \"/\").concat(tableName)];\n                            if (!tblCache)\n                                return downTable.mutate(req);\n                            var promise = downTable.mutate(req);\n                            if ((req.type === 'add' || req.type === 'put') && (req.values.length >= 50 || getEffectiveKeys(primKey, req).some(function (key) { return key == null; }))) {\n                                promise.then(function (res) {\n                                    var reqWithResolvedKeys = __assign(__assign({}, req), { values: req.values.map(function (value, i) {\n                                            var _a;\n                                            if (res.failures[i])\n                                                return value;\n                                            var valueWithKey = ((_a = primKey.keyPath) === null || _a === void 0 ? void 0 : _a.includes('.'))\n                                                ? deepClone(value)\n                                                : __assign({}, value);\n                                            setByKeyPath(valueWithKey, primKey.keyPath, res.results[i]);\n                                            return valueWithKey;\n                                        }) });\n                                    var adjustedReq = adjustOptimisticFromFailures(tblCache, reqWithResolvedKeys, res);\n                                    tblCache.optimisticOps.push(adjustedReq);\n                                    queueMicrotask(function () { return req.mutatedParts && signalSubscribersLazily(req.mutatedParts); });\n                                });\n                            }\n                            else {\n                                tblCache.optimisticOps.push(req);\n                                req.mutatedParts && signalSubscribersLazily(req.mutatedParts);\n                                promise.then(function (res) {\n                                    if (res.numFailures > 0) {\n                                        delArrayItem(tblCache.optimisticOps, req);\n                                        var adjustedReq = adjustOptimisticFromFailures(tblCache, req, res);\n                                        if (adjustedReq) {\n                                            tblCache.optimisticOps.push(adjustedReq);\n                                        }\n                                        req.mutatedParts && signalSubscribersLazily(req.mutatedParts);\n                                    }\n                                });\n                                promise.catch(function () {\n                                    delArrayItem(tblCache.optimisticOps, req);\n                                    req.mutatedParts && signalSubscribersLazily(req.mutatedParts);\n                                });\n                            }\n                            return promise;\n                        }, query: function (req) {\n                            var _a;\n                            if (!isCachableContext(PSD, downTable) || !isCachableRequest(\"query\", req))\n                                return downTable.query(req);\n                            var freezeResults = ((_a = PSD.trans) === null || _a === void 0 ? void 0 : _a.db._options.cache) === 'immutable';\n                            var _b = PSD, requery = _b.requery, signal = _b.signal;\n                            var _c = findCompatibleQuery(dbName, tableName, 'query', req), cacheEntry = _c[0], exactMatch = _c[1], tblCache = _c[2], container = _c[3];\n                            if (cacheEntry && exactMatch) {\n                                cacheEntry.obsSet = req.obsSet;\n                            }\n                            else {\n                                var promise = downTable.query(req).then(function (res) {\n                                    var result = res.result;\n                                    if (cacheEntry)\n                                        cacheEntry.res = result;\n                                    if (freezeResults) {\n                                        for (var i = 0, l = result.length; i < l; ++i) {\n                                            Object.freeze(result[i]);\n                                        }\n                                        Object.freeze(result);\n                                    }\n                                    else {\n                                        res.result = deepClone(result);\n                                    }\n                                    return res;\n                                }).catch(function (error) {\n                                    if (container && cacheEntry)\n                                        delArrayItem(container, cacheEntry);\n                                    return Promise.reject(error);\n                                });\n                                cacheEntry = {\n                                    obsSet: req.obsSet,\n                                    promise: promise,\n                                    subscribers: new Set(),\n                                    type: 'query',\n                                    req: req,\n                                    dirty: false,\n                                };\n                                if (container) {\n                                    container.push(cacheEntry);\n                                }\n                                else {\n                                    container = [cacheEntry];\n                                    if (!tblCache) {\n                                        tblCache = cache[\"idb://\".concat(dbName, \"/\").concat(tableName)] = {\n                                            queries: {\n                                                query: {},\n                                                count: {},\n                                            },\n                                            objs: new Map(),\n                                            optimisticOps: [],\n                                            unsignaledParts: {}\n                                        };\n                                    }\n                                    tblCache.queries.query[req.query.index.name || ''] = container;\n                                }\n                            }\n                            subscribeToCacheEntry(cacheEntry, container, requery, signal);\n                            return cacheEntry.promise.then(function (res) {\n                                return {\n                                    result: applyOptimisticOps(res.result, req, tblCache === null || tblCache === void 0 ? void 0 : tblCache.optimisticOps, downTable, cacheEntry, freezeResults),\n                                };\n                            });\n                        } });\n                    return tableMW;\n                } });\n            return coreMW;\n        },\n    };\n\n    function vipify(target, vipDb) {\n        return new Proxy(target, {\n            get: function (target, prop, receiver) {\n                if (prop === 'db')\n                    return vipDb;\n                return Reflect.get(target, prop, receiver);\n            }\n        });\n    }\n\n    var Dexie$1 =  (function () {\n        function Dexie(name, options) {\n            var _this = this;\n            this._middlewares = {};\n            this.verno = 0;\n            var deps = Dexie.dependencies;\n            this._options = options = __assign({\n                addons: Dexie.addons, autoOpen: true,\n                indexedDB: deps.indexedDB, IDBKeyRange: deps.IDBKeyRange, cache: 'cloned' }, options);\n            this._deps = {\n                indexedDB: options.indexedDB,\n                IDBKeyRange: options.IDBKeyRange\n            };\n            var addons = options.addons;\n            this._dbSchema = {};\n            this._versions = [];\n            this._storeNames = [];\n            this._allTables = {};\n            this.idbdb = null;\n            this._novip = this;\n            var state = {\n                dbOpenError: null,\n                isBeingOpened: false,\n                onReadyBeingFired: null,\n                openComplete: false,\n                dbReadyResolve: nop,\n                dbReadyPromise: null,\n                cancelOpen: nop,\n                openCanceller: null,\n                autoSchema: true,\n                PR1398_maxLoop: 3,\n                autoOpen: options.autoOpen,\n            };\n            state.dbReadyPromise = new DexiePromise(function (resolve) {\n                state.dbReadyResolve = resolve;\n            });\n            state.openCanceller = new DexiePromise(function (_, reject) {\n                state.cancelOpen = reject;\n            });\n            this._state = state;\n            this.name = name;\n            this.on = Events(this, \"populate\", \"blocked\", \"versionchange\", \"close\", { ready: [promisableChain, nop] });\n            this.once = function (event, callback) {\n                var fn = function () {\n                    var args = [];\n                    for (var _i = 0; _i < arguments.length; _i++) {\n                        args[_i] = arguments[_i];\n                    }\n                    _this.on(event).unsubscribe(fn);\n                    callback.apply(_this, args);\n                };\n                return _this.on(event, fn);\n            };\n            this.on.ready.subscribe = override(this.on.ready.subscribe, function (subscribe) {\n                return function (subscriber, bSticky) {\n                    Dexie.vip(function () {\n                        var state = _this._state;\n                        if (state.openComplete) {\n                            if (!state.dbOpenError)\n                                DexiePromise.resolve().then(subscriber);\n                            if (bSticky)\n                                subscribe(subscriber);\n                        }\n                        else if (state.onReadyBeingFired) {\n                            state.onReadyBeingFired.push(subscriber);\n                            if (bSticky)\n                                subscribe(subscriber);\n                        }\n                        else {\n                            subscribe(subscriber);\n                            var db_1 = _this;\n                            if (!bSticky)\n                                subscribe(function unsubscribe() {\n                                    db_1.on.ready.unsubscribe(subscriber);\n                                    db_1.on.ready.unsubscribe(unsubscribe);\n                                });\n                        }\n                    });\n                };\n            });\n            this.Collection = createCollectionConstructor(this);\n            this.Table = createTableConstructor(this);\n            this.Transaction = createTransactionConstructor(this);\n            this.Version = createVersionConstructor(this);\n            this.WhereClause = createWhereClauseConstructor(this);\n            this.on(\"versionchange\", function (ev) {\n                if (ev.newVersion > 0)\n                    console.warn(\"Another connection wants to upgrade database '\".concat(_this.name, \"'. Closing db now to resume the upgrade.\"));\n                else\n                    console.warn(\"Another connection wants to delete database '\".concat(_this.name, \"'. Closing db now to resume the delete request.\"));\n                _this.close({ disableAutoOpen: false });\n            });\n            this.on(\"blocked\", function (ev) {\n                if (!ev.newVersion || ev.newVersion < ev.oldVersion)\n                    console.warn(\"Dexie.delete('\".concat(_this.name, \"') was blocked\"));\n                else\n                    console.warn(\"Upgrade '\".concat(_this.name, \"' blocked by other connection holding version \").concat(ev.oldVersion / 10));\n            });\n            this._maxKey = getMaxKey(options.IDBKeyRange);\n            this._createTransaction = function (mode, storeNames, dbschema, parentTransaction) { return new _this.Transaction(mode, storeNames, dbschema, _this._options.chromeTransactionDurability, parentTransaction); };\n            this._fireOnBlocked = function (ev) {\n                _this.on(\"blocked\").fire(ev);\n                connections\n                    .filter(function (c) { return c.name === _this.name && c !== _this && !c._state.vcFired; })\n                    .map(function (c) { return c.on(\"versionchange\").fire(ev); });\n            };\n            this.use(cacheExistingValuesMiddleware);\n            this.use(cacheMiddleware);\n            this.use(observabilityMiddleware);\n            this.use(virtualIndexMiddleware);\n            this.use(hooksMiddleware);\n            var vipDB = new Proxy(this, {\n                get: function (_, prop, receiver) {\n                    if (prop === '_vip')\n                        return true;\n                    if (prop === 'table')\n                        return function (tableName) { return vipify(_this.table(tableName), vipDB); };\n                    var rv = Reflect.get(_, prop, receiver);\n                    if (rv instanceof Table)\n                        return vipify(rv, vipDB);\n                    if (prop === 'tables')\n                        return rv.map(function (t) { return vipify(t, vipDB); });\n                    if (prop === '_createTransaction')\n                        return function () {\n                            var tx = rv.apply(this, arguments);\n                            return vipify(tx, vipDB);\n                        };\n                    return rv;\n                }\n            });\n            this.vip = vipDB;\n            addons.forEach(function (addon) { return addon(_this); });\n        }\n        Dexie.prototype.version = function (versionNumber) {\n            if (isNaN(versionNumber) || versionNumber < 0.1)\n                throw new exceptions.Type(\"Given version is not a positive number\");\n            versionNumber = Math.round(versionNumber * 10) / 10;\n            if (this.idbdb || this._state.isBeingOpened)\n                throw new exceptions.Schema(\"Cannot add version when database is open\");\n            this.verno = Math.max(this.verno, versionNumber);\n            var versions = this._versions;\n            var versionInstance = versions.filter(function (v) { return v._cfg.version === versionNumber; })[0];\n            if (versionInstance)\n                return versionInstance;\n            versionInstance = new this.Version(versionNumber);\n            versions.push(versionInstance);\n            versions.sort(lowerVersionFirst);\n            versionInstance.stores({});\n            this._state.autoSchema = false;\n            return versionInstance;\n        };\n        Dexie.prototype._whenReady = function (fn) {\n            var _this = this;\n            return (this.idbdb && (this._state.openComplete || PSD.letThrough || this._vip)) ? fn() : new DexiePromise(function (resolve, reject) {\n                if (_this._state.openComplete) {\n                    return reject(new exceptions.DatabaseClosed(_this._state.dbOpenError));\n                }\n                if (!_this._state.isBeingOpened) {\n                    if (!_this._state.autoOpen) {\n                        reject(new exceptions.DatabaseClosed());\n                        return;\n                    }\n                    _this.open().catch(nop);\n                }\n                _this._state.dbReadyPromise.then(resolve, reject);\n            }).then(fn);\n        };\n        Dexie.prototype.use = function (_a) {\n            var stack = _a.stack, create = _a.create, level = _a.level, name = _a.name;\n            if (name)\n                this.unuse({ stack: stack, name: name });\n            var middlewares = this._middlewares[stack] || (this._middlewares[stack] = []);\n            middlewares.push({ stack: stack, create: create, level: level == null ? 10 : level, name: name });\n            middlewares.sort(function (a, b) { return a.level - b.level; });\n            return this;\n        };\n        Dexie.prototype.unuse = function (_a) {\n            var stack = _a.stack, name = _a.name, create = _a.create;\n            if (stack && this._middlewares[stack]) {\n                this._middlewares[stack] = this._middlewares[stack].filter(function (mw) {\n                    return create ? mw.create !== create :\n                        name ? mw.name !== name :\n                            false;\n                });\n            }\n            return this;\n        };\n        Dexie.prototype.open = function () {\n            var _this = this;\n            return usePSD(globalPSD,\n            function () { return dexieOpen(_this); });\n        };\n        Dexie.prototype._close = function () {\n            this.on.close.fire(new CustomEvent('close'));\n            var state = this._state;\n            var idx = connections.indexOf(this);\n            if (idx >= 0)\n                connections.splice(idx, 1);\n            if (this.idbdb) {\n                try {\n                    this.idbdb.close();\n                }\n                catch (e) { }\n                this.idbdb = null;\n            }\n            if (!state.isBeingOpened) {\n                state.dbReadyPromise = new DexiePromise(function (resolve) {\n                    state.dbReadyResolve = resolve;\n                });\n                state.openCanceller = new DexiePromise(function (_, reject) {\n                    state.cancelOpen = reject;\n                });\n            }\n        };\n        Dexie.prototype.close = function (_a) {\n            var _b = _a === void 0 ? { disableAutoOpen: true } : _a, disableAutoOpen = _b.disableAutoOpen;\n            var state = this._state;\n            if (disableAutoOpen) {\n                if (state.isBeingOpened) {\n                    state.cancelOpen(new exceptions.DatabaseClosed());\n                }\n                this._close();\n                state.autoOpen = false;\n                state.dbOpenError = new exceptions.DatabaseClosed();\n            }\n            else {\n                this._close();\n                state.autoOpen = this._options.autoOpen ||\n                    state.isBeingOpened;\n                state.openComplete = false;\n                state.dbOpenError = null;\n            }\n        };\n        Dexie.prototype.delete = function (closeOptions) {\n            var _this = this;\n            if (closeOptions === void 0) { closeOptions = { disableAutoOpen: true }; }\n            var hasInvalidArguments = arguments.length > 0 && typeof arguments[0] !== 'object';\n            var state = this._state;\n            return new DexiePromise(function (resolve, reject) {\n                var doDelete = function () {\n                    _this.close(closeOptions);\n                    var req = _this._deps.indexedDB.deleteDatabase(_this.name);\n                    req.onsuccess = wrap(function () {\n                        _onDatabaseDeleted(_this._deps, _this.name);\n                        resolve();\n                    });\n                    req.onerror = eventRejectHandler(reject);\n                    req.onblocked = _this._fireOnBlocked;\n                };\n                if (hasInvalidArguments)\n                    throw new exceptions.InvalidArgument(\"Invalid closeOptions argument to db.delete()\");\n                if (state.isBeingOpened) {\n                    state.dbReadyPromise.then(doDelete);\n                }\n                else {\n                    doDelete();\n                }\n            });\n        };\n        Dexie.prototype.backendDB = function () {\n            return this.idbdb;\n        };\n        Dexie.prototype.isOpen = function () {\n            return this.idbdb !== null;\n        };\n        Dexie.prototype.hasBeenClosed = function () {\n            var dbOpenError = this._state.dbOpenError;\n            return dbOpenError && (dbOpenError.name === 'DatabaseClosed');\n        };\n        Dexie.prototype.hasFailed = function () {\n            return this._state.dbOpenError !== null;\n        };\n        Dexie.prototype.dynamicallyOpened = function () {\n            return this._state.autoSchema;\n        };\n        Object.defineProperty(Dexie.prototype, \"tables\", {\n            get: function () {\n                var _this = this;\n                return keys(this._allTables).map(function (name) { return _this._allTables[name]; });\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Dexie.prototype.transaction = function () {\n            var args = extractTransactionArgs.apply(this, arguments);\n            return this._transaction.apply(this, args);\n        };\n        Dexie.prototype._transaction = function (mode, tables, scopeFunc) {\n            var _this = this;\n            var parentTransaction = PSD.trans;\n            if (!parentTransaction || parentTransaction.db !== this || mode.indexOf('!') !== -1)\n                parentTransaction = null;\n            var onlyIfCompatible = mode.indexOf('?') !== -1;\n            mode = mode.replace('!', '').replace('?', '');\n            var idbMode, storeNames;\n            try {\n                storeNames = tables.map(function (table) {\n                    var storeName = table instanceof _this.Table ? table.name : table;\n                    if (typeof storeName !== 'string')\n                        throw new TypeError(\"Invalid table argument to Dexie.transaction(). Only Table or String are allowed\");\n                    return storeName;\n                });\n                if (mode == \"r\" || mode === READONLY)\n                    idbMode = READONLY;\n                else if (mode == \"rw\" || mode == READWRITE)\n                    idbMode = READWRITE;\n                else\n                    throw new exceptions.InvalidArgument(\"Invalid transaction mode: \" + mode);\n                if (parentTransaction) {\n                    if (parentTransaction.mode === READONLY && idbMode === READWRITE) {\n                        if (onlyIfCompatible) {\n                            parentTransaction = null;\n                        }\n                        else\n                            throw new exceptions.SubTransaction(\"Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY\");\n                    }\n                    if (parentTransaction) {\n                        storeNames.forEach(function (storeName) {\n                            if (parentTransaction && parentTransaction.storeNames.indexOf(storeName) === -1) {\n                                if (onlyIfCompatible) {\n                                    parentTransaction = null;\n                                }\n                                else\n                                    throw new exceptions.SubTransaction(\"Table \" + storeName +\n                                        \" not included in parent transaction.\");\n                            }\n                        });\n                    }\n                    if (onlyIfCompatible && parentTransaction && !parentTransaction.active) {\n                        parentTransaction = null;\n                    }\n                }\n            }\n            catch (e) {\n                return parentTransaction ?\n                    parentTransaction._promise(null, function (_, reject) { reject(e); }) :\n                    rejection(e);\n            }\n            var enterTransaction = enterTransactionScope.bind(null, this, idbMode, storeNames, parentTransaction, scopeFunc);\n            return (parentTransaction ?\n                parentTransaction._promise(idbMode, enterTransaction, \"lock\") :\n                PSD.trans ?\n                    usePSD(PSD.transless, function () { return _this._whenReady(enterTransaction); }) :\n                    this._whenReady(enterTransaction));\n        };\n        Dexie.prototype.table = function (tableName) {\n            if (!hasOwn(this._allTables, tableName)) {\n                throw new exceptions.InvalidTable(\"Table \".concat(tableName, \" does not exist\"));\n            }\n            return this._allTables[tableName];\n        };\n        return Dexie;\n    }());\n\n    var symbolObservable = typeof Symbol !== \"undefined\" && \"observable\" in Symbol\n        ? Symbol.observable\n        : \"@@observable\";\n    var Observable =  (function () {\n        function Observable(subscribe) {\n            this._subscribe = subscribe;\n        }\n        Observable.prototype.subscribe = function (x, error, complete) {\n            return this._subscribe(!x || typeof x === \"function\" ? { next: x, error: error, complete: complete } : x);\n        };\n        Observable.prototype[symbolObservable] = function () {\n            return this;\n        };\n        return Observable;\n    }());\n\n    var domDeps;\n    try {\n        domDeps = {\n            indexedDB: _global.indexedDB || _global.mozIndexedDB || _global.webkitIndexedDB || _global.msIndexedDB,\n            IDBKeyRange: _global.IDBKeyRange || _global.webkitIDBKeyRange\n        };\n    }\n    catch (e) {\n        domDeps = { indexedDB: null, IDBKeyRange: null };\n    }\n\n    function liveQuery(querier) {\n        var hasValue = false;\n        var currentValue;\n        var observable = new Observable(function (observer) {\n            var scopeFuncIsAsync = isAsyncFunction(querier);\n            function execute(ctx) {\n                var wasRootExec = beginMicroTickScope();\n                try {\n                    if (scopeFuncIsAsync) {\n                        incrementExpectedAwaits();\n                    }\n                    var rv = newScope(querier, ctx);\n                    if (scopeFuncIsAsync) {\n                        rv = rv.finally(decrementExpectedAwaits);\n                    }\n                    return rv;\n                }\n                finally {\n                    wasRootExec && endMicroTickScope();\n                }\n            }\n            var closed = false;\n            var abortController;\n            var accumMuts = {};\n            var currentObs = {};\n            var subscription = {\n                get closed() {\n                    return closed;\n                },\n                unsubscribe: function () {\n                    if (closed)\n                        return;\n                    closed = true;\n                    if (abortController)\n                        abortController.abort();\n                    if (startedListening)\n                        globalEvents.storagemutated.unsubscribe(mutationListener);\n                },\n            };\n            observer.start && observer.start(subscription);\n            var startedListening = false;\n            var doQuery = function () { return execInGlobalContext(_doQuery); };\n            function shouldNotify() {\n                return obsSetsOverlap(currentObs, accumMuts);\n            }\n            var mutationListener = function (parts) {\n                extendObservabilitySet(accumMuts, parts);\n                if (shouldNotify()) {\n                    doQuery();\n                }\n            };\n            var _doQuery = function () {\n                if (closed ||\n                    !domDeps.indexedDB)\n                 {\n                    return;\n                }\n                accumMuts = {};\n                var subscr = {};\n                if (abortController)\n                    abortController.abort();\n                abortController = new AbortController();\n                var ctx = {\n                    subscr: subscr,\n                    signal: abortController.signal,\n                    requery: doQuery,\n                    querier: querier,\n                    trans: null\n                };\n                var ret = execute(ctx);\n                Promise.resolve(ret).then(function (result) {\n                    hasValue = true;\n                    currentValue = result;\n                    if (closed || ctx.signal.aborted) {\n                        return;\n                    }\n                    accumMuts = {};\n                    currentObs = subscr;\n                    if (!objectIsEmpty(currentObs) && !startedListening) {\n                        globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, mutationListener);\n                        startedListening = true;\n                    }\n                    execInGlobalContext(function () { return !closed && observer.next && observer.next(result); });\n                }, function (err) {\n                    hasValue = false;\n                    if (!['DatabaseClosedError', 'AbortError'].includes(err === null || err === void 0 ? void 0 : err.name)) {\n                        if (!closed)\n                            execInGlobalContext(function () {\n                                if (closed)\n                                    return;\n                                observer.error && observer.error(err);\n                            });\n                    }\n                });\n            };\n            setTimeout(doQuery, 0);\n            return subscription;\n        });\n        observable.hasValue = function () { return hasValue; };\n        observable.getValue = function () { return currentValue; };\n        return observable;\n    }\n\n    var Dexie = Dexie$1;\n    props(Dexie, __assign(__assign({}, fullNameExceptions), {\n        delete: function (databaseName) {\n            var db = new Dexie(databaseName, { addons: [] });\n            return db.delete();\n        },\n        exists: function (name) {\n            return new Dexie(name, { addons: [] }).open().then(function (db) {\n                db.close();\n                return true;\n            }).catch('NoSuchDatabaseError', function () { return false; });\n        },\n        getDatabaseNames: function (cb) {\n            try {\n                return getDatabaseNames(Dexie.dependencies).then(cb);\n            }\n            catch (_a) {\n                return rejection(new exceptions.MissingAPI());\n            }\n        },\n        defineClass: function () {\n            function Class(content) {\n                extend(this, content);\n            }\n            return Class;\n        }, ignoreTransaction: function (scopeFunc) {\n            return PSD.trans ?\n                usePSD(PSD.transless, scopeFunc) :\n                scopeFunc();\n        }, vip: vip, async: function (generatorFn) {\n            return function () {\n                try {\n                    var rv = awaitIterator(generatorFn.apply(this, arguments));\n                    if (!rv || typeof rv.then !== 'function')\n                        return DexiePromise.resolve(rv);\n                    return rv;\n                }\n                catch (e) {\n                    return rejection(e);\n                }\n            };\n        }, spawn: function (generatorFn, args, thiz) {\n            try {\n                var rv = awaitIterator(generatorFn.apply(thiz, args || []));\n                if (!rv || typeof rv.then !== 'function')\n                    return DexiePromise.resolve(rv);\n                return rv;\n            }\n            catch (e) {\n                return rejection(e);\n            }\n        },\n        currentTransaction: {\n            get: function () { return PSD.trans || null; }\n        }, waitFor: function (promiseOrFunction, optionalTimeout) {\n            var promise = DexiePromise.resolve(typeof promiseOrFunction === 'function' ?\n                Dexie.ignoreTransaction(promiseOrFunction) :\n                promiseOrFunction)\n                .timeout(optionalTimeout || 60000);\n            return PSD.trans ?\n                PSD.trans.waitFor(promise) :\n                promise;\n        },\n        Promise: DexiePromise,\n        debug: {\n            get: function () { return debug; },\n            set: function (value) {\n                setDebug(value);\n            }\n        },\n        derive: derive, extend: extend, props: props, override: override,\n        Events: Events, on: globalEvents, liveQuery: liveQuery, extendObservabilitySet: extendObservabilitySet,\n        getByKeyPath: getByKeyPath, setByKeyPath: setByKeyPath, delByKeyPath: delByKeyPath, shallowClone: shallowClone, deepClone: deepClone, getObjectDiff: getObjectDiff, cmp: cmp, asap: asap$1,\n        minKey: minKey,\n        addons: [],\n        connections: connections,\n        errnames: errnames,\n        dependencies: domDeps, cache: cache,\n        semVer: DEXIE_VERSION, version: DEXIE_VERSION.split('.')\n            .map(function (n) { return parseInt(n); })\n            .reduce(function (p, c, i) { return p + (c / Math.pow(10, i * 2)); }) }));\n    Dexie.maxKey = getMaxKey(Dexie.dependencies.IDBKeyRange);\n\n    if (typeof dispatchEvent !== 'undefined' && typeof addEventListener !== 'undefined') {\n        globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, function (updatedParts) {\n            if (!propagatingLocally) {\n                var event_1;\n                event_1 = new CustomEvent(STORAGE_MUTATED_DOM_EVENT_NAME, {\n                    detail: updatedParts\n                });\n                propagatingLocally = true;\n                dispatchEvent(event_1);\n                propagatingLocally = false;\n            }\n        });\n        addEventListener(STORAGE_MUTATED_DOM_EVENT_NAME, function (_a) {\n            var detail = _a.detail;\n            if (!propagatingLocally) {\n                propagateLocally(detail);\n            }\n        });\n    }\n    function propagateLocally(updateParts) {\n        var wasMe = propagatingLocally;\n        try {\n            propagatingLocally = true;\n            globalEvents.storagemutated.fire(updateParts);\n            signalSubscribersNow(updateParts, true);\n        }\n        finally {\n            propagatingLocally = wasMe;\n        }\n    }\n    var propagatingLocally = false;\n\n    var bc;\n    var createBC = function () { };\n    if (typeof BroadcastChannel !== 'undefined') {\n        createBC = function () {\n            bc = new BroadcastChannel(STORAGE_MUTATED_DOM_EVENT_NAME);\n            bc.onmessage = function (ev) { return ev.data && propagateLocally(ev.data); };\n        };\n        createBC();\n        if (typeof bc.unref === 'function') {\n            bc.unref();\n        }\n        globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, function (changedParts) {\n            if (!propagatingLocally) {\n                bc.postMessage(changedParts);\n            }\n        });\n    }\n\n    if (typeof addEventListener !== 'undefined') {\n        addEventListener('pagehide', function (event) {\n            if (!Dexie$1.disableBfCache && event.persisted) {\n                if (debug)\n                    console.debug('Dexie: handling persisted pagehide');\n                bc === null || bc === void 0 ? void 0 : bc.close();\n                for (var _i = 0, connections_1 = connections; _i < connections_1.length; _i++) {\n                    var db = connections_1[_i];\n                    db.close({ disableAutoOpen: false });\n                }\n            }\n        });\n        addEventListener('pageshow', function (event) {\n            if (!Dexie$1.disableBfCache && event.persisted) {\n                if (debug)\n                    console.debug('Dexie: handling persisted pageshow');\n                createBC();\n                propagateLocally({ all: new RangeSet(-Infinity, [[]]) });\n            }\n        });\n    }\n\n    function add(value) {\n        return new PropModification({ add: value });\n    }\n\n    function remove(value) {\n        return new PropModification({ remove: value });\n    }\n\n    function replacePrefix(a, b) {\n        return new PropModification({ replacePrefix: [a, b] });\n    }\n\n    DexiePromise.rejectionMapper = mapError;\n    setDebug(debug);\n\n    var namedExports = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        Dexie: Dexie$1,\n        liveQuery: liveQuery,\n        Entity: Entity,\n        cmp: cmp,\n        PropModification: PropModification,\n        replacePrefix: replacePrefix,\n        add: add,\n        remove: remove,\n        'default': Dexie$1,\n        RangeSet: RangeSet,\n        mergeRanges: mergeRanges,\n        rangesOverlap: rangesOverlap\n    });\n\n    __assign(Dexie$1, namedExports, { default: Dexie$1 });\n\n    return Dexie$1;\n\n}));\n//# sourceMappingURL=dexie.js.map\n","// Making the module version consumable via require - to prohibit\n// multiple occurrancies of the same module in the same app\n// (dual package hazard, https://nodejs.org/api/packages.html#dual-package-hazard)\nimport _Dexie from \"./dist/dexie.js\";\nconst DexieSymbol = Symbol.for(\"Dexie\");\nconst Dexie = globalThis[DexieSymbol] || (globalThis[DexieSymbol] = _Dexie);\nif (_Dexie.semVer !== Dexie.semVer) {\n    throw new Error(`Two different versions of Dexie loaded in the same app: ${_Dexie.semVer} and ${Dexie.semVer}`);\n}\nconst { liveQuery, mergeRanges, rangesOverlap, RangeSet, cmp, Entity,\n    PropModification, replacePrefix, add, remove,\n    DexieYProvider } = Dexie;\nexport { liveQuery, mergeRanges, rangesOverlap, RangeSet, cmp, Dexie, Entity,\n    PropModification, replacePrefix, add, remove,\n    DexieYProvider};\n    \nexport default Dexie;\n","// IndexedDB database using Dexie.js\n// This provides a structured, indexed storage layer for bookmarks and enrichment data\n\nimport Dexie from 'dexie';\n\n// Initialize Dexie database\nexport const db = new Dexie('BookmarkInsightsDB');\n\n// Define schema version 1\ndb.version(1).stores({\n  bookmarks: 'id, url, title, domain, category, dateAdded, lastAccessed, lastChecked, isAlive, parentId',\n  enrichmentQueue: '++queueId, bookmarkId, addedAt, priority',\n  events: '++eventId, bookmarkId, type, timestamp',\n  cache: 'key',\n  settings: 'key'\n});\n\n// Schema version 2: Add rawMetadata field for comprehensive data storage\ndb.version(2).stores({\n  bookmarks: 'id, url, title, domain, category, dateAdded, lastAccessed, lastChecked, isAlive, parentId',\n  enrichmentQueue: '++queueId, bookmarkId, addedAt, priority',\n  events: '++eventId, bookmarkId, type, timestamp',\n  cache: 'key',\n  settings: 'key'\n}).upgrade(tx => {\n  console.log('Upgrading database to version 2 - adding rawMetadata support');\n  // No need to modify existing records, new field will be added on enrichment\n});\n\n// Schema version 3: Add similarities and computedMetrics tables for caching\ndb.version(3).stores({\n  bookmarks: 'id, url, title, domain, category, dateAdded, lastAccessed, lastChecked, isAlive, parentId',\n  enrichmentQueue: '++queueId, bookmarkId, addedAt, priority',\n  events: '++eventId, bookmarkId, type, timestamp',\n  cache: 'key',\n  settings: 'key',\n  similarities: '++id, bookmark1Id, bookmark2Id, score, [bookmark1Id+bookmark2Id]',\n  computedMetrics: 'key'\n}).upgrade(tx => {\n  console.log('Upgrading database to version 3 - adding similarities and computedMetrics tables');\n});\n\n// Define default settings\nconst DEFAULT_SETTINGS = {\n  enrichmentEnabled: true,\n  enrichmentSchedule: 'manual', // 'manual' only - user triggers enrichment\n  enrichmentBatchSize: 20,\n  enrichmentConcurrency: 3, // Number of parallel requests (1-10)\n  enrichmentRateLimit: 1000, // milliseconds between requests (deprecated with concurrency)\n  enrichmentFreshnessDays: 30, // Re-enrich bookmarks older than this many days (0 = always re-enrich)\n  autoCategorizationEnabled: true,\n  deadLinkCheckEnabled: true,\n  privacyMode: false, // If true, skip enrichment entirely\n  trackBrowsingBehavior: false // If false, don't track tab visits (default OFF for privacy)\n};\n\n// Initialize settings\nexport async function initializeSettings() {\n  try {\n    const existingSettings = await db.settings.get('app');\n    if (!existingSettings) {\n      await db.settings.put({ key: 'app', ...DEFAULT_SETTINGS });\n    }\n  } catch (error) {\n    console.error('Error initializing settings:', error);\n  }\n}\n\n// Get current settings\nexport async function getSettings() {\n  try {\n    const settings = await db.settings.get('app');\n    return settings || DEFAULT_SETTINGS;\n  } catch (error) {\n    console.error('Error getting settings:', error);\n    return DEFAULT_SETTINGS;\n  }\n}\n\n// Update settings\nexport async function updateSettings(newSettings) {\n  try {\n    const current = await getSettings();\n    await db.settings.put({ key: 'app', ...current, ...newSettings });\n    return true;\n  } catch (error) {\n    console.error('Error updating settings:', error);\n    return false;\n  }\n}\n\n// Migration: Import data from chrome.storage.local to IndexedDB\nexport async function migrateFromChromeStorage() {\n  try {\n    // Check if migration has already been done\n    const migrationStatus = await db.settings.get('migration');\n    if (migrationStatus && migrationStatus.completed) {\n      console.log('Migration already completed');\n      return { success: true, alreadyMigrated: true };\n    }\n\n    console.log('Starting migration from chrome.storage.local to IndexedDB...');\n    \n    // Get existing data from chrome.storage.local\n    const result = await chrome.storage.local.get(['bookmarks', 'lastSyncTime']);\n    const oldBookmarks = result.bookmarks || [];\n    \n    if (oldBookmarks.length === 0) {\n      console.log('No bookmarks to migrate');\n      await db.settings.put({ key: 'migration', completed: true, timestamp: Date.now(), count: 0 });\n      return { success: true, count: 0 };\n    }\n\n    // Transform old bookmarks to new schema with enrichment fields\n    const newBookmarks = oldBookmarks.map(bookmark => ({\n      ...bookmark,\n      // New enrichment fields\n      description: null,\n      keywords: [],\n      category: null,\n      tags: [],\n      isAlive: null, // null = unknown, true = alive, false = dead\n      lastChecked: null,\n      faviconUrl: null,\n      contentSnippet: null,\n      lastAccessed: null,\n      accessCount: 0\n    }));\n\n    // Bulk insert into IndexedDB\n    await db.bookmarks.bulkPut(newBookmarks);\n    \n    // Mark migration as complete\n    await db.settings.put({ \n      key: 'migration', \n      completed: true, \n      timestamp: Date.now(), \n      count: newBookmarks.length,\n      oldSyncTime: result.lastSyncTime\n    });\n\n    console.log(`Successfully migrated ${newBookmarks.length} bookmarks`);\n    return { success: true, count: newBookmarks.length };\n  } catch (error) {\n    console.error('Migration error:', error);\n    return { success: false, error: error.message };\n  }\n}\n\n// Get all bookmarks from IndexedDB\nexport async function getAllBookmarks() {\n  try {\n    return await db.bookmarks.toArray();\n  } catch (error) {\n    console.error('Error getting bookmarks:', error);\n    return [];\n  }\n}\n\n// Get bookmark by ID\nexport async function getBookmark(id) {\n  try {\n    return await db.bookmarks.get(id);\n  } catch (error) {\n    console.error('Error getting bookmark:', error);\n    return null;\n  }\n}\n\n// Add or update a bookmark\nexport async function upsertBookmark(bookmark) {\n  try {\n    await db.bookmarks.put(bookmark);\n    return true;\n  } catch (error) {\n    console.error('Error upserting bookmark:', error);\n    return false;\n  }\n}\n\n// Add multiple bookmarks\nexport async function bulkUpsertBookmarks(bookmarks) {\n  try {\n    await db.bookmarks.bulkPut(bookmarks);\n    return true;\n  } catch (error) {\n    console.error('Error bulk upserting bookmarks:', error);\n    return false;\n  }\n}\n\n/**\n * Smart merge bookmarks - preserves enrichment data during sync\n * This fixes the issue where extension updates reset enrichment progress\n * @param {Array} newBookmarks - Fresh bookmarks from Chrome API\n * @returns {Promise<boolean>} Success status\n */\nexport async function smartMergeBookmarks(newBookmarks) {\n  try {\n    // Get all existing bookmarks as a map for fast lookup\n    const existingBookmarks = await db.bookmarks.toArray();\n    const existingMap = new Map(existingBookmarks.map(b => [b.id, b]));\n    \n    // Merge new bookmarks with existing enrichment data\n    const mergedBookmarks = newBookmarks.map(newBookmark => {\n      const existing = existingMap.get(newBookmark.id);\n      \n      if (existing) {\n        // Preserve enrichment data from existing bookmark\n        return {\n          // Chrome bookmark fields (always take fresh)\n          id: newBookmark.id,\n          title: newBookmark.title,\n          url: newBookmark.url,\n          dateAdded: newBookmark.dateAdded,\n          parentId: newBookmark.parentId,\n          folderPath: newBookmark.folderPath,\n          domain: newBookmark.domain,\n          // Enrichment fields (preserve existing)\n          description: existing.description ?? null,\n          keywords: existing.keywords ?? [],\n          category: existing.category ?? null,\n          tags: existing.tags ?? [],\n          isAlive: existing.isAlive ?? null,\n          lastChecked: existing.lastChecked ?? null,\n          faviconUrl: existing.faviconUrl ?? null,\n          contentSnippet: existing.contentSnippet ?? null,\n          rawMetadata: existing.rawMetadata ?? null,\n          lastAccessed: existing.lastAccessed ?? null,\n          accessCount: existing.accessCount ?? 0,\n        };\n      }\n      \n      // New bookmark - use default enrichment fields\n      return {\n        ...newBookmark,\n        description: null,\n        keywords: [],\n        category: null,\n        tags: [],\n        isAlive: null,\n        lastChecked: null,\n        faviconUrl: null,\n        contentSnippet: null,\n        rawMetadata: null,\n        lastAccessed: null,\n        accessCount: 0,\n      };\n    });\n    \n    // Bulk upsert the merged bookmarks\n    await db.bookmarks.bulkPut(mergedBookmarks);\n    \n    console.log(`Smart merged ${mergedBookmarks.length} bookmarks (${newBookmarks.length - existingMap.size} new, ${existingMap.size} updated)`);\n    return true;\n  } catch (error) {\n    console.error('Error smart merging bookmarks:', error);\n    return false;\n  }\n}\n\n// Delete a bookmark\nexport async function deleteBookmark(id) {\n  try {\n    await db.bookmarks.delete(id);\n    return true;\n  } catch (error) {\n    console.error('Error deleting bookmark:', error);\n    return false;\n  }\n}\n\n// Search bookmarks (basic implementation, will be enhanced with FlexSearch later)\nexport async function searchBookmarks(query) {\n  try {\n    if (!query || !query.trim()) {\n      return await db.bookmarks.orderBy('dateAdded').reverse().toArray();\n    }\n\n    const lowerQuery = query.toLowerCase();\n    const bookmarks = await db.bookmarks.toArray();\n    \n    return bookmarks.filter(bookmark => \n      bookmark.title.toLowerCase().includes(lowerQuery) ||\n      bookmark.url.toLowerCase().includes(lowerQuery) ||\n      (bookmark.domain && bookmark.domain.toLowerCase().includes(lowerQuery)) ||\n      (bookmark.description && bookmark.description.toLowerCase().includes(lowerQuery)) ||\n      (bookmark.keywords && bookmark.keywords.some(k => k.toLowerCase().includes(lowerQuery)))\n    ).sort((a, b) => b.dateAdded - a.dateAdded);\n  } catch (error) {\n    console.error('Search error:', error);\n    return [];\n  }\n}\n\n// Get bookmarks by domain\nexport async function getBookmarksByDomain(domain) {\n  try {\n    return await db.bookmarks.where('domain').equals(domain).toArray();\n  } catch (error) {\n    console.error('Error getting bookmarks by domain:', error);\n    return [];\n  }\n}\n\n// Get bookmarks by category\nexport async function getBookmarksByCategory(category) {\n  try {\n    return await db.bookmarks.where('category').equals(category).toArray();\n  } catch (error) {\n    console.error('Error getting bookmarks by category:', error);\n    return [];\n  }\n}\n\n// Get bookmarks by date range\nexport async function getBookmarksByDateRange(startDate, endDate) {\n  try {\n    return await db.bookmarks\n      .where('dateAdded')\n      .between(startDate, endDate, true, true)\n      .toArray();\n  } catch (error) {\n    console.error('Error getting bookmarks by date range:', error);\n    return [];\n  }\n}\n\n// Get unique domains\nexport async function getUniqueDomains() {\n  try {\n    const bookmarks = await db.bookmarks.toArray();\n    const domains = [...new Set(bookmarks.map(b => b.domain).filter(d => d))];\n    return domains.sort();\n  } catch (error) {\n    console.error('Error getting unique domains:', error);\n    return [];\n  }\n}\n\n// Get unique categories\nexport async function getUniqueCategories() {\n  try {\n    const bookmarks = await db.bookmarks.toArray();\n    const categories = [...new Set(bookmarks.map(b => b.category).filter(c => c))];\n    return categories.sort();\n  } catch (error) {\n    console.error('Error getting unique categories:', error);\n    return [];\n  }\n}\n\n// Get domain statistics\nexport async function getDomainStats() {\n  try {\n    const bookmarks = await db.bookmarks.toArray();\n    const domainCount = {};\n    \n    bookmarks.forEach(bookmark => {\n      if (bookmark.domain) {\n        domainCount[bookmark.domain] = (domainCount[bookmark.domain] || 0) + 1;\n      }\n    });\n    \n    return Object.entries(domainCount)\n      .sort(([, a], [, b]) => b - a)\n      .slice(0, 10);\n  } catch (error) {\n    console.error('Error getting domain stats:', error);\n    return [];\n  }\n}\n\n// Get activity timeline\nexport async function getActivityTimeline() {\n  try {\n    const bookmarks = await db.bookmarks.toArray();\n    const monthlyCount = {};\n    \n    bookmarks.forEach(bookmark => {\n      const date = new Date(bookmark.dateAdded);\n      const monthKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}`;\n      monthlyCount[monthKey] = (monthlyCount[monthKey] || 0) + 1;\n    });\n    \n    return Object.entries(monthlyCount).sort();\n  } catch (error) {\n    console.error('Error getting activity timeline:', error);\n    return [];\n  }\n}\n\n// Event logging\nexport async function logEvent(bookmarkId, type, metadata = {}) {\n  try {\n    await db.events.add({\n      bookmarkId,\n      type, // 'create', 'delete', 'access', 'update', 'enrichment'\n      timestamp: Date.now(),\n      ...metadata\n    });\n    return true;\n  } catch (error) {\n    console.error('Error logging event:', error);\n    return false;\n  }\n}\n\n// Get events for a bookmark\nexport async function getBookmarkEvents(bookmarkId, limit = 50) {\n  try {\n    return await db.events\n      .where('bookmarkId').equals(bookmarkId)\n      .reverse()\n      .limit(limit)\n      .toArray();\n  } catch (error) {\n    console.error('Error getting bookmark events:', error);\n    return [];\n  }\n}\n\n// Get recent events\nexport async function getRecentEvents(limit = 100) {\n  try {\n    return await db.events\n      .orderBy('timestamp')\n      .reverse()\n      .limit(limit)\n      .toArray();\n  } catch (error) {\n    console.error('Error getting recent events:', error);\n    return [];\n  }\n}\n\n// Cache operations\nexport async function setCache(key, value, ttl = null) {\n  try {\n    await db.cache.put({\n      key,\n      value,\n      timestamp: Date.now(),\n      ttl\n    });\n    return true;\n  } catch (error) {\n    console.error('Error setting cache:', error);\n    return false;\n  }\n}\n\nexport async function getCache(key) {\n  try {\n    const cached = await db.cache.get(key);\n    if (!cached) return null;\n    \n    // Check TTL\n    if (cached.ttl && Date.now() - cached.timestamp > cached.ttl) {\n      await db.cache.delete(key);\n      return null;\n    }\n    \n    return cached.value;\n  } catch (error) {\n    console.error('Error getting cache:', error);\n    return null;\n  }\n}\n\nexport async function clearCache(keyPattern = null) {\n  try {\n    if (keyPattern) {\n      const allCache = await db.cache.toArray();\n      const toDelete = allCache.filter(c => c.key.includes(keyPattern)).map(c => c.key);\n      await db.cache.bulkDelete(toDelete);\n    } else {\n      await db.cache.clear();\n    }\n    return true;\n  } catch (error) {\n    console.error('Error clearing cache:', error);\n    return false;\n  }\n}\n\n// Enrichment queue operations\nexport async function addToEnrichmentQueue(bookmarkId, priority = 0) {\n  try {\n    // Check if already in queue\n    const existing = await db.enrichmentQueue.where('bookmarkId').equals(bookmarkId).first();\n    if (existing) {\n      return false; // Already queued\n    }\n    \n    await db.enrichmentQueue.add({\n      bookmarkId,\n      addedAt: Date.now(),\n      priority // Higher priority = processed first\n    });\n    return true;\n  } catch (error) {\n    console.error('Error adding to enrichment queue:', error);\n    return false;\n  }\n}\n\nexport async function getNextEnrichmentBatch(batchSize = 20) {\n  try {\n    return await db.enrichmentQueue\n      .orderBy('priority')\n      .reverse()\n      .limit(batchSize)\n      .toArray();\n  } catch (error) {\n    console.error('Error getting enrichment batch:', error);\n    return [];\n  }\n}\n\nexport async function removeFromEnrichmentQueue(queueId) {\n  try {\n    await db.enrichmentQueue.delete(queueId);\n    return true;\n  } catch (error) {\n    console.error('Error removing from enrichment queue:', error);\n    return false;\n  }\n}\n\nexport async function clearEnrichmentQueue() {\n  try {\n    await db.enrichmentQueue.clear();\n    return true;\n  } catch (error) {\n    console.error('Error clearing enrichment queue:', error);\n    return false;\n  }\n}\n\nexport async function getEnrichmentQueueSize() {\n  try {\n    return await db.enrichmentQueue.count();\n  } catch (error) {\n    console.error('Error getting queue size:', error);\n    return 0;\n  }\n}\n\n// Initialize database\nexport async function initializeDatabase() {\n  try {\n    await initializeSettings();\n    const migrationResult = await migrateFromChromeStorage();\n    console.log('Database initialized', migrationResult);\n    return migrationResult;\n  } catch (error) {\n    console.error('Error initializing database:', error);\n    return { success: false, error: error.message };\n  }\n}\n\n// =============================================\n// Computed Metrics Caching System\n// =============================================\n\n/**\n * Cache duration constants (in milliseconds)\n */\nconst CACHE_DURATIONS = {\n  domainStats: 60 * 60 * 1000,      // 1 hour\n  activityTimeline: 6 * 60 * 60 * 1000,  // 6 hours\n  wordFrequency: 24 * 60 * 60 * 1000,    // 24 hours\n  ageDistribution: 6 * 60 * 60 * 1000,   // 6 hours\n  categoryTrends: 24 * 60 * 60 * 1000,   // 24 hours\n  expertiseAreas: 24 * 60 * 60 * 1000,   // 24 hours\n  quickStats: 5 * 60 * 1000,             // 5 minutes\n  duplicates: 24 * 60 * 60 * 1000,       // 24 hours\n  similarities: 24 * 60 * 60 * 1000,     // 24 hours\n  insightsSummary: 5 * 60 * 1000,        // 5 minutes\n};\n\n/**\n * Generic cached metric getter\n * @param {string} key - Cache key\n * @param {Function} computeFn - Function to compute the metric if not cached\n * @param {number} ttlMs - Time to live in milliseconds\n * @returns {Promise<any>} Cached or computed data\n */\nexport async function getCachedMetric(key, computeFn, ttlMs) {\n  try {\n    const cached = await db.computedMetrics.get(key);\n    if (cached && cached.validUntil > Date.now()) {\n      console.log(`Cache hit for metric: ${key}`);\n      return cached.data;\n    }\n    \n    console.log(`Cache miss for metric: ${key}, computing...`);\n    const data = await computeFn();\n    \n    await db.computedMetrics.put({\n      key,\n      data,\n      computedAt: Date.now(),\n      validUntil: Date.now() + ttlMs\n    });\n    \n    return data;\n  } catch (error) {\n    console.error(`Error getting cached metric ${key}:`, error);\n    // Fall back to computing without cache\n    return computeFn();\n  }\n}\n\n/**\n * Invalidate specific metric caches based on change type\n * @param {string} changeType - Type of change: 'add', 'delete', 'update', 'enrich'\n */\nexport async function invalidateMetricCaches(changeType) {\n  const keysToInvalidate = {\n    'add': ['domainStats', 'quickStats', 'activityTimeline', 'ageDistribution', 'insightsSummary'],\n    'delete': ['domainStats', 'quickStats', 'duplicates', 'similarities', 'insightsSummary'],\n    'update': ['quickStats', 'insightsSummary'],\n    'enrich': ['categoryTrends', 'expertiseAreas', 'insightsSummary', 'quickStats'],\n    'all': Object.keys(CACHE_DURATIONS) // Invalidate all\n  };\n  \n  const keys = keysToInvalidate[changeType] || [];\n  \n  try {\n    for (const key of keys) {\n      await db.computedMetrics.delete(key);\n    }\n    console.log(`Invalidated caches for change type: ${changeType}`, keys);\n  } catch (error) {\n    console.error('Error invalidating metric caches:', error);\n  }\n}\n\n/**\n * Clear all computed metrics (useful for debugging or forced refresh)\n */\nexport async function clearAllMetricCaches() {\n  try {\n    await db.computedMetrics.clear();\n    console.log('Cleared all metric caches');\n    return true;\n  } catch (error) {\n    console.error('Error clearing metric caches:', error);\n    return false;\n  }\n}\n\n// =============================================\n// Similarity Storage Functions\n// =============================================\n\n/**\n * Store similarity results for a bookmark\n * @param {string} bookmarkId - Source bookmark ID\n * @param {Array} similarities - Array of {bookmark2Id, score} objects\n */\nexport async function storeSimilarities(bookmarkId, similarities) {\n  try {\n    // Remove old similarities for this bookmark\n    await db.similarities.where('bookmark1Id').equals(bookmarkId).delete();\n    \n    // Add new similarities\n    const records = similarities.map(sim => ({\n      bookmark1Id: bookmarkId,\n      bookmark2Id: sim.bookmark2Id,\n      score: sim.score,\n      computedAt: Date.now()\n    }));\n    \n    await db.similarities.bulkAdd(records);\n    return true;\n  } catch (error) {\n    console.error('Error storing similarities:', error);\n    return false;\n  }\n}\n\n/**\n * Get stored similar bookmarks for a specific bookmark\n * @param {string} bookmarkId - Bookmark ID\n * @returns {Promise<Array>} Array of similar bookmarks with scores\n */\nexport async function getStoredSimilarities(bookmarkId) {\n  try {\n    return await db.similarities.where('bookmark1Id').equals(bookmarkId).toArray();\n  } catch (error) {\n    console.error('Error getting stored similarities:', error);\n    return [];\n  }\n}\n\n/**\n * Clear all stored similarities (call when bookmarks are deleted)\n */\nexport async function clearSimilarities() {\n  try {\n    await db.similarities.clear();\n    return true;\n  } catch (error) {\n    console.error('Error clearing similarities:', error);\n    return false;\n  }\n}\n\n// Export cache durations for use in other modules\nexport { CACHE_DURATIONS };\n\n// =============================================\n// Consolidated Analytics Functions\n// (Migrated from database.js for single source of truth)\n// =============================================\n\n/**\n * Get bookmarks with pagination and filtering\n * @param {number} page - Page number (0-indexed)\n * @param {number} pageSize - Items per page\n * @param {Object} filters - Filter options\n * @returns {Promise<Object>} Paginated results\n */\nexport async function getBookmarksPaginated(page = 0, pageSize = 50, filters = {}) {\n  try {\n    let bookmarks = await getAllBookmarks();\n    \n    // Apply multiple filters\n    if (filters.domains && filters.domains.length > 0) {\n      bookmarks = bookmarks.filter(b => filters.domains.includes(b.domain));\n    }\n    \n    if (filters.folders && filters.folders.length > 0) {\n      bookmarks = bookmarks.filter(b => filters.folders.includes(b.folderPath));\n    }\n    \n    if (filters.dateRange) {\n      bookmarks = bookmarks.filter(b => \n        b.dateAdded >= filters.dateRange.startDate && \n        b.dateAdded <= filters.dateRange.endDate\n      );\n    }\n    \n    if (filters.searchQuery) {\n      const lowerQuery = filters.searchQuery.toLowerCase();\n      bookmarks = bookmarks.filter(b => \n        (b.title && b.title.toLowerCase().includes(lowerQuery)) ||\n        (b.url && b.url.toLowerCase().includes(lowerQuery)) ||\n        (b.domain && b.domain.toLowerCase().includes(lowerQuery)) ||\n        (b.description && b.description.toLowerCase().includes(lowerQuery))\n      );\n    }\n    \n    if (filters.category) {\n      bookmarks = bookmarks.filter(b => b.category === filters.category);\n    }\n    \n    if (filters.isEnriched !== undefined) {\n      bookmarks = filters.isEnriched \n        ? bookmarks.filter(b => b.lastChecked) \n        : bookmarks.filter(b => !b.lastChecked);\n    }\n    \n    // Apply sorting\n    const sortBy = filters.sortBy || 'date_desc';\n    switch (sortBy) {\n      case 'date_asc':\n        bookmarks.sort((a, b) => a.dateAdded - b.dateAdded);\n        break;\n      case 'title_asc':\n        bookmarks.sort((a, b) => (a.title || '').localeCompare(b.title || ''));\n        break;\n      case 'title_desc':\n        bookmarks.sort((a, b) => (b.title || '').localeCompare(a.title || ''));\n        break;\n      case 'domain_asc':\n        bookmarks.sort((a, b) => (a.domain || '').localeCompare(b.domain || ''));\n        break;\n      case 'accessed_desc':\n        bookmarks.sort((a, b) => (b.lastAccessed || 0) - (a.lastAccessed || 0));\n        break;\n      case 'date_desc':\n      default:\n        bookmarks.sort((a, b) => b.dateAdded - a.dateAdded);\n        break;\n    }\n    \n    const startIndex = page * pageSize;\n    const endIndex = startIndex + pageSize;\n    \n    return {\n      bookmarks: bookmarks.slice(startIndex, endIndex),\n      totalCount: bookmarks.length,\n      hasMore: endIndex < bookmarks.length,\n      currentPage: page,\n      totalPages: Math.ceil(bookmarks.length / pageSize)\n    };\n  } catch (error) {\n    console.error('Error getting paginated bookmarks:', error);\n    return { bookmarks: [], totalCount: 0, hasMore: false, currentPage: 0, totalPages: 0 };\n  }\n}\n\n/**\n * Get consolidated domain analytics in a single pass\n */\nexport async function getConsolidatedDomainAnalytics() {\n  return getCachedMetric('domainAnalytics', async () => {\n    const bookmarks = await getAllBookmarks();\n    const domainData = {};\n    \n    bookmarks.forEach(bookmark => {\n      if (!bookmark.domain) return;\n      \n      if (!domainData[bookmark.domain]) {\n        domainData[bookmark.domain] = {\n          domain: bookmark.domain,\n          count: 0,\n          latestDate: 0,\n          oldestDate: Infinity,\n          enrichedCount: 0\n        };\n      }\n      \n      const data = domainData[bookmark.domain];\n      data.count++;\n      if (bookmark.lastChecked) data.enrichedCount++;\n      if (bookmark.dateAdded > data.latestDate) data.latestDate = bookmark.dateAdded;\n      if (bookmark.dateAdded < data.oldestDate) data.oldestDate = bookmark.dateAdded;\n    });\n    \n    const domainArray = Object.values(domainData);\n    const totalBookmarks = bookmarks.length;\n    \n    domainArray.forEach(d => {\n      d.percentage = totalBookmarks > 0 ? Math.round((d.count / totalBookmarks) * 100) : 0;\n      d.dateAdded = d.latestDate;\n    });\n    \n    return {\n      byRecency: [...domainArray].sort((a, b) => b.latestDate - a.latestDate),\n      byCount: [...domainArray].sort((a, b) => b.count - a.count),\n      top10: [...domainArray].sort((a, b) => b.count - a.count).slice(0, 10),\n      totalDomains: domainArray.length,\n      totalBookmarks\n    };\n  }, CACHE_DURATIONS.domainStats);\n}\n\n/**\n * Get unique folders from bookmarks\n */\nexport async function getUniqueFolders() {\n  try {\n    const bookmarks = await getAllBookmarks();\n    const folders = [...new Set(bookmarks.map(b => b.folderPath).filter(f => f))];\n    return folders.sort();\n  } catch (error) {\n    console.error('Error getting unique folders:', error);\n    return [];\n  }\n}\n\n/**\n * Get bookmark age distribution\n */\nexport async function getBookmarkAgeDistribution() {\n  return getCachedMetric('ageDistribution', async () => {\n    const bookmarks = await getAllBookmarks();\n    const now = Date.now();\n    const ageGroups = {\n      'Last 24 hours': 0,\n      'Last week': 0,\n      'Last month': 0,\n      'Last 3 months': 0,\n      'Last 6 months': 0,\n      'Last year': 0,\n      'Over 1 year': 0\n    };\n    \n    const DAY = 24 * 60 * 60 * 1000;\n    const WEEK = 7 * DAY;\n    const MONTH = 30 * DAY;\n    \n    bookmarks.forEach(bookmark => {\n      const age = now - bookmark.dateAdded;\n      \n      if (age <= DAY) ageGroups['Last 24 hours']++;\n      else if (age <= WEEK) ageGroups['Last week']++;\n      else if (age <= MONTH) ageGroups['Last month']++;\n      else if (age <= 3 * MONTH) ageGroups['Last 3 months']++;\n      else if (age <= 6 * MONTH) ageGroups['Last 6 months']++;\n      else if (age <= 365 * DAY) ageGroups['Last year']++;\n      else ageGroups['Over 1 year']++;\n    });\n    \n    return Object.entries(ageGroups);\n  }, CACHE_DURATIONS.ageDistribution);\n}\n\n/**\n * Get bookmark creation patterns (hourly, daily, monthly)\n */\nexport async function getBookmarkCreationPatterns() {\n  return getCachedMetric('creationPatterns', async () => {\n    const bookmarks = await getAllBookmarks();\n    const hourPatterns = new Array(24).fill(0);\n    const dayPatterns = new Array(7).fill(0);\n    const monthPatterns = new Array(12).fill(0);\n    \n    const dayNames = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n    const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\n    \n    bookmarks.forEach(bookmark => {\n      const date = new Date(bookmark.dateAdded);\n      hourPatterns[date.getHours()]++;\n      dayPatterns[date.getDay()]++;\n      monthPatterns[date.getMonth()]++;\n    });\n    \n    return {\n      hourly: hourPatterns.map((count, hour) => [`${hour}:00`, count]),\n      daily: dayPatterns.map((count, day) => [dayNames[day], count]),\n      monthly: monthPatterns.map((count, month) => [monthNames[month], count])\n    };\n  }, CACHE_DURATIONS.ageDistribution);\n}\n\n/**\n * Get title word frequency\n */\nexport async function getTitleWordFrequency() {\n  return getCachedMetric('wordFrequency', async () => {\n    const bookmarks = await getAllBookmarks();\n    const wordCount = {};\n    \n    const stopWords = new Set([\n      'the', 'a', 'an', 'and', 'or', 'but', 'in', 'on', 'at', 'to', 'for', 'of', 'with', 'by',\n      'is', 'are', 'was', 'were', 'be', 'been', 'have', 'has', 'had', 'do', 'does', 'did',\n      'will', 'would', 'could', 'should', 'may', 'might', 'can', 'about', 'from', 'up', 'out'\n    ]);\n    \n    bookmarks.forEach(bookmark => {\n      if (bookmark.title) {\n        const words = bookmark.title\n          .toLowerCase()\n          .replace(/[^\\w\\s]/g, ' ')\n          .split(/\\s+/)\n          .filter(word => word.length > 2 && !stopWords.has(word));\n        \n        words.forEach(word => {\n          wordCount[word] = (wordCount[word] || 0) + 1;\n        });\n      }\n    });\n    \n    return Object.entries(wordCount)\n      .sort(([, a], [, b]) => b - a)\n      .slice(0, 20);\n  }, CACHE_DURATIONS.wordFrequency);\n}\n\n/**\n * Find duplicate bookmarks\n */\nexport async function findDuplicates() {\n  return getCachedMetric('duplicates', async () => {\n    const bookmarks = await getAllBookmarks();\n    const urlMap = {};\n    \n    bookmarks.forEach(bookmark => {\n      const normalizedUrl = bookmark.url.toLowerCase().replace(/\\/$/, '');\n      if (!urlMap[normalizedUrl]) {\n        urlMap[normalizedUrl] = [];\n      }\n      urlMap[normalizedUrl].push(bookmark);\n    });\n    \n    return Object.values(urlMap).filter(group => group.length > 1);\n  }, CACHE_DURATIONS.duplicates);\n}\n\n/**\n * Find uncategorized bookmarks (in root folders)\n */\nexport async function findUncategorizedBookmarks() {\n  try {\n    const bookmarks = await getAllBookmarks();\n    const rootFolders = ['Bookmarks Bar', 'Other Bookmarks', 'Mobile Bookmarks', ''];\n    \n    return bookmarks.filter(bookmark => {\n      const folderPath = bookmark.folderPath || '';\n      return rootFolders.includes(folderPath) || !folderPath.includes('/');\n    });\n  } catch (error) {\n    console.error('Error finding uncategorized bookmarks:', error);\n    return [];\n  }\n}\n\n/**\n * Find malformed URLs\n */\nexport async function findMalformedUrls() {\n  try {\n    const bookmarks = await getAllBookmarks();\n    \n    const validSchemes = [\n      'http://', 'https://', 'chrome://', 'chrome-extension://',\n      'file://', 'javascript:', 'data:', 'about:', 'mailto:',\n      'tel:', 'ftp://', 'sftp://', 'ssh://'\n    ];\n    \n    return bookmarks.filter(bookmark => {\n      const url = bookmark.url || '';\n      const hasValidScheme = validSchemes.some(scheme => url.startsWith(scheme));\n      return !hasValidScheme || url.trim() === '';\n    });\n  } catch (error) {\n    console.error('Error finding malformed URLs:', error);\n    return [];\n  }\n}\n\n/**\n * Get quick statistics for dashboard\n */\nexport async function getQuickStats() {\n  return getCachedMetric('quickStats', async () => {\n    const bookmarks = await getAllBookmarks();\n    const duplicates = await findDuplicates();\n    const uncategorized = await findUncategorizedBookmarks();\n    const malformed = await findMalformedUrls();\n    \n    const now = Date.now();\n    const oneWeek = 7 * 24 * 60 * 60 * 1000;\n    const oneMonth = 30 * 24 * 60 * 60 * 1000;\n    \n    const enriched = bookmarks.filter(b => b.lastChecked).length;\n    const deadLinks = bookmarks.filter(b => b.isAlive === false).length;\n    const uniqueDomains = new Set(bookmarks.map(b => b.domain).filter(d => d)).size;\n    \n    return {\n      total: bookmarks.length,\n      enriched,\n      pending: bookmarks.length - enriched,\n      enrichedPercentage: bookmarks.length > 0 ? Math.round((enriched / bookmarks.length) * 100) : 0,\n      duplicateGroups: duplicates.length,\n      uncategorized: uncategorized.length,\n      malformed: malformed.length,\n      deadLinks,\n      uniqueDomains,\n      addedThisWeek: bookmarks.filter(b => now - b.dateAdded < oneWeek).length,\n      addedThisMonth: bookmarks.filter(b => now - b.dateAdded < oneMonth).length,\n      oldestBookmark: bookmarks.reduce((oldest, b) => b.dateAdded < oldest ? b.dateAdded : oldest, Date.now()),\n      newestBookmark: bookmarks.reduce((newest, b) => b.dateAdded > newest ? b.dateAdded : newest, 0)\n    };\n  }, CACHE_DURATIONS.quickStats);\n}\n\n/**\n * Export bookmarks to JSON format\n */\nexport async function exportBookmarks() {\n  try {\n    const bookmarks = await getAllBookmarks();\n    return {\n      exportDate: new Date().toISOString(),\n      version: '2.0',\n      totalBookmarks: bookmarks.length,\n      bookmarks: bookmarks\n    };\n  } catch (error) {\n    console.error('Error exporting bookmarks:', error);\n    throw error;\n  }\n}\n\n// =============================================\n// Additional Analytics Functions (migrated from database.js)\n// =============================================\n\n/**\n * Get bookmarks by folder path\n */\nexport async function getBookmarksByFolder(folderPath) {\n  try {\n    const bookmarks = await getAllBookmarks();\n    return bookmarks.filter(bookmark => bookmark.folderPath === folderPath);\n  } catch (error) {\n    console.error('Error getting bookmarks by folder:', error);\n    return [];\n  }\n}\n\n/**\n * Find similar bookmarks using word overlap\n */\nexport async function findSimilarBookmarks(threshold = 0.7, maxPairs = 100) {\n  try {\n    const bookmarks = await getAllBookmarks();\n    const similar = [];\n    \n    // Pre-compute word sets\n    const wordSets = bookmarks.map(b => ({\n      bookmark: b,\n      words: new Set(b.title.toLowerCase().split(/\\s+/).filter(w => w.length > 2))\n    })).filter(item => item.words.size > 0);\n    \n    for (let i = 0; i < wordSets.length; i++) {\n      for (let j = i + 1; j < wordSets.length; j++) {\n        if (wordSets[i].bookmark.url === wordSets[j].bookmark.url) continue;\n        \n        const words1 = wordSets[i].words;\n        const words2 = wordSets[j].words;\n        \n        const intersection = [...words1].filter(w => words2.has(w)).length;\n        const similarity = (2 * intersection) / (words1.size + words2.size);\n        \n        if (similarity >= threshold) {\n          similar.push([wordSets[i].bookmark, wordSets[j].bookmark, similarity]);\n        }\n      }\n      \n      if (similar.length >= maxPairs * 2) break;\n    }\n    \n    return similar.sort((a, b) => b[2] - a[2]).slice(0, maxPairs);\n  } catch (error) {\n    console.error('Error finding similar bookmarks:', error);\n    return [];\n  }\n}\n\n/**\n * Legacy alias for backward compatibility\n */\nexport async function findOrphans() {\n  return findUncategorizedBookmarks();\n}\n\n/**\n * Get domains sorted by recency\n */\nexport async function getDomainsByRecency() {\n  const analytics = await getConsolidatedDomainAnalytics();\n  return analytics.byRecency;\n}\n\n/**\n * Get domains sorted by count\n */\nexport async function getDomainsByCount() {\n  const analytics = await getConsolidatedDomainAnalytics();\n  return analytics.byCount;\n}\n\n/**\n * Delete multiple bookmarks\n */\nexport async function deleteBookmarks(bookmarkIds) {\n  try {\n    const errors = [];\n    \n    // Delete from Chrome bookmarks API\n    for (const id of bookmarkIds) {\n      try {\n        await chrome.bookmarks.remove(id);\n      } catch (error) {\n        console.error(`Error deleting bookmark ${id}:`, error);\n        errors.push({ id, error: error.message });\n      }\n    }\n    \n    // Remove from IndexedDB\n    await db.bookmarks.bulkDelete(bookmarkIds);\n    \n    // Invalidate caches\n    await invalidateMetricCaches('delete');\n    \n    return {\n      success: bookmarkIds.length - errors.length,\n      errors: errors\n    };\n  } catch (error) {\n    console.error('Error deleting bookmarks:', error);\n    throw error;\n  }\n}\n\n/**\n * Get common title patterns\n */\nexport async function getTitlePatterns() {\n  try {\n    const bookmarks = await getAllBookmarks();\n    const patterns = {};\n    \n    bookmarks.forEach(bookmark => {\n      if (bookmark.title) {\n        const title = bookmark.title.toLowerCase();\n        \n        if (title.includes('how to')) patterns['How-to guides'] = (patterns['How-to guides'] || 0) + 1;\n        if (title.includes('tutorial')) patterns['Tutorials'] = (patterns['Tutorials'] || 0) + 1;\n        if (title.includes('documentation') || title.includes('docs')) patterns['Documentation'] = (patterns['Documentation'] || 0) + 1;\n        if (title.includes('api') || title.includes('reference')) patterns['API/Reference'] = (patterns['API/Reference'] || 0) + 1;\n        if (title.includes('blog') || title.includes('article')) patterns['Blog/Articles'] = (patterns['Blog/Articles'] || 0) + 1;\n        if (title.includes('github') || title.includes('repository')) patterns['Code Repositories'] = (patterns['Code Repositories'] || 0) + 1;\n        if (title.includes('video') || title.includes('youtube')) patterns['Videos'] = (patterns['Videos'] || 0) + 1;\n        if (title.includes('tool') || title.includes('app')) patterns['Tools/Apps'] = (patterns['Tools/Apps'] || 0) + 1;\n        \n        if (title.length > 60) patterns['Long titles (60+ chars)'] = (patterns['Long titles (60+ chars)'] || 0) + 1;\n        if (title.split(' ').length <= 3) patterns['Short titles (3 words)'] = (patterns['Short titles (3 words)'] || 0) + 1;\n      }\n    });\n    \n    return Object.entries(patterns).sort(([,a], [,b]) => b - a);\n  } catch (error) {\n    console.error('Error getting title patterns:', error);\n    return [];\n  }\n}\n\n/**\n * Analyze URL patterns\n */\nexport async function getUrlPatterns() {\n  try {\n    const bookmarks = await getAllBookmarks();\n    const protocols = {};\n    const topLevelDomains = {};\n    const pathPatterns = {};\n    const subdomainPatterns = {};\n    \n    bookmarks.forEach(bookmark => {\n      try {\n        const url = new URL(bookmark.url);\n        \n        protocols[url.protocol] = (protocols[url.protocol] || 0) + 1;\n        \n        const domain = url.hostname;\n        const parts = domain.split('.');\n        if (parts.length > 1) {\n          const tld = parts[parts.length - 1];\n          topLevelDomains[tld] = (topLevelDomains[tld] || 0) + 1;\n        }\n        \n        if (parts.length > 2) {\n          const subdomain = parts[0];\n          if (subdomain !== 'www') {\n            subdomainPatterns[subdomain] = (subdomainPatterns[subdomain] || 0) + 1;\n          }\n        }\n        \n        const pathSegments = url.pathname.split('/').filter(segment => segment.length > 0);\n        if (pathSegments.length > 0) {\n          const firstSegment = pathSegments[0];\n          pathPatterns[firstSegment] = (pathPatterns[firstSegment] || 0) + 1;\n        }\n      } catch (e) {\n        // Skip malformed URLs\n      }\n    });\n    \n    return {\n      protocols: Object.entries(protocols).sort(([,a], [,b]) => b - a),\n      topLevelDomains: Object.entries(topLevelDomains).sort(([,a], [,b]) => b - a).slice(0, 10),\n      subdomains: Object.entries(subdomainPatterns).sort(([,a], [,b]) => b - a).slice(0, 10),\n      pathPatterns: Object.entries(pathPatterns).sort(([,a], [,b]) => b - a).slice(0, 15)\n    };\n  } catch (error) {\n    console.error('Error getting URL patterns:', error);\n    return { protocols: [], topLevelDomains: [], subdomains: [], pathPatterns: [] };\n  }\n}\n\n/**\n * Analyze URL parameter usage\n */\nexport async function getUrlParameterUsage() {\n  try {\n    const bookmarks = await getAllBookmarks();\n    const parameterCount = {};\n    let urlsWithParams = 0;\n    let totalUrls = 0;\n    \n    bookmarks.forEach(bookmark => {\n      totalUrls++;\n      try {\n        const url = new URL(bookmark.url);\n        const params = url.searchParams;\n        \n        if (params.toString()) {\n          urlsWithParams++;\n          for (const [key] of params) {\n            parameterCount[key] = (parameterCount[key] || 0) + 1;\n          }\n        }\n      } catch (e) {\n        // Skip malformed URLs\n      }\n    });\n    \n    const parameterUsage = Object.entries(parameterCount)\n      .sort(([,a], [,b]) => b - a)\n      .slice(0, 15);\n    \n    return {\n      parameters: parameterUsage,\n      urlsWithParams,\n      totalUrls,\n      percentage: totalUrls > 0 ? Math.round((urlsWithParams / totalUrls) * 100) : 0\n    };\n  } catch (error) {\n    console.error('Error getting URL parameter usage:', error);\n    return { parameters: [], urlsWithParams: 0, totalUrls: 0, percentage: 0 };\n  }\n}\n\n/**\n * Get domain distribution\n */\nexport async function getDomainDistribution() {\n  try {\n    const bookmarks = await getAllBookmarks();\n    const domainCount = {};\n    \n    bookmarks.forEach(bookmark => {\n      domainCount[bookmark.domain] = (domainCount[bookmark.domain] || 0) + 1;\n    });\n    \n    const sortedDomains = Object.entries(domainCount)\n      .sort(([,a], [,b]) => b - a);\n    \n    const totalBookmarks = bookmarks.length;\n    const top10 = sortedDomains.slice(0, 10);\n    const others = sortedDomains.slice(10);\n    const othersCount = others.reduce((sum, [,count]) => sum + count, 0);\n    \n    const distribution = top10.map(([domain, count]) => ({\n      domain,\n      count,\n      percentage: Math.round((count / totalBookmarks) * 100)\n    }));\n    \n    if (othersCount > 0) {\n      distribution.push({\n        domain: 'Others',\n        count: othersCount,\n        percentage: Math.round((othersCount / totalBookmarks) * 100)\n      });\n    }\n    \n    return distribution;\n  } catch (error) {\n    console.error('Error getting domain distribution:', error);\n    return [];\n  }\n}\n\n/**\n * Get bookmarks that have been detected as dead links\n * Returns bookmarks where isAlive === false (already checked and found dead)\n */\nexport async function getDeadLinks() {\n  try {\n    const bookmarks = await getAllBookmarks();\n    return bookmarks.filter(b => b.isAlive === false);\n  } catch (error) {\n    console.error('Error getting dead links:', error);\n    return [];\n  }\n}\n\n/**\n * Check for dead links\n */\nexport async function checkDeadLinks(bookmarkIds = null, batchSize = 10) {\n  try {\n    const bookmarks = await getAllBookmarks();\n    const toCheck = bookmarkIds \n      ? bookmarks.filter(b => bookmarkIds.includes(b.id))\n      : bookmarks.filter(b => b.url.startsWith('http'));\n    \n    const results = {\n      checked: 0,\n      alive: [],\n      dead: [],\n      errors: [],\n      inProgress: false\n    };\n    \n    for (let i = 0; i < Math.min(toCheck.length, batchSize); i++) {\n      const bookmark = toCheck[i];\n      results.checked++;\n      \n      try {\n        const controller = new AbortController();\n        const timeoutId = setTimeout(() => controller.abort(), 5000);\n        \n        await fetch(bookmark.url, {\n          method: 'HEAD',\n          mode: 'no-cors',\n          signal: controller.signal\n        });\n        \n        clearTimeout(timeoutId);\n        results.alive.push(bookmark);\n      } catch (error) {\n        if (error.name === 'AbortError') {\n          results.errors.push({ bookmark, reason: 'timeout' });\n        } else {\n          results.dead.push({ bookmark, reason: error.message });\n        }\n      }\n    }\n    \n    return {\n      ...results,\n      total: toCheck.length,\n      remaining: Math.max(0, toCheck.length - batchSize)\n    };\n  } catch (error) {\n    console.error('Error checking dead links:', error);\n    return { checked: 0, alive: [], dead: [], errors: [], total: 0, remaining: 0 };\n  }\n}\n\n// =============================================\n// Backup & Restore System\n// =============================================\n\n/**\n * Create a full backup of the IndexedDB database\n * @returns {Promise<Object>} Backup object with all data\n */\nexport async function createBackup() {\n  try {\n    const bookmarks = await db.bookmarks.toArray();\n    const settings = await db.settings.toArray();\n    const events = await db.events.orderBy('timestamp').reverse().limit(1000).toArray();\n    const similarities = await db.similarities.toArray();\n    \n    // Get stats for backup metadata\n    const enrichedCount = bookmarks.filter(b => b.lastChecked).length;\n    const categorizedCount = bookmarks.filter(b => b.category).length;\n    \n    const backup = {\n      version: '2.1',\n      schemaVersion: 3,\n      createdAt: new Date().toISOString(),\n      metadata: {\n        totalBookmarks: bookmarks.length,\n        enrichedCount,\n        categorizedCount,\n        eventsCount: events.length,\n        similaritiesCount: similarities.length\n      },\n      data: {\n        bookmarks,\n        settings,\n        events,\n        similarities\n      }\n    };\n    \n    return backup;\n  } catch (error) {\n    console.error('Error creating backup:', error);\n    throw error;\n  }\n}\n\n/**\n * Download backup as a JSON file\n */\nexport async function downloadBackup() {\n  try {\n    const backup = await createBackup();\n    const blob = new Blob([JSON.stringify(backup, null, 2)], { type: 'application/json' });\n    const url = URL.createObjectURL(blob);\n    \n    const date = new Date().toISOString().slice(0, 10);\n    const filename = `bookmark-insights-backup-${date}.json`;\n    \n    // Create download link\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = filename;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    URL.revokeObjectURL(url);\n    \n    return { success: true, filename, metadata: backup.metadata };\n  } catch (error) {\n    console.error('Error downloading backup:', error);\n    throw error;\n  }\n}\n\n/**\n * Restore database from a backup file\n * @param {Object} backup - The backup object to restore from\n * @param {Object} options - Restore options\n * @returns {Promise<Object>} Restore result\n */\nexport async function restoreFromBackup(backup, options = {}) {\n  const { \n    restoreBookmarks = true, \n    restoreSettings = true,\n    restoreEvents = false,  // Events are optional\n    restoreSimilarities = true,\n    mergeMode = false  // If true, merge with existing data; if false, replace\n  } = options;\n  \n  try {\n    // Validate backup format\n    if (!backup || !backup.version || !backup.data) {\n      throw new Error('Invalid backup format');\n    }\n    \n    if (!backup.data.bookmarks || !Array.isArray(backup.data.bookmarks)) {\n      throw new Error('Backup does not contain valid bookmarks data');\n    }\n    \n    const results = {\n      bookmarksRestored: 0,\n      settingsRestored: 0,\n      eventsRestored: 0,\n      similaritiesRestored: 0,\n      errors: []\n    };\n    \n    // Restore bookmarks\n    if (restoreBookmarks && backup.data.bookmarks.length > 0) {\n      if (!mergeMode) {\n        await db.bookmarks.clear();\n      }\n      \n      if (mergeMode) {\n        // Merge mode: preserve newer enrichment data\n        const existingBookmarks = await db.bookmarks.toArray();\n        const existingMap = new Map(existingBookmarks.map(b => [b.id, b]));\n        \n        for (const bookmark of backup.data.bookmarks) {\n          const existing = existingMap.get(bookmark.id);\n          if (existing) {\n            // Keep whichever has more recent lastChecked\n            const existingTime = existing.lastChecked || 0;\n            const backupTime = bookmark.lastChecked || 0;\n            if (backupTime > existingTime) {\n              await db.bookmarks.put(bookmark);\n              results.bookmarksRestored++;\n            }\n          } else {\n            await db.bookmarks.put(bookmark);\n            results.bookmarksRestored++;\n          }\n        }\n      } else {\n        // Replace mode: bulk insert\n        await db.bookmarks.bulkPut(backup.data.bookmarks);\n        results.bookmarksRestored = backup.data.bookmarks.length;\n      }\n    }\n    \n    // Restore settings\n    if (restoreSettings && backup.data.settings && backup.data.settings.length > 0) {\n      if (!mergeMode) {\n        await db.settings.clear();\n      }\n      await db.settings.bulkPut(backup.data.settings);\n      results.settingsRestored = backup.data.settings.length;\n    }\n    \n    // Restore events (optional)\n    if (restoreEvents && backup.data.events && backup.data.events.length > 0) {\n      if (!mergeMode) {\n        await db.events.clear();\n      }\n      await db.events.bulkPut(backup.data.events);\n      results.eventsRestored = backup.data.events.length;\n    }\n    \n    // Restore similarities\n    if (restoreSimilarities && backup.data.similarities && backup.data.similarities.length > 0) {\n      if (!mergeMode) {\n        await db.similarities.clear();\n      }\n      await db.similarities.bulkPut(backup.data.similarities);\n      results.similaritiesRestored = backup.data.similarities.length;\n    }\n    \n    // Clear caches after restore\n    await clearAllMetricCaches();\n    \n    return {\n      success: true,\n      results,\n      backupMetadata: backup.metadata\n    };\n  } catch (error) {\n    console.error('Error restoring from backup:', error);\n    throw error;\n  }\n}\n\n/**\n * Validate a backup file before restoring\n * @param {Object} backup - The backup object to validate\n * @returns {Object} Validation result\n */\nexport function validateBackup(backup) {\n  const issues = [];\n  \n  if (!backup) {\n    return { valid: false, issues: ['Backup is empty or null'] };\n  }\n  \n  if (!backup.version) {\n    issues.push('Missing version field');\n  }\n  \n  if (!backup.data) {\n    issues.push('Missing data field');\n  } else {\n    if (!backup.data.bookmarks || !Array.isArray(backup.data.bookmarks)) {\n      issues.push('Missing or invalid bookmarks array');\n    }\n    \n    if (backup.data.bookmarks && backup.data.bookmarks.length > 0) {\n      const sample = backup.data.bookmarks[0];\n      if (!sample.id || !sample.url) {\n        issues.push('Bookmarks are missing required fields (id, url)');\n      }\n    }\n  }\n  \n  return {\n    valid: issues.length === 0,\n    issues,\n    metadata: backup.metadata || null,\n    version: backup.version || 'unknown',\n    createdAt: backup.createdAt || 'unknown'\n  };\n}\n\n/**\n * Create an automatic backup (called before risky operations)\n * Stores backup in chrome.storage.local with rotation (keeps last 3)\n */\nexport async function createAutoBackup() {\n  try {\n    const backup = await createBackup();\n    \n    // Get existing auto-backups\n    const result = await chrome.storage.local.get(['autoBackups']);\n    let autoBackups = result.autoBackups || [];\n    \n    // Add new backup\n    autoBackups.unshift({\n      createdAt: backup.createdAt,\n      metadata: backup.metadata,\n      data: backup.data\n    });\n    \n    // Keep only last 3 auto-backups\n    if (autoBackups.length > 3) {\n      autoBackups = autoBackups.slice(0, 3);\n    }\n    \n    await chrome.storage.local.set({ autoBackups });\n    \n    console.log('Auto-backup created:', backup.metadata);\n    return { success: true, metadata: backup.metadata };\n  } catch (error) {\n    console.error('Error creating auto-backup:', error);\n    return { success: false, error: error.message };\n  }\n}\n\n/**\n * List available auto-backups\n */\nexport async function listAutoBackups() {\n  try {\n    const result = await chrome.storage.local.get(['autoBackups']);\n    const autoBackups = result.autoBackups || [];\n    \n    return autoBackups.map((b, index) => ({\n      index,\n      createdAt: b.createdAt,\n      metadata: b.metadata\n    }));\n  } catch (error) {\n    console.error('Error listing auto-backups:', error);\n    return [];\n  }\n}\n\n/**\n * Restore from an auto-backup by index\n * @param {number} index - The index of the auto-backup to restore (0 = most recent)\n */\nexport async function restoreFromAutoBackup(index = 0) {\n  try {\n    const result = await chrome.storage.local.get(['autoBackups']);\n    const autoBackups = result.autoBackups || [];\n    \n    if (index < 0 || index >= autoBackups.length) {\n      throw new Error(`Invalid backup index: ${index}. Available: 0-${autoBackups.length - 1}`);\n    }\n    \n    const backup = {\n      version: '2.1',\n      ...autoBackups[index]\n    };\n    \n    return await restoreFromBackup(backup);\n  } catch (error) {\n    console.error('Error restoring from auto-backup:', error);\n    throw error;\n  }\n}\n\n\n","<script>\n  import { createEventDispatcher, onMount } from 'svelte';\n  import { getDomainsByRecency, getDomainsByCount, getUniqueFolders } from './db.js';\n  \n  const dispatch = createEventDispatcher();\n  \n  // Props for search result stats\n  export let searchResultStats = null;\n  export let isSearchActive = false;\n  \n  let domainsByRecency = [];\n  let domainsByCount = [];\n  let folders = [];\n  let selectedFilters = {\n    domains: [],\n    folders: [],\n    dateRange: null\n  };\n  let domainSortMode = 'count'; // 'recency' or 'count'\n  \n  onMount(async () => {\n    try {\n      await loadDomains();\n      folders = await getUniqueFolders();\n    } catch (error) {\n      console.error('Error loading filters:', error);\n    }\n  });\n\n  async function loadDomains() {\n    domainsByRecency = await getDomainsByRecency();\n    domainsByCount = await getDomainsByCount();\n  }\n\n  // Use search result stats when available, otherwise use full domain list\n  $: displayDomains = isSearchActive && searchResultStats?.domains \n    ? searchResultStats.domains \n    : (domainSortMode === 'recency' ? domainsByRecency : domainsByCount);\n  \n  // Use search result folders when available\n  $: displayFolders = isSearchActive && searchResultStats?.folders \n    ? searchResultStats.folders.map(f => f.folder)\n    : folders;\n  \n  function toggleDomainFilter(domain) {\n    if (selectedFilters.domains.includes(domain)) {\n      selectedFilters.domains = selectedFilters.domains.filter(d => d !== domain);\n    } else {\n      selectedFilters.domains = [...selectedFilters.domains, domain];\n    }\n    dispatchFilters();\n  }\n\n  function toggleFolderFilter(folder) {\n    if (selectedFilters.folders.includes(folder)) {\n      selectedFilters.folders = selectedFilters.folders.filter(f => f !== folder);\n    } else {\n      selectedFilters.folders = [...selectedFilters.folders, folder];\n    }\n    dispatchFilters();\n  }\n\n  function setDateFilter(startDate, endDate, period) {\n    selectedFilters.dateRange = { startDate, endDate, period };\n    dispatchFilters();\n  }\n  \n  function clearFilters() {\n    selectedFilters = {\n      domains: [],\n      folders: [],\n      dateRange: null\n    };\n    dispatchFilters();\n  }\n\n  function dispatchFilters() {\n    dispatch('filter', selectedFilters);\n  }\n\n  function hasActiveFilters() {\n    return selectedFilters.domains.length > 0 || \n           selectedFilters.folders.length > 0 || \n           selectedFilters.dateRange !== null;\n  }\n  \n  function applyDateFilter(period) {\n    const now = new Date();\n    let startDate;\n    \n    switch (period) {\n      case 'week':\n        startDate = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);\n        break;\n      case 'month':\n        startDate = new Date(now.getFullYear(), now.getMonth(), 1);\n        break;\n      case 'year':\n        startDate = new Date(now.getFullYear(), 0, 1);\n        break;\n    }\n    \n    setDateFilter(startDate.getTime(), now.getTime(), period);\n  }\n\n  function formatTimeAgo(timestamp) {\n    const now = Date.now();\n    const diff = now - timestamp;\n    const days = Math.floor(diff / (1000 * 60 * 60 * 24));\n    \n    if (days === 0) return 'Today';\n    if (days === 1) return '1 day ago';\n    if (days < 7) return `${days} days ago`;\n    if (days < 30) return `${Math.floor(days / 7)} weeks ago`;\n    if (days < 365) return `${Math.floor(days / 30)} months ago`;\n    return `${Math.floor(days / 365)} years ago`;\n  }\n</script>\n\n<div class=\"w-64 bg-gray-50 border-r border-gray-200 p-4 overflow-y-auto flex-shrink-0\">\n  <div class=\"mb-6\">\n    <div class=\"flex items-center justify-between mb-3\">\n      <h3 class=\"text-sm font-medium text-gray-900\">Filters</h3>\n      {#if hasActiveFilters()}\n        <button\n          on:click={clearFilters}\n          class=\"text-xs text-blue-600 hover:text-blue-800\"\n        >\n          Clear All\n        </button>\n      {/if}\n    </div>\n    \n    <!-- Active Filters Display -->\n    {#if hasActiveFilters()}\n      <div class=\"mb-4 space-y-2\">\n        {#each selectedFilters.domains as domain}\n          <div class=\"flex items-center justify-between p-2 bg-blue-50 rounded-md\">\n            <div class=\"text-xs text-blue-800\">Domain: {domain}</div>\n            <button \n              on:click={() => toggleDomainFilter(domain)}\n              class=\"text-blue-600 hover:text-blue-800\"\n            >\n              \n            </button>\n          </div>\n        {/each}\n        {#each selectedFilters.folders as folder}\n          <div class=\"flex items-center justify-between p-2 bg-green-50 rounded-md\">\n            <div class=\"text-xs text-green-800\">Folder: {folder}</div>\n            <button \n              on:click={() => toggleFolderFilter(folder)}\n              class=\"text-green-600 hover:text-green-800\"\n            >\n              \n            </button>\n          </div>\n        {/each}\n        {#if selectedFilters.dateRange}\n          <div class=\"flex items-center justify-between p-2 bg-purple-50 rounded-md\">\n            <div class=\"text-xs text-purple-800\">\n              {selectedFilters.dateRange.period === 'week' ? 'This Week' : \n               selectedFilters.dateRange.period === 'month' ? 'This Month' : 'This Year'}\n            </div>\n            <button \n              on:click={() => { selectedFilters.dateRange = null; dispatchFilters(); }}\n              class=\"text-purple-600 hover:text-purple-800\"\n            >\n              \n            </button>\n          </div>\n        {/if}\n      </div>\n    {/if}\n  </div>\n  \n  <!-- Date Filters -->\n  <div class=\"mb-6\">\n    <h4 class=\"text-xs font-medium text-gray-700 uppercase tracking-wide mb-2\">\n      Date Added\n    </h4>\n    <div class=\"space-y-1\">\n      <button\n        on:click={() => applyDateFilter('week')}\n        class=\"w-full text-left px-2 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded\"\n        class:bg-blue-50={selectedFilters.dateRange?.period === 'week'}\n        class:text-blue-700={selectedFilters.dateRange?.period === 'week'}\n      >\n        This Week\n      </button>\n      <button\n        on:click={() => applyDateFilter('month')}\n        class=\"w-full text-left px-2 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded\"\n        class:bg-blue-50={selectedFilters.dateRange?.period === 'month'}\n        class:text-blue-700={selectedFilters.dateRange?.period === 'month'}\n      >\n        This Month\n      </button>\n      <button\n        on:click={() => applyDateFilter('year')}\n        class=\"w-full text-left px-2 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded\"\n        class:bg-blue-50={selectedFilters.dateRange?.period === 'year'}\n        class:text-blue-700={selectedFilters.dateRange?.period === 'year'}\n      >\n        This Year\n      </button>\n    </div>\n  </div>\n  \n  <!-- Domain Filters -->\n  <div class=\"mb-6\">\n    <div class=\"flex items-center justify-between mb-2\">\n      <h4 class=\"text-xs font-medium text-gray-700 uppercase tracking-wide\">\n        {#if isSearchActive}\n          <span class=\"text-blue-600\">Matching Domains ({displayDomains.length})</span>\n        {:else}\n          Domains ({displayDomains.length})\n        {/if}\n      </h4>\n      {#if !isSearchActive}\n        <div class=\"flex space-x-1\">\n          <button\n            on:click={() => domainSortMode = 'recency'}\n            class=\"text-xs px-2 py-1 rounded\"\n            class:bg-blue-100={domainSortMode === 'recency'}\n            class:text-blue-700={domainSortMode === 'recency'}\n            class:text-gray-500={domainSortMode !== 'recency'}\n            title=\"Sort by most recent bookmark\"\n          >\n            Recent\n          </button>\n          <button\n            on:click={() => domainSortMode = 'count'}\n            class=\"text-xs px-2 py-1 rounded\"\n            class:bg-blue-100={domainSortMode === 'count'}\n            class:text-blue-700={domainSortMode === 'count'}\n            class:text-gray-500={domainSortMode !== 'count'}\n            title=\"Sort by bookmark count\"\n          >\n            Count\n          </button>\n        </div>\n      {/if}\n    </div>\n    <div class=\"space-y-1 max-h-64 overflow-y-auto\">\n      {#each displayDomains.slice(0, 30) as domainData}\n        <button\n          on:click={() => toggleDomainFilter(domainData.domain)}\n          class=\"w-full text-left px-2 py-2 text-sm hover:bg-gray-100 rounded border\"\n          class:bg-blue-50={selectedFilters.domains.includes(domainData.domain)}\n          class:text-blue-700={selectedFilters.domains.includes(domainData.domain)}\n          class:border-blue-200={selectedFilters.domains.includes(domainData.domain)}\n          class:text-gray-600={!selectedFilters.domains.includes(domainData.domain)}\n          class:border-transparent={!selectedFilters.domains.includes(domainData.domain)}\n          title={domainData.domain}\n        >\n          <div class=\"truncate font-medium\">{domainData.domain}</div>\n          <div class=\"flex justify-between items-center text-xs text-gray-500 mt-1\">\n            <span>{domainData.count} bookmark{domainData.count !== 1 ? 's' : ''}</span>\n            {#if !isSearchActive && domainSortMode === 'recency' && (domainData.dateAdded || domainData.latestDate)}\n              <span>{formatTimeAgo(domainData.dateAdded || domainData.latestDate)}</span>\n            {/if}\n          </div>\n        </button>\n      {/each}\n      {#if displayDomains.length > 30}\n        <div class=\"text-xs text-gray-400 px-2 py-1\">\n          ... and {displayDomains.length - 30} more\n        </div>\n      {/if}\n      {#if displayDomains.length === 0}\n        <div class=\"text-xs text-gray-400 px-2 py-2 italic\">\n          No domains found\n        </div>\n      {/if}\n    </div>\n  </div>\n  \n  <!-- Folder Filters -->\n  <div class=\"mb-6\">\n    <h4 class=\"text-xs font-medium text-gray-700 uppercase tracking-wide mb-2\">\n      {#if isSearchActive}\n        <span class=\"text-blue-600\">Matching Folders ({displayFolders.length})</span>\n      {:else}\n        Folders ({displayFolders.length})\n      {/if}\n    </h4>\n    <div class=\"space-y-1 max-h-48 overflow-y-auto\">\n      {#each displayFolders.slice(0, 15) as folder}\n        <button\n          on:click={() => toggleFolderFilter(folder)}\n          class=\"w-full text-left px-2 py-1 text-sm hover:bg-gray-100 rounded border\"\n          class:bg-green-50={selectedFilters.folders.includes(folder)}\n          class:text-green-700={selectedFilters.folders.includes(folder)}\n          class:border-green-200={selectedFilters.folders.includes(folder)}\n          class:text-gray-600={!selectedFilters.folders.includes(folder)}\n          class:border-transparent={!selectedFilters.folders.includes(folder)}\n          title={folder}\n        >\n          <span class=\"truncate block\"> {folder}</span>\n        </button>\n      {/each}\n      {#if displayFolders.length > 15}\n        <div class=\"text-xs text-gray-400 px-2 py-1\">\n          ... and {displayFolders.length - 15} more\n        </div>\n      {/if}\n      {#if displayFolders.length === 0}\n        <div class=\"text-xs text-gray-400 px-2 py-2 italic\">\n          No folders found\n        </div>\n      {/if}\n    </div>\n  </div>\n</div>\n","<script>\n  import { onMount } from 'svelte';\n  import BookmarkCard from './BookmarkCard.svelte';\n  import SearchBar from './SearchBar.svelte';\n  import Sidebar from './Sidebar.svelte';\n  import { searchBookmarks, getAllBookmarks, getBookmarksByDomain, getBookmarksByDateRange, getBookmarksByFolder } from './db.js';\n  \n  let bookmarks = [];\n  let loading = true;\n  let error = null;\n  let searchQuery = '';\n  let showSidebar = false;\n  \n  onMount(async () => {\n    try {\n      await loadBookmarks();\n    } catch (err) {\n      error = err.message;\n    } finally {\n      loading = false;\n    }\n  });\n  \n  async function loadBookmarks() {\n    bookmarks = await getAllBookmarks();\n  }\n  \n  async function handleSearch(event) {\n    const query = event.detail.query;\n    searchQuery = query;\n    \n    try {\n      loading = true;\n      bookmarks = await searchBookmarks(query);\n    } catch (err) {\n      error = err.message;\n    } finally {\n      loading = false;\n    }\n  }\n  \n  async function handleFilter(event) {\n    const { type, value } = event.detail;\n    \n    try {\n      loading = true;\n      \n      switch (type) {\n        case 'clear':\n          bookmarks = await getAllBookmarks();\n          break;\n        case 'domain':\n          bookmarks = await getBookmarksByDomain(value);\n          break;\n        case 'folder':\n          bookmarks = await getBookmarksByFolder(value);\n          break;\n        case 'date':\n          bookmarks = await getBookmarksByDateRange(value.startDate, value.endDate);\n          break;\n      }\n    } catch (err) {\n      error = err.message;\n    } finally {\n      loading = false;\n    }\n  }\n  \n  function openDashboard() {\n    chrome.tabs.create({ url: chrome.runtime.getURL('dashboard.html') });\n    window.close();\n  }\n  \n  function toggleSidebar() {\n    showSidebar = !showSidebar;\n  }\n</script>\n\n<div class=\"w-96 h-96 bg-white flex flex-col\">\n  <!-- Header -->\n  <div class=\"p-4 border-b border-gray-200 bg-gray-50\">\n    <div class=\"flex items-center justify-between mb-3\">\n      <h1 class=\"text-lg font-semibold text-gray-900\">Bookmark Insight</h1>\n      <div class=\"flex space-x-2\">\n        <button\n          on:click={toggleSidebar}\n          class=\"p-2 text-gray-400 hover:text-gray-600 rounded-md hover:bg-gray-100\"\n          title=\"Toggle Filters\"\n        >\n          <svg class=\"w-4 h-4\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.207A1 1 0 013 6.5V4z\"></path>\n          </svg>\n        </button>\n        <button\n          on:click={openDashboard}\n          class=\"px-3 py-1 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700\"\n        >\n          Dashboard\n        </button>\n      </div>\n    </div>\n    \n    <SearchBar on:search={handleSearch} />\n    \n    <div class=\"text-xs text-gray-500\">\n      {bookmarks.length} bookmark{bookmarks.length !== 1 ? 's' : ''}\n    </div>\n  </div>\n  \n  <div class=\"flex flex-1 overflow-hidden\">\n    {#if showSidebar}\n      <Sidebar on:filter={handleFilter} />\n    {/if}\n    \n    <!-- Main Content -->\n    <div class=\"flex-1 overflow-y-auto p-4\">\n      {#if loading}\n        <div class=\"flex items-center justify-center h-32\">\n          <div class=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n        </div>\n      {:else if error}\n        <div class=\"text-center text-red-600 p-4\">\n          <p>Error: {error}</p>\n          <button\n            on:click={loadBookmarks}\n            class=\"mt-2 px-3 py-1 text-sm bg-blue-600 text-white rounded-md hover:bg-blue-700\"\n          >\n            Retry\n          </button>\n        </div>\n      {:else if bookmarks.length === 0}\n        <div class=\"text-center text-gray-500 p-4\">\n          {#if searchQuery}\n            <p>No bookmarks found for \"{searchQuery}\"</p>\n          {:else}\n            <p>No bookmarks found</p>\n          {/if}\n        </div>\n      {:else}\n        <div class=\"space-y-3\">\n          {#each bookmarks as bookmark (bookmark.id)}\n            <BookmarkCard {bookmark} />\n          {/each}\n        </div>\n      {/if}\n    </div>\n  </div>\n</div>\n","import App from './App.svelte';\n\nconst app = new App({\n  target: document.body\n});\n\nexport default app;\n"],"names":["noop","run","fn","blank_object","Object","create","run_all","fns","forEach","is_function","thing","safe_not_equal","a","b","src_url_equal_anchor","current_component","src_url_equal","element_src","url","document","createElement","href","append","target","node","appendChild","insert","anchor","insertBefore","detach","parentNode","removeChild","destroy_each","iterations","detaching","i","length","d","element","name","svg_element","createElementNS","text","data","createTextNode","space","listen","event","handler","options","addEventListener","removeEventListener","attr","attribute","value","removeAttribute","getAttribute","setAttribute","set_data","set_input_value","input","toggle_class","toggle","classList","set_current_component","component","get_current_component","Error","onMount","$$","on_mount","push","createEventDispatcher","type","detail","cancelable","callbacks","bubbles","CustomEvent","custom_event","slice","call","defaultPrevented","dirty_components","binding_callbacks","render_callbacks","flush_callbacks","resolved_promise","Promise","resolve","update_scheduled","add_render_callback","seen_callbacks","Set","flushidx","flush","saved_component","update","e","pop","callback","has","add","clear","fragment","before_update","dirty","p","ctx","after_update","outroing","outros","group_outros","r","c","check_outros","transition_in","block","local","delete","transition_out","o","ensure_array_like","array_like_or_iterator","undefined","Array","from","outro_and_destroy_block","lookup","key","create_component","mount_component","m","new_on_destroy","map","filter","on_destroy","destroy_component","filtered","targets","indexOf","flush_render_callbacks","make_dirty","then","fill","init","instance","create_fragment","not_equal","props","append_styles","parent_component","bound","on_disconnect","context","Map","skip_bound","root","ready","ret","rest","hydrate","nodes","childNodes","children","l","intro","SvelteComponent","$$set","$destroy","this","$on","index","splice","$set","obj","keys","formatDate","timestamp","Date","toLocaleDateString","getFaviconUrl","bookmark","startsWith","firstLetter","domain","charAt","toUpperCase","colors","getDomainLabel","svg","path","t1_value","folderPath","p_title_value","t1","title","t3_value","t5_value","dateAdded","create_if_block_1","if_block1","create_if_block","img","src","img_src_value","h3","h3_title_value","div4","div3","div2","div1","span0","div0","button","span1","t3","t5","t8","t8_value","openBookmark","chrome","tabs","$$props","showCopied","async","stopPropagation","success","navigator","clipboard","writeText","err","console","error","copyToClipboard","$$invalidate","setTimeout","window","__svelte","v","each_value_2","positive","each_value_1","negative","each_value","phrases","div","span","div6","create_if_block_2","dispatch","debounceTimer","inputElement","placeholder","showHelp","clearSearch","query","focus","parsedQuery","regular","match","replace","trim","split","t","term","parseQueryForDisplay","clearTimeout","$$value","exports","extendStatics","setPrototypeOf","__proto__","prototype","hasOwnProperty","__extends","TypeError","String","__","constructor","__assign","assign","s","n","arguments","apply","__spreadArray","to","pack","ar","concat","_global","globalThis","self","global","isArray","extend","extension","getProto","getPrototypeOf","_hasOwn","hasOwn","prop","proto","Reflect","ownKeys","setProp","defineProperty","functionOrGetSet","get","set","configurable","writable","derive","Child","Parent","bind","getOwnPropertyDescriptor","getPropertyDescriptor","_slice","args","start","end","override","origFunc","overridedFactory","assert","asap$1","setImmediate","arrayToObject","array","extractor","reduce","result","item","nameAndValue","getByKeyPath","keyPath","rv","val","period","innerObj","substr","setByKeyPath","isFrozen","currentKeyPath","remainingKeyPath","isNaN","parseInt","delByKeyPath","kp","shallowClone","flatten","intrinsicTypeNames","num","intrinsicTypes","cloneSimpleObjectTree","k","objectIsEmpty","circularRefs","deepClone","any","WeakMap","innerDeepClone","x","toString","toStringTag","iteratorSymbol","Symbol","iterator","getIteratorOf","delArrayItem","NO_CHAR_ARRAY","getArrayOf","arrayLike","it","next","done","isAsyncFunction","idbDomErrorNames","errorList","defaultTexts","VersionChanged","DatabaseClosed","Abort","TransactionInactive","MissingAPI","DexieError","msg","message","getMultiErrorMessage","failures","join","ModifyError","successCount","failedKeys","BulkError","pos","failuresByPos","errnames","BaseException","exceptions","fullName","msgOrInner","inner","Syntax","SyntaxError","Type","Range","RangeError","exceptionMap","mapError","domError","stack","fullNameExceptions","nop","mirror","pureFunctionChain","f1","f2","callBoth","on1","on2","hookCreatingChain","res","onsuccess","onerror","res2","hookDeletingChain","hookUpdatingChain","modifications","reverseStoppableEventChain","promisableChain","thiz","debug","location","test","setDebug","INTERNAL","ZONE_ECHO_LIMIT","_a$1","globalP","crypto","subtle","nativeP","digest","Uint8Array","resolvedNativePromise","nativePromiseProto","resolvedGlobalPromise","nativePromiseThen","NativePromise","patchGlobalPromise","schedulePhysicalTick","queueMicrotask","physicalTick","asap","microtickQueue","needsNewPhysicalTick","isOutsideMicroTick","unhandledErrors","rejectingErrors","rejectionMapper","globalPSD","id","ref","unhandleds","onunhandled","pgp","env","finalize","PSD","numScheduledCalls","tickFinalizers","DexiePromise","_listeners","_lib","psd","_PSD","_state","_value","handleRejection","executePromiseTask","thenProp","microTaskId","totalEchoes","onFulfilled","onRejected","_this","possibleAwait","cleanup","decrementExpectedAwaits","reject","propagateToListener","Listener","nativeAwaitCompatibleWrap","_consoleTask","zone","promise","shouldExecuteTick","beginMicroTickScope","_then","propagateAllListeners","endMicroTickScope","ex","reason","addPossiblyUnhandledError","listeners","len","finalizePhysicalTick","listener","cb","callListener","markErrorAsHandled","usePSD","wasRootExec","unhandledErrs","finalizers","run_at_end_of_this_or_next_physical_tick","finalizer","some","PromiseReject","wrap","errorCatcher","outerScope","switchToZone","catch","finally","onFinally","timeout","ms","Infinity","handle","Timeout","snapShot","all","values","onPossibleParallellAsync","remaining","race","newPSD","newScope","scheduler","follow","zoneProps","allSettled","possiblePromises","results","status","AggregateError","failure","withResolvers","task","awaits","echoes","taskCounter","zoneStack","zoneEchoes","zone_id_counter","a1","a2","parent","PromiseProp","incrementExpectedAwaits","possiblePromise","rejection","zoneEnterEcho","targetZone","zoneLeaveEcho","bEnteringZone","currentZone","GlobalPromise","targetEnv","a3","outerZone","execInGlobalContext","enqueueNativeMicroTask","tempTransaction","db","mode","storeNames","idbdb","openComplete","letThrough","_vip","trans","_createTransaction","_dbSchema","PR1398_maxLoop","InvalidState","isOpen","warn","close","disableAutoOpen","open","_promise","idbtrans","commit","_a","_completion","dbOpenError","isBeingOpened","autoOpen","dbReadyPromise","DEXIE_VERSION","maxString","fromCharCode","minKey","INVALID_KEY_ARGUMENT","STRING_EXPECTED","connections","DBNAMES_DB","READONLY","READWRITE","combine","filter1","filter2","AnyRange","lower","lowerOpen","upper","upperOpen","workaroundForUndefinedPrimKey","Entity","cmp","ta","tb","NaN","compareUint8Arrays","getUint8Array","compareArrays","al","bl","ArrayBuffer","isView","tsTag","buffer","byteOffset","byteLength","builtInDeletionTrigger","table","yProps","schema","numFailures","_","updatesTable","where","anyOf","PropModification","spec","execute","sort","Number","BigInt","_b","remove","subtrahend_1","includes","_c","prefixToReplace","replacePrefix","substring","applyUpdateSpec","changes","keyPaths","numKeys","anythingModified","origValue","Table","_trans","writeLocked","_tx","tableName","createTask","checkTableInTransaction","NotFound","_novip","transless","trace","keyOrCrit","first","core","hook","reading","fire","indexOrCrit","WhereClause","equals","compoundIndex","indexes","primKey","ix","compound","every","_maxKey","keyPathsInValidOrder","JSON","stringify","idxByName","prevIndex","prevFilterFn","multi","idx","filterFunction","toCollection","and","count","thenShortcut","offset","limit","numRows","each","toArray","Collection","orderBy","reverse","mapToClass","mappedClass","_super","class_1","enumerable","inheritedProps","getOwnPropertyNames","propName","readHook","unsubscribe","defineClass","Class","content","auto","objToAdd","mutate","lastResult","upsert","existing","updates","changeSpecs","keyOrObject","modify","InvalidArgument","put","range","bulkGet","getMany","bulkAdd","objects","keysOrOptions","wantResults","allKeys","numObjects","objectsToAdd","bulkPut","objectsToPut","bulkUpdate","keysAndChanges","coreTable","entry","offsetMap","cache","objs","resultKeys","resultObjs","_i","Constraint","numEntries","mappedOffset","bulkDelete","Events","evs","eventName","subscriber","subscribe","addEventType","chainFunction","defaultFunction","addConfiguredEvents","subscribers","cfg","makeClassConstructor","createTableConstructor","tableSchema","_allTables","creating","updating","deleting","isPlainKeyRange","ignoreLimitFilter","algorithm","or","justLimit","replayFilter","addFilter","addReplayFilter","factory","isLimitFilter","curr","addMatchFilter","isMatch","getIndexOrStore","coreSchema","isPrimKey","primaryKey","getIndexByKeyPath","Schema","openCursor","keysOnly","dir","unique","iter","coreTrans","set_1","union","cursor","advance","stop","fail","_iterate","iterate","valueMapper","cursorPromise","wrappedFn","continue","advancer","_read","_ctx","_write","_addAlgorithm","clone","raw","Math","min","sortBy","parts","lastPart","lastIndex","getval","order","sorter","valueMapper_1","a_1","offsetLeft","rowsLeft","until","bIncludeStopEntry","last","indexName","_ondirectionchange","desc","eachKey","eachUniqueKey","eachPrimaryKey","primaryKeys","uniqueKeys","firstKey","lastKey","distinct","strKey","found","modifyer","outbound","extractKey","modifyChunkSize","_options","totalFailures","applyMutateResult","expectedCount","isUnconditionalDelete","deleteCallback","criteria","nextChunk","keysInChunk","addValues","putValues","putKeys","deleteKeys","ctx_1","changeSpec","isAdditionalChunk","coreRange","createCollectionConstructor","whereClause","keyRangeGenerator","keyRange","whereCtx","readingHook","simpleCompare","simpleCompareReverse","collectionOrWhereClause","T","collection","emptyCollection","rangeEqual","upperFactory","toLowerCase","lowerFactory","nextCasing","lowerKey","upperNeedle","lowerNeedle","llp","lwrKeyChar","addIgnoreCaseAlgorithm","needles","suffix","compare","upperNeedles","lowerNeedles","direction","nextKeySuffix","needlesLen","initDirection","needleBounds","needle","nb","createRange","firstPossibleNeedle","lowestPossibleCasing","casing","between","includeLower","includeUpper","_cmp","above","aboveOrEqual","below","belowOrEqual","str","startsWithIgnoreCase","equalsIgnoreCase","anyOfIgnoreCase","startsWithAnyOfIgnoreCase","_ascending","_descending","notEqual","inAnyRange","includeLowers","includeUppers","noneOf","ranges","ascending","descending","_min","max","_max","addRange","newRange","sortDirection","rangeSorter","rangePos","keyIsBeyondCurrentEntry","keyIsBeforeCurrentEntry","keyWithinCurrentRange","checkKey","startsWithAnyOf","createWhereClauseConstructor","orCollection","_IDBKeyRange","_deps","IDBKeyRange","eventRejectHandler","preventDefault","DEXIE_STORAGE_MUTATED_EVENT_NAME","STORAGE_MUTATED_DOM_EVENT_NAME","globalEvents","Transaction","_lock","_reculock","lockOwnerFor","_unlock","_blockedFuncs","_locked","fnAndPSD","shift","OpenFailed","active","transaction","durability","chromeTransactionDurability","ev","_reject","onabort","on","oncomplete","_resolve","storagemutated","bWriteLock","ReadOnly","_root","waitFor","promiseLike","_waitingFor","_waitingQueue","store","objectStore","spin","_spinCount","currentWaitPromise","abort","memoizedTables","_memoizedTables","transactionBoundTable","createTransactionConstructor","dbschema","storeName","complete","wasActive","createIndexSpec","nameFromKeyPath","createTableSchema","safariMultiStoreFix","getMaxKey","IdbKeyRange","only","getKeyExtractor","getSinglePathKeyExtractor","arrayify","_id_counter","getKeyPathAlias","createDBCore","tmpTrans","extractSchema","tables","objectStoreNames","autoIncrement","indexByKeyPath","isPrimaryKey","indexNames","multiEntry","hasGetAll","userAgent","makeIDBKeyRange","upperBound","lowerBound","createDbCoreTable","isAddOrPut","req","reqs","errorHandler","args1","args2","source","openKeyCursor","___id","_cursorContinue","_cursorContinuePrimaryKey","continuePrimaryKey","_cursorAdvance","doThrowCursorIsNotStarted","doThrowCursorIsStopped","gotOne","iterationPromise","resolveIteration","rejectIteration","guardedCallback","request","nonInfinitLimit","idbKeyRange","getAll","getAllKeys","count_1","req_1","result_1","keyCount","callbackCount","successHandler","_pos","tableMap","MIN_KEY","MAX_KEY","createMiddlewareStack","stackImpl","middlewares","down","createMiddlewareStacks","indexedDB","dbcore","generateMiddlewareStacks","stacks","_middlewares","tbl","setApiOnPlace","tableNames","propDesc","removeTablesApi","lowerVersionFirst","_cfg","version","runUpgraders","oldVersion","idbUpgradeTrans","globalSchema","contains","$meta","parseIndexSyntax","_storeNames","rejectTransaction","getExistingVersion","updateTablesAndIndexes","createTable","populate","patchCurrentVersion","createMissingTables","createObjectStore","ceil","buildGlobalSchema","adjustToExistingIndexNames","_loop_1","tableChange","change","recreate","addIndex","getSchemaDiff","state_1","metaVersion","queue","versions","_versions","versToRun","runQueue","oldSchema","newSchema","diff","tuple","Upgrade","store_1","deleteIndex","del","idxName","contentUpgrade","upgradeSchema_1","returnValue_1","contentUpgradeIsAsync_1","promiseFollowed","decrementor","deleteRemovedTables","deleteObjectStore","oldDef","newDef","def","oldIndexes","newIndexes","oldIdx","newIdx","createIndex","j","idbindex","readGlobalSchema","verno","verifyInstalledSchema","ch","_hasGetAll","dexieName","indexSpec","WorkerGlobalScope","primKeyAndIndexes","indexNum","typeSplit","Version","_createTableSchema","_parseIndexSyntax","_parseStoresSpec","stores","outSchema","tblSchema","storesSource","storesSpec","upgrade","upgradeFunction","createVersionConstructor","versionNumber","getDbNamesTable","dbNamesDB","Dexie$1","addons","dbnames","hasDatabasesNative","databases","getDatabaseNames","infos","info","_onDatabaseCreated","_onDatabaseDeleted","vip","idbReady","intervalId","userAgentData","tryIdb","setInterval","clearInterval","isEmptyRange","RangeSet","fromOrTree","left","right","rebalance","rightWasCutOff","mergeRanges","newSet","_addRangeSet","rangesOverlap","rangeSet1","rangeSet2","i1","getRangeSetIterator","nextResult1","i2","nextResult2","state","keyProvided","up","rootClone","oldRootRight","computeDepth","extendObservabilitySet","part","obsSetsOverlap","os1","os2","rangeSet","addKey","addKeys","hasKey","unsignaledParts","isTaskEnqueued","signalSubscribersLazily","optimistic","signalSubscribersNow","updatedParts","deleteAffectedCacheEntries","queriesToSignal","collectTableSubscribers","tblCache","exec","dbName","requery","outQueriesToSignal","updatedEntryLists","entries","queries","filteredEntries","entries_1","obsSet","_d","updatedEntryLists_1","_e","dexieOpen","openCanceller","nativeVerToOpen","round","schemaPatchMode","throwIfCancelled","resolveDbReady","dbReadyResolve","upgradeTransaction","wasCreated","tryOpenDB","autoSchema","onblocked","_fireOnBlocked","onupgradeneeded","allowEmptyDB","delreq","deleteDatabase","NoSuchDatabase","oldVer","pow","onversionchange","vcFired","onclose","onReadyBeingFired","fireRemainders","remainders_1","_close","everything_1","awaitIterator","callNext","doThrow","throw","onSuccess","step","onError","getNext","extractTransactionArgs","_tableArgs_","scopeFunc","enterTransactionScope","parentTransaction","explicit","_explicit","returnValue","scopeFuncIsAsync","PrematureCommit","pad","createVirtualIndexMiddleware","indexLookup","allVirtualIndexes","addVirtualIndexes","keyTail","lowLevelIndex","keyPathAlias","indexList","keyLength","isVirtual","virtualIndex","findBestIndex","translateRange","translateRequest","createVirtualCursor","_continue","virtualCursor","virtualIndexMiddleware","level","getObjectDiff","prfx","ap","bp","apTypeName","getEffectiveKeys","hooksMiddleware","downCore","downTable","tableMiddleware","dxTrans","addPutOrDelete","deleteRange","getExistingValues","existingValues","contexts","existingValue","generatedPrimaryKey","objectDiff","additionalChanges_1","requestedValue_1","deleteNextChunk","effectiveKeys","getFromTransactionCache","cacheExistingValuesMiddleware","cachedResult","isCachableContext","subscr","isCachableRequest","observabilityMiddleware","FULL_RANGE","querier","indexesWithAutoIncPK","tableClone","mutatedParts","getRangeSet","pkRangeSet","delsRangeSet","newObjs","oldCache","oldObjs","trackAffectedIndexes","idxVals","pkPos","findIndex","getRange","readSubscribers","method","isLiveQuery","pkRangeSet_1","delsRangeSet_1","queriedIndex","queriedRanges","keysPromise_1","resultingKeys","pKeys","cursor_1","wantValues_1","pkey","addAffectedIndex","addKeyOrKeys","oldKey","newKey","adjustOptimisticFromFailures","numBulkOps","isAboveLower","isBelowUpper","isWithinRange","applyOptimisticOps","ops","cacheEntry","immutable","queryRange","extractPrimKey","extractIndex","extractLowLevelIndex","finalResult","op","modifedResult","includedValues","includedPKs","pk","existingKeys_1","keySet_1","keysToDelete_1","range_1","freeze","areRangesEqual","r1","r2","compareLowers","lower1","lower2","lowerOpen1","lowerOpen2","compareUppers","upper1","upper2","upperOpen1","upperOpen2","isSuperRange","findCompatibleQuery","equalEntry","find","countQuery","subscribeToCacheEntry","container","signal","size","enqueForDeletion","cacheMiddleware","coreMW","ac_1","AbortController","endTransaction","wasCommitted","affectedSubscribers_1","stores_1","optimisticOps","_f","_g","_h","freezeResults","modRes","tableMW","adjustedReq","reqWithResolvedKeys","valueWithKey","exactMatch","vipify","vipDb","Proxy","receiver","domDeps","Dexie","deps","dependencies","cancelOpen","once","bSticky","db_1","newVersion","use","vipDB","addon","versionInstance","_whenReady","unuse","mw","closeOptions","hasInvalidArguments","doDelete","backendDB","hasBeenClosed","hasFailed","dynamicallyOpened","_transaction","idbMode","onlyIfCompatible","SubTransaction","enterTransaction","InvalidTable","symbolObservable","observable","Observable","_subscribe","mozIndexedDB","webkitIndexedDB","msIndexedDB","webkitIDBKeyRange","liveQuery","currentValue","hasValue","observer","abortController","closed","accumMuts","currentObs","subscription","startedListening","mutationListener","doQuery","_doQuery","shouldNotify","aborted","getValue","propagateLocally","updateParts","wasMe","propagatingLocally","databaseName","exists","ignoreTransaction","generatorFn","spawn","currentTransaction","promiseOrFunction","optionalTimeout","semVer","maxKey","dispatchEvent","event_1","bc","createBC","BroadcastChannel","onmessage","unref","changedParts","postMessage","disableBfCache","persisted","connections_1","default","DexieSymbol","for","_Dexie","getAllBookmarks","bookmarks","enrichmentQueue","events","settings","tx","log","similarities","computedMetrics","CACHE_DURATIONS","getConsolidatedDomainAnalytics","computeFn","ttlMs","cached","validUntil","now","computedAt","getCachedMetric","domainData","latestDate","oldestDate","enrichedCount","lastChecked","domainArray","totalBookmarks","percentage","byRecency","byCount","top10","totalDomains","t0_value","dateRange","t0","button0","button1","t_value","formatTimeAgo","t2_value","t4_value","create_if_block_5","button_title_value","domains","t2","t4","folders","each_value_3","if_block","create_if_block_9","create_if_block_7","create_if_block_6","create_if_block_4","create_if_block_3","button2","div9","h40","h41","div5","div8","h42","div7","days","floor","searchResultStats","isSearchActive","domainsByRecency","domainsByCount","selectedFilters","domainSortMode","toggleDomainFilter","dispatchFilters","toggleFolderFilter","folder","f","applyDateFilter","startDate","getTime","getFullYear","getMonth","endDate","setDateFilter","getDomainsByRecency","getDomainsByCount","loadDomains","getUniqueFolders","displayDomains","displayFolders","get_key","old_blocks","dynamic","list","destroy","create_each_block","get_context","old_indexes","new_blocks","new_lookup","deltas","child_ctx","abs","will_move","did_move","new_block","old_block","new_key","old_key","t6_value","h1","openDashboard","current","t6","runtime","getURL","loading","searchQuery","showSidebar","loadBookmarks","lowerQuery","description","keywords","searchBookmarks","getBookmarksByDomain","getBookmarksByFolder","getBookmarksByDateRange","app","body"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,9,10,12,13]}